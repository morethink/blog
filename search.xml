<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Python è±†ç“£é¡¶å¸–</title>
      <link href="/Python/douban-ding/"/>
      <url>/Python/douban-ding/</url>
      
        <content type="html"><![CDATA[<p><img src="https://images.morethink.cn/278d71ed0f07f6d1d72a8afa76039cc2.png" alt="" title="ğŸ†™ğŸ†™"></p><p>ç”±äºåœ¨è±†ç“£å‘äº†ä¸ªç§Ÿæˆ¿å¸–å­ï¼Œå‘ç°å¾ˆå¿«å°±è¢«å…¶ä»–çš„å¸–å­æ·¹æ²¡ï¼Œä½†æ˜¯æ‰‹åŠ¨é¡¶å¸–å®åœ¨å¤ªç´¯ï¼ŒğŸ˜­ï¼Œæ‰€ä»¥æƒ³é€šè¿‡è‡ªåŠ¨é¡¶å¸–çš„æ–¹å¼æ¥è§£æ”¾åŒæ‰‹ï¼</p><a id="more"></a><h1 id="è¯„è®ºè¯·æ±‚åˆ†æ"><a href="#è¯„è®ºè¯·æ±‚åˆ†æ" class="headerlink" title="è¯„è®ºè¯·æ±‚åˆ†æ"></a>è¯„è®ºè¯·æ±‚åˆ†æ</h1><p>é€šè¿‡Chrome network åˆ†æ</p><p><img src="https://images.morethink.cn/4220f35fed72284a44099dfcf27028d8.png" alt="" title="add_comment"></p><ul><li>è¯„è®ºurlæ˜¯<code>https://www.douban.com/group/topic/129122199/add_comment</code></li><li>éœ€è¦å¸¦5ä¸ªå‚æ•°ï¼Œå…¶ä¸­ ck æ˜¯ cookie é‡Œé¢çš„å€¼ï¼Œrv_comment æ˜¯ è¯„è®º</li><li>è¿”å›302ä»£è¡¨é‡å®šå‘</li></ul><p>Python æ¨¡æ‹Ÿè¯·æ±‚ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è±†ç“£å…·ä½“å¸–å­</span></span><br><span class="line">url = <span class="string">"https://www.douban.com/group/topic/129122199/"</span></span><br><span class="line"><span class="comment"># è±†ç“£å…·ä½“å¸–å­å›å¤çš„æ¥å£ï¼Œæ ¼å¼æ˜¯å¸–å­é“¾æ¥+/add_comment</span></span><br><span class="line">comment_url = url + <span class="string">"/add_comment"</span></span><br><span class="line">cookie = <span class="string">'cookie'</span></span><br><span class="line">referer = url</span><br><span class="line">agent = <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36'</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">"Host"</span>: <span class="string">"www.douban.com"</span>,</span><br><span class="line">    <span class="string">"Referer"</span>: referer,</span><br><span class="line">    <span class="string">'User-Agent'</span>: agent,</span><br><span class="line">    <span class="string">"Cookie"</span>: cookie</span><br><span class="line">&#125;</span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">"rv_comment"</span>: <span class="string">'ğŸ†™'</span>,</span><br><span class="line">    <span class="string">"ck"</span>: re.findall(<span class="string">"ck=(.*?);"</span>, headers[<span class="string">"Cookie"</span>])[<span class="number">-1</span>],</span><br><span class="line">    <span class="string">'start'</span>: <span class="string">'0'</span>,</span><br><span class="line">    <span class="string">'submit_btn'</span>: <span class="string">'å‘é€'</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.post(comment_url, headers=headers, allow_redirects=<span class="keyword">False</span>,</span><br><span class="line">                         data=params, verify=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¿è¡Œå³å¯ã€‚</p><p>ä½†æ˜¯å¤šè¿è¡Œå‡ æ¬¡å°±ä¼šå‘ç°ï¼Œè¿”å›çš„çŠ¶æ€ç æ˜¯200ï¼Œè€Œä¸”æ²¡æœ‰é¡¶å¸–æˆåŠŸã€‚å®é™…ä¸Šæ˜¯è§¦å‘äº†è±†ç“£çš„é˜²çˆ¬è™«ã€‚</p><p><img src="https://images.morethink.cn/96695d5876d98ca99abc79866020a284.png" alt="" title="è§¦å‘äº†è±†ç“£éªŒè¯ç "></p><p>è€Œä¸”åœ¨æˆ‘ä»¬é¡¶å¸–çš„æ—¶å€™å‘é€è¯·æ±‚çš„æ—¶å€™è¿˜å¸¦æœ‰ captcha-solution å’Œ captcha-id å­—æ®µã€‚</p><p><img src="https://images.morethink.cn/8a57550867a8e02b3272d6043632f51b.png" alt=""></p><p>ç›®å‰å‘ç°ï¼Œæ¯æ¬¡è¯„è®ºå°±ç®—ç›¸éš”1åˆ†é’Ÿï¼Œåªè¦æ»¡3æ¬¡ï¼Œå°±ä¸€å®šä¼šå¼¹å‡ºè¿™ä¸ªéªŒè¯ç è¿›è¡ŒéªŒè¯ã€‚</p><h1 id="éªŒè¯ç è§£æ"><a href="#éªŒè¯ç è§£æ" class="headerlink" title="éªŒè¯ç è§£æ"></a>éªŒè¯ç è§£æ</h1><p>é‡åˆ°éªŒè¯ç æˆ‘ä»¬å°±æ¥ç ´è§£éªŒè¯ç ã€‚</p><h2 id="tesserocr"><a href="#tesserocr" class="headerlink" title="tesserocr"></a>tesserocr</h2><p>è¯†åˆ«å›¾å½¢éªŒè¯ç éœ€è¦å®‰è£…tesserocrè¿™ä¸ªåº“ï¼Œä¸‹é¢ä»‹ç»ä¸‹tesserocrã€‚</p><p>tesserocræ˜¯Pythonçš„ä¸€ä¸ªOCRè¯†åˆ«åº“ï¼Œä½†å…¶å®æ˜¯å¯¹tesseractåšäº†ä¸€å±‚Python Apiçš„å°è£…ï¼Œæ ¸å¿ƒè¿˜æ˜¯tesseractï¼Œæ‰€ä»¥åœ¨å®‰è£…tesserocrä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…tesseractã€‚<code>Tesseract</code>(/â€˜tesÉ™rÃ¦kt/) è¿™ä¸ªè¯çš„æ„æ€æ˜¯â€è¶…ç«‹æ–¹ä½“â€ï¼ŒæŒ‡çš„æ˜¯å‡ ä½•å­¦é‡Œçš„å››ç»´æ ‡å‡†æ–¹ä½“ï¼Œåˆç§°â€æ­£å…«èƒä½“â€ï¼Œæ˜¯ä¸€æ¬¾è¢«å¹¿æ³›ä½¿ç”¨çš„å¼€æº <code>OCR</code> å·¥å…·ã€‚</p><p>åœ¨Macä¸‹ï¼Œä½¿ç”¨ brew å®‰è£…</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install tesseract --all-languages</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å†å®‰è£…tesserocrå³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew install imagemagick</span><br><span class="line">pip install tesserocr pillow</span><br></pre></td></tr></table></figure><p>Python ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> tesserocr</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># æ–°å»ºImageå¯¹è±¡</span></span><br><span class="line">    image = Image.open(<span class="string">"/Users/liwenhao/Desktop/douban-captcha-example1.jpeg"</span>)</span><br><span class="line">    <span class="comment"># è°ƒç”¨tesserocrçš„image_to_text()æ–¹æ³•ï¼Œä¼ å…¥imageå¯¹è±¡å®Œæˆè¯†åˆ«</span></span><br><span class="line">    result = tesserocr.image_to_text(image)</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure><p>éªŒè¯çš„å›¾ç‰‡å¦‚ä¸‹ï¼š</p><p><img src="https://images.morethink.cn/douban-captcha-example1.jpeg" alt="douban-captcha-example1" title="douban-captcha-example1"></p><p>ç»“æœæ— æ³•è¯†åˆ«ã€‚</p><p>æ¢ä¸€å¼ ç®€å•çš„å›¾ç‰‡è¯•è¯•ï¼š<br><img src="http://images.morethink.cn/captcha-example1.jpg" alt="captcha-example1.jpg"></p><p>ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">5594</span><br></pre></td></tr></table></figure></p><p>çœ‹æ¥ Tesseract åªèƒ½è¯†åˆ«ä¸€äº›ç®€å•çš„éªŒè¯ç ï¼Œä¸é€‚åˆè±†ç“£éªŒè¯ç è¯†åˆ«ã€‚</p><p>è¯•è¯•è¯†åˆ«éªŒè¯ç å¹³å°ã€‚</p><h2 id="ç™¾åº¦OCR"><a href="#ç™¾åº¦OCR" class="headerlink" title="ç™¾åº¦OCR"></a>ç™¾åº¦OCR</h2><p><strong>å®˜æ–¹æ¥å…¥æ–‡æ¡£</strong>: <a href="https://link.juejin.im?target=https%3A%2F%2Fcloud.baidu.com%2Fdoc%2FOCR%2FOCR-Python-SDK.html%23.E5.BF.AB.E9.80.9F.E5.85.A5.E9.97.A8" target="_blank" rel="noopener">æ–‡å­—è¯†åˆ«-Python SDKæ¥å…¥æ–‡æ¡£</a></p><ul><li><strong>é‡ç‚¹ï¼šå…è´¹</strong>  </li><li>é€šç”¨è¯†åˆ«ï¼ˆåŒ…æ‹¬èº«ä»½è¯ã€é“¶è¡Œå¡ï¼‰500æ¬¡/æ—¥ï¼Œ  </li><li>é«˜ç²¾åº¦åˆ™50æ¬¡/æ—¥ï¼Œ  </li><li>é©¾é©¶è¯ï¼Œè¡Œé©¶è¯ï¼Œè½¦ç¥¨ï¼Œè¥ä¸šæ‰§ç…§ï¼Œé€šç”¨ç¥¨æ®å‡ä¸º200æ¬¡/æ—¥  </li></ul><p>æ³¨æ„ï¼š<br><strong>æ”¯æŒ2.7.+åŠ3.+</strong></p><h3 id="é…ç½®æµç¨‹ï¼š"><a href="#é…ç½®æµç¨‹ï¼š" class="headerlink" title="é…ç½®æµç¨‹ï¼š"></a>é…ç½®æµç¨‹ï¼š</h3><ol><li>å…ˆå¼€é€šä¸ªç™¾åº¦çš„è´¦å·ï¼›  </li><li>å¼€é€š<strong>æ–‡å­—è¯†åˆ«æœåŠ¡</strong>ï¼Œæ‰“å¼€åç‚¹å‡»ç«‹å³ä½¿ç”¨ï¼š<a href="https://cloud.baidu.com/product/ocr.html" target="_blank" rel="noopener">https://cloud.baidu.com/product/ocr.html</a>  </li><li>ç‚¹å‡»æ­¥éª¤2ï¼Œåº”è¯¥æœ‰ä¸ªä¿¡æ¯ç¡®è®¤çš„ï¼Œç¡®è®¤åï¼Œä¼šè¿›å…¥åˆ°ç”¨æˆ·ä¸ªäººé¦–é¡µï¼Œå‘ä¸‹æ»‘åŠ¨ï¼Œç›´æ¥ç‚¹å‡»æ–‡å­—è¯†åˆ«:<br><img src="https://user-gold-cdn.xitu.io/2018/6/11/163ecde99a94d224?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></li><li>ç‚¹å‡»åˆ›å»ºåº”ç”¨ï¼Œè¾“å…¥ä¸€å †å†…å®¹åï¼Œç‚¹å‡»ç¡®è®¤å³å¯ï¼Œç„¶åç‚¹å‡»æˆ‘çš„åº”ç”¨ï¼Œè¿™é‡Œé¢çš„<strong>API Key</strong> è·Ÿ<strong>Secret Key</strong>éœ€è¦ä½¿ç”¨åˆ°: <img src="https://user-gold-cdn.xitu.io/2018/6/11/163ece17b329ea80?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></li><li><p>ç‚¹å‡»å³ä¸Šè§’ï¼Œç”¨æˆ·ä¸­å¿ƒï¼Œç”¨æˆ·IDä¹Ÿéœ€è¦ç”¨åˆ°:<br><img src="https://user-gold-cdn.xitu.io/2018/6/11/163ece27d4bc3e76?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></p></li><li><p>éœ€è¦çš„ä¿¡æ¯å‡†å¤‡å¥½äº†ï¼Œ<strong>pip</strong> å®‰è£…ä¸€æ³¢</p> <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip install baidu-aip</span><br></pre></td></tr></table></figure></li></ol><h3 id="æµ‹è¯•ä¸€æ³¢"><a href="#æµ‹è¯•ä¸€æ³¢" class="headerlink" title="æµ‹è¯•ä¸€æ³¢"></a>æµ‹è¯•ä¸€æ³¢</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> aip <span class="keyword">import</span> AipOcr</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    APP_ID = <span class="string">' '</span></span><br><span class="line">    API_KEY = <span class="string">' '</span></span><br><span class="line">    SECRET_KEY = <span class="string">' '</span></span><br><span class="line"></span><br><span class="line">    client = AipOcr(APP_ID, API_KEY, SECRET_KEY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–å›¾ç‰‡</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_file_content</span><span class="params">(file_path)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(file_path, <span class="string">'rb'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            <span class="keyword">return</span> fp.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    image = get_file_content(<span class="string">'/Users/liwenhao/Desktop/douban-captcha-example2.jpg'</span>)</span><br><span class="line">    <span class="string">""" è°ƒç”¨é€šç”¨æ–‡å­—è¯†åˆ«(é«˜ç²¾åº¦), å›¾ç‰‡å‚æ•°ä¸ºæœ¬åœ°å›¾ç‰‡ """</span></span><br><span class="line">    result = json.dumps(client.basicAccurate(image))</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure><p>éªŒè¯çš„å›¾ç‰‡å¦‚ä¸‹ï¼š</p><p><img src="https://images.morethink.cn/douban-captcha-example1.jpeg" alt="douban-captcha-example1" title="douban-captcha-example1"></p><p>ç»“æœèµ°ä¸€æ³¢ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;log_id&quot;: 3968431492157876638, &quot;words_result_num&quot;: 1, &quot;words_result&quot;: [&#123;&quot;words&quot;: &quot; minute:&quot;&#125;]&#125;</span><br></pre></td></tr></table></figure><p>ä»ç»“æœå¯ä»¥çœ‹å‡ºè¯†åˆ«å‡ºäº†è¿™ä¸ªéªŒè¯ç ã€‚</p><ul><li><code>words_result_num</code> æ˜¯è¯†åˆ«ç»“æœæ•°</li><li><code>words_result</code> æ˜¯å®šä½å’Œè¯†åˆ«ç»“æœæ•°ç»„</li><li><code>words</code> æ˜¯è¯†åˆ«ç»“æœå­—ç¬¦ä¸²</li></ul><p>å†æ¥è¯•è¯•</p><p><img src="https://images.morethink.cn/douban-captcha-example2.jpg" alt="douban-captcha-example2" title="douban-captcha-example2"></p><p>ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;log_id&quot;: 5251449865676063710, &quot;words_result_num&quot;: 0, &quot;words_result&quot;: []&#125;</span><br></pre></td></tr></table></figure></p><p>æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Œå¯ä»¥çœ‹åˆ°å¯¹äºå¤æ‚ä¸€äº›çš„éªŒè¯ç è¿˜æ˜¯ä¼šå‡ºç°æ— æ³•è¯†åˆ«çš„æƒ…å†µï¼Œä½†æ˜¯èƒœåœ¨å…è´¹ã€‚</p><h2 id="è¶…çº§é¹°"><a href="#è¶…çº§é¹°" class="headerlink" title="è¶…çº§é¹°"></a>è¶…çº§é¹°</h2><p>å¯¹äºæ— æ³•è¯†åˆ«çš„æƒ…å†µå°±éœ€è¦æ‰“ç å¹³å°äº†ï¼Œä¸šç•Œæ¯”è¾ƒå‡ºåçš„æ˜¯ <a href="https://link.juejin.im?target=http%3A%2F%2Fwww.chaojiying.com%2F" target="_blank" rel="noopener">è¶…çº§é¹°</a> ã€‚</p><p>è¶…çº§é¹°æ˜¯æŒ‰é‡çº§æ”¶è´¹ï¼Œé‡å¤§ä¾¿å®œï¼Œæ ‡å‡†ä»·æ ¼:1å…ƒ=1000é¢˜åˆ†ï¼Œä¸åŒéªŒè¯ç ç±»å‹ï¼Œéœ€è¦çš„é¢˜åˆ†ä¸ä¸€æ ·ï¼Œè¯¦æƒ…å¯ä»¥åˆ°è¿™é‡ŒæŸ¥è¯¢ <a href="http://www.chaojiying.com/price.html" target="_blank" rel="noopener">http://www.chaojiying.com/price.html</a></p><p>python ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡è¶…çº§é¹°è¯†åˆ«éªŒè¯ç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recognition_captcha</span><span class="params">(filename, code_type)</span>:</span></span><br><span class="line">    im = open(filename, <span class="string">'rb'</span>).read()</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'user'</span>: <span class="string">'è´¦å·'</span>,</span><br><span class="line">        <span class="string">'pass2'</span>: md5(<span class="string">'å¯†ç '</span>.encode(<span class="string">'utf8'</span>)).hexdigest(),</span><br><span class="line">        <span class="string">'softid'</span>: <span class="string">'softid'</span>,</span><br><span class="line">        <span class="string">'codetype'</span>: code_type</span><br><span class="line">    &#125;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'Connection'</span>: <span class="string">'Keep-Alive'</span>,</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    files = &#123;<span class="string">'userfile'</span>: (<span class="string">'ccc.jpg'</span>, im)&#125;</span><br><span class="line">    resp = requests.post(<span class="string">'http://upload.chaojiying.net/Upload/Processing.php'</span>, data=params, files=files,</span><br><span class="line">                         headers=headers).json()</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ä»£ç </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    print(json.dumps(recognition_captcha(<span class="string">'/Users/liwenhao/Desktop/douban-captcha-example2.jpg'</span>, <span class="number">1006</span>)))</span><br></pre></td></tr></table></figure></p><p>ä¸Šä¼ çš„éªŒè¯ç å°±æ˜¯ä¸Šé¢ç™¾åº¦ OCR æœªæ›¾è¯†åˆ«çš„éªŒè¯ç ï¼Œå¦‚ä¸‹ï¼š</p><p><img src="https://images.morethink.cn/douban-captcha-example2.jpg" alt="douban-captcha-example2" title="douban-captcha-example2"><br>ç»“æœå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;&quot;err_str&quot;: &quot;OK&quot;, &quot;err_no&quot;: 0, &quot;md5&quot;: &quot;0475b05654c376deb409bfef7eee75cd&quot;, &quot;pic_id&quot;: &quot;8054415552001300054&quot;, &quot;pic_str&quot;: &quot;yacvmd&quot;&#125;</span><br></pre></td></tr></table></figure></p><p>å‘ç° éªŒè¯ç  <code>yacvmd</code> å·²å‡ºæ¥ã€‚ä½†æ˜¯æ—¶é—´èŠ±äº†5så·¦å³ã€‚åæ¥æµ‹è¯•å‘ç°å¯¹äºè±†ç“£æ¯”è¾ƒå»ºçš„éªŒè¯ç èŠ±è´¹çš„æ—¶é—´åœ¨1så†…ï¼Œå› æ­¤ä»æ—¶é—´å’Œå‡†ç¡®æ€§ä¸Šé¢ï¼Œæœ€åè¿˜æ˜¯é‡‡ç”¨äº†è¶…çº§é¹°æ‰“ç å¹³å°ã€‚</p><h1 id="å¤±è´¥å¾®ä¿¡é€šçŸ¥"><a href="#å¤±è´¥å¾®ä¿¡é€šçŸ¥" class="headerlink" title="å¤±è´¥å¾®ä¿¡é€šçŸ¥"></a>å¤±è´¥å¾®ä¿¡é€šçŸ¥</h1><p>æ— è®ºé‡‡ç”¨ä»€ä¹ˆæ–¹å¼ï¼Œéƒ½æœ‰å¯èƒ½å‡ºç°å¤±è´¥çš„æƒ…å†µï¼Œæˆ‘æ€»ä¸èƒ½é‡‡å– è½®è¯¢ çš„æ–¹å¼ï¼Œéš”å‡ ä¸ªå°æ—¶å°±å»çœ‹çœ‹åˆ°åº•å‰é¢å‡ æ¬¡æ˜¯å¦ğŸ†™æˆåŠŸï¼Œå› æ­¤éœ€è¦ä¸€ä¸ª å¼‚æ­¥é€šçŸ¥ ï¼Œæœ€å¼€å§‹æƒ³ç”¨ é‚®ä»¶ï¼Œåæ¥å‘ç°äº† <a href="http://sc.ftqq.com/3.version" target="_blank" rel="noopener">Serveré…±</a> è¿™ä¸ªç¥å™¨ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘é€å¾®ä¿¡é€šçŸ¥ï¼Œè€Œä¸”ç‰¹åˆ«ç®€å•ã€‚</p><p>å…·ä½“å¯ä»¥æŸ¥çœ‹ <a href="http://sc.ftqq.com/3.version" target="_blank" rel="noopener">Serveré…±</a>ã€‚</p><h1 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h1><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> html</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"></span><br><span class="line">logging.basicConfig(level=logging.INFO, format=<span class="string">'%(asctime)s.%(msecs)03d %(levelname)s: %(message)s'</span>,</span><br><span class="line">                    datefmt=<span class="string">'%Y-%m-%d %H:%M:%S'</span>)</span><br><span class="line">urllib3.disable_warnings()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½éªŒè¯ç å›¾ç‰‡</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">download_captcha</span><span class="params">(captcha_url, agent)</span>:</span></span><br><span class="line">    <span class="comment"># findallè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨</span></span><br><span class="line">    captcha_name = re.findall(<span class="string">"id=(.*?):"</span>, captcha_url)</span><br><span class="line">    filename = <span class="string">"douban_%s.jpg"</span> % (str(captcha_name[<span class="number">0</span>]))</span><br><span class="line">    logging.info(<span class="string">"æ–‡ä»¶åä¸º: "</span> + filename)</span><br><span class="line">    <span class="keyword">with</span> open(filename, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># ä»¥äºŒè¿›åˆ¶å†™å…¥çš„æ¨¡å¼åœ¨æœ¬åœ°æ„å»ºæ–°æ–‡ä»¶</span></span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">'User-Agent'</span>: agent,</span><br><span class="line">            <span class="string">'Referer'</span>: captcha_url</span><br><span class="line">        &#125;</span><br><span class="line">        f.write(requests.get(captcha_url, headers=header).content)</span><br><span class="line">        logging.info(<span class="string">"%s ä¸‹è½½å®Œæˆ"</span> % filename)</span><br><span class="line">    <span class="keyword">return</span> filename</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡è¶…çº§é¹°è¯†åˆ«éªŒè¯ç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">recognition_captcha</span><span class="params">(filename, code_type)</span>:</span></span><br><span class="line">    im = open(filename, <span class="string">'rb'</span>).read()</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">'user'</span>: <span class="string">'ç”¨æˆ·'</span>,</span><br><span class="line">        <span class="string">'pass2'</span>: md5(<span class="string">'å¯†ç '</span>.encode(<span class="string">'utf8'</span>)).hexdigest(),</span><br><span class="line">        <span class="string">'softid'</span>: <span class="string">'softid'</span>,</span><br><span class="line">        <span class="string">'codetype'</span>: code_type</span><br><span class="line">    &#125;</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">'Connection'</span>: <span class="string">'Keep-Alive'</span>,</span><br><span class="line">        <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    files = &#123;<span class="string">'userfile'</span>: (<span class="string">'ccc.jpg'</span>, im)&#125;</span><br><span class="line">    resp = requests.post(<span class="string">'http://upload.chaojiying.net/Upload/Processing.php'</span>, data=params, files=files,</span><br><span class="line">                         headers=headers).json()</span><br><span class="line">    <span class="comment"># é”™è¯¯å¤„ç†</span></span><br><span class="line">    <span class="keyword">if</span> resp.get(<span class="string">'err_no'</span>, <span class="number">0</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> resp.get(<span class="string">'pic_str'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">result_verification</span><span class="params">(response)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> response.status_code == <span class="number">302</span>:</span><br><span class="line">        logging.info(<span class="string">"è±†ç“£dingæˆåŠŸ"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        logging.info(response.status_code)</span><br><span class="line">        logging.info(response)</span><br><span class="line">        url = <span class="string">"https://sc.ftqq.com/ä½ çš„SCKEY.send?text=doubanå¤±è´¥"</span> + \</span><br><span class="line">              str(random.randint(<span class="number">0</span>, <span class="number">1000</span>))</span><br><span class="line">        requests.post(url)</span><br><span class="line">        logging.info(<span class="string">"è±†ç“£dingå¤±è´¥ï¼Œå‘é€å¤±è´¥ä¿¡æ¯åˆ°å¾®ä¿¡"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è±†ç“£é¡¶å¸–</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">douban_ding</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="comment"># è±†ç“£å…·ä½“å¸–å­</span></span><br><span class="line">    url = <span class="string">"https://www.douban.com/group/topic/129122199/"</span></span><br><span class="line">    <span class="comment"># è±†ç“£å…·ä½“å¸–å­å›å¤çš„æ¥å£ï¼Œæ ¼å¼æ˜¯å¸–å­é“¾æ¥+/add_comment</span></span><br><span class="line">    comment_url = url + <span class="string">"/add_comment"</span></span><br><span class="line">    cookie = <span class="string">'cookie'</span></span><br><span class="line">    referer = url</span><br><span class="line">    agent = <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.181 Safari/537.36'</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">"Host"</span>: <span class="string">"www.douban.com"</span>,</span><br><span class="line">        <span class="string">"Referer"</span>: referer,</span><br><span class="line">        <span class="string">'User-Agent'</span>: agent,</span><br><span class="line">        <span class="string">"Cookie"</span>: cookie</span><br><span class="line">    &#125;</span><br><span class="line">    params = &#123;</span><br><span class="line">        <span class="string">"rv_comment"</span>: <span class="string">'ğŸ†™'</span>,</span><br><span class="line">        <span class="string">"ck"</span>: re.findall(<span class="string">"ck=(.*?);"</span>, headers[<span class="string">"Cookie"</span>])[<span class="number">-1</span>],</span><br><span class="line">        <span class="string">'start'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'submit_btn'</span>: <span class="string">'å‘é€'</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.get(url, headers=headers, verify=<span class="keyword">False</span>).content.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    selector = html.fromstring(response)</span><br><span class="line">    captcha_image = selector.xpath(<span class="string">"//img[@id=\"captcha_image\"]/@src"</span>)</span><br><span class="line">    <span class="keyword">if</span> captcha_image:</span><br><span class="line">        logging.info(<span class="string">"å‘ç°éªŒè¯ç ï¼Œä¸‹è½½éªŒè¯ç "</span>)</span><br><span class="line">        captcha_id = selector.xpath(<span class="string">"//input[@name=\"captcha-id\"]/@value"</span>)</span><br><span class="line">        filename = download_captcha(captcha_image[<span class="number">0</span>], agent)</span><br><span class="line">        captcha_solution = recognition_captcha(filename, <span class="number">1006</span>)</span><br><span class="line">        os.remove(filename)</span><br><span class="line">        params[<span class="string">'captcha-solution'</span>] = captcha_solution</span><br><span class="line">        params[<span class="string">'captcha-id'</span>] = captcha_id</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        logging.info(<span class="string">"æ²¡æœ‰éªŒè¯ç "</span>)</span><br><span class="line">    response = requests.post(comment_url, headers=headers, allow_redirects=<span class="keyword">False</span>,</span><br><span class="line">                             data=params, verify=<span class="keyword">False</span>)</span><br><span class="line">    result_verification(response)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    douban_ding()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><ol><li><p>ç¬¬1æ¬¡ï¼š</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2018-12-30 16:09:35.589 INFO: æ²¡æœ‰éªŒè¯ç </span><br><span class="line">2018-12-30 16:09:36.436 INFO: è±†ç“£dingæˆåŠŸ</span><br></pre></td></tr></table></figure></li><li><p>ç¬¬4æ¬¡ï¼š</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">2018-12-30 16:13:02.135 INFO: å‘ç°éªŒè¯ç ï¼Œä¸‹è½½éªŒè¯ç </span><br><span class="line">2018-12-30 16:13:02.135 INFO: æ–‡ä»¶åä¸º: douban_OJGsVa0hST4O2WhFA0VpMnR9.jpg</span><br><span class="line">2018-12-30 16:13:02.554 INFO: douban_OJGsVa0hST4O2WhFA0VpMnR9.jpg ä¸‹è½½å®Œæˆ</span><br><span class="line">2018-12-30 16:13:09.687 INFO: è±†ç“£dingæˆåŠŸ</span><br></pre></td></tr></table></figure></li></ol><p>æ•ˆæœå›¾ï¼š</p><p><img src="https://images.morethink.cn/b9eeaa536e309a201824eac764d11e33.png" alt=""></p><p>æ³¨ï¼š</p><ol><li>é¡¶å¸–çš„æ—¶å€™æ§åˆ¶å¥½é¢‘ç‡ï¼Œä¸ç„¶å®¹æ˜“è¢«ç¦è¨€ã€‚ <img src="https://images.morethink.cn/douban-ban.jpg" alt="" title="è±†ç“£ç¦è¨€"></li></ol>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Nettyæ¥æ”¶HTTPæ–‡ä»¶ä¸Šä¼ åŠæ–‡ä»¶ä¸‹è½½</title>
      <link href="/Netty%E6%8E%A5%E6%94%B6HTTP%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8F%8A%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/"/>
      <url>/Netty%E6%8E%A5%E6%94%B6HTTP%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8F%8A%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><p>è¿™ä¸ªå¤„ç†å™¨çš„åŸç†æ˜¯æ¥æ”¶HttpObjectå¯¹è±¡ï¼ŒæŒ‰ç…§HttpRequestï¼ŒHttpContentæ¥åšå¤„ç†ï¼Œæ–‡ä»¶å†…å®¹æ˜¯åœ¨HttpContentæ¶ˆæ¯å¸¦æ¥çš„ã€‚</p><p>ç„¶ååœ¨HttpContentä¸­ä¸€ä¸ªchunkä¸€ä¸ªchunkè¯»ï¼Œchunkå¤§å°å¯ä»¥åœ¨åˆå§‹åŒ–HttpServerCodecæ—¶è®¾ç½®ã€‚å°†æ¯ä¸ªchunkäº¤ä¸ªhttpDecoderå¤åˆ¶ä¸€ä»½ï¼Œå½“è¯»åˆ°LastHttpContentå¯¹è±¡æ—¶ï¼Œè¡¨æ˜ä¸Šä¼ ç»“æŸï¼Œå¯ä»¥å°†httpDecoderä¸­ç¼“å­˜çš„æ–‡ä»¶é€šè¿‡HttpDataFactoryå†™åˆ°ç£ç›˜ä¸Šï¼Œç„¶ååœ¨åˆ é™¤ç¼“å­˜çš„HttpContentå¯¹è±¡ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttUploadHandler</span> <span class="keyword">extends</span> <span class="title">SimpleChannelInboundHandler</span>&lt;<span class="title">HttpObject</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttUploadHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HttpDataFactory factory = <span class="keyword">new</span> DefaultHttpDataFactory(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String FILE_UPLOAD = <span class="string">"/data/"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String URI = <span class="string">"/upload"</span>;</span><br><span class="line">    <span class="keyword">private</span> HttpPostRequestDecoder httpDecoder;</span><br><span class="line">    HttpRequest request;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">channelRead0</span><span class="params">(<span class="keyword">final</span> ChannelHandlerContext ctx, <span class="keyword">final</span> HttpObject httpObject)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (httpObject <span class="keyword">instanceof</span> HttpRequest) &#123;</span><br><span class="line">            request = (HttpRequest) httpObject;</span><br><span class="line">            <span class="keyword">if</span> (request.uri().startsWith(URI) &amp;&amp; request.method().equals(HttpMethod.POST)) &#123;</span><br><span class="line">                httpDecoder = <span class="keyword">new</span> HttpPostRequestDecoder(factory, request);</span><br><span class="line">                httpDecoder.setDiscardThreshold(<span class="number">0</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//ä¼ é€’ç»™ä¸‹ä¸€ä¸ªHandler</span></span><br><span class="line">                ctx.fireChannelRead(httpObject);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (httpObject <span class="keyword">instanceof</span> HttpContent) &#123;</span><br><span class="line">            <span class="keyword">if</span> (httpDecoder != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">final</span> HttpContent chunk = (HttpContent) httpObject;</span><br><span class="line">                httpDecoder.offer(chunk);</span><br><span class="line">                <span class="keyword">if</span> (chunk <span class="keyword">instanceof</span> LastHttpContent) &#123;</span><br><span class="line">                    writeChunk(ctx);</span><br><span class="line">                    <span class="comment">//å…³é—­httpDecoder</span></span><br><span class="line">                    httpDecoder.destroy();</span><br><span class="line">                    httpDecoder = <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ReferenceCountUtil.release(httpObject);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ctx.fireChannelRead(httpObject);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeChunk</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (httpDecoder.hasNext()) &#123;</span><br><span class="line">            InterfaceHttpData data = httpDecoder.next();</span><br><span class="line">            <span class="keyword">if</span> (data != <span class="keyword">null</span> &amp;&amp; HttpDataType.FileUpload.equals(data.getHttpDataType())) &#123;</span><br><span class="line">                <span class="keyword">final</span> FileUpload fileUpload = (FileUpload) data;</span><br><span class="line">                <span class="keyword">final</span> File file = <span class="keyword">new</span> File(FILE_UPLOAD + fileUpload.getFilename());</span><br><span class="line">                log.info(<span class="string">"upload file: &#123;&#125;"</span>, file);</span><br><span class="line">                <span class="keyword">try</span> (FileChannel inputChannel = <span class="keyword">new</span> FileInputStream(fileUpload.getFile()).getChannel();</span><br><span class="line">                     FileChannel outputChannel = <span class="keyword">new</span> FileOutputStream(file).getChannel()) &#123;</span><br><span class="line">                    outputChannel.transferFrom(inputChannel, <span class="number">0</span>, inputChannel.size());</span><br><span class="line">                    ResponseUtil.response(ctx, request, <span class="keyword">new</span> GeneralResponse(HttpResponseStatus.OK, <span class="string">"SUCCESS"</span>, <span class="keyword">null</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable cause)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        log.warn(<span class="string">"&#123;&#125;"</span>, cause);</span><br><span class="line">        ctx.channel().close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelInactive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (httpDecoder != <span class="keyword">null</span>) &#123;</span><br><span class="line">            httpDecoder.cleanFiles();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸‹è½½"></a>æ–‡ä»¶ä¸‹è½½</h1><p>å‚è€ƒå®˜æ–¹Demoï¼š <a href="https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/http/file/HttpStaticFileServerHandler.java" target="_blank" rel="noopener">https://github.com/netty/netty/blob/4.1/example/src/main/java/io/netty/example/http/file/HttpStaticFileServerHandler.java</a></p><p>åšäº†æ”¹åŠ¨ï¼š</p><ul><li>ä¸ºäº†æ›´é«˜æ•ˆçš„ä¼ è¾“å¤§æ•°æ®ï¼Œå®ä¾‹ä¸­ç”¨åˆ°äº†ChunkedWriteHandlerç¼–ç å™¨ï¼Œå®ƒæä¾›äº†ä»¥zero-memory-copyæ–¹å¼å†™æ–‡ä»¶ã€‚</li><li>é€šè¿‡ChannelProgressiveFutureListenerå¯¹æ–‡ä»¶ä¸‹è½½è¿‡ç¨‹è¿›è¡Œç›‘å¬ã€‚</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">// æ–°å¢ChunkedHandlerï¼Œä¸»è¦ä½œç”¨æ˜¯æ”¯æŒå¼‚æ­¥å‘é€å¤§çš„ç æµï¼ˆä¾‹å¦‚å¤§æ–‡ä»¶ä¼ è¾“ï¼‰ï¼Œä½†æ˜¯ä¸å ç”¨è¿‡å¤šçš„å†…å­˜ï¼Œé˜²æ­¢å‘ç”Ÿjavaå†…å­˜æº¢å‡ºé”™è¯¯</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> ChunkedWriteHandler());</span><br><span class="line"><span class="comment">// ç”¨äºä¸‹è½½æ–‡ä»¶</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> HttpDownloadHandler());</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpDownloadHandler</span> <span class="keyword">extends</span> <span class="title">SimpleChannelInboundHandler</span>&lt;<span class="title">FullHttpRequest</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttpDownloadHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="keyword">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String filePath = <span class="string">"/data/body.csv"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">channelRead0</span><span class="params">(ChannelHandlerContext ctx, FullHttpRequest request)</span> </span>&#123;</span><br><span class="line">        String uri = request.uri();</span><br><span class="line">        <span class="keyword">if</span> (uri.startsWith(<span class="string">"/download"</span>) &amp;&amp; request.method().equals(HttpMethod.GET)) &#123;</span><br><span class="line">            GeneralResponse generalResponse = <span class="keyword">null</span>;</span><br><span class="line">            File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">final</span> RandomAccessFile raf = <span class="keyword">new</span> RandomAccessFile(file, <span class="string">"r"</span>);</span><br><span class="line">                <span class="keyword">long</span> fileLength = raf.length();</span><br><span class="line">                HttpResponse response = <span class="keyword">new</span> DefaultHttpResponse(HTTP_1_1, HttpResponseStatus.OK);</span><br><span class="line">                response.headers().set(HttpHeaderNames.CONTENT_LENGTH, fileLength);</span><br><span class="line">                response.headers().set(HttpHeaderNames.CONTENT_TYPE, <span class="string">"application/octet-stream"</span>);</span><br><span class="line">                response.headers().add(HttpHeaderNames.CONTENT_DISPOSITION, String.format(<span class="string">"attachment; filename=\"%s\""</span>, file.getName()));</span><br><span class="line">                ctx.write(response);</span><br><span class="line">                ChannelFuture sendFileFuture = ctx.write(<span class="keyword">new</span> DefaultFileRegion(raf.getChannel(), <span class="number">0</span>, fileLength), ctx.newProgressivePromise());</span><br><span class="line">                sendFileFuture.addListener(<span class="keyword">new</span> ChannelProgressiveFutureListener() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operationComplete</span><span class="params">(ChannelProgressiveFuture future)</span></span></span><br><span class="line"><span class="function">                            <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        log.info(<span class="string">"file &#123;&#125; transfer complete."</span>, file.getName());</span><br><span class="line">                        raf.close();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">operationProgressed</span><span class="params">(ChannelProgressiveFuture future,</span></span></span><br><span class="line"><span class="function"><span class="params">                                                    <span class="keyword">long</span> progress, <span class="keyword">long</span> total)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">if</span> (total &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                            log.warn(<span class="string">"file &#123;&#125; transfer progress: &#123;&#125;"</span>, file.getName(), progress);</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            log.debug(<span class="string">"file &#123;&#125; transfer progress: &#123;&#125;/&#123;&#125;"</span>, file.getName(), progress, total);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">                ctx.writeAndFlush(LastHttpContent.EMPTY_LAST_CONTENT);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">                log.warn(<span class="string">"file &#123;&#125; not found"</span>, file.getPath());</span><br><span class="line">                generalResponse = <span class="keyword">new</span> GeneralResponse(HttpResponseStatus.NOT_FOUND, String.format(<span class="string">"file %s not found"</span>, file.getPath()), <span class="keyword">null</span>);</span><br><span class="line">                ResponseUtil.response(ctx, request, generalResponse);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                log.warn(<span class="string">"file &#123;&#125; has a IOException: &#123;&#125;"</span>, file.getName(), e.getMessage());</span><br><span class="line">                generalResponse = <span class="keyword">new</span> GeneralResponse(HttpResponseStatus.INTERNAL_SERVER_ERROR, String.format(<span class="string">"è¯»å– file %s å‘ç”Ÿå¼‚å¸¸"</span>, filePath), <span class="keyword">null</span>);</span><br><span class="line">                ResponseUtil.response(ctx, request, generalResponse);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ctx.fireChannelRead(request);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exceptionCaught</span><span class="params">(ChannelHandlerContext ctx, Throwable e)</span> </span>&#123;</span><br><span class="line">        log.warn(<span class="string">"&#123;&#125;"</span>, e);</span><br><span class="line">        ctx.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸‹è½½æ–‡ä»¶é‡åˆ°çš„å‘"><a href="#ä¸‹è½½æ–‡ä»¶é‡åˆ°çš„å‘" class="headerlink" title="ä¸‹è½½æ–‡ä»¶é‡åˆ°çš„å‘"></a>ä¸‹è½½æ–‡ä»¶é‡åˆ°çš„å‘</h2><p>ç”±äº<code>RandomAccessFile</code>æ˜¯ä¸€ç§æ–‡ä»¶èµ„æºï¼Œæ‰€ä»¥æˆ‘ä¹ æƒ¯æ€§çš„åœ¨æœ€åå…³é—­æ–‡ä»¶èµ„æºï¼Œé‡‡ç”¨çš„æ˜¯Java7çš„ <code>try-with-resources</code> è¯­æ³•ï¼Œäºæ˜¯é—®é¢˜å°±å‡ºç°äº†ï¼Œç”±äº <code>ctx.write(new DefaultFileRegion(raf.getChannel(), 0, fileLength), ctx.newProgressivePromise());</code> æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨æˆ‘å…³é—­<code>RandomAccessFile</code>æ—¶ï¼Œæ–‡ä»¶è¿˜æœªä¼ è¾“å®Œæ¯•ï¼Œå°±ä¼šå¯¼è‡´ä¸‹è½½æ–‡ä»¶åœæ­¢ã€‚</p><p>ä»£ç æ”¾åœ¨ï¼š <a href="https://github.com/morethink/code/tree/master/java/netty-example" target="_blank" rel="noopener">https://github.com/morethink/code/tree/master/java/netty-example</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Netty </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dockerä¸­æ‰§è¡ŒShellå‡ºç°ä¹±ç </title>
      <link href="/Docker%E4%B8%AD%E6%89%A7%E8%A1%8CShell%E5%87%BA%E7%8E%B0%E4%B9%B1%E7%A0%81/"/>
      <url>/Docker%E4%B8%AD%E6%89%A7%E8%A1%8CShell%E5%87%BA%E7%8E%B0%E4%B9%B1%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>æœ€è¿‘é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š<br>æ‰§è¡Œå‘½ä»¤<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker exec f4af9b sh -c 'bash /tmp/build.sh'</span><br></pre></td></tr></table></figure></p><p>åœ¨dockerä¸­æ‰§è¡Œshellï¼Œä¼šå‡ºç°ä¸­æ–‡ä¹±ç çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨dockerå®¹å™¨ä¸­å•ç‹¬æ‰§è¡Œshellè„šæœ¬å´æ²¡æœ‰å‡ºç°ä¹±ç ã€‚æŸ¥çœ‹ç¯å¢ƒå˜é‡å­˜åœ¨<code>LANG=en_US.UTF-8</code>ï¼Œå› æ­¤ä»åŸç†ä¸Šæ¥è¯´æ˜¯ä¸åº”è¯¥å‡ºç°ä¹±ç çš„ã€‚</p><p>ä½†æ˜¯æ—¢ç„¶å‡ºç°äº†ä¹±ç ï¼Œé‚£ä¹ˆ<code>LANG=en_US.UTF-8</code>åº”è¯¥å°±æ²¡æœ‰è¯»å–åˆ°ï¼Œäºæ˜¯åœ¨ <code>build.sh</code>ä¸­è¿è¡Œ<code>env</code>å‘½ä»¤ï¼Œå‘ç°é€šè¿‡<code>docker exec f4af9b sh -c &#39;bash /tmp/build.sh&#39;</code>æ–¹å¼æ²¡æœ‰<code>LANG=en_US.UTF-8</code>ç¯å¢ƒå˜é‡ï¼Œé‚£ä¹ˆåŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p><a id="more"></a><h1 id="åŸå› å®šä½"><a href="#åŸå› å®šä½" class="headerlink" title="åŸå› å®šä½"></a>åŸå› å®šä½</h1><p>åŸå› å¦‚ä¸‹ï¼š<br><code>docker exec f4af9b sh -c &#39;bash /tmp/build.sh&#39;</code> å¯¹äºdocker å®¹å™¨æ¥è¯´æ˜¯éç™»å½•å’Œéäº¤äº’å¼shellï¼Œè¿™æ ·å°±ä¸ä¼šè¯»å–æŸäº›é…ç½®æ–‡ä»¶ï¼Œå¯¼è‡´<code>LANG=en_US.UTF-8</code>æ²¡æœ‰åŠ è½½æˆåŠŸã€‚</p><h1 id="Linux-Shell"><a href="#Linux-Shell" class="headerlink" title="Linux Shell"></a>Linux Shell</h1><p>ä¸‹é¢ä»‹ç»ä¸€ä¸‹Linuxäº¤äº’å¼å’Œéäº¤äº’å¼shellã€ç™»å½•å’Œéç™»å½•shellä¹‹é—´çš„åŒºåˆ«ã€‚</p><ul><li><p><strong>äº¤äº’å¼shellï¼ˆinteractive shellï¼‰å’Œéäº¤äº’å¼shellï¼ˆnon-interactive shellï¼‰</strong>ï¼š</p><ul><li>äº¤äº’å¼çš„shellä¼šæœ‰ä¸€ä¸ªè¾“å…¥æç¤ºç¬¦ï¼Œå¹¶ä¸”å®ƒçš„æ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºéƒ½ä¼šæ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸Šã€‚è¿™ç§æ¨¡å¼ä¹Ÿæ˜¯å¤§å¤šæ•°ç”¨æˆ·éå¸¸ç†Ÿæ‚‰çš„ï¼šç™»å½•ã€æ‰§è¡Œä¸€äº›å‘½ä»¤ã€é€€å‡ºã€‚å½“ä½ é€€å‡ºåï¼Œshellä¹Ÿç»ˆæ­¢äº†ã€‚  </li><li>éäº¤äº’å¼shellæ˜¯<code>bash script.sh</code>è¿™ç±»çš„shellã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œshellä¸ä¸ä½ è¿›è¡Œäº¤äº’ï¼Œè€Œæ˜¯è¯»å–å­˜æ”¾åœ¨æ–‡ä»¶ä¸­çš„å‘½ä»¤ï¼Œå¹¶ä¸”æ‰§è¡Œå®ƒä»¬ã€‚å½“å®ƒè¯»åˆ°æ–‡ä»¶çš„ç»“å°¾EOFï¼Œshellä¹Ÿå°±ç»ˆæ­¢äº†ã€‚</li></ul></li><li><p><strong>ç™»å½•å¼shellï¼ˆlogin shellï¼‰å’Œéç™»é™†å¼shellï¼ˆno-login shellï¼‰</strong>ï¼š</p><ul><li>éœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç çš„shellå°±æ˜¯ç™»é™†å¼shellã€‚å› æ­¤é€šå¸¸ä¸ç®¡ä»¥ä½•ç§æ–¹å¼ç™»é™†æœºå™¨åç”¨æˆ·è·å¾—çš„ç¬¬ä¸€ä¸ªshellå°±æ˜¯login shellã€‚ä¸è¾“å…¥å¯†ç çš„sshæ˜¯å…¬é’¥æ‰“é€šçš„ï¼ŒæŸç§æ„ä¹‰ä¸Šè¯´ä¹Ÿæ˜¯è¾“å…¥å¯†ç çš„ã€‚</li><li>éç™»é™†å¼çš„å°±æ˜¯åœ¨ç™»é™†åå¯åŠ¨bashç­‰ï¼Œå³ä¸æ˜¯è¿œç¨‹ç™»é™†åˆ°ä¸»æœºè¿™ç§ã€‚</li></ul></li></ul><p>å¯¹äºå¸¸ç”¨ç¯å¢ƒå˜é‡è®¾ç½®æ–‡ä»¶ï¼Œæ•´ç†å‡ºå¦‚ä¸‹åŠ è½½æƒ…å†µè¡¨ï¼š</p><table><thead><tr><th style="text-align:center">æ–‡ä»¶</th><th style="text-align:center">éäº¤äº’+ç™»é™†å¼</th><th style="text-align:center">äº¤äº’+ç™»é™†å¼</th><th style="text-align:center">äº¤äº’+éç™»é™†å¼</th><th style="text-align:center">éäº¤äº’+éç™»é™†å¼</th></tr></thead><tbody><tr><td style="text-align:center">/etc/profile</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">/etc/bashrc</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">~/.bash_profile</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">-</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">~/.bashrc</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">åŠ è½½</td><td style="text-align:center">-</td></tr><tr><td style="text-align:center">BASH_ENV</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">-</td><td style="text-align:center">åŠ è½½</td></tr></tbody></table><p>æ‰§è¡Œè„šæœ¬ï¼Œå¦‚<code>bash script.sh</code>æ˜¯å±äºnon-login + non-interactiveã€‚</p><h1 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h1><p>å› è€Œï¼Œæ‰§è¡Œå‘½ä»¤<code>docker exec f4af9b sh -c &#39;bash /tmp/build.sh&#39;</code>å¯¹äºdockerå®¹å™¨æ¥è¯´æ˜¯å±äºnon-login + non-interactiveã€‚</p><p>å°†ä¸Šé¢çš„<code>bash /tmp/build.sh</code>æ”¹ä¸º<code>bash --login /tmp/build.sh</code>å˜ä¸ºç™»å½•shellï¼Œå°±å¯ä»¥è¯»å–/etc/profileå’Œ~/.bash_profileç­‰æ–‡ä»¶ã€‚</p><p>æˆ–è€…åœ¨æ‰§è¡Œ<code>bash /tmp/build.sh</code>æ—¶åœ¨<code>build.sh</code>åŠ å…¥<code>export LANG=&quot;en_US.UTF-8&quot;</code>æ‰‹åŠ¨è®¾ç½®ã€‚</p><h1 id="å¸¸è§çš„shellå˜é‡"><a href="#å¸¸è§çš„shellå˜é‡" class="headerlink" title="å¸¸è§çš„shellå˜é‡"></a>å¸¸è§çš„shellå˜é‡</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">PATHï¼šå†³å®šäº†shellå°†åˆ°å“ªäº›ç›®å½•ä¸­å¯»æ‰¾å‘½ä»¤æˆ–ç¨‹åº</span><br><span class="line">HOMEï¼šå½“å‰ç”¨æˆ·ä¸»ç›®å½•</span><br><span class="line">MAILï¼šæ˜¯æŒ‡å½“å‰ç”¨æˆ·çš„é‚®ä»¶å­˜æ”¾ç›®å½•ã€‚</span><br><span class="line">SHELLï¼šæ˜¯æŒ‡å½“å‰ç”¨æˆ·ç”¨çš„æ˜¯å“ªç§Shellã€‚</span><br><span class="line">HISTSIZEï¼šæ˜¯æŒ‡ä¿å­˜å†å²å‘½ä»¤è®°å½•çš„æ¡æ•°</span><br><span class="line">LOGNAMEï¼šæ˜¯æŒ‡å½“å‰ç”¨æˆ·çš„ç™»å½•åã€‚</span><br><span class="line">HOSTNAMEï¼šæ˜¯æŒ‡ä¸»æœºçš„åç§°ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºå¦‚æœè¦ç”¨åˆ°ä¸»æœºåçš„è¯ï¼Œé€šå¸¸æ˜¯ä»è¿™ä¸ªç¯å¢ƒå˜é‡ä¸­æ¥å–å¾—çš„ã€‚</span><br><span class="line">LANG/LANGUGEï¼šæ˜¯å’Œè¯­è¨€ç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨å¤šç§è¯­è¨€çš„ç”¨æˆ·å¯ä»¥ä¿®æ”¹æ­¤ç¯å¢ƒå˜é‡ã€‚</span><br><span class="line">PS1ï¼šæ˜¯åŸºæœ¬æç¤ºç¬¦ï¼Œå¯¹äºrootç”¨æˆ·æ˜¯#ï¼Œå¯¹äºæ™®é€šç”¨æˆ·æ˜¯$ã€‚</span><br><span class="line">PS2ï¼šæ˜¯é™„å±æç¤ºç¬¦ï¼Œé»˜è®¤æ˜¯&quot;&gt;&quot;ã€‚</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Netty URLè·¯ç”±æ–¹æ¡ˆæ¢è®¨</title>
      <link href="/Netty-URL-routing-scheme/"/>
      <url>/Netty-URL-routing-scheme/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨ç”¨Nettyåšå¼€å‘ï¼Œéœ€è¦æä¾›ä¸€ä¸ªhttp web serverï¼Œä¾›è°ƒç”¨æ–¹è°ƒç”¨ã€‚é‡‡ç”¨Nettyæœ¬èº«æä¾›çš„<code>HttpServerCodec</code> handlerè¿›è¡ŒHttpåè®®çš„è§£æï¼Œä½†æ˜¯éœ€è¦è‡ªå·±æä¾›è·¯ç”±ã€‚</p><p>æœ€å¼€å§‹æ˜¯é€šè¿‡å¯¹Http methodåŠuri é‡‡ç”¨å¤šå±‚if else åµŒå¥—åˆ¤æ–­çš„æ–¹æ³•è·¯ç”±åˆ°çœŸæ­£çš„controllerç±»ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String uri = request.uri();</span><br><span class="line">HttpMethod method = request.method();</span><br><span class="line"><span class="keyword">if</span> (method == HttpMethod.POST) &#123;</span><br><span class="line">    <span class="keyword">if</span> (uri.startsWith(<span class="string">"/login"</span>)) &#123;</span><br><span class="line">        <span class="comment">//urlå‚æ•°è§£æï¼Œè°ƒç”¨controllerçš„æ–¹æ³•</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (uri.startsWith(<span class="string">"/logout"</span>)) &#123;</span><br><span class="line">        <span class="comment">//åŒä¸Š</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (method == HttpMethod.GET) &#123;</span><br><span class="line">    <span class="keyword">if</span> (uri.startsWith(<span class="string">"/"</span>)) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (uri.startsWith(<span class="string">"/status"</span>)) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><a id="more"></a><p>åœ¨åªéœ€æä¾›<code>login</code>åŠ<code>logout</code>APIæ—¶ï¼Œä»£ç å¯ä»¥å®ŒæˆåŠŸèƒ½ï¼Œå¯æ˜¯éšç€APIçš„æ•°é‡è¶Šæ¥è¶Šå¤šï¼Œéœ€è¦æ”¯æŒçš„æ–¹æ³•åŠuriè¶Šæ¥è¶Šå¤šï¼Œ<code>else if</code> è¶Šæ¥è¶Šå¤šï¼Œä»£ç è¶Šæ¥è¶Šå¤æ‚ã€‚</p><p><img src="https://images.morethink.cn/time-for-change.jpg" alt="time-for-change" title="æ˜¯æ—¶å€™è€ƒè™‘é‡æ„äº†"></p><p>åœ¨é˜¿é‡Œå¼€å‘æ‰‹å†Œä¸­ä¹Ÿæåˆ°è¿‡ï¼š</p><p><img src="https://images.morethink.cn/e1a6f2bd638f0baf5aba0d7a63e77230.png" alt="" title="é‡æ„å¤šå±‚else if"></p><p>å› æ­¤é¦–å…ˆè€ƒè™‘é‡‡ç”¨çŠ¶æ€è®¾è®¡æ¨¡å¼åŠç­–ç•¥è®¾è®¡æ¨¡å¼é‡æ„ã€‚</p><h1 id="çŠ¶æ€æ¨¡å¼"><a href="#çŠ¶æ€æ¨¡å¼" class="headerlink" title="çŠ¶æ€æ¨¡å¼"></a>çŠ¶æ€æ¨¡å¼</h1><h2 id="çŠ¶æ€æ¨¡å¼çš„è§’è‰²ï¼š"><a href="#çŠ¶æ€æ¨¡å¼çš„è§’è‰²ï¼š" class="headerlink" title="çŠ¶æ€æ¨¡å¼çš„è§’è‰²ï¼š"></a>çŠ¶æ€æ¨¡å¼çš„è§’è‰²ï¼š</h2><ul><li>stateçŠ¶æ€<br>è¡¨ç¤ºçŠ¶æ€ï¼Œå®šä¹‰äº†æ ¹æ®ä¸åŒçŠ¶æ€è¿›è¡Œä¸åŒå¤„ç†çš„æ¥å£ï¼Œè¯¥æ¥å£æ˜¯é‚£äº›å¤„ç†å†…å®¹ä¾èµ–äºçŠ¶æ€çš„æ–¹æ³•é›†åˆï¼Œå¯¹åº”å®ä¾‹çš„stateç±»</li><li>å…·ä½“çš„çŠ¶æ€<br>å®ç°äº†stateæ¥å£ï¼Œå¯¹åº”daystateå’Œnightstate</li><li>context<br>contextæŒæœ‰å½“å‰çŠ¶æ€çš„å…·ä½“çŠ¶æ€çš„å®ä¾‹ï¼Œæ­¤å¤–ï¼Œä»–è¿˜å®šä¹‰äº†ä¾›å¤–éƒ¨è°ƒç”¨è€…ä½¿ç”¨çš„çŠ¶æ€æ¨¡å¼çš„æ¥å£ã€‚</li></ul><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“æ¯ä¸ªhttpè¯·æ±‚éƒ½æ˜¯ç”±methodåŠuriæ¥å”¯ä¸€æ ‡è¯†çš„ï¼Œæ‰€è°“è·¯ç”±å°±æ˜¯é€šè¿‡è¿™ä¸ªå”¯ä¸€æ ‡è¯†å®šä½åˆ°controllerç±»çš„ä¸­çš„æŸä¸ªæ–¹æ³•ã€‚</p><p>å› æ­¤æŠŠHttpLabelä½œä¸ºçŠ¶æ€<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpLabel</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String uri;</span><br><span class="line">    <span class="keyword">private</span> HttpMethod method;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>çŠ¶æ€æ¥å£ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Route</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·¯ç”±</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">GeneralResponse <span class="title">call</span><span class="params">(FullHttpRequest request)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸ºæ¯ä¸ªçŠ¶æ€æ·»åŠ çŠ¶æ€å®ç°ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">route</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å•ä¾‹controllerç±»</span></span><br><span class="line">    <span class="keyword">final</span> DemoController demoController = DemoController.getInstance();</span><br><span class="line">    Map&lt;HttpLabel, Route&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    map.put(<span class="keyword">new</span> HttpLabel(<span class="string">"/login"</span>, HttpMethod.POST), demoController::login);</span><br><span class="line">    map.put(<span class="keyword">new</span> HttpLabel(<span class="string">"/logout"</span>, HttpMethod.POST), demoController::login);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥åˆ°è¯·æ±‚ï¼Œåˆ¤æ–­çŠ¶æ€ï¼Œè°ƒç”¨ä¸åŒæ¥å£ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerHandler</span> <span class="keyword">extends</span> <span class="title">SimpleChannelInboundHandler</span>&lt;<span class="title">FullHttpRequest</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">channelRead0</span><span class="params">(ChannelHandlerContext ctx, FullHttpRequest request)</span> </span>&#123;</span><br><span class="line">        String uri = request.uri();</span><br><span class="line">        GeneralResponse generalResponse;</span><br><span class="line">        <span class="keyword">if</span> (uri.contains(<span class="string">"?"</span>)) &#123;</span><br><span class="line">            uri = uri.substring(<span class="number">0</span>, uri.indexOf(<span class="string">"?"</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        Route route = map.get(<span class="keyword">new</span> HttpLabel(uri, request.method()));</span><br><span class="line">        <span class="keyword">if</span> (route != <span class="keyword">null</span>) &#123;</span><br><span class="line">            ResponseUtil.response(ctx, request, route.call(request));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            generalResponse = <span class="keyword">new</span> GeneralResponse(HttpResponseStatus.BAD_REQUEST, <span class="string">"è¯·æ£€æŸ¥ä½ çš„è¯·æ±‚æ–¹æ³•åŠurl"</span>, <span class="keyword">null</span>);</span><br><span class="line">            ResponseUtil.response(ctx, request, generalResponse);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨çŠ¶æ€è®¾è®¡æ¨¡å¼é‡æ„ä»£ç ï¼Œåœ¨å¢åŠ urlæ—¶åªéœ€è¦ç½‘mapé‡Œé¢putä¸€ä¸ªå€¼å°±è¡Œäº†ã€‚</p><h1 id="ç±»ä¼¼SpringMVCè·¯ç”±åŠŸèƒ½"><a href="#ç±»ä¼¼SpringMVCè·¯ç”±åŠŸèƒ½" class="headerlink" title="ç±»ä¼¼SpringMVCè·¯ç”±åŠŸèƒ½"></a>ç±»ä¼¼SpringMVCè·¯ç”±åŠŸèƒ½</h1><p>åæ¥çœ‹äº† <a href="https://yuerblog.cc/2018/03/08/java-router-with-annotation/" target="_blank" rel="noopener">JAVAåå°„+è¿è¡Œæ—¶æ³¨è§£å®ç°URLè·¯ç”±</a> å‘ç°åå°„+æ³¨è§£çš„æ–¹å¼å¾ˆä¼˜é›…ï¼Œä»£ç ä¹Ÿä¸å¤æ‚ã€‚</p><p>ä¸‹é¢ä»‹ç»Nettyä½¿ç”¨åå°„å®ç°URLè·¯ç”±ã€‚</p><p>è·¯ç”±æ³¨è§£ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RequestMapping &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·¯ç”±çš„uri</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">uri</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·¯ç”±çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">String <span class="title">method</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ‰«æclasspathä¸‹å¸¦æœ‰<code>@RequestMapping</code>æ³¨è§£çš„æ–¹æ³•ï¼Œå°†è¿™ä¸ªæ–¹æ³•æ”¾è¿›ä¸€ä¸ªè·¯ç”±Mapï¼š<code>Map&lt;HttpLabel, Action&lt;GeneralResponse&gt;&gt; httpRouterAction</code>ï¼Œkeyä¸ºä¸Šé¢æåˆ°è¿‡çš„Httpå”¯ä¸€æ ‡è¯†  <code>HttpLabel</code>ï¼Œvalueä¸ºé€šè¿‡åå°„è°ƒç”¨çš„æ–¹æ³•ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpRouter</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;HttpLabel, Action&lt;GeneralResponse&gt;&gt; httpRouterAction = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String classpath = <span class="keyword">this</span>.getClass().getResource(<span class="string">""</span>).getPath();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; controllerBeans = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        String path = classpath + name.replaceAll(<span class="string">"\\."</span>, <span class="string">"/"</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes;</span><br><span class="line">        <span class="keyword">try</span> (InputStream ins = <span class="keyword">new</span> FileInputStream(path)) &#123;</span><br><span class="line">            <span class="keyword">try</span> (ByteArrayOutputStream out = <span class="keyword">new</span> ByteArrayOutputStream()) &#123;</span><br><span class="line">                <span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span> * <span class="number">5</span>];</span><br><span class="line">                <span class="keyword">int</span> b = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> ((b = ins.read(buffer)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    out.write(buffer, <span class="number">0</span>, b);</span><br><span class="line">                &#125;</span><br><span class="line">                bytes = out.toByteArray();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ClassNotFoundException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> defineClass(name, bytes, <span class="number">0</span>, bytes.length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addRouter</span><span class="params">(String controllerClass)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; cls = loadClass(controllerClass);</span><br><span class="line">            Method[] methods = cls.getDeclaredMethods();</span><br><span class="line">            <span class="keyword">for</span> (Method invokeMethod : methods) &#123;</span><br><span class="line">                Annotation[] annotations = invokeMethod.getAnnotations();</span><br><span class="line">                <span class="keyword">for</span> (Annotation annotation : annotations) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (annotation.annotationType() == RequestMapping.class) &#123;</span><br><span class="line">                        RequestMapping requestMapping = (RequestMapping) annotation;</span><br><span class="line">                        String uri = requestMapping.uri();</span><br><span class="line">                        String httpMethod = requestMapping.method().toUpperCase();</span><br><span class="line">                        <span class="comment">// ä¿å­˜Beanå•ä¾‹</span></span><br><span class="line">                        <span class="keyword">if</span> (!controllerBeans.containsKey(cls.getName())) &#123;</span><br><span class="line">                            controllerBeans.put(cls.getName(), cls.newInstance());</span><br><span class="line">                        &#125;</span><br><span class="line">                        Action action = <span class="keyword">new</span> Action(controllerBeans.get(cls.getName()), invokeMethod);</span><br><span class="line">                        <span class="comment">//å¦‚æœéœ€è¦FullHttpRequestï¼Œå°±æ³¨å…¥FullHttpRequestå¯¹è±¡</span></span><br><span class="line">                        Class[] params = invokeMethod.getParameterTypes();</span><br><span class="line">                        <span class="keyword">if</span> (params.length == <span class="number">1</span> &amp;&amp; params[<span class="number">0</span>] == FullHttpRequest.class) &#123;</span><br><span class="line">                            action.setInjectionFullhttprequest(<span class="keyword">true</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// ä¿å­˜æ˜ å°„å…³ç³»</span></span><br><span class="line">                        httpRouterAction.put(<span class="keyword">new</span> HttpLabel(uri, <span class="keyword">new</span> HttpMethod(httpMethod)), action);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.warn(<span class="string">"&#123;&#125;"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Action <span class="title">getRoute</span><span class="params">(HttpLabel httpLabel)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> httpRouterAction.get(httpLabel);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡åå°„è°ƒç”¨<code>controller</code> ç±»ä¸­çš„æ–¹æ³•ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Action</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Object object;</span><br><span class="line">    <span class="meta">@NonNull</span></span><br><span class="line">    <span class="keyword">private</span> Method method;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> injectionFullhttprequest;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">call</span><span class="params">(Object... args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (T) method.invoke(object, args);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException | InvocationTargetException e) &#123;</span><br><span class="line">            log.warn(<span class="string">"&#123;&#125;"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p><code>ServerHandler.java</code>å¤„ç†å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"> <span class="comment">//æ ¹æ®ä¸åŒçš„è¯·æ±‚APIåšä¸åŒçš„å¤„ç†(è·¯ç”±åˆ†å‘)</span></span><br><span class="line">Action&lt;GeneralResponse&gt; action = httpRouter.getRoute(<span class="keyword">new</span> HttpLabel(uri, request.method()));</span><br><span class="line"><span class="keyword">if</span> (action != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (action.isInjectionFullhttprequest()) &#123;</span><br><span class="line">        ResponseUtil.response(ctx, request, action.call(request));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ResponseUtil.response(ctx, request, action.call());</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//é”™è¯¯å¤„ç†</span></span><br><span class="line">    generalResponse = <span class="keyword">new</span> GeneralResponse(HttpResponseStatus.BAD_REQUEST, <span class="string">"è¯·æ£€æŸ¥ä½ çš„è¯·æ±‚æ–¹æ³•åŠurl"</span>, <span class="keyword">null</span>);</span><br><span class="line">    ResponseUtil.response(ctx, request, generalResponse);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>DemoController</code> æ–¹æ³•é…ç½®ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@RequestMapping(uri = &quot;/login&quot;, method = &quot;POST&quot;)</span><br><span class="line">public GeneralResponse login(FullHttpRequest request) &#123;</span><br><span class="line">    User user = JsonUtil.fromJson(request, User.class);</span><br><span class="line">    log.info(&quot;/login called,user: &#123;&#125;&quot;, user);</span><br><span class="line">    return new GeneralResponse(null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://images.morethink.cn/5166aac96c36b6fca7645a5aca07f630.png" alt="" title="æµ‹è¯•ç»“æœ"></p><p>å®Œæ•´ä»£ç åœ¨ <a href="https://github.com/morethink/Netty-Route" target="_blank" rel="noopener">https://github.com/morethink/Netty-Route</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Netty </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaä½¿ç”¨UDPå‘é€æ•°æ®åˆ°InfluxDB</title>
      <link href="/Java-USES-InfluxDB-UDP-sending-data/"/>
      <url>/Java-USES-InfluxDB-UDP-sending-data/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœ¨åšå‹æµ‹å¼•æ“ç›¸å…³çš„å¼€å‘ï¼Œéœ€è¦å°†èšåˆæ•°æ®å‘é€åˆ°InfluxDBä¿å­˜ä»¥ä¾¿å®æ—¶åˆ†æå’Œæ§åˆ¶QPSã€‚</p><p>ä¸‹é¢ä»‹ç»å¯¹InfluxDBçš„ä½¿ç”¨ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯InfluxDB"><a href="#ä»€ä¹ˆæ˜¯InfluxDB" class="headerlink" title="ä»€ä¹ˆæ˜¯InfluxDB"></a>ä»€ä¹ˆæ˜¯InfluxDB</h1><p>InfluxDBæ˜¯ä¸€æ¬¾ç”¨Goè¯­è¨€ç¼–å†™çš„å¼€æºåˆ†å¸ƒå¼æ—¶åºã€äº‹ä»¶å’ŒæŒ‡æ ‡æ•°æ®åº“ï¼Œæ— éœ€å¤–éƒ¨ä¾èµ–ã€‚è¯¥æ•°æ®åº“ç°åœ¨ä¸»è¦ç”¨äºå­˜å‚¨æ¶‰åŠå¤§é‡çš„æ—¶é—´æˆ³æ•°æ®ï¼Œå¦‚DevOpsç›‘æ§æ•°æ®ï¼ŒAPP metrics, loTä¼ æ„Ÿå™¨æ•°æ®å’Œå®æ—¶åˆ†ææ•°æ®ã€‚</p><a id="more"></a><p>InfluxDBç‰¹å¾ï¼š</p><ul><li>æ— ç»“æ„(æ— æ¨¡å¼)ï¼šå¯ä»¥æ˜¯ä»»æ„æ•°é‡çš„åˆ—(tags)ã€‚</li><li>å¯ä»¥è®¾ç½®metricçš„ä¿å­˜æ—¶é—´ã€‚</li><li>æ”¯æŒä¸æ—¶é—´æœ‰å…³çš„ç›¸å…³å‡½æ•°(å¦‚minã€maxã€sumã€countã€meanã€medianç­‰)ï¼Œæ–¹ä¾¿ç»Ÿè®¡ã€‚</li><li>æ”¯æŒå­˜å‚¨ç­–ç•¥ï¼šå¯ä»¥ç”¨äºæ•°æ®çš„åˆ æ”¹(influxDBæ²¡æœ‰æä¾›æ•°æ®çš„åˆ é™¤ä¸ä¿®æ”¹æ–¹æ³•)ã€‚</li><li>æ”¯æŒè¿ç»­æŸ¥è¯¢ï¼šæ˜¯æ•°æ®åº“ä¸­è‡ªåŠ¨å®šæ—¶å¯åŠ¨çš„ä¸€ç»„è¯­å¥ï¼Œå’Œå­˜å‚¨ç­–ç•¥æ­é…å¯ä»¥é™ä½InfluxDBçš„ç³»ç»Ÿå ç”¨é‡ã€‚</li><li>åŸç”Ÿçš„HTTPæ”¯æŒï¼Œå†…ç½®HTTP APIã€‚</li><li>æ”¯æŒç±»ä¼¼SQLè¯­æ³•ã€‚</li><li>æ”¯æŒè®¾ç½®æ•°æ®åœ¨é›†ç¾¤ä¸­çš„å‰¯æœ¬æ•°ã€‚</li><li>æ”¯æŒå®šæœŸé‡‡æ ·æ•°æ®ï¼Œå†™å…¥å¦å¤–çš„measurementï¼Œæ–¹ä¾¿åˆ†ç²’åº¦å­˜å‚¨æ•°æ®ã€‚</li><li>è‡ªå¸¦webç®¡ç†ç•Œé¢ï¼Œæ–¹ä¾¿ä½¿ç”¨(ç™»å…¥æ–¹å¼ï¼šhttp://&lt; InfluxDB-IP &gt;:8083)ã€‚</li><li>æ”¯æŒGrafanaç”»å›¾å±•ç¤ºã€‚</li></ul><p>PSï¼šæœ‰äº†InfluxDB+Grafanaåï¼Œä½ å°±å¯ä»¥å†™ä¸€äº›ç®€å•çš„ç¨‹åºäº†ï¼Œå¯ä»¥åªè´Ÿè´£å†™åç«¯é€»è¾‘éƒ¨åˆ†ï¼Œæ•°æ®éƒ½å¯ä»¥å­˜å…¥InfluxDBï¼Œç„¶åé€šè¿‡Grafanaå±•ç¤ºå‡ºæ¥ã€‚</p><h1 id="Macå®‰è£…InfluxDB"><a href="#Macå®‰è£…InfluxDB" class="headerlink" title="Macå®‰è£…InfluxDB"></a>Macå®‰è£…InfluxDB</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span> å®‰è£…</span><br><span class="line">brew install influxdb</span><br><span class="line"><span class="meta">#</span> å¯åŠ¨</span><br><span class="line">influxd -config /usr/local/etc/influxdb.conf</span><br><span class="line"><span class="meta">#</span> æŸ¥çœ‹influxdbè¿è¡Œé…ç½®</span><br><span class="line">influxd config</span><br><span class="line"><span class="meta">#</span> å¯åŠ¨å®¢æˆ·ç«¯</span><br><span class="line">influx -precision rfc3339</span><br></pre></td></tr></table></figure><h1 id="InfluxDBå¼€å¯UDPé…ç½®"><a href="#InfluxDBå¼€å¯UDPé…ç½®" class="headerlink" title="InfluxDBå¼€å¯UDPé…ç½®"></a>InfluxDBå¼€å¯UDPé…ç½®</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /usr/local/etc/influxdb.conf</span><br></pre></td></tr></table></figure><p>å¼€å¯udpé…ç½®ï¼Œå…¶ä»–ä¸ºé»˜è®¤å€¼<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[[udp]]</span><br><span class="line">  enabled = true</span><br></pre></td></tr></table></figure></p><p>udpé…ç½®å«ä¹‰ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[[udp]] â€“ udpé…ç½®</span><br><span class="line"></span><br><span class="line">    enabledï¼šæ˜¯å¦å¯ç”¨è¯¥æ¨¡å—ï¼Œé»˜è®¤å€¼ï¼šfalseã€‚</span><br><span class="line"></span><br><span class="line">    bind-addressï¼šç»‘å®šåœ°å€ï¼Œé»˜è®¤å€¼ï¼šâ€:8089â€³ã€‚</span><br><span class="line"></span><br><span class="line">    databaseï¼šæ•°æ®åº“åç§°ï¼Œé»˜è®¤å€¼ï¼šâ€udpâ€ã€‚</span><br><span class="line"></span><br><span class="line">    retention-policyï¼šå­˜å‚¨ç­–ç•¥ï¼Œæ— é»˜è®¤å€¼ã€‚</span><br><span class="line"></span><br><span class="line">    batch-sizeï¼šé»˜è®¤å€¼ï¼š5000ã€‚</span><br><span class="line"></span><br><span class="line">    batch-pendingï¼šé»˜è®¤å€¼ï¼š10ã€‚</span><br><span class="line"></span><br><span class="line">    read-bufferï¼šudpè¯»å–bufferçš„å¤§å°ï¼Œ0è¡¨ç¤ºä½¿ç”¨æ“ä½œç³»ç»Ÿæä¾›çš„å€¼ï¼Œå¦‚æœè¶…è¿‡æ“ä½œç³»ç»Ÿçš„é»˜è®¤é…ç½®åˆ™ä¼šå‡ºé”™ã€‚ è¯¥é…ç½®çš„é»˜è®¤å€¼ï¼š0ã€‚</span><br><span class="line"></span><br><span class="line">    batch-timeoutï¼šè¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤å€¼ï¼šâ€1sâ€ã€‚</span><br><span class="line"></span><br><span class="line">    precisionï¼šæ—¶é—´ç²¾åº¦ï¼Œæ— é»˜è®¤å€¼ã€‚</span><br></pre></td></tr></table></figure></p><h1 id="Javaå‘é€UDPæ•°æ®æŠ¥"><a href="#Javaå‘é€UDPæ•°æ®æŠ¥" class="headerlink" title="Javaå‘é€UDPæ•°æ®æŠ¥"></a>Javaå‘é€UDPæ•°æ®æŠ¥</h1><p>æˆ‘ä»¬çŸ¥é“InfluxDBæ˜¯æ”¯æŒHttpçš„ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦é‡‡ç”¨UDPæ–¹å¼å‘é€æ•°æ®å‘¢ï¼Ÿ</p><p>åŸºäºä¸‹åˆ—åŸå› ï¼š</p><ol><li>TCPæ•°æ®ä¼ è¾“æ…¢ï¼ŒUDPæ•°æ®ä¼ è¾“å¿«ã€‚</li><li>ç½‘ç»œå¸¦å®½éœ€æ±‚è¾ƒå°ï¼Œè€Œå®æ—¶æ€§è¦æ±‚é«˜ã€‚</li><li>InfluxDBå’ŒæœåŠ¡å™¨åœ¨åŒæœºæˆ¿ï¼Œå‘ç”Ÿæ•°æ®ä¸¢åŒ…çš„å¯èƒ½æ€§è¾ƒå°ï¼Œå³ä½¿çœŸçš„å‘ç”Ÿä¸¢åŒ…ï¼Œå¯¹æ•´ä¸ªè¯·æ±‚æµé‡çš„æ”¶é›†å½±å“ä¹Ÿè¾ƒå°ã€‚</li></ol><p>æˆ‘ä»¬é‡‡ç”¨äº†workerçº¿ç¨‹è°ƒç”¨<code>addMetric</code>æ–¹æ³•å°†æ•°æ®å­˜å‚¨åˆ°ç¼“å­˜ <code>map</code> ä¸­ï¼Œsendçº¿ç¨‹æ± æ¥è¿›è¡Œæ¯ä¸ªæŒ‡å®šæ—¶é—´å‘é€æ•°æ®åˆ°Influxdbã€‚</p><p>ä»£ç å¦‚ä¸‹(ä¹Ÿå¯å‚è€ƒ<code>Jmeter</code>çš„<code>UdpMetricsSender</code>ç±»)ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InfluxDBClient</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String measurement = <span class="string">"example"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object lock = <span class="keyword">new</span> Object();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> InetAddress hostAddress;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> udpPort;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> Map&lt;String, List&lt;Response&gt;&gt; metrics = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> time;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String transaction;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">InfluxDBClient</span><span class="params">(String influxdbUrl, String transaction)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.transaction = transaction;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.debug(<span class="string">"Setting up with url:&#123;&#125;"</span>, influxdbUrl);</span><br><span class="line">            String[] urlComponents = influxdbUrl.split(<span class="string">":"</span>);</span><br><span class="line">            <span class="keyword">if</span> (urlComponents.length == <span class="number">2</span>) &#123;</span><br><span class="line">                hostAddress = InetAddress.getByName(urlComponents[<span class="number">0</span>]);</span><br><span class="line">                udpPort = Integer.parseInt(urlComponents[<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"InfluxDBClient url '"</span> + influxdbUrl + <span class="string">"'Â is wrong. The format shoule be &lt;host/ip&gt;:&lt;port&gt;"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"InfluxDBClient url '"</span> + influxdbUrl + <span class="string">"'Â is wrong. The format shoule be &lt;host/ip&gt;:&lt;port&gt;"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addMetric</span><span class="params">(Response response)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            <span class="keyword">if</span> (metrics.containsKey(response.getLabel())) &#123;</span><br><span class="line">                metrics.get(response.getLabel()).add(response);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                metrics.put(response.getLabel(), <span class="keyword">new</span> ArrayList&lt;&gt;(Collections.singletonList(response)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        sendMetrics();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">sendMetrics</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Map&lt;String, List&lt;Response&gt;&gt; tempMetrics;</span><br><span class="line">        <span class="comment">//å¤åˆ¶æ•°æ®åˆ°tempMetricsï¼Œæ¸…ç©ºåŸæ¥metricså¹¶åˆå§‹åŒ–ä¸Šæ¬¡çš„å¤§å°</span></span><br><span class="line">        <span class="keyword">synchronized</span> (lock) &#123;</span><br><span class="line">            <span class="keyword">if</span> (isEmpty(metrics)) &#123;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            time = System.currentTimeMillis();</span><br><span class="line">            tempMetrics = metrics;</span><br><span class="line">            metrics = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, List&lt;Response&gt;&gt; entry : tempMetrics.entrySet()) &#123;</span><br><span class="line">                metrics.put(entry.getKey(), <span class="keyword">new</span> ArrayList&lt;&gt;(entry.getValue().size()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> Map&lt;String, List&lt;Response&gt;&gt; copyMetrics = tempMetrics;</span><br><span class="line">        <span class="keyword">final</span> List&lt;MetricTuple&gt; aggregateMetrics = aggregate(copyMetrics);</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder(aggregateMetrics.size() * <span class="number">200</span>);</span><br><span class="line">        <span class="comment">//å‘é€tempMetrics,ç”Ÿæˆä¸€è¡Œæ•°æ®ï¼Œç„¶åæ¢è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> (MetricTuple metric : aggregateMetrics) &#123;</span><br><span class="line">            sb.append(metric.getMeasurement()).append(metric.getTag()).append(<span class="string">" "</span>)</span><br><span class="line">                    .append(metric.getField()).append(<span class="string">" "</span>).append(metric.getTimestamp() + <span class="string">"000000"</span>).append(<span class="string">"\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//udpå‘é€æ•°æ®åˆ°Influxdb</span></span><br><span class="line">        <span class="keyword">try</span> (DatagramSocket ds = <span class="keyword">new</span> DatagramSocket()) &#123;</span><br><span class="line">            <span class="keyword">byte</span>[] buf = sb.toString().getBytes();</span><br><span class="line">            DatagramPacket dp = <span class="keyword">new</span> DatagramPacket(buf, buf.length, <span class="keyword">this</span>.hostAddress, <span class="keyword">this</span>.udpPort);</span><br><span class="line">            ds.send(dp);</span><br><span class="line">            log.debug(<span class="string">"send &#123;&#125; to influxdb"</span>, sb.toString());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SocketException e) &#123;</span><br><span class="line">            log.error(<span class="string">"Cannot open udp port!"</span>, e);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">"Error in transferring udp package"</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¾—åˆ°èšåˆæ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> metrics</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;MetricTuple&gt; <span class="title">aggregate</span><span class="params">(Map&lt;String, List&lt;Response&gt;&gt; metrics)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEmpty</span><span class="params">(Map&lt;String, List&lt;Response&gt;&gt; map)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, List&lt;Response&gt;&gt; entry : map.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!entry.getValue().isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://jasper-zhang1.gitbooks.io/influxdb/content/" target="_blank" rel="noopener">InfluxDBä¸­æ–‡æ–‡æ¡£</a></li><li><a href="http://www.ywnds.com/?p=10763" target="_blank" rel="noopener">ç©è½¬æ—¶åºæ•°æ®åº“InfluxDB</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> InfluxDB </tag>
            
            <tag> UDP </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaå‹ç¼©/è§£å‹ .zipã€.tar.gzã€.tar.bz2(æ”¯æŒä¸­æ–‡)</title>
      <link href="/Java%E5%8E%8B%E7%BC%A9/%E8%A7%A3%E5%8E%8B%20.zip%E3%80%81.tar.gz%E3%80%81.tar.bz2(%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87)/"/>
      <url>/Java%E5%8E%8B%E7%BC%A9/%E8%A7%A3%E5%8E%8B%20.zip%E3%80%81.tar.gz%E3%80%81.tar.bz2(%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87)/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»Javaå‹ç¼©/è§£å‹.zipã€.tar.gzã€.tar.bz2çš„æ–¹å¼ã€‚</p><ol><li>å¯¹äºzipæ–‡ä»¶ï¼šä½¿ç”¨<code>java.util.zip.ZipEntry</code> å’Œ <code>java.util.zip.ZipFile</code>ï¼Œé€šè¿‡è®¾ç½®<code>Charset</code>ä¸º<code>StandardCharsets.UTF_8</code>æ”¯æŒä¸­æ–‡ã€‚</li><li>å¯¹äº.tar.gzã€tgzæ–‡ä»¶ï¼šå¯ä»¥çœ‹åšå…ˆç”¨taræ‰“åŒ…ï¼Œå†ä½¿ç”¨gzè¿›è¡Œå‹ç¼©ã€‚ä½¿ç”¨<code>commons-compress</code>åŒ…çš„<code>TarArchiveInputStream</code>å’Œ<code>GzipCompressorInputStream</code>ã€‚</li><li>å¯¹äº.tar.bz2æ–‡ä»¶ï¼šå¯ä»¥çœ‹åšå…ˆç”¨taræ‰“åŒ…ï¼Œå†ä½¿ç”¨bz2è¿›è¡Œå‹ç¼©ã€‚ä½¿ç”¨<code>commons-compress</code>åŒ…çš„<code>TarArchiveInputStream</code>å’Œ<code>BZip2CompressorInputStream</code>ã€‚</li></ol><p>åœ¨è¿™é‡Œæœ‰ä¸ªé—®é¢˜å¦‚æœä½¿ç”¨<code>TarInputStream</code>æ­é…jdkçš„ <code>GZIPInputStream</code>ä¼šäº§ç”Ÿä¹±ç ã€‚è€Œä½¿ç”¨<code>commons-compress</code>åŒ…çš„<code>TarArchiveInputStream</code>å’Œ<code>GzipCompressorInputStream</code>åˆ™å¯è§£å†³ä¹±ç é—®é¢˜ã€‚</p><a id="more"></a><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ZipUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOG = LoggerFactory.getLogger(ZipUtil.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BUFFER_SIZE = <span class="number">1024</span> * <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">ZipUtil</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§æœ‰å‡½æ•°å°†æ–‡ä»¶é›†åˆå‹ç¼©æˆtaråŒ…åè¿”å›</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> files  è¦å‹ç¼©çš„æ–‡ä»¶é›†åˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target tar è¾“å‡ºæµçš„ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> File  æŒ‡å®šè¿”å›çš„ç›®æ ‡æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> File <span class="title">pack</span><span class="params">(List&lt;File&gt; files, File target)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(target)) &#123;</span><br><span class="line">            <span class="keyword">try</span> (BufferedOutputStream bos = <span class="keyword">new</span> BufferedOutputStream(fos, BUFFER_SIZE)) &#123;</span><br><span class="line">                <span class="keyword">try</span> (TarArchiveOutputStream taos = <span class="keyword">new</span> TarArchiveOutputStream(bos)) &#123;</span><br><span class="line">                    <span class="comment">//è§£å†³æ–‡ä»¶åè¿‡é•¿é—®é¢˜</span></span><br><span class="line">                    taos.setLongFileMode(TarArchiveOutputStream.LONGFILE_GNU);</span><br><span class="line">                    <span class="keyword">for</span> (File file : files) &#123;</span><br><span class="line">                        taos.putArchiveEntry(<span class="keyword">new</span> TarArchiveEntry(file));</span><br><span class="line">                        <span class="keyword">try</span> (FileInputStream fis = <span class="keyword">new</span> FileInputStream(file)) &#123;</span><br><span class="line">                            IOUtils.copy(fis, taos);</span><br><span class="line">                            taos.closeArchiveEntry();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†tarå‹ç¼©æˆtar.gzæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> list</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outPutPath</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> File <span class="title">compress</span><span class="params">(List&lt;File&gt; list, String outPutPath, String fileName)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        File outPutFile = <span class="keyword">new</span> File(outPutPath + File.separator + fileName + <span class="string">".tar.gz"</span>);</span><br><span class="line">        File tempTar = <span class="keyword">new</span> File(<span class="string">"temp.tar"</span>);</span><br><span class="line">        <span class="keyword">try</span> (FileInputStream fis = <span class="keyword">new</span> FileInputStream(pack(list, tempTar))) &#123;</span><br><span class="line">            <span class="keyword">try</span> (BufferedInputStream bis = <span class="keyword">new</span> BufferedInputStream(fis, BUFFER_SIZE)) &#123;</span><br><span class="line">                <span class="keyword">try</span> (FileOutputStream fos = <span class="keyword">new</span> FileOutputStream(outPutFile)) &#123;</span><br><span class="line">                    <span class="keyword">try</span> (GZIPOutputStream gzp = <span class="keyword">new</span> GZIPOutputStream(fos)) &#123;</span><br><span class="line">                        <span class="keyword">int</span> count;</span><br><span class="line">                        <span class="keyword">byte</span>[] data = <span class="keyword">new</span> <span class="keyword">byte</span>[BUFFER_SIZE];</span><br><span class="line">                        <span class="keyword">while</span> ((count = bis.read(data, <span class="number">0</span>, BUFFER_SIZE)) != -<span class="number">1</span>) &#123;</span><br><span class="line">                            gzp.write(data, <span class="number">0</span>, count);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Files.deleteIfExists(tempTar.toPath());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> outPutFile;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">decompress</span><span class="params">(String filePath, String outputDir, <span class="keyword">boolean</span> isDeleted)</span> </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            LOG.error(<span class="string">"decompress file not exist."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (filePath.endsWith(<span class="string">".zip"</span>)) &#123;</span><br><span class="line">                unZip(file, outputDir);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (filePath.endsWith(<span class="string">".tar.gz"</span>) || filePath.endsWith(<span class="string">".tgz"</span>)) &#123;</span><br><span class="line">                decompressTarGz(file, outputDir);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (filePath.endsWith(<span class="string">".tar.bz2"</span>)) &#123;</span><br><span class="line">                decompressTarBz2(file, outputDir);</span><br><span class="line">            &#125;</span><br><span class="line">            filterFile(<span class="keyword">new</span> File(outputDir));</span><br><span class="line">            <span class="keyword">if</span> (isDeleted) &#123;</span><br><span class="line">                FileUtils.deleteQuietly(file);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            LOG.error(<span class="string">"decompress occur error."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£å‹ .zip æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file      è¦è§£å‹çš„zipæ–‡ä»¶å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputDir è¦è§£å‹åˆ°æŸä¸ªæŒ‡å®šçš„ç›®å½•ä¸‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">unZip</span><span class="params">(File file, String outputDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (ZipFile zipFile = <span class="keyword">new</span> ZipFile(file, StandardCharsets.UTF_8)) &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºè¾“å‡ºç›®å½•</span></span><br><span class="line">            createDirectory(outputDir, <span class="keyword">null</span>);</span><br><span class="line">            Enumeration&lt;?&gt; enums = zipFile.entries();</span><br><span class="line">            <span class="keyword">while</span> (enums.hasMoreElements()) &#123;</span><br><span class="line">                ZipEntry entry = (ZipEntry) enums.nextElement();</span><br><span class="line">                <span class="keyword">if</span> (entry.isDirectory()) &#123;</span><br><span class="line">                    <span class="comment">//åˆ›å»ºç©ºç›®å½•</span></span><br><span class="line">                    createDirectory(outputDir, entry.getName());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> (InputStream in = zipFile.getInputStream(entry)) &#123;</span><br><span class="line">                        <span class="keyword">try</span> (OutputStream out = <span class="keyword">new</span> FileOutputStream(</span><br><span class="line">                                <span class="keyword">new</span> File(outputDir + File.separator + entry.getName()))) &#123;</span><br><span class="line">                            writeFile(in, out);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">decompressTarGz</span><span class="params">(File file, String outputDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (TarArchiveInputStream tarIn = <span class="keyword">new</span> TarArchiveInputStream(</span><br><span class="line">                <span class="keyword">new</span> GzipCompressorInputStream(</span><br><span class="line">                        <span class="keyword">new</span> BufferedInputStream(</span><br><span class="line">                                <span class="keyword">new</span> FileInputStream(file))))) &#123;</span><br><span class="line">            <span class="comment">//åˆ›å»ºè¾“å‡ºç›®å½•</span></span><br><span class="line">            createDirectory(outputDir, <span class="keyword">null</span>);</span><br><span class="line">            TarArchiveEntry entry = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span> ((entry = tarIn.getNextTarEntry()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//æ˜¯ç›®å½•</span></span><br><span class="line">                <span class="keyword">if</span> (entry.isDirectory()) &#123;</span><br><span class="line">                    <span class="comment">//åˆ›å»ºç©ºç›®å½•</span></span><br><span class="line">                    createDirectory(outputDir, entry.getName());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//æ˜¯æ–‡ä»¶</span></span><br><span class="line">                    <span class="keyword">try</span> (OutputStream out = <span class="keyword">new</span> FileOutputStream(</span><br><span class="line">                            <span class="keyword">new</span> File(outputDir + File.separator + entry.getName()))) &#123;</span><br><span class="line">                        writeFile(tarIn, out);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£å‹ç¼©tar.bz2æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file      å‹ç¼©åŒ…æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputDir ç›®æ ‡æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">decompressTarBz2</span><span class="params">(File file, String outputDir)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> (TarArchiveInputStream tarIn =</span><br><span class="line">                     <span class="keyword">new</span> TarArchiveInputStream(</span><br><span class="line">                             <span class="keyword">new</span> BZip2CompressorInputStream(</span><br><span class="line">                                     <span class="keyword">new</span> FileInputStream(file)))) &#123;</span><br><span class="line">            createDirectory(outputDir, <span class="keyword">null</span>);</span><br><span class="line">            TarArchiveEntry entry;</span><br><span class="line">            <span class="keyword">while</span> ((entry = tarIn.getNextTarEntry()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (entry.isDirectory()) &#123;</span><br><span class="line">                    createDirectory(outputDir, entry.getName());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">try</span> (OutputStream out = <span class="keyword">new</span> FileOutputStream(</span><br><span class="line">                            <span class="keyword">new</span> File(outputDir + File.separator + entry.getName()))) &#123;</span><br><span class="line">                        writeFile(tarIn, out);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†™æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> out</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(InputStream in, OutputStream out)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> length;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[BUFFER_SIZE];</span><br><span class="line">        <span class="keyword">while</span> ((length = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">            out.write(b, <span class="number">0</span>, length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> outputDir</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subDir</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createDirectory</span><span class="params">(String outputDir, String subDir)</span> </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(outputDir);</span><br><span class="line">        <span class="comment">//å­ç›®å½•ä¸ä¸ºç©º</span></span><br><span class="line">        <span class="keyword">if</span> (!(subDir == <span class="keyword">null</span> || subDir.trim().equals(<span class="string">""</span>))) &#123;</span><br><span class="line">            file = <span class="keyword">new</span> File(outputDir + File.separator + subDir);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!file.exists()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!file.getParentFile().exists()) &#123;</span><br><span class="line">                file.getParentFile().mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤Macå‹ç¼©å†è§£å‹äº§ç”Ÿçš„ __MACOSX æ–‡ä»¶å¤¹å’Œ .å¼€å¤´çš„å…¶ä»–æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filteredFile</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">filterFile</span><span class="params">(File filteredFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (filteredFile != <span class="keyword">null</span>) &#123;</span><br><span class="line">            File[] files = filteredFile.listFiles();</span><br><span class="line">            <span class="keyword">for</span> (File file : files) &#123;</span><br><span class="line">                <span class="keyword">if</span> (file.getName().startsWith(<span class="string">"."</span>) ||</span><br><span class="line">                        (file.isDirectory() &amp;&amp; file.getName().equals(<span class="string">"__MACOSX"</span>))) &#123;</span><br><span class="line">                    FileUtils.deleteQuietly(file);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»£ç åœ°å€ï¼š <a href="https://github.com/morethink/code/blob/master/java/tools/src/main/java/cn/morethink/tools/util/ZipUtil.java" target="_blank" rel="noopener">https://github.com/morethink/code/blob/master/java/tools/src/main/java/cn/morethink/tools/util/ZipUtil.java</a></p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://www.programcreek.com/java-api-examples/?api=org.apache.commons.compress.archivers.tar.TarArchiveInputStream" target="_blank" rel="noopener">commons-compresså®˜æ–¹å®ä¾‹</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Gitä¸ºæŸä¸ªåŸŸåè®¾ç½®ä»£ç†</title>
      <link href="/Git-set-proxy-for-a-domain/"/>
      <url>/Git-set-proxy-for-a-domain/</url>
      
        <content type="html"><![CDATA[<p>å›½å†…è®¿é—®Githubå¾ˆæ…¢ï¼Œå¯ä»¥é€šè¿‡é…ç½®ä»£ç†æ¥åŠ å¿«è®¿é—®é€Ÿåº¦ï¼Œä½†æ˜¯å¯¹å…¬å¸å†…éƒ¨gitæœåŠ¡å™¨å´ä¸èƒ½ä½¿ç”¨ä»£ç†ã€‚</p><p>ä¸‹é¢é€šè¿‡æ›´æ”¹Gité…ç½®æ–‡ä»¶å¯¹ä¸åŒçš„åŸŸåä½¿ç”¨ä¸åŒçš„ä»£ç†é…ç½®ã€‚<br><br><a id="more"></a></p><ol><li><p>æ‰“å¼€Git é…ç½®æ–‡ä»¶</p> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vi ~/.gitconfig</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[http "https://github.com/"]</span><br><span class="line">    proxy = http://127.0.0.1:1081</span><br><span class="line">[https "https://github.com/"]</span><br><span class="line">    proxy = http://127.0.0.1:1081</span><br><span class="line">[http "https://my.comapnyserver.com/"]</span><br><span class="line">    proxy = ""</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>MongoDB åŠ Mysql èƒŒåçš„ B/B+æ ‘</title>
      <link href="/data-structure-behind-the-index/"/>
      <url>/data-structure-behind-the-index/</url>
      
        <content type="html"><![CDATA[<p>ç´¢å¼•æ˜¯æ•°æ®åº“å¸¸è§çš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªåå°å¼€å‘äººå‘˜éƒ½åº”è¯¥å¯¹ç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„æœ‰æ‰€äº†è§£ã€‚</p><p>æœ¬æ–‡é€šè¿‡åˆ†æB-TreeåŠB-/+Treeæ•°æ®ç»“æ„åŠç´¢å¼•æ€§èƒ½åˆ†æåŠç£ç›˜å­˜å–åŸç†å°è¯•ç€å›ç­”ä¸€ä¸‹é—®é¢˜ï¼š</p><ol><li>ä¸ºä»€ä¹ˆB-Treeé€‚åˆæ•°æ®åº“ç´¢å¼•åŠçº¢é»‘æ ‘çš„äºŒå‰å¹³è¡¡æ ‘ä¸é€‚åˆä½œä¸ºç´¢å¼•</li><li>B+Treeæ¯”BTreeåšç´¢å¼•çš„ä¼˜åŠ¿</li><li>ä¸ºä»€ä¹ˆMongoDBé‡‡ç”¨B-Treeä½œä¸ºç´¢å¼•ç»“æ„è€ŒMySQLé‡‡ç”¨B+Treeä½œä¸ºç´¢å¼•å­˜å‚¨ç»“æ„</li></ol><a id="more"></a><h1 id="B-Tree"><a href="#B-Tree" class="headerlink" title="B-Tree"></a>B-Tree</h1><p>B æ ‘ï¼ˆB-Treeï¼‰æ˜¯ä¸ºç£ç›˜ç­‰è¾…åŠ©å­˜å–è®¾å¤‡è®¾è®¡çš„ä¸€ç§å¹³è¡¡æŸ¥æ‰¾æ ‘ï¼Œå®ƒå®ç°äº†ä»¥ $O(\lg n)$ æ—¶é—´å¤æ‚åº¦æ‰§è¡ŒæŸ¥æ‰¾ã€é¡ºåºè¯»å–ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚ç”±äº B æ ‘å’Œ B æ ‘çš„å˜ç§åœ¨é™ä½ç£ç›˜ I/O æ“ä½œæ¬¡æ•°æ–¹é¢è¡¨ç°ä¼˜å¼‚ï¼Œæ‰€ä»¥ç»å¸¸ç”¨äºè®¾è®¡æ–‡ä»¶ç³»ç»Ÿå’Œæ•°æ®åº“ã€‚</p><p>ä½¿ç”¨é˜¶æ¥å®šä¹‰ B æ ‘ï¼Œä¸€æ£µ m é˜¶çš„ B æ ‘ï¼Œéœ€è¦æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼š</p><ol><li>æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šæ‹¥æœ‰mä¸ªå­èŠ‚ç‚¹ä¸”m&gt;=2ï¼Œç©ºæ ‘é™¤å¤–</li><li><strong>é™¤æ ¹èŠ‚ç‚¹å¤–æ¯ä¸ªèŠ‚ç‚¹çš„å…³é”®å­—æ•°é‡å¤§äºç­‰äº<code>ceil(m/2)-1</code>ï¼Œå°äºç­‰äº<code>m-1</code>ï¼Œéæ ¹èŠ‚ç‚¹å…³é”®å­—æ•°å¿…é¡»&gt;=2</strong></li><li>æ‰€æœ‰å¶å­èŠ‚ç‚¹å‡åœ¨åŒä¸€å±‚ã€å¶å­èŠ‚ç‚¹é™¤äº†åŒ…å«äº†å…³é”®å­—å’Œå…³é”®å­—è®°å½•çš„æŒ‡é’ˆå¤–ä¹Ÿæœ‰æŒ‡å‘å…¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆåªä¸è¿‡å…¶æŒ‡é’ˆåœ°å€éƒ½ä¸ºnullå¯¹åº”ä¸‹å›¾æœ€åä¸€å±‚èŠ‚ç‚¹çš„ç©ºæ ¼å­</li><li><strong>å¦‚æœä¸€ä¸ªéå¶èŠ‚ç‚¹æœ‰nä¸ªå­èŠ‚ç‚¹ï¼Œåˆ™è¯¥èŠ‚ç‚¹çš„å…³é”®å­—æ•°ç­‰äºn-1</strong></li><li>æ‰€æœ‰èŠ‚ç‚¹å…³é”®å­—æ˜¯æŒ‰é€’å¢æ¬¡åºæ’åˆ—ï¼Œå¹¶éµå¾ªå·¦å°å³å¤§åŸåˆ™</li></ol><p>æ³¨ï¼š</p><ol><li>mé˜¶ä»£è¡¨ä¸€ä¸ªæ ‘èŠ‚ç‚¹æœ€å¤šæœ‰å¤šå°‘ä¸ªæŸ¥æ‰¾è·¯å¾„ï¼Œmé˜¶=mè·¯,å½“m=2åˆ™æ˜¯2å‰æ ‘ï¼Œm=3åˆ™æ˜¯3å‰ã€‚</li><li>ceil()æ˜¯ä¸ªæœæ­£æ— ç©·æ–¹å‘å–æ•´çš„å‡½æ•°ï¼Œå¦‚ceil(1.1)ç»“æœä¸º2ï¼Œå³å‘ä¸Šå–æ•´ã€‚</li></ol><p><img src="https://images.morethink.cn/B-Tree-1.jpg" alt="B-Tree" title="B-Tree"></p><p>B æ ‘ä¸­çš„èŠ‚ç‚¹åˆ†ä¸ºå†…éƒ¨èŠ‚ç‚¹ï¼ˆInternal Nodeï¼‰å’Œå¶èŠ‚ç‚¹ï¼ˆLeaf Nodeï¼‰ï¼Œå†…éƒ¨èŠ‚ç‚¹ä¹Ÿå°±æ˜¯éå¶èŠ‚ç‚¹ï¼ˆNon-Leaf Nodeï¼‰ã€‚</p><h2 id="B-Treeçš„æŸ¥æ‰¾"><a href="#B-Treeçš„æŸ¥æ‰¾" class="headerlink" title="B-Treeçš„æŸ¥æ‰¾"></a>B-Treeçš„æŸ¥æ‰¾</h2><p>B-Treeçš„æŸ¥æ‰¾è¿‡ç¨‹ï¼šæ ¹æ®ç»™å®šå€¼æŸ¥æ‰¾ç»“ç‚¹å’Œåœ¨ç»“ç‚¹çš„å…³é”®å­—ä¸­è¿›è¡ŒæŸ¥æ‰¾äº¤å‰è¿›è¡Œã€‚</p><p>é¦–å…ˆä»æ ¹ç»“ç‚¹å¼€å§‹é‡å¤å¦‚ä¸‹è¿‡ç¨‹ï¼šè‹¥æ¯”ç»“ç‚¹çš„ç¬¬ä¸€ä¸ªå…³é”®å­—å°ï¼Œåˆ™æŸ¥æ‰¾åœ¨è¯¥ç»“ç‚¹ç¬¬ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹è¿›è¡Œï¼›è‹¥ç­‰äºç»“ç‚¹ä¸­æŸä¸ªå…³é”®å­—ï¼Œåˆ™æŸ¥æ‰¾æˆåŠŸï¼›è‹¥åœ¨ä¸¤ä¸ªå…³é”®å­—ä¹‹é—´ï¼Œåˆ™æŸ¥æ‰¾åœ¨å®ƒä»¬ä¹‹é—´çš„æŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹è¿›è¡Œï¼›è‹¥æ¯”è¯¥ç»“ç‚¹æ‰€æœ‰å…³é”®å­—å¤§ï¼Œåˆ™æŸ¥æ‰¾åœ¨è¯¥ç»“ç‚¹æœ€åä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘çš„ç»“ç‚¹è¿›è¡Œï¼›è‹¥æŸ¥æ‰¾å·²ç»åˆ°è¾¾æŸä¸ªå¶ç»“ç‚¹ï¼Œåˆ™è¯´æ˜ç»™å®šå€¼å¯¹åº”çš„æ•°æ®è®°å½•ä¸å­˜åœ¨ï¼ŒæŸ¥æ‰¾å¤±è´¥ã€‚</p><p>ä¾‹å¦‚ï¼š<br>åœ¨ä¸€æ£µ 5 é˜¶B-æ ‘ä¸­æŸ¥æ‰¾å…ƒç´  29</p><p><img src="https://upload-images.jianshu.io/upload_images/1630488-43897a4dd77bf18f.gif" alt="" title="B-Treeçš„æŸ¥è¯¢"></p><p>é¦–å…ˆ29æ¯”æ ¹èŠ‚ç‚¹å€¼å¤§ï¼Œæ‰€ä»¥æ‰¾æ ¹èŠ‚ç‚¹çš„å³å­æ•°ï¼Œç„¶åå†æ ¹æ®å€¼å¾—åˆ¤æ–­ï¼Œå‘ç° 29 ä»‹äº 28 å’Œ 48 ä¹‹é—´ï¼Œç„¶ååœ¨ä»ä¸­é—´å­æ ‘ç»§ç»­æŸ¥æ‰¾ä¸‹å»ã€‚</p><h2 id="B-Treeçš„æ’å…¥"><a href="#B-Treeçš„æ’å…¥" class="headerlink" title="B-Treeçš„æ’å…¥"></a>B-Treeçš„æ’å…¥</h2><p>æ’å…¥çš„è¿‡ç¨‹åˆ†ä¸¤æ­¥å®Œæˆï¼š</p><ol><li><p>åˆ©ç”¨å‰è¿°çš„B-æ ‘çš„æŸ¥æ‰¾ç®—æ³•æŸ¥æ‰¾å…³é”®å­—çš„æ’å…¥ä½ç½®ã€‚è‹¥æ‰¾åˆ°ï¼Œåˆ™è¯´æ˜è¯¥å…³é”®å­—å·²ç»å­˜åœ¨ï¼Œç›´æ¥è¿”å›ã€‚å¦åˆ™æŸ¥æ‰¾æ“ä½œå¿…å¤±è´¥äºæŸä¸ªæœ€ä½å±‚çš„éç»ˆç«¯ç»“ç‚¹ä¸Šã€‚</p></li><li><p>åˆ¤æ–­è¯¥ç»“ç‚¹æ˜¯å¦è¿˜æœ‰ç©ºä½ç½®ã€‚<strong>å³åˆ¤æ–­è¯¥ç»“ç‚¹çš„å…³é”®å­—æ€»æ•°æ˜¯å¦æ»¡è¶³n&lt;=m-1</strong>ã€‚è‹¥æ»¡è¶³ï¼Œåˆ™è¯´æ˜è¯¥ç»“ç‚¹è¿˜æœ‰ç©ºä½ç½®ï¼Œç›´æ¥æŠŠå…³é”®å­—kæ’å…¥åˆ°è¯¥ç»“ç‚¹çš„åˆé€‚ä½ç½®ä¸Šã€‚è‹¥ä¸æ»¡è¶³ï¼Œè¯´æ˜è¯¥ç»“ç‚¹å·±æ²¡æœ‰ç©ºä½ç½®ï¼Œéœ€è¦æŠŠç»“ç‚¹åˆ†è£‚æˆä¸¤ä¸ªã€‚</p></li></ol><p>åˆ†è£‚çš„æ–¹æ³•æ˜¯ï¼š<br>ç”Ÿæˆä¸€æ–°ç»“ç‚¹ã€‚æŠŠåŸç»“ç‚¹ä¸Šçš„å…³é”®å­—å’ŒkæŒ‰å‡åºæ’åºåï¼Œ<strong>ä»ä¸­é—´ä½ç½®æŠŠå…³é”®å­—ï¼ˆä¸åŒ…æ‹¬ä¸­é—´ä½ç½®çš„å…³é”®å­—ï¼‰åˆ†æˆä¸¤éƒ¨åˆ†</strong>ã€‚å·¦éƒ¨åˆ†æ‰€å«å…³é”®å­—æ”¾åœ¨æ—§ç»“ç‚¹ä¸­ï¼Œå³éƒ¨åˆ†æ‰€å«å…³é”®å­—æ”¾åœ¨æ–°ç»“ç‚¹ä¸­ï¼Œä¸­é—´ä½ç½®çš„å…³é”®å­—è¿åŒæ–°ç»“ç‚¹çš„å­˜å‚¨ä½ç½®æ’å…¥åˆ°çˆ¶ç»“ç‚¹ä¸­ã€‚å¦‚æœçˆ¶ç»“ç‚¹çš„å…³é”®å­—ä¸ªæ•°ä¹Ÿè¶…è¿‡ï¼ˆm-1ï¼‰ï¼Œåˆ™è¦å†åˆ†è£‚ï¼Œå†å¾€ä¸Šæ’ã€‚ç›´è‡³è¿™ä¸ªè¿‡ç¨‹ä¼ åˆ°æ ¹ç»“ç‚¹ä¸ºæ­¢ã€‚</p><p>ä¾‹å­ï¼š</p><p><strong>å¦‚æœè¯¥èŠ‚ç‚¹çš„å…ƒç´ ä¸ªæ•°è¿˜æ²¡è¾¾åˆ° mï¼Œåˆ™æ’å…¥å®Œåæ— éœ€å¤„ç†</strong><br>æ¯”å¦‚ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/1630488-25083e10d9708891.gif" alt="" title="åœ¨ B-æ ‘ä¸­æ’å…¥å…ƒç´  3"></p><p><strong>å¦‚æœè¯¥èŠ‚ç‚¹å…ƒç´ ä¸ªæ•°è¾¾åˆ° m æ—¶ï¼Œè¿™æ—¶å€™å°†å…ƒç´ æ’å…¥åˆ°åˆé€‚çš„ä½ç½®ï¼Œå°†æœ€ä¸­é—´çš„å…ƒç´ å–å‡ºï¼Œæˆä¸ºè¯¥èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å…ƒç´ ï¼Œç„¶åå°†å…¶ä½™å·¦å³å…ƒç´ æ‹†æˆä¸¤ä¸ªæ–°èŠ‚ç‚¹</strong></p><p>æ¯”å¦‚ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/1630488-afa3b6b35908cf99.gif" alt="" title="åœ¨ B-æ ‘ä¸­æ’å…¥å…ƒç´  44"></p><p><strong>åˆšæ‰çš„æ“ä½œå¯èƒ½å¯¼è‡´çˆ¶èŠ‚ç‚¹çš„å…ƒç´ ä¸ªæ•°è¾¾åˆ° mï¼Œè¿™æ—¶å€™ç”¨æƒ…å†µ 2 è¿­ä»£å¤„ç†ï¼Œç›´åˆ°å¦‚æœé‡åˆ°æ ¹ç»“ç‚¹å…ƒç´ ä¸ªæ•°è¾¾åˆ° mï¼Œåˆ™æœ€ä¸­é—´å…ƒç´ å°†æˆä¸ºæ–°çš„æ ¹ç»“ç‚¹ã€‚</strong></p><p>æ¯”å¦‚ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/1630488-8dda91b45852ba9d.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt="" title="åœ¨ B-æ ‘ä¸­æ’å…¥å…ƒç´  45"></p><h2 id="B-Tree-çš„åˆ é™¤"><a href="#B-Tree-çš„åˆ é™¤" class="headerlink" title="B-Tree çš„åˆ é™¤"></a>B-Tree çš„åˆ é™¤</h2><p>æˆ‘ä»¬éœ€è¦åˆ†ä¸¤ç§æƒ…å†µè¿›è¡Œè®¨è®ºï¼š</p><ul><li>å¦‚æœè¯¥å…ƒç´ å­˜åœ¨äºå¶å­ç»“ç‚¹ï¼Œç›´æ¥åˆ é™¤å®ƒï¼Œæ— éœ€è¿›è¡Œå…¶å®ƒå¤„ç†ã€‚</li><li>å¦‚æœè¯¥å…ƒç´ å­˜åœ¨äºéå¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåˆ é™¤å®ƒå°†ä¼šç•™ä¸‹ä¸€ä¸ªç©ºä½ï¼Œè¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€äº›å¤„ç†æ¥å¡«å……è¯¥ä½ç½®ã€‚<br>å› ä¸ºèŠ‚ç‚¹çš„å…ƒç´ ä¸ªæ•°åœ¨ [M/2, M] çš„èŒƒå›´å†…ï¼Œæ‰€ä»¥æ¯”å¦‚è¿™é‡Œæˆ‘ä»¬ä»¥ 5 é˜¶B-æ ‘ä¸ºä¾‹ï¼Œåˆ¤æ–­èŠ‚ç‚¹å…ƒç´ æ˜¯å¦å……è¶³å³æ»¡è¶³ä¸ªæ•°åˆ™è‡³å°‘æ‹¥æœ‰ä¸‰ï¼ˆ2 + 1ï¼‰ä¸ªå…ƒç´ çš„èŠ‚ç‚¹æ‰ç®—æ˜¯æœ‰å……è¶³çš„å…ƒç´ ã€‚<ol><li>å¦‚æœè¢«åˆ å…ƒç´ çš„å·¦å­æ ‘æ‹¥æœ‰è¶³å¤Ÿçš„å…ƒç´ ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åªéœ€æ‹¿å·¦å­èŠ‚ç‚¹çš„æœ€å¤§å€¼å…ƒç´ ä¸Šæ¥å¡«å……å³å¯</li><li>å½“å·¦å­æ ‘ä¸å¤Ÿå…ƒç´ è€Œå³å­æ ‘å…ƒç´ å……è¶³æ—¶ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æ‹¿å³å­æ ‘çš„æœ€å°å€¼å…ƒç´ ä¸Šæ¥è¿›è¡Œå¡«å……</li><li>å½“å·¦å³å­æ ‘æ‰€å«å…ƒç´ å‡ä¸è¶³æ—¶ï¼Œä½†å·¦å­æ ‘çš„å·¦è¾¹å…„å¼ŸèŠ‚ç‚¹çš„å…ƒç´ ä¸ªæ•°å……è¶³ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦æ‹¿å·¦è¾¹çš„å…„å¼ŸèŠ‚ç‚¹æ¥è¿›è¡Œè°ƒæ•´ã€‚</li><li>å½“å·¦å³å­æ ‘æ‰€å«å…ƒç´ å‡ä¸è¶³æ—¶ï¼Œä½†å·¦å­æ ‘çš„å·¦è¾¹å…„å¼ŸèŠ‚ç‚¹çš„å…ƒç´ ä¸ªæ•°ä¹Ÿä¸è¶³æ—¶ï¼Œè¿™æ—¶å€™æˆ‘ä»¬è¿˜æ˜¯æ‹¿å·¦å­æ ‘çš„æœ€å¤§å€¼å…ƒç´ è¿›è¡Œå¡«å……ï¼Œä¹‹åå†å°†è¯¥èŠ‚ç‚¹ä¸å…¶ä»–èŠ‚ç‚¹åˆå¹¶å½¢æˆæ–°çš„èŠ‚ç‚¹ã€‚</li></ol></li></ul><h1 id="B-Tree-1"><a href="#B-Tree-1" class="headerlink" title="B+Tree"></a>B+Tree</h1><p>B-Treeæœ‰è®¸å¤šå˜ç§ï¼Œå…¶ä¸­æœ€å¸¸è§çš„æ˜¯B+Treeï¼Œä¾‹å¦‚MySQLå°±æ™®éä½¿ç”¨B+Treeå®ç°å…¶ç´¢å¼•ç»“æ„ã€‚</p><p>ä¸B-Treeç›¸æ¯”ï¼ŒB+Treeæœ‰ä»¥ä¸‹ä¸åŒç‚¹ï¼š</p><ul><li>æ¯ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆä¸Šé™ä¸º2dè€Œä¸æ˜¯2d+1ã€‚</li><li>B+Treeå¶å­èŠ‚ç‚¹ä¿å­˜äº†çˆ¶èŠ‚ç‚¹çš„æ‰€æœ‰å…³é”®å­—å’Œå…³é”®å­—è®°å½•çš„æŒ‡é’ˆï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹çš„å…³é”®å­—ä»å°åˆ°å¤§é“¾æ¥</li><li>å†…èŠ‚ç‚¹ä¸å­˜å‚¨dataï¼Œåªå­˜å‚¨keyï¼›å¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æŒ‡é’ˆã€‚å› æ­¤æ‰€æœ‰æ•°æ®åœ°å€å¿…é¡»è¦åˆ°å¶å­èŠ‚ç‚¹æ‰èƒ½è·å–åˆ°ï¼Œæ‰€ä»¥æ¯æ¬¡æ•°æ®æŸ¥è¯¢çš„æ¬¡æ•°éƒ½ä¸€æ ·ã€‚<br><img src="https://images.morethink.cn/B+Tree.jpg" alt="" title="B+Tree"></li></ul><h1 id="ç´¢å¼•"><a href="#ç´¢å¼•" class="headerlink" title="ç´¢å¼•"></a>ç´¢å¼•</h1><p>çº¢é»‘æ ‘ç­‰æ•°æ®ç»“æ„ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°ç´¢å¼•ï¼Œä½†æ˜¯æ–‡ä»¶ç³»ç»ŸåŠæ•°æ®åº“ç³»ç»Ÿæ™®éé‡‡ç”¨B-/+Treeä½œä¸ºç´¢å¼•ç»“æ„ï¼Œè¿™ä¸€èŠ‚å°†ç»“åˆè®¡ç®—æœºç»„æˆåŸç†ç›¸å…³çŸ¥è¯†è®¨è®ºB-/+Treeä½œä¸ºç´¢å¼•çš„ç†è®ºåŸºç¡€ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§ï¼Œä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç´¢å¼•å¾€å¾€ä»¥ç´¢å¼•æ–‡ä»¶çš„å½¢å¼å­˜å‚¨çš„ç£ç›˜ä¸Šã€‚è¿™æ ·çš„è¯ï¼Œç´¢å¼•æŸ¥æ‰¾è¿‡ç¨‹ä¸­å°±è¦äº§ç”Ÿç£ç›˜I/Oæ¶ˆè€—ï¼Œç›¸å¯¹äºå†…å­˜å­˜å–ï¼ŒI/Oå­˜å–çš„æ¶ˆè€—è¦é«˜å‡ ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥è¯„ä»·ä¸€ä¸ªæ•°æ®ç»“æ„ä½œä¸ºç´¢å¼•çš„ä¼˜åŠ£æœ€é‡è¦çš„æŒ‡æ ‡å°±æ˜¯åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ç£ç›˜I/Oæ“ä½œæ¬¡æ•°çš„æ¸è¿›å¤æ‚åº¦ã€‚æ¢å¥è¯è¯´ï¼Œ<strong>ç´¢å¼•çš„ç»“æ„ç»„ç»‡è¦å°½é‡å‡å°‘æŸ¥æ‰¾è¿‡ç¨‹ä¸­ç£ç›˜I/Oçš„å­˜å–æ¬¡æ•°</strong>ã€‚</p><p>ä¸‹é¢å…ˆä»‹ç»å†…å­˜å’Œç£ç›˜å­˜å–åŸç†ï¼Œç„¶åå†ç»“åˆè¿™äº›åŸç†åˆ†æB-/+Treeä½œä¸ºç´¢å¼•çš„æ•ˆç‡ã€‚</p><h1 id="ç£ç›˜å­˜å–åŸç†"><a href="#ç£ç›˜å­˜å–åŸç†" class="headerlink" title="ç£ç›˜å­˜å–åŸç†"></a>ç£ç›˜å­˜å–åŸç†</h1><p>ç´¢å¼•ä¸€èˆ¬ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç´¢å¼•æ£€ç´¢éœ€è¦ç£ç›˜I/Oæ“ä½œã€‚ä¸ä¸»å­˜ä¸åŒï¼Œç£ç›˜I/Oå­˜åœ¨æœºæ¢°è¿åŠ¨è€—è´¹ï¼Œå› æ­¤ç£ç›˜I/Oçš„æ—¶é—´æ¶ˆè€—æ˜¯å·¨å¤§çš„ã€‚</p><p>ä¸‹é¢æ˜¯ç£ç›˜çš„æ•´ä½“ç»“æ„ç¤ºæ„å›¾ï¼š</p><p><img src="http://blog.codinglabs.org/uploads/pictures/theory-of-mysql-index/6.png" alt="" title="ç£ç›˜çš„æ•´ä½“ç»“æ„"></p><p>ä¸€ä¸ªç£ç›˜ç”±å¤§å°ç›¸åŒä¸”åŒè½´çš„åœ†å½¢ç›˜ç‰‡ç»„æˆï¼Œç£ç›˜å¯ä»¥è½¬åŠ¨ï¼ˆå„ä¸ªç£ç›˜å¿…é¡»åŒæ­¥è½¬åŠ¨ï¼‰ã€‚åœ¨ç£ç›˜çš„ä¸€ä¾§æœ‰ç£å¤´æ”¯æ¶ï¼Œç£å¤´æ”¯æ¶å›ºå®šäº†ä¸€ç»„ç£å¤´ï¼Œæ¯ä¸ªç£å¤´è´Ÿè´£å­˜å–ä¸€ä¸ªç£ç›˜çš„å†…å®¹ã€‚ç£å¤´ä¸èƒ½è½¬åŠ¨ï¼Œä½†æ˜¯å¯ä»¥æ²¿ç£ç›˜åŠå¾„æ–¹å‘è¿åŠ¨ï¼ˆå®é™…æ˜¯æ–œåˆ‡å‘è¿åŠ¨ï¼‰ï¼Œæ¯ä¸ªç£å¤´åŒä¸€æ—¶åˆ»ä¹Ÿå¿…é¡»æ˜¯åŒè½´çš„ï¼Œå³ä»æ­£ä¸Šæ–¹å‘ä¸‹çœ‹ï¼Œæ‰€æœ‰ç£å¤´ä»»ä½•æ—¶å€™éƒ½æ˜¯é‡å çš„ï¼ˆä¸è¿‡ç›®å‰å·²ç»æœ‰å¤šç£å¤´ç‹¬ç«‹æŠ€æœ¯ï¼Œå¯ä¸å—æ­¤é™åˆ¶ï¼‰ã€‚</p><p>ä¸‹é¢æ˜¯ç£ç›˜ç»“æ„çš„ç¤ºæ„å›¾ï¼š</p><p><img src="http://blog.codinglabs.org/uploads/pictures/theory-of-mysql-index/7.png" alt="" title="ç£ç›˜ç»“æ„"></p><p>ç›˜ç‰‡è¢«åˆ’åˆ†æˆä¸€ç³»åˆ—åŒå¿ƒç¯ï¼Œåœ†å¿ƒæ˜¯ç›˜ç‰‡ä¸­å¿ƒï¼Œæ¯ä¸ªåŒå¿ƒç¯å«åšä¸€ä¸ªç£é“ï¼Œæ‰€æœ‰åŠå¾„ç›¸åŒçš„ç£é“ç»„æˆä¸€ä¸ªæŸ±é¢ã€‚ç£é“è¢«æ²¿åŠå¾„çº¿åˆ’åˆ†æˆä¸€ä¸ªä¸ªå°çš„æ®µï¼Œæ¯ä¸ªæ®µå«åšä¸€ä¸ªæ‰‡åŒºï¼Œæ¯ä¸ªæ‰‡åŒºæ˜¯ç£ç›˜çš„æœ€å°å­˜å‚¨å•å…ƒã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä¸‹é¢å‡è®¾ç£ç›˜åªæœ‰ä¸€ä¸ªç›˜ç‰‡å’Œä¸€ä¸ªç£å¤´ã€‚</p><p>å½“éœ€è¦ä»ç£ç›˜è¯»å–æ•°æ®æ—¶ï¼Œç³»ç»Ÿä¼šå°†æ•°æ®é€»è¾‘åœ°å€ä¼ ç»™ç£ç›˜ï¼Œç£ç›˜çš„æ§åˆ¶ç”µè·¯æŒ‰ç…§å¯»å€é€»è¾‘å°†é€»è¾‘åœ°å€ç¿»è¯‘æˆç‰©ç†åœ°å€ï¼Œå³ç¡®å®šè¦è¯»çš„æ•°æ®åœ¨å“ªä¸ªç£é“ï¼Œå“ªä¸ªæ‰‡åŒºã€‚ä¸ºäº†è¯»å–è¿™ä¸ªæ‰‡åŒºçš„æ•°æ®ï¼Œéœ€è¦å°†ç£å¤´æ”¾åˆ°è¿™ä¸ªæ‰‡åŒºä¸Šæ–¹ï¼Œä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œç£å¤´éœ€è¦ç§»åŠ¨å¯¹å‡†ç›¸åº”ç£é“ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšå¯»é“ï¼Œæ‰€è€—è´¹æ—¶é—´å«åšå¯»é“æ—¶é—´ï¼Œç„¶åç£ç›˜æ—‹è½¬å°†ç›®æ ‡æ‰‡åŒºæ—‹è½¬åˆ°ç£å¤´ä¸‹ï¼Œè¿™ä¸ªè¿‡ç¨‹è€—è´¹çš„æ—¶é—´å«åšæ—‹è½¬æ—¶é—´ã€‚</p><h2 id="å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»"><a href="#å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»" class="headerlink" title="å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»"></a>å±€éƒ¨æ€§åŸç†ä¸ç£ç›˜é¢„è¯»</h2><p>ç”±äºå­˜å‚¨ä»‹è´¨çš„ç‰¹æ€§ï¼Œç£ç›˜æœ¬èº«å­˜å–å°±æ¯”ä¸»å­˜æ…¢å¾ˆå¤šï¼Œå†åŠ ä¸Šæœºæ¢°è¿åŠ¨è€—è´¹ï¼Œç£ç›˜çš„å­˜å–é€Ÿåº¦å¾€å¾€æ˜¯ä¸»å­˜çš„å‡ ç™¾åˆ†åˆ†ä¹‹ä¸€ï¼Œå› æ­¤ä¸ºäº†æé«˜æ•ˆç‡ï¼Œè¦å°½é‡å‡å°‘ç£ç›˜I/Oã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œç£ç›˜å¾€å¾€ä¸æ˜¯ä¸¥æ ¼æŒ‰éœ€è¯»å–ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½ä¼šé¢„è¯»ï¼Œå³ä½¿åªéœ€è¦ä¸€ä¸ªå­—èŠ‚ï¼Œç£ç›˜ä¹Ÿä¼šä»è¿™ä¸ªä½ç½®å¼€å§‹ï¼Œé¡ºåºå‘åè¯»å–ä¸€å®šé•¿åº¦çš„æ•°æ®æ”¾å…¥å†…å­˜ã€‚</p><p>è¿™æ ·åšçš„ç†è®ºä¾æ®æ˜¯è®¡ç®—æœºç§‘å­¦ä¸­è‘—åçš„å±€éƒ¨æ€§åŸç†ï¼š</p><blockquote><p>å½“ä¸€ä¸ªæ•°æ®è¢«ç”¨åˆ°æ—¶ï¼Œå…¶é™„è¿‘çš„æ•°æ®ä¹Ÿé€šå¸¸ä¼šé©¬ä¸Šè¢«ä½¿ç”¨ã€‚</p></blockquote><p>ç¨‹åºè¿è¡ŒæœŸé—´æ‰€éœ€è¦çš„æ•°æ®é€šå¸¸æ¯”è¾ƒé›†ä¸­ã€‚</p><p>ç”±äºç£ç›˜é¡ºåºè¯»å–çš„æ•ˆç‡å¾ˆé«˜ï¼ˆä¸éœ€è¦å¯»é“æ—¶é—´ï¼Œåªéœ€å¾ˆå°‘çš„æ—‹è½¬æ—¶é—´ï¼‰ï¼Œå› æ­¤å¯¹äºå…·æœ‰å±€éƒ¨æ€§çš„ç¨‹åºæ¥è¯´ï¼Œé¢„è¯»å¯ä»¥æé«˜I/Oæ•ˆç‡ã€‚</p><p>é¢„è¯»çš„é•¿åº¦ä¸€èˆ¬ä¸ºé¡µï¼ˆpageï¼‰çš„æ•´å€æ•°ã€‚é¡µæ˜¯è®¡ç®—æœºç®¡ç†å­˜å‚¨å™¨çš„é€»è¾‘å—ï¼Œç¡¬ä»¶åŠæ“ä½œç³»ç»Ÿå¾€å¾€å°†ä¸»å­˜å’Œç£ç›˜å­˜å‚¨åŒºåˆ†å‰²ä¸ºè¿ç»­çš„å¤§å°ç›¸ç­‰çš„å—ï¼Œæ¯ä¸ªå­˜å‚¨å—ç§°ä¸ºä¸€é¡µï¼ˆåœ¨è®¸å¤šæ“ä½œç³»ç»Ÿä¸­ï¼Œé¡µå¾—å¤§å°é€šå¸¸ä¸º4kï¼‰ï¼Œä¸»å­˜å’Œç£ç›˜ä»¥é¡µä¸ºå•ä½äº¤æ¢æ•°æ®ã€‚å½“ç¨‹åºè¦è¯»å–çš„æ•°æ®ä¸åœ¨ä¸»å­˜ä¸­æ—¶ï¼Œä¼šè§¦å‘ä¸€ä¸ªç¼ºé¡µå¼‚å¸¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šå‘ç£ç›˜å‘å‡ºè¯»ç›˜ä¿¡å·ï¼Œç£ç›˜ä¼šæ‰¾åˆ°æ•°æ®çš„èµ·å§‹ä½ç½®å¹¶å‘åè¿ç»­è¯»å–ä¸€é¡µæˆ–å‡ é¡µè½½å…¥å†…å­˜ä¸­ï¼Œç„¶åå¼‚å¸¸è¿”å›ï¼Œç¨‹åºç»§ç»­è¿è¡Œã€‚</p><h1 id="B-Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ"><a href="#B-Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ" class="headerlink" title="B-/+Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ"></a>B-/+Treeç´¢å¼•çš„æ€§èƒ½åˆ†æ</h1><p>ä¸€èˆ¬ä½¿ç”¨ç£ç›˜I/Oæ¬¡æ•°è¯„ä»·ç´¢å¼•ç»“æ„çš„ä¼˜åŠ£ã€‚å…ˆä»B-Treeåˆ†æï¼Œæ ¹æ®B-Treeçš„å®šä¹‰ï¼Œå¯çŸ¥æ£€ç´¢ä¸€æ¬¡æœ€å¤šéœ€è¦è®¿é—®hä¸ªèŠ‚ç‚¹ã€‚æ•°æ®åº“ç³»ç»Ÿçš„è®¾è®¡è€…å·§å¦™åˆ©ç”¨äº†ç£ç›˜é¢„è¯»åŸç†ï¼Œå°†ä¸€ä¸ªèŠ‚ç‚¹çš„å¤§å°è®¾ä¸ºç­‰äºä¸€ä¸ªé¡µï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹åªéœ€è¦ä¸€æ¬¡I/Oå°±å¯ä»¥å®Œå…¨è½½å…¥ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œåœ¨å®é™…å®ç°B-Treeè¿˜éœ€è¦ä½¿ç”¨å¦‚ä¸‹æŠ€å·§ï¼š</p><p>æ¯æ¬¡æ–°å»ºèŠ‚ç‚¹æ—¶ï¼Œç›´æ¥ç”³è¯·ä¸€ä¸ªé¡µçš„ç©ºé—´ï¼Œè¿™æ ·å°±ä¿è¯ä¸€ä¸ªèŠ‚ç‚¹ç‰©ç†ä¸Šä¹Ÿå­˜å‚¨åœ¨ä¸€ä¸ªé¡µé‡Œï¼ŒåŠ ä¹‹è®¡ç®—æœºå­˜å‚¨åˆ†é…éƒ½æ˜¯æŒ‰é¡µå¯¹é½çš„ï¼Œå°±å®ç°äº†ä¸€ä¸ªnodeåªéœ€ä¸€æ¬¡I/Oã€‚</p><p>B-Treeä¸­ä¸€æ¬¡æ£€ç´¢æœ€å¤šéœ€è¦h-1æ¬¡I/Oï¼ˆæ ¹èŠ‚ç‚¹å¸¸é©»å†…å­˜ï¼‰ï¼Œæ¸è¿›å¤æ‚åº¦ä¸º$O(h)=O(\log_d N)$ã€‚ä¸€èˆ¬å®é™…åº”ç”¨ä¸­ï¼Œå‡ºåº¦dæ˜¯éå¸¸å¤§çš„æ•°å­—ï¼Œé€šå¸¸è¶…è¿‡100ï¼Œå› æ­¤héå¸¸å°ï¼ˆé€šå¸¸ä¸è¶…è¿‡3ï¼‰ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œç”¨B-Treeä½œä¸ºç´¢å¼•ç»“æ„æ•ˆç‡æ˜¯éå¸¸é«˜çš„ã€‚</p><p><strong>è€Œçº¢é»‘æ ‘è¿™ç§ç»“æ„ï¼Œhæ˜æ˜¾è¦æ·±çš„å¤šã€‚ç”±äºé€»è¾‘ä¸Šå¾ˆè¿‘çš„èŠ‚ç‚¹ï¼ˆçˆ¶å­ï¼‰ç‰©ç†ä¸Šå¯èƒ½å¾ˆè¿œï¼Œæ— æ³•åˆ©ç”¨å±€éƒ¨æ€§ï¼Œæ‰€ä»¥çº¢é»‘æ ‘çš„I/Oæ¸è¿›å¤æ‚åº¦ä¹Ÿä¸ºO(h)ï¼Œæ•ˆç‡æ˜æ˜¾æ¯”B-Treeå·®å¾ˆå¤šã€‚</strong></p><p>ä¸Šæ–‡è¿˜è¯´è¿‡ï¼ŒB+Treeæ›´é€‚åˆå¤–å­˜ç´¢å¼•ï¼ŒåŸå› å’Œå†…èŠ‚ç‚¹å‡ºåº¦dæœ‰å…³ã€‚ä»ä¸Šé¢åˆ†æå¯ä»¥çœ‹åˆ°ï¼Œdè¶Šå¤§ç´¢å¼•çš„æ€§èƒ½è¶Šå¥½ï¼Œè€Œå‡ºåº¦çš„ä¸Šé™å–å†³äºèŠ‚ç‚¹å†…keyå’Œdataçš„å¤§å°ï¼š</p><p>$$<br>d_{max}=floor({pagesize \over keysize+datasize+pointsize})<br>$$</p><p>floorè¡¨ç¤ºå‘ä¸‹å–æ•´ã€‚</p><p><strong>ç”±äºB+Treeå†…èŠ‚ç‚¹å»æ‰äº†dataåŸŸï¼Œå› æ­¤å¯ä»¥æ‹¥æœ‰æ›´å¤§çš„å‡ºåº¦ï¼Œå®¹çº³æ›´å¤šçš„èŠ‚ç‚¹ï¼Œèƒ½å¤Ÿæœ‰æ•ˆå‡å°‘ç£ç›˜IOæ¬¡æ•°</strong>ã€‚</p><p>ä¸€èˆ¬åœ¨æ•°æ®åº“ç³»ç»Ÿæˆ–æ–‡ä»¶ç³»ç»Ÿä¸­ä½¿ç”¨çš„B+Treeç»“æ„éƒ½åœ¨ç»å…¸B+Treeçš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¢åŠ äº†é¡ºåºè®¿é—®æŒ‡é’ˆã€‚</p><p><img src="https://images.morethink.cn/B+Tree.jpg" alt="" title="B+Tree"></p><p>å¦‚ä¸Šå›¾å›¾æ‰€ç¤ºï¼Œåœ¨B+Treeçš„æ¯ä¸ªå¶å­èŠ‚ç‚¹å¢åŠ ä¸€ä¸ªæŒ‡å‘ç›¸é‚»å¶å­èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå°±å½¢æˆäº†å¸¦æœ‰é¡ºåºè®¿é—®æŒ‡é’ˆçš„B+Treeã€‚åšè¿™ä¸ªä¼˜åŒ–çš„ç›®çš„æ˜¯ä¸ºäº†æé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ï¼Œä¾‹å¦‚å›¾4ä¸­å¦‚æœè¦æŸ¥è¯¢keyä¸ºä»18åˆ°49çš„æ‰€æœ‰æ•°æ®è®°å½•ï¼Œå½“æ‰¾åˆ°18åï¼Œ<strong>åªéœ€é¡ºç€èŠ‚ç‚¹å’ŒæŒ‡é’ˆé¡ºåºéå†å°±å¯ä»¥ä¸€æ¬¡æ€§è®¿é—®åˆ°æ‰€æœ‰æ•°æ®èŠ‚ç‚¹ï¼Œæå¤§æåˆ°äº†åŒºé—´æŸ¥è¯¢æ•ˆç‡</strong>ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼š<br>B+Treeåšç´¢å¼•çš„ä¼˜åŠ¿æ˜¯ï¼š</p><ol><li>å†…éƒ¨èŠ‚ç‚¹å–æ¶ˆdataåŸŸï¼Œæ¯ä¸€é¡µå¯ä»¥å®¹çº³æ›´å¤šçš„æ•°æ®ï¼Œæœ‰æ•ˆå‡å°‘ç£ç›˜IOæ¬¡æ•°ã€‚</li><li>æ•°æ®éƒ½å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚æ‰€ä»¥B+æ ‘æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸ºlog nï¼Œè€ŒBæ ‘æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸å›ºå®šï¼Œä¸æ‰€æŸ¥ç»“ç‚¹åœ¨æ ‘ä¸­çš„ä½ç½®æœ‰å…³ï¼Œæœ€å¥½ä¸ºO(1)ã€‚</li><li>é€šè¿‡å¢åŠ é¡ºåºè®¿é—®æŒ‡é’ˆæé«˜åŒºé—´æŸ¥è¯¢æ•ˆç‡ã€‚</li></ol><p>è€ŒMongoDBç´¢å¼•é€‰æ‹©Bæ ‘å¯èƒ½æ˜¯å› ä¸ºï¼š<br>MongoDB æ˜¯æ–‡æ¡£å‹çš„æ•°æ®åº“ï¼Œæ˜¯ä¸€ç§nosqlï¼Œå®ƒä½¿ç”¨BSONæ ¼å¼ä¿å­˜æ•°æ®ï¼Œå½’å±äºèšåˆå‹æ•°æ®åº“ã€‚è¢«è®¾è®¡ç”¨åœ¨æ•°æ®æ¨¡å‹ç®€å•ï¼Œæ€§èƒ½è¦æ±‚é«˜çš„åœºåˆã€‚ä¹‹æ‰€ä»¥é‡‡ç”¨Bæ ‘ï¼Œæ˜¯å› ä¸ºBæ ‘keyå’ŒdataåŸŸèšåˆåœ¨ä¸€èµ·ã€‚å› æ­¤å¹¶ä¸éœ€è¦ç±»ä¼¼äºåŒºé—´æŸ¥è¯¢çš„æ“ä½œã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html" target="_blank" rel="noopener">MySQLç´¢å¼•èƒŒåçš„æ•°æ®ç»“æ„åŠç®—æ³•åŸç†</a></li><li><a href="https://www.cnblogs.com/gaochundong/p/btree_and_bplustree.html#bplustree_implementation" target="_blank" rel="noopener">äººäººéƒ½æ˜¯ DBAï¼ˆVIIï¼‰B æ ‘å’Œ B+ æ ‘</a></li><li><a href="https://zhuanlan.zhihu.com/p/27700617" target="_blank" rel="noopener">å¹³è¡¡äºŒå‰æ ‘ã€B-Treeã€B+Treeã€B*æ ‘ ç†è§£å…¶ä¸­ä¸€ç§ä½ å°±éƒ½æ˜ç™½äº†</a></li><li><a href="https://zh.wikipedia.org/wiki/B%E6%A0%91" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/B%E6%A0%91</a></li><li>B-Tree gifï¼š<a href="https://www.cs.usfca.edu/~galles/visualization/BTree.html" target="_blank" rel="noopener">https://www.cs.usfca.edu/~galles/visualization/BTree.html</a></li><li><a href="https://www.jianshu.com/p/ed76dbc0536d" target="_blank" rel="noopener">6. æ•°æ®ç»“æ„ - B æ ‘</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
            <tag> ç´¢å¼• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>MACå®‰è£…RabbitMQ</title>
      <link href="/MAC%E5%AE%89%E8%A3%85RabbitMQ/"/>
      <url>/MAC%E5%AE%89%E8%A3%85RabbitMQ/</url>
      
        <content type="html"><![CDATA[<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install rabbitmq</span><br></pre></td></tr></table></figure><a id="more"></a><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><ol><li>æ·»åŠ ç¯å¢ƒå˜é‡<ul><li>æ‰“å¼€é…ç½®æ–‡ä»¶<code>$ vi ~/.bash_profile</code></li><li>æ·»åŠ  <code>export PATH=$PATH:/usr/local/sbin</code><br>åˆ°æœ«å°¾ï¼Œç¼–è¾‘å®Œå:wqä¿å­˜é€€å‡ºã€‚</li><li>ä½¿ç¯å¢ƒå˜é‡ç«‹å³ç”Ÿæ•ˆ <code>$ source ~/.bash_profile</code></li></ul></li><li>å¯åŠ¨RabbitMQæœåŠ¡<br>ä¸Šé¢é…ç½®å®Œæˆåï¼Œéœ€è¦å…³é—­ç»ˆç«¯çª—å£ï¼Œé‡æ–°æ‰“å¼€ï¼Œç„¶åè¾“å…¥ä¸‹é¢å‘½ä»¤å³å¯å¯åŠ¨RabbitMQæœåŠ¡ï¼š<code>rabbitmq-server</code></li><li>ç™»å½•Webç®¡ç†ç•Œé¢<br>æµè§ˆå™¨è¾“å…¥localhostï¼š15672ï¼Œè´¦å·å¯†ç å…¨è¾“å…¥guestå³å¯ç™»å½•ã€‚</li></ol><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸‹ï¼Œä»3.3.1ç‰ˆæœ¬å¼€å§‹ï¼ŒRabbitMQé»˜è®¤ä¸å…è®¸è¿œç¨‹ipç™»å½•ï¼Œå³åªèƒ½ä½¿ç”¨localhostç™»å½•ã€‚å¦‚æœå¸Œæœ›è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ·»åŠ ç”¨æˆ·æƒé™ã€‚</p><h1 id="è®¾ç½®RabbitMQè¿œç¨‹ipç™»å½•"><a href="#è®¾ç½®RabbitMQè¿œç¨‹ipç™»å½•" class="headerlink" title="è®¾ç½®RabbitMQè¿œç¨‹ipç™»å½•"></a>è®¾ç½®RabbitMQè¿œç¨‹ipç™»å½•</h1><p>ç”±äºè´¦å·guestå…·æœ‰æ‰€æœ‰çš„æ“ä½œæƒé™ï¼Œå¹¶ä¸”åˆæ˜¯é»˜è®¤è´¦å·ï¼Œå‡ºäºå®‰å…¨å› ç´ çš„è€ƒè™‘ï¼Œguestç”¨æˆ·åªèƒ½é€šè¿‡localhostç™»é™†ä½¿ç”¨ï¼Œå¹¶å»ºè®®ä¿®æ”¹guestç”¨æˆ·çš„å¯†ç ä»¥åŠæ–°å»ºå…¶ä»–è´¦å·ç®¡ç†ä½¿ç”¨rabbitmqã€‚<br>è¿™é‡Œæˆ‘ä»¬ä»¥åˆ›å»ºä¸ªtestå¸å·ï¼Œå¯†ç 123456ä¸ºä¾‹ï¼Œåˆ›å»ºä¸€ä¸ªè´¦å·å¹¶æ”¯æŒè¿œç¨‹ipè®¿é—®ã€‚</p><ul><li><p>åˆ›å»ºè´¦å·</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl add_user test 123456</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®ç”¨æˆ·è§’è‰²</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl  set_user_tags  test  administrator</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®ç”¨æˆ·æƒé™</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl set_permissions -p &quot;/&quot; test &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®å®Œæˆåå¯ä»¥æŸ¥çœ‹å½“å‰ç”¨æˆ·å’Œè§’è‰²(éœ€è¦å¼€å¯æœåŠ¡)</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl list_users</span><br></pre></td></tr></table></figure></li></ul><p>è¿™æ˜¯ä½ å°±å¯ä»¥é€šè¿‡å…¶ä»–ä¸»æœºçš„è®¿é—®RabbitMQçš„Webç®¡ç†ç•Œé¢äº†ï¼Œè®¿é—®æ–¹å¼ï¼Œæµè§ˆå™¨è¾“å…¥ï¼šserverip:15672ã€‚å…¶ä¸­serveripæ˜¯RabbitMQ-Serveræ‰€åœ¨ä¸»æœºçš„ipã€‚</p><h1 id="RabbitMQå¸¸ç”¨æ“ä½œ"><a href="#RabbitMQå¸¸ç”¨æ“ä½œ" class="headerlink" title="RabbitMQå¸¸ç”¨æ“ä½œ"></a>RabbitMQå¸¸ç”¨æ“ä½œ</h1><ol><li><p>ç”¨æˆ·ç®¡ç†<br>ç”¨æˆ·ç®¡ç†åŒ…æ‹¬å¢åŠ ç”¨æˆ·ï¼Œåˆ é™¤ç”¨æˆ·ï¼ŒæŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨ï¼Œä¿®æ”¹ç”¨æˆ·å¯†ç ã€‚</p><ul><li><p>æ–°å¢ä¸€ä¸ªç”¨æˆ·</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl  add_user  Username  Password</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ä¸€ä¸ªç”¨æˆ·</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl  delete_user  Username</span><br></pre></td></tr></table></figure></li><li><p>ä¿®æ”¹ç”¨æˆ·çš„å¯†ç </p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl  change_password  Username  Newpassword</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹å½“å‰ç”¨æˆ·åˆ—è¡¨</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rabbitmqctl  list_users</span><br></pre></td></tr></table></figure></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MQ </tag>
            
            <tag> MAC </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç§‘å­¦ä¸Šç½‘ä¹‹åœ¨VPSä¸Šå®‰è£…SSR</title>
      <link href="/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%B9%8B%E5%9C%A8VPS%E4%B8%8A%E5%AE%89%E8%A3%85SSR/"/>
      <url>/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E4%B9%8B%E5%9C%A8VPS%E4%B8%8A%E5%AE%89%E8%A3%85SSR/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å¯¹VPSå®‰è£…SSRçš„è¿‡ç¨‹è¿›è¡Œæ€»ç»“ï¼Œå…å¾—å› ä¸ºXXé‡æ–°å®‰è£…SSRæ—¶æ‰¾ä¸åˆ°å®‰è£…æ–¹æ³•ã€‚</p><h1 id="å®‰è£…SSR"><a href="#å®‰è£…SSR" class="headerlink" title="å®‰è£…SSR"></a>å®‰è£…SSR</h1><p>ç®€å•çš„æ¥è¯´ï¼Œå¦‚æœä½ ä»€ä¹ˆéƒ½ä¸æ‡‚ï¼Œé‚£ä¹ˆä½ ç›´æ¥ä¸€è·¯å›è½¦å°±å¯ä»¥äº†ï¼<br><a id="more"></a><br>æœ¬è„šæœ¬éœ€è¦Linux rootè´¦æˆ·æƒé™æ‰èƒ½æ­£å¸¸å®‰è£…è¿è¡Œï¼Œæ‰€ä»¥ <strong>å¦‚æœä¸æ˜¯ rootè´¦å·ï¼Œè¯·å…ˆåˆ‡æ¢ä¸ºrootï¼Œå¦‚æœæ˜¯ rootè´¦å·ï¼Œé‚£ä¹ˆè¯·è·³è¿‡</strong>ï¼</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p>è¾“å…¥ä¸Šé¢ä»£ç å›è½¦åä¼šæç¤ºä½ è¾“å…¥å½“å‰ç”¨æˆ·çš„å¯†ç ï¼Œè¾“å…¥å¹¶å›è½¦åï¼Œæ²¡æœ‰æŠ¥é”™å°±ç»§ç»­ä¸‹é¢çš„æ­¥éª¤å®‰è£…ShadowsocksRã€‚</p><p>v2.0.0 ç‰ˆæœ¬ä»¥åçš„è„šæœ¬ï¼Œè¯·å…ˆå¸è½½æ—§è„šæœ¬ShadowsocksRæœåŠ¡ç«¯ï¼Œå†é‡æ–°å®‰è£…ï¼</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate https://softs.fun/Bash/ssr.sh &amp;&amp; chmod +x ssr.sh &amp;&amp; bash ssr.sh</span><br></pre></td></tr></table></figure><p>å¤‡ç”¨ä¸‹è½½åœ°å€ï¼ˆä¸Šé¢çš„é“¾æ¥æ— æ³•ä¸‹è½½ï¼Œå°±ç”¨è¿™ä¸ªï¼‰ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssr.sh &amp;&amp; chmod +x ssr.sh &amp;&amp; bash ssr.sh</span><br></pre></td></tr></table></figure></p><p>ä¸‹è½½è¿è¡Œåä¼šæç¤ºä½ è¾“å…¥æ•°å­—æ¥é€‰æ‹©è¦åšä»€ä¹ˆã€‚</p><p>è¿è¡Œè„šæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash ssr.sh</span><br></pre></td></tr></table></figure><p>è¾“å…¥å¯¹åº”çš„æ•°å­—æ¥æ‰§è¡Œç›¸åº”çš„å‘½ä»¤ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">  è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—æ¥é€‰æ‹©èœå•é€‰é¡¹</span><br><span class="line"></span><br><span class="line"> 1. å®‰è£… ShadowsocksR</span><br><span class="line"> 2. æ›´æ–° ShadowsocksR</span><br><span class="line"> 3. å¸è½½ ShadowsocksR</span><br><span class="line"> 4. å®‰è£… libsodium(chacha20)</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line"> 5. æŸ¥çœ‹ è´¦å·ä¿¡æ¯</span><br><span class="line"> 6. æ˜¾ç¤º è¿æ¥ä¿¡æ¯</span><br><span class="line"> 7. è®¾ç½® ç”¨æˆ·é…ç½®</span><br><span class="line"> 8. æ‰‹åŠ¨ ä¿®æ”¹é…ç½®</span><br><span class="line"> 9. åˆ‡æ¢ ç«¯å£æ¨¡å¼</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line"> 10. å¯åŠ¨ ShadowsocksR</span><br><span class="line"> 11. åœæ­¢ ShadowsocksR</span><br><span class="line"> 12. é‡å¯ ShadowsocksR</span><br><span class="line"> 13. æŸ¥çœ‹ ShadowsocksR æ—¥å¿—</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line"> 14. å…¶ä»–åŠŸèƒ½</span><br><span class="line"> 15. å‡çº§è„šæœ¬</span><br><span class="line"></span><br><span class="line"> å½“å‰çŠ¶æ€: å·²å®‰è£… å¹¶ å·²å¯åŠ¨</span><br><span class="line"> å½“å‰æ¨¡å¼: å•ç«¯å£</span><br><span class="line"></span><br><span class="line">è¯·è¾“å…¥æ•°å­—(1-15)ï¼š</span><br></pre></td></tr></table></figure></p><h1 id="æ–‡ä»¶ä½ç½®"><a href="#æ–‡ä»¶ä½ç½®" class="headerlink" title="æ–‡ä»¶ä½ç½®"></a>æ–‡ä»¶ä½ç½®</h1><ul><li>å®‰è£…ç›®å½•ï¼š<code>/usr/local/shadowsocksr</code></li><li>é…ç½®æ–‡ä»¶ï¼š<code>/etc/shadowsocksr/user-config.json</code></li></ul><h1 id="è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡"><a href="#è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡" class="headerlink" title="è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡"></a>è®¾ç½®ä¸ºç³»ç»ŸæœåŠ¡</h1><p>ShadowsocksR å®‰è£…åï¼Œè‡ªåŠ¨è®¾ç½®ä¸º ç³»ç»ŸæœåŠ¡ï¼Œæ‰€ä»¥æ”¯æŒä½¿ç”¨æœåŠ¡æ¥å¯åŠ¨/åœæ­¢ç­‰æ“ä½œï¼ŒåŒæ—¶æ”¯æŒå¼€æœºå¯åŠ¨ã€‚</p><ul><li>å¯åŠ¨ ShadowsocksRï¼š<code>/etc/init.d/ssr start</code></li><li>åœæ­¢ ShadowsocksRï¼š<code>/etc/init.d/ssr stop</code></li><li>é‡å¯ ShadowsocksRï¼š<code>/etc/init.d/ssr restart</code></li><li>æŸ¥çœ‹ ShadowsocksRçŠ¶æ€ï¼š<code>/etc/init.d/ssr status</code></li></ul><p>ShadowsocksR é»˜è®¤æ”¯æŒUDPè½¬å‘ï¼ŒæœåŠ¡ç«¯æ— éœ€ä»»ä½•è®¾ç½®ã€‚</p><h1 id="å®šæ—¶é‡å¯"><a href="#å®šæ—¶é‡å¯" class="headerlink" title="å®šæ—¶é‡å¯"></a>å®šæ—¶é‡å¯</h1><p>ä¸€äº›äººå¯èƒ½éœ€è¦å®šæ—¶é‡å¯ShadowsocksRæœåŠ¡ç«¯æ¥ä¿è¯ç¨³å®šæ€§ç­‰ï¼Œæ‰€ä»¥è¿™é‡Œç”¨ crontab å®šæ—¶ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># è¾“å…¥è¿™ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰é…ç½®çš„å®šæ—¶ä»»åŠ¡</span><br><span class="line">crontab -l</span><br><span class="line"># å¦‚æœæç¤ºå‘½ä»¤ä¸å­˜åœ¨ï¼Œä¸‹é¢æ˜¯å®‰è£…å‘½ä»¤</span><br><span class="line"># CentOSç³»ç»Ÿï¼š</span><br><span class="line">yum update</span><br><span class="line">yum install -y crond</span><br><span class="line"># Debian/Ubuntuç³»ç»Ÿï¼š</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y cron</span><br></pre></td></tr></table></figure><p>å®‰è£… crontab åï¼Œæˆ‘ä»¬å°±èƒ½å¼€å§‹æ·»åŠ å®šæ—¶ä»»åŠ¡äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">crontab -l &gt; &quot;crontab.bak&quot;</span><br><span class="line">sed -i &quot;/ssr restart/d&quot; &quot;crontab.bak&quot;</span><br><span class="line">echo -e &quot;\n10 3 * * * /etc/init.d/ssr restart&quot; &gt;&gt; &quot;crontab.bak&quot;</span><br><span class="line">crontab &quot;crontab.bak&quot;</span><br><span class="line">rm -r &quot;crontab.bak&quot;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å®šæ—¶ä»»åŠ¡è§„åˆ™(ä»£ç å‰é¢çš„ <em> </em> <em> </em> * åˆ†åˆ«å¯¹åº”ï¼šåˆ†é’Ÿ å°æ—¶ æ—¥ æœˆ æ˜ŸæœŸ)å‚è€ƒï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">10 2 * * * /etc/init.d/ssr restart</span><br><span class="line"># è¿™ä¸ªä»£è¡¨ æ¯å¤©2ç‚¹10åˆ†é‡å¯ä¸€æ¬¡ ShadowsocksR</span><br><span class="line"></span><br><span class="line">10 2 */2 * * /etc/init.d/ssr restart</span><br><span class="line"># è¿™ä¸ªä»£è¡¨ æ¯éš”2å¤©çš„2ç‚¹10åˆ†é‡å¯ä¸€æ¬¡ ShadowsocksR</span><br><span class="line"></span><br><span class="line">10 */4 * * * /etc/init.d/ssr restart</span><br><span class="line"># è¿™ä¸ªä»£è¡¨ æ¯éš”4å°æ—¶çš„ç¬¬10åˆ†é‡å¯ä¸€æ¬¡ ShadowsocksR</span><br></pre></td></tr></table></figure><h1 id="BBRå’Œé”é€Ÿ"><a href="#BBRå’Œé”é€Ÿ" class="headerlink" title="BBRå’Œé”é€Ÿ"></a>BBRå’Œé”é€Ÿ</h1><p>BBRå’Œé”é€Ÿéƒ½æ˜¯ç”¨æ¥æé«˜ç¿»å¢™é€Ÿåº¦çš„ã€‚</p><p>BBRæ˜¯æ¥è‡ªäºGoogleçš„é»‘ç§‘æŠ€ï¼Œç›®çš„æ˜¯é€šè¿‡ä¼˜åŒ–å’Œæ§åˆ¶TCPçš„æ‹¥å¡ï¼Œå……åˆ†åˆ©ç”¨å¸¦å®½å¹¶é™ä½å»¶è¿Ÿï¼Œå…¶ç›®çš„å°±æ˜¯è¦å°½é‡è·‘æ»¡å¸¦å®½ï¼Œå¹¶ä¸”å°½é‡ä¸è¦æœ‰æ’é˜Ÿçš„æƒ…å†µã€‚<br>BBR è¿™ä¸ªç‰¹æ€§å…¶å®æ˜¯åœ¨ Linux å†…æ ¸ 4.9 æ‰è®¡åˆ’åŠ å…¥çš„ã€‚æ‰€ä»¥ï¼Œè¦å¼€å¯BBRï¼Œéœ€è¦å†…æ ¸ç‰ˆæœ¬åœ¨Linux kernel 4.9ä»¥ä¸Šï¼Œè„šæœ¬ä¼šå¸®åŠ©æˆ‘ä»¬å®‰è£…ã€‚</p><p>åœ¨BBRä¹‹å‰ï¼Œæ¯”è¾ƒæœ‰åçš„å°±æ˜¯å›½äº§çš„é”é€Ÿäº†ï¼Œä¸è¿‡ï¼Œç”±äºé”é€Ÿæ˜¯ä¸ªå›½äº§çš„é—­æºè½¯ä»¶ï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œå› æ­¤ <strong>æ¨èä½¿ç”¨å®‰è£…BBR</strong>ã€‚</p><ul><li><p>å¯åŠ¨è„šæœ¬ï¼š</p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bash ssr.sh</span><br></pre></td></tr></table></figure></li><li><p>é€‰æ‹©<code>14. å…¶ä»–åŠŸèƒ½</code></p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  1. é…ç½® BBR</span><br><span class="line">  2. é…ç½® é”é€Ÿ(ServerSpeeder)</span><br><span class="line">  3. é…ç½® LotServer(é”é€Ÿæ¯å…¬å¸)</span><br><span class="line">  æ³¨æ„ï¼š é”é€Ÿ/LotServer/BBR ä¸æ”¯æŒ OpenVZï¼</span><br><span class="line">  æ³¨æ„ï¼š é”é€Ÿ/LotServer/BBR ä¸èƒ½å…±å­˜ï¼</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br><span class="line">  4. ä¸€é”®å°ç¦ BT/PT/SPAM (iptables)</span><br><span class="line">  5. ä¸€é”®è§£å° BT/PT/SPAM (iptables)</span><br><span class="line">  6. åˆ‡æ¢ ShadowsocksRæ—¥å¿—è¾“å‡ºæ¨¡å¼</span><br><span class="line">  â€”â€”è¯´æ˜ï¼šSSRé»˜è®¤åªè¾“å‡ºé”™è¯¯æ—¥å¿—ï¼Œæ­¤é¡¹å¯åˆ‡æ¢ä¸ºè¾“å‡ºè¯¦ç»†çš„è®¿é—®æ—¥å¿—</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…BBRæˆ–è€…é”é€Ÿ(æ¨èBBR)</p></li></ul><h1 id="TCPä¼˜åŒ–"><a href="#TCPä¼˜åŒ–" class="headerlink" title="TCPä¼˜åŒ–"></a>TCPä¼˜åŒ–</h1><ul><li><p>å¢åŠ TCPè¿æ¥æ•°é‡</p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi /etc/security/limits.conf</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ ä¸¤è¡Œï¼š</p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* soft nofile 51200</span><br><span class="line">* hard nofile 51200</span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®ulimitï¼š</p>  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ulimit -n 51200</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ ä¸€äº›ä¼˜åŒ–å†…å®¹</p><ul><li><p>ä¿®æ”¹sysctl.conf</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vi  /etc/sysctl.conf</span><br></pre></td></tr></table></figure></li><li><p>æ’å…¥ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#TCPé…ç½®ä¼˜åŒ–(ä¸ç„¶ä½ è‡ªå·±æ ¹æœ¬ä¸çŸ¥é“ä½ åœ¨å¹²ä»€ä¹ˆ)</span><br><span class="line">fs.file-max = 51200</span><br><span class="line">#æé«˜æ•´ä¸ªç³»ç»Ÿçš„æ–‡ä»¶é™åˆ¶</span><br><span class="line">net.core.rmem_max = 67108864</span><br><span class="line">net.core.wmem_max = 67108864</span><br><span class="line">net.core.netdev_max_backlog = 250000</span><br><span class="line">net.core.somaxconn = 4096</span><br><span class="line">net.ipv4.tcp_syncookies = 1</span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line">net.ipv4.tcp_tw_recycle = 0</span><br><span class="line">net.ipv4.tcp_fin_timeout = 30</span><br><span class="line">net.ipv4.tcp_keepalive_time = 1200</span><br><span class="line">net.ipv4.ip_local_port_range = 10000 65000</span><br><span class="line">net.ipv4.tcp_max_syn_backlog = 8192</span><br><span class="line">net.ipv4.tcp_max_tw_buckets = 5000</span><br><span class="line">net.ipv4.tcp_fastopen = 3</span><br><span class="line">net.ipv4.tcp_mem = 25600 51200 102400</span><br><span class="line">net.ipv4.tcp_rmem = 4096 87380 67108864</span><br><span class="line">net.ipv4.tcp_wmem = 4096 65536 67108864</span><br><span class="line">net.ipv4.tcp_mtu_probing = 1</span><br><span class="line">net.ipv4.tcp_congestion_control = bbr</span><br><span class="line">#END OF LINE</span><br></pre></td></tr></table></figure></li><li><p>åº”ç”¨</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯SSR</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/etc/init.d/ssr restart</span><br></pre></td></tr></table></figure></li></ul></li></ul><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://jasper-1024.github.io/2016/06/26/VPS%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E6%95%99%E7%A8%8B%E7%B3%BB%E5%88%97/" target="_blank" rel="noopener">ç§‘å­¦ä¸Šç½‘æ•™ç¨‹ï¼ˆä¸€ï¼‰â€”â€”VPSä¸Šæ­å»ºSSR</a></li><li><a href="https://doub.io/ss-jc42" target="_blank" rel="noopener">ã€åŸåˆ›ã€CentOS/Debian/Ubuntu ShadowsocksR å•/å¤šç«¯å£ ä¸€é”®ç®¡ç†è„šæœ¬</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>ç»™ä½ çš„åšå®¢å›­å›¾ç‰‡æ·»åŠ æ ‡é¢˜</title>
      <link href="/%E7%BB%99%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%9B%AD%E5%9B%BE%E7%89%87%E6%B7%BB%E5%8A%A0%E6%A0%87%E9%A2%98/"/>
      <url>/%E7%BB%99%E4%BD%A0%E7%9A%84%E5%8D%9A%E5%AE%A2%E5%9B%AD%E5%9B%BE%E7%89%87%E6%B7%BB%E5%8A%A0%E6%A0%87%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ä¸€ç›´ä»¥æ¥éƒ½è§‰å¾—åœ¨å›¾ç‰‡ä¸‹é¢æ·»åŠ ä¸€ä¸ªæ ‡é¢˜å¯ä»¥æ›´åŠ æ¸…æ™°çš„è¡¨ç¤ºè¿™å¼ å›¾ç‰‡çš„å«ä¹‰ï¼Œå¯æ˜¯åšå®¢å›­åŸç”Ÿå¹¶ä¸æ”¯æŒè¿™ç§æ¸²æŸ“æ–¹å¼ï¼Œå†åŠ ä¸Šåšå®¢å›­å¯ä»¥è‡ªå·±å†™jsæ¥æ›´æ”¹ä¸»é¢˜ï¼Œäºæ˜¯é€šè¿‡æœç´¢èµ„æ–™å®Œæˆç»™åšå®¢å›­å›¾ç‰‡æ·»åŠ æ ‡é¢˜çš„åŠŸèƒ½ã€‚</p><a id="more"></a><p>å½“æˆ‘ä»¬å¦‚ä¸‹ä¹¦å†™markdownæ—¶ï¼š<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](https://images.morethink.cn/092017231747399.jpg "TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹")</span><br></pre></td></tr></table></figure></p><p>ä¼šè¢«åšå®¢å›­æ¸²æŸ“æˆ<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"https://images.morethink.cn/092017231747399.jpg"</span> <span class="attr">title</span>=<span class="string">"TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>äºæ˜¯æˆ‘å°±æƒ³é€šè¿‡åœ¨imgæ ‡ç­¾åé¢åŠ¨æ€æ·»åŠ ä¸€ä¸ªå¸¦æœ‰<code>title</code>çš„pæ ‡ç­¾æ¥ç»™åšå®¢å›­å›¾ç‰‡æ·»åŠ æ ‡é¢˜ã€‚</p><p>å°†ä¸‹é¢ä»£ç æ”¾å…¥<code>é¡µé¦–Htmlä»£ç </code>ä»£ç ä¸­å³å¯(éœ€è¦ç”³è¯·jsæƒé™)ã€‚</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¼•å…¥jQuery --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    $(<span class="built_in">window</span>).load(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">//ç»™æ¯å¼ å›¾ç‰‡æ·»åŠ æ ‡é¢˜,div.cnblogs_post_bodyæ˜¯åšå®¢ä¸»ä½“</span></span></span><br><span class="line"><span class="javascript">        $(<span class="string">"div[id=cnblogs_post_body] img"</span>).each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> title = $(<span class="keyword">this</span>).attr(<span class="string">"title"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (title != <span class="literal">undefined</span>) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> boardp_style = <span class="string">"style='display: block; text-align: center; color: #969696;padding: 10px;border-bottom: 1px solid #d9d9d9;margin: 0 auto;"</span> +</span></span><br><span class="line"><span class="javascript">                    <span class="string">"width: "</span> + ($(<span class="keyword">this</span>).width() * <span class="number">0.8</span>) + <span class="string">"px;"</span> +</span></span><br><span class="line"><span class="javascript">                    <span class="string">"height: 28px;"</span> +</span></span><br><span class="line"><span class="javascript">                    <span class="string">"'&gt;"</span>;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> boardp = <span class="string">"&lt;p "</span> + boardp_style + title + <span class="string">"&lt;/p"</span>;</span></span><br><span class="line"><span class="javascript">                $(<span class="keyword">this</span>).after(boardp);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- å°†imgå˜ä¸ºå—çº§å…ƒç´  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    img &#123;</span></span><br><span class="line"><span class="undefined">        margin: 0 auto;</span></span><br><span class="line"><span class="undefined">        display: block;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>markdownå›¾ç‰‡ï¼š<br><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">![](https://images.morethink.cn/092017231747399.jpg "TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹")</span><br></pre></td></tr></table></figure></p><p><img src="https://images.morethink.cn/092017231747399.jpg" alt="" title="TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"></p>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Cronè¡¨è¾¾å¼</title>
      <link href="/Cron%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
      <url>/Cron%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p><strong>Cronè¡¨è¾¾å¼èŒƒä¾‹ï¼š</strong></p><ul><li><code>*/5 * * * * ?</code>  ï¼šæ¯éš”5<code>ç§’</code>æ‰§è¡Œä¸€æ¬¡</li><li><code>0 */1 * * * ?</code>  ï¼šæ¯éš”1åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</li><li><code>0 0 23 * * ?</code>   ï¼šæ¯å¤©23ç‚¹æ‰§è¡Œä¸€æ¬¡</li><li><code>0 0 1 * * ?</code>    ï¼šæ¯å¤©å‡Œæ™¨1ç‚¹æ‰§è¡Œä¸€æ¬¡ï¼š</li><li><code>0 0 1 1 * ?</code>  ï¼šæ¯æœˆ1å·å‡Œæ™¨1ç‚¹æ‰§è¡Œä¸€æ¬¡</li><li><code>0 0 23 L * ?</code> ï¼š æ¯æœˆæœ€åä¸€å¤©23ç‚¹æ‰§è¡Œä¸€æ¬¡</li><li><code>0 0 1 ? * L</code>  ï¼šæ¯å‘¨æ˜ŸæœŸå¤©å‡Œæ™¨1ç‚¹å®è¡Œä¸€æ¬¡</li><li><code>0 26,29,33 * * * ?</code> ï¼š åœ¨26åˆ†ã€29åˆ†ã€33åˆ†æ‰§è¡Œä¸€æ¬¡</li><li><code>0 0 0,13,18,21 * * ?</code> ï¼š æ¯å¤©çš„0ç‚¹ã€13ç‚¹ã€18ç‚¹ã€21ç‚¹éƒ½æ‰§è¡Œä¸€æ¬¡<a id="more"></a><h1 id="Cronè¡¨è¾¾å¼"><a href="#Cronè¡¨è¾¾å¼" class="headerlink" title="Cronè¡¨è¾¾å¼"></a>Cronè¡¨è¾¾å¼</h1></li></ul><p>Cronè¡¨è¾¾å¼ç”±7ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå„éƒ¨åˆ†ç”¨ç©ºæ ¼éš”å¼€ï¼ŒCronè¡¨è¾¾å¼çš„7ä¸ªéƒ¨åˆ†ä»å·¦åˆ°å³ä»£è¡¨çš„å«ä¹‰å¦‚ä¸‹ï¼š</p><p><code>ç§’</code> <code>åˆ†</code> <code>æ—¶</code> <code>æ—¥</code> <code>æœˆ</code> <code>å‘¨</code> <code>å¹´</code><br>å…¶ä¸­ <code>å¹´</code>æ˜¯å¯é€‰çš„ã€‚</p><table><thead><tr><th>å­—æ®µå</th><th>å…è®¸çš„å€¼</th><th>å…è®¸çš„ç‰¹æ®Šå­—ç¬¦</th></tr></thead><tbody><tr><td><code>ç§’</code></td><td>0-59</td><td>,- * /</td><td></td></tr><tr><td><code>åˆ†</code></td><td>0-59</td><td>,- * /</td><td></td></tr><tr><td><code>æ—¶</code></td><td>0-23</td><td>,- * /</td><td></td></tr><tr><td><code>æ—¥</code></td><td>1-31</td><td>,- * ? / L W C</td><td></td></tr><tr><td><code>æœˆ</code></td><td>1-12 or JAN-DEC</td><td>,- * /</td><td></td></tr><tr><td><code>å‘¨</code></td><td>1-7 or SUN-SAT</td><td>,- * ? / L C #</td><td></td></tr><tr><td><code>å¹´</code> (å¯é€‰å­—æ®µ)</td><td>emptyï¼Œ1970-2099</td><td>,- * /</td></tr></tbody></table><h1 id="ç¬¦å·è¯´æ˜"><a href="#ç¬¦å·è¯´æ˜" class="headerlink" title="ç¬¦å·è¯´æ˜"></a>ç¬¦å·è¯´æ˜</h1><ul><li><code>,</code>ï¼šè¡¨ç¤ºåˆ—å‡ºæšä¸¾å€¼å€¼ã€‚ä¾‹å¦‚åœ¨<code>åˆ†</code>ä½¿ç”¨5,20ï¼Œåˆ™æ„å‘³ç€åœ¨5å’Œ20åˆ†æ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚</li><li><code>-</code>ï¼šè¡¨ç¤ºèŒƒå›´ã€‚ä¾‹å¦‚åœ¨<code>åˆ†</code>ä½¿ç”¨5-20ï¼Œè¡¨ç¤ºä»5åˆ†åˆ°20åˆ†é’Ÿæ¯åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ã€‚</li><li><code>*</code> ï¼šè¡¨ç¤ºåŒ¹é…è¯¥åŸŸçš„ä»»æ„å€¼ã€‚å‡å¦‚åœ¨<code>åˆ†</code>åŸŸä½¿ç”¨<code>*</code>ï¼Œå³è¡¨ç¤ºæ¯åˆ†é’Ÿéƒ½ä¼šè§¦å‘äº‹ä»¶ã€‚</li><li><code>/</code> ï¼šè¡¨ç¤ºèµ·å§‹æ—¶é—´å¼€å§‹è§¦å‘ï¼Œç„¶åæ¯éš”å›ºå®šæ—¶é—´è§¦å‘ä¸€æ¬¡ï¼Œä¾‹å¦‚åœ¨MinutesåŸŸä½¿ç”¨5/20,åˆ™æ„å‘³ç€5åˆ†é’Ÿè§¦å‘ä¸€æ¬¡ï¼Œè€Œ25ï¼Œ45ç­‰åˆ†åˆ«è§¦å‘ä¸€æ¬¡ã€‚</li><li><code>?</code> ï¼šåªèƒ½ç”¨åœ¨<code>å‘¨</code>å’Œ<code>æ—¥</code>ã€‚å®ƒä¹ŸåŒ¹é…åŸŸçš„ä»»æ„å€¼ï¼Œä½†å®é™…ä¸ä¼šã€‚å› ä¸º<code>å‘¨</code>å’Œ<code>æ—¥</code>ä¼šç›¸äº’å½±å“ã€‚ä¾‹å¦‚æƒ³åœ¨æ¯æœˆçš„20æ—¥è§¦å‘è°ƒåº¦ï¼Œä¸ç®¡20æ—¥åˆ°åº•æ˜¯æ˜ŸæœŸå‡ ï¼Œåˆ™åªèƒ½ä½¿ç”¨å¦‚ä¸‹å†™æ³•ï¼š 13 13 15 20 <em> ?,å…¶ä¸­æœ€åä¸€ä½åªèƒ½ç”¨ï¼Ÿï¼Œè€Œä¸èƒ½ä½¿ç”¨</em>ï¼Œå¦‚æœä½¿ç”¨*è¡¨ç¤ºä¸ç®¡æ˜ŸæœŸå‡ éƒ½ä¼šè§¦å‘ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯è¿™æ ·ã€‚    </li><li><code>L</code> ï¼š è¡¨ç¤ºæœ€åï¼Œåªèƒ½å‡ºç°åœ¨<code>æ—¥</code>å’Œ<code>å‘¨</code>ï¼Œå¦‚æœåœ¨<code>æ—¥</code>ä½¿ç”¨5L,æ„å‘³ç€åœ¨æœ€åçš„ä¸€ä¸ªæ˜ŸæœŸå››è§¦å‘ã€‚  </li><li><code>W</code>ï¼šè¡¨ç¤ºæœ‰æ•ˆå·¥ä½œæ—¥(å‘¨ä¸€åˆ°å‘¨äº”),åªèƒ½å‡ºç°åœ¨<code>å‘¨</code>åŸŸï¼Œç³»ç»Ÿå°†åœ¨ç¦»æŒ‡å®šæ—¥æœŸçš„æœ€è¿‘çš„æœ‰æ•ˆå·¥ä½œæ—¥è§¦å‘äº‹ä»¶ã€‚ä¾‹å¦‚ï¼šåœ¨<code>æ—¥</code>ä½¿ç”¨5Wï¼Œå¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå…­ï¼Œåˆ™å°†åœ¨æœ€è¿‘çš„å·¥ä½œæ—¥ï¼šæ˜ŸæœŸäº”ï¼Œå³4æ—¥è§¦å‘ã€‚å¦‚æœ5æ—¥æ˜¯æ˜ŸæœŸå¤©ï¼Œåˆ™åœ¨6æ—¥è§¦å‘ï¼›å¦‚æœ5æ—¥åœ¨æ˜ŸæœŸä¸€åˆ°æ˜ŸæœŸäº”ä¸­çš„ä¸€å¤©ï¼Œåˆ™å°±åœ¨5æ—¥è§¦å‘ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒWçš„æœ€è¿‘å¯»æ‰¾ä¸ä¼šè·¨è¿‡æœˆä»½ã€‚</li><li><code>#</code>ï¼šç”¨äºç¡®å®šæ¯ä¸ªæœˆç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ ï¼Œåªèƒ½å‡ºç°åœ¨<code>å‘¨</code>ã€‚ä¾‹å¦‚åœ¨4#2ï¼Œè¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸä¸‰ã€‚</li></ul><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://Cron.qqe2.com/" target="_blank" rel="noopener">åœ¨çº¿Cronè¡¨è¾¾å¼ç”Ÿæˆå™¨</a></li><li><a href="https://www.jianshu.com/p/f03b1497122a" target="_blank" rel="noopener">QuartZ Cronè¡¨è¾¾å¼è¯¦è§£</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>GitHubæ›´æ–°å·²ç»forkçš„é¡¹ç›®</title>
      <link href="/GitHub%E6%9B%B4%E6%96%B0%E5%B7%B2%E7%BB%8Ffork%E7%9A%84%E9%A1%B9%E7%9B%AE/"/>
      <url>/GitHub%E6%9B%B4%E6%96%B0%E5%B7%B2%E7%BB%8Ffork%E7%9A%84%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>å½“æˆ‘ä»¬forkä¸€ä¸ªé¡¹ç›®åï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨ä»£ç çš„æ—¶å€™å°±ä¼šä»¥æˆ‘ä»¬æœ¬åœ°ä¸ºå‡†ï¼Œä¸ä¼šè·Ÿéšæˆ‘ä»¬forkå‰çš„é¡¹ç›®ï¼Œå¦‚æœéœ€è¦åŒæ­¥å¯¹æ–¹çš„ä»£ç ï¼Œéœ€è¦è¿›è¡ŒåŒæ­¥æ“ä½œã€‚</p><a id="more"></a><ol><li>clone è‡ªå·±çš„ fork åˆ†æ”¯åˆ°æœ¬åœ°<br>å¯ä»¥ç›´æ¥ä½¿ç”¨ GitHub å®¢æˆ·ç«¯ï¼Œclone åˆ°æœ¬åœ°ï¼Œå¦‚æœä½¿ç”¨å‘½ä»¤è¡Œï¼Œå‘½ä»¤ä¸ºï¼š<br><code>$ git clone  git@github.com:morethink/git-recipes.git</code></li><li><p>è¿›å…¥ä»“åº“ï¼Œå¢åŠ æºåˆ†æ”¯åœ°å€åˆ°ä½ é¡¹ç›®è¿œç¨‹åˆ†æ”¯åˆ—è¡¨ä¸­<br>æ­¤å¤„æ˜¯å…³é”®ï¼Œå…ˆå¾—å°†åŸæ¥çš„ä»“åº“æŒ‡å®šä¸º upstreamï¼Œå‘½ä»¤ä¸ºï¼š<br><code>$ git remote add upstream git@github.com:geeeeeeeeek/git-recipes.git</code><br>æ­¤å¤„å¯ä½¿ç”¨ <code>git remote -v</code> æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯åˆ—è¡¨</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git remote -v</span><br><span class="line">origingit@github.com:morethink/git-recipes.git (fetch)</span><br><span class="line">origingit@github.com:morethink/git-recipes.git (push)</span><br><span class="line">upstreamgit@github.com:geeeeeeeeek/git-recipes.git (fetch)</span><br><span class="line">upstreamgit@github.com:geeeeeeeeek/git-recipes.git (push)</span><br></pre></td></tr></table></figure></li><li><p>fetch æºåˆ†æ”¯çš„æ–°ç‰ˆæœ¬åˆ°æœ¬åœ°<br><code>$ git fetch upstream</code></p></li><li>åˆ‡æ¢åˆ°æœ¬åœ°masteråˆ†æ”¯<br><code>$ git checkout master</code></li><li>åˆå¹¶ä¸¤ä¸ªç‰ˆæœ¬çš„ä»£ç <br><code>$ git merge upstream/master</code></li><li>å°†åˆå¹¶åçš„ä»£ç  push åˆ° GitHub ä¸Šå»<br><code>$ git push origin master</code></li></ol><p><strong>å‚è€ƒæ–‡æ¡£ï¼š</strong></p><ol><li>æ·»åŠ è¿œç¨‹åˆ†æ”¯<br><a href="https://help.github.com/articles/configuring-a-remote-for-a-fork/" target="_blank" rel="noopener">https://help.github.com/articles/configuring-a-remote-for-a-fork/</a></li><li>å®ŒæˆåŒæ­¥<br><a href="https://help.github.com/articles/syncing-a-fork/" target="_blank" rel="noopener">https://help.github.com/articles/syncing-a-fork/</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¸¸è§webæ”»å‡»æ€»ç»“</title>
      <link href="/%E5%B8%B8%E8%A7%81web%E6%94%BB%E5%87%BB%E6%80%BB%E7%BB%93/"/>
      <url>/%E5%B8%B8%E8%A7%81web%E6%94%BB%E5%87%BB%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>æWebå¼€å‘ç¦»ä¸å¼€å®‰å…¨è¿™ä¸ªè¯é¢˜ï¼Œç¡®ä¿ç½‘ç«™æˆ–è€…ç½‘é¡µåº”ç”¨çš„å®‰å…¨æ€§ï¼Œæ˜¯æ¯ä¸ªå¼€å‘äººå‘˜éƒ½åº”è¯¥äº†è§£çš„äº‹ã€‚æœ¬ç¯‡ä¸»è¦ç®€å•ä»‹ç»åœ¨Webé¢†åŸŸå‡ ç§å¸¸è§çš„æ”»å‡»æ‰‹æ®µåŠJava Webä¸­çš„é¢„é˜²æ–¹å¼ã€‚</p><ul><li><a href="#XSS">XSS</a></li><li><a href="#SQLæ³¨å…¥">SQLæ³¨å…¥</a></li><li><a href="#DDOS">DDOS</a></li><li><a href="#CSRF">CSRF</a></li></ul><a id="more"></a><p>é¡¹ç›®åœ°å€ï¼š <a href="https://github.com/morethink/web-security" target="_blank" rel="noopener">https://github.com/morethink/web-security</a></p><h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><h2 id="ä»€ä¹ˆæ˜¯XSS"><a href="#ä»€ä¹ˆæ˜¯XSS" class="headerlink" title="ä»€ä¹ˆæ˜¯XSS"></a>ä»€ä¹ˆæ˜¯XSS</h2><p>XSSæ”»å‡»ï¼šè·¨ç«™è„šæœ¬æ”»å‡»(Cross-Site Scripting)ï¼Œä¸ºäº†ä¸å’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets, CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSã€‚XSSæ˜¯ä¸€ç§å¸¸è§çš„webå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ”»å‡»è€…å°†æ¶æ„ä»£ç æ¤å…¥åˆ°æä¾›ç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨çš„é¡µé¢ä¸­ã€‚ä¸åŒäºå¤§å¤šæ•°æ”»å‡»(ä¸€èˆ¬åªæ¶‰åŠæ”»å‡»è€…å’Œå—å®³è€…)ï¼ŒXSSæ¶‰åŠåˆ°ä¸‰æ–¹ï¼Œå³æ”»å‡»è€…ã€å®¢æˆ·ç«¯ä¸Webåº”ç”¨ã€‚XSSçš„æ”»å‡»ç›®æ ‡æ˜¯ä¸ºäº†ç›—å–å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„cookieæˆ–è€…å…¶ä»–ç½‘ç«™ç”¨äºè¯†åˆ«å®¢æˆ·ç«¯èº«ä»½çš„æ•æ„Ÿä¿¡æ¯ã€‚ä¸€æ—¦è·å–åˆ°åˆæ³•ç”¨æˆ·çš„ä¿¡æ¯åï¼Œæ”»å‡»è€…ç”šè‡³å¯ä»¥å‡å†’åˆæ³•ç”¨æˆ·ä¸ç½‘ç«™è¿›è¡Œäº¤äº’ã€‚</p><p>XSSé€šå¸¸å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><ol><li>å­˜å‚¨å‹XSSï¼Œä¸»è¦å‡ºç°åœ¨è®©ç”¨æˆ·è¾“å…¥æ•°æ®ï¼Œä¾›å…¶ä»–æµè§ˆæ­¤é¡µçš„ç”¨æˆ·è¿›è¡ŒæŸ¥çœ‹çš„åœ°æ–¹ï¼ŒåŒ…æ‹¬ç•™è¨€ã€è¯„è®ºã€åšå®¢æ—¥å¿—å’Œå„ç±»è¡¨å•ç­‰ã€‚åº”ç”¨ç¨‹åºä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®ï¼Œåœ¨é¡µé¢ä¸­æ˜¾ç¤ºå‡ºæ¥ï¼Œæ”»å‡»è€…åœ¨ç›¸å…³é¡µé¢è¾“å…¥æ¶æ„çš„è„šæœ¬æ•°æ®åï¼Œç”¨æˆ·æµè§ˆæ­¤ç±»é¡µé¢æ—¶å°±å¯èƒ½å—åˆ°æ”»å‡»ã€‚è¿™ä¸ªæµç¨‹ç®€å•å¯ä»¥æè¿°ä¸ºï¼š<code>æ¶æ„ç”¨æˆ·çš„Htmlè¾“å…¥Webç¨‹åº-&gt;è¿›å…¥æ•°æ®åº“-&gt;Webç¨‹åº-&gt;ç”¨æˆ·æµè§ˆå™¨</code>ã€‚</li><li>åå°„å‹XSSï¼Œä¸»è¦åšæ³•æ˜¯å°†è„šæœ¬ä»£ç åŠ å…¥URLåœ°å€çš„è¯·æ±‚å‚æ•°é‡Œï¼Œè¯·æ±‚å‚æ•°è¿›å…¥ç¨‹åºååœ¨é¡µé¢ç›´æ¥è¾“å‡ºï¼Œç”¨æˆ·ç‚¹å‡»ç±»ä¼¼çš„æ¶æ„é“¾æ¥å°±å¯èƒ½å—åˆ°æ”»å‡»ã€‚</li></ol><p>æ¯”å¦‚è¯´æˆ‘å†™äº†ä¸€ä¸ªç½‘ç«™ï¼Œç„¶åæ”»å‡»è€…åœ¨ä¸Šé¢å‘å¸ƒäº†ä¸€ä¸ªæ–‡ç« ï¼Œå†…å®¹æ˜¯è¿™æ ·çš„ <code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>,å¦‚æœæˆ‘æ²¡æœ‰å¯¹ä»–çš„å†…å®¹è¿›è¡Œå¤„ç†ï¼Œç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡å½“å…¶ä»–ç”¨æˆ·è®¿é—®ä»–çš„è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ä»æ•°æ®åº“è¯»å–åç„¶åå“åº”ç»™å®¢æˆ·ç«¯ï¼Œæµè§ˆå™¨æ‰§è¡Œäº†è¿™æ®µè„šæœ¬ï¼Œå°±ä¼šå°†cookieå±•ç°å‡ºæ¥ï¼Œè¿™å°±æ˜¯å…¸å‹çš„å­˜å‚¨å‹XSSã€‚</p><p>å¦‚å›¾ï¼š<br><img src="https://images.morethink.cn/a1c6ebf6de227e086d0289f34d8c5f76.png" alt=""></p><h2 id="å¦‚ä½•é¢„é˜²XSS"><a href="#å¦‚ä½•é¢„é˜²XSS" class="headerlink" title="å¦‚ä½•é¢„é˜²XSS"></a>å¦‚ä½•é¢„é˜²XSS</h2><p>ç­”æ¡ˆå¾ˆç®€å•ï¼Œåšå†³ä¸è¦ç›¸ä¿¡ç”¨æˆ·çš„ä»»ä½•è¾“å…¥ï¼Œå¹¶è¿‡æ»¤æ‰è¾“å…¥ä¸­çš„æ‰€æœ‰ç‰¹æ®Šå­—ç¬¦ã€‚è¿™æ ·å°±èƒ½æ¶ˆç­ç»å¤§éƒ¨åˆ†çš„XSSæ”»å‡»ã€‚</p><p>ç›®å‰é˜²å¾¡XSSä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼ï¼š</p><ol><li>è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦<br>é¿å…XSSçš„æ–¹æ³•ä¹‹ä¸€ä¸»è¦æ˜¯å°†ç”¨æˆ·æ‰€æä¾›çš„å†…å®¹è¿›è¡Œè¿‡æ»¤(å¦‚ä¸Šé¢çš„<code>script</code>æ ‡ç­¾)ã€‚</li><li>ä½¿ç”¨HTTPå¤´æŒ‡å®šç±»å‹<br><code>w.Header().Set(&quot;Content-Type&quot;,&quot;text/javascript&quot;)</code><br>è¿™æ ·å°±å¯ä»¥è®©æµè§ˆå™¨è§£æjavascriptä»£ç ï¼Œè€Œä¸ä¼šæ˜¯htmlè¾“å‡ºã€‚</li></ol><h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><h2 id="ä»€ä¹ˆæ˜¯SQLæ³¨å…¥"><a href="#ä»€ä¹ˆæ˜¯SQLæ³¨å…¥" class="headerlink" title="ä»€ä¹ˆæ˜¯SQLæ³¨å…¥"></a>ä»€ä¹ˆæ˜¯SQLæ³¨å…¥</h2><p>æ”»å‡»è€…æˆåŠŸçš„å‘æœåŠ¡å™¨æäº¤æ¶æ„çš„SQLæŸ¥è¯¢ä»£ç ï¼Œç¨‹åºåœ¨æ¥æ”¶åé”™è¯¯çš„å°†æ”»å‡»è€…çš„è¾“å…¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ä¸€éƒ¨åˆ†æ‰§è¡Œï¼Œå¯¼è‡´åŸå§‹çš„æŸ¥è¯¢é€»è¾‘è¢«æ”¹å˜ï¼Œé¢å¤–çš„æ‰§è¡Œäº†æ”»å‡»è€…ç²¾å¿ƒæ„é€ çš„æ¶æ„ä»£ç ã€‚</p><p>ä¸¾ä¾‹ï¼š<code>&#39; OR &#39;1&#39;=&#39;1</code></p><p>è¿™æ˜¯æœ€å¸¸è§çš„ SQLæ³¨å…¥æ”»å‡»ï¼Œå½“æˆ‘ä»¬è¾“å¦‚ç”¨æˆ·å admin ï¼Œç„¶åå¯†ç è¾“å¦‚<code>&#39; OR &#39;1&#39;=1=&#39;1</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®çš„æ—¶å€™ï¼Œæœ¬æ¥è¦æ‰§è¡Œçš„æ˜¯<code>SELECT * FROM user WHERE username=&#39;&#39; and password=&#39;&#39;</code>,ç»è¿‡å‚æ•°æ‹¼æ¥åï¼Œä¼šæ‰§è¡Œ SQLè¯­å¥ <code>SELECT * FROM user WHERE username=&#39;&#39; and password=&#39;&#39; OR &#39;1&#39;=&#39;1&#39;</code>ï¼Œè¿™ä¸ªæ—¶å€™1=1æ˜¯æˆç«‹ï¼Œè‡ªç„¶å°±è·³è¿‡éªŒè¯äº†ã€‚<br>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://images.morethink.cn/69855b1538333659f26afc281feb4e30.png" alt=""></p><p>ä½†æ˜¯å¦‚æœå†ä¸¥é‡ä¸€ç‚¹ï¼Œå¯†ç è¾“å¦‚çš„æ˜¯<code>&#39;;DROP TABLE user;--</code>ï¼Œé‚£ä¹ˆ SQLå‘½ä»¤ä¸º<code>SELECT *  FROM user WHERE username=&#39;admin&#39; and password=&#39;&#39;;drop table user;--&#39;</code> è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±ç›´æ¥æŠŠè¿™ä¸ªè¡¨ç»™åˆ é™¤äº†ã€‚</p><h2 id="å¦‚ä½•é¢„é˜²SQLæ³¨å…¥"><a href="#å¦‚ä½•é¢„é˜²SQLæ³¨å…¥" class="headerlink" title="å¦‚ä½•é¢„é˜²SQLæ³¨å…¥"></a>å¦‚ä½•é¢„é˜²SQLæ³¨å…¥</h2><ul><li>åœ¨Javaä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥(PreparedStatement)ï¼Œè¿™æ ·çš„è¯å³ä½¿æˆ‘ä»¬ä½¿ç”¨ SQLè¯­å¥ä¼ªé€ æˆå‚æ•°ï¼Œåˆ°äº†æœåŠ¡ç«¯çš„æ—¶å€™ï¼Œè¿™ä¸ªä¼ªé€  SQLè¯­å¥çš„å‚æ•°ä¹Ÿåªæ˜¯ç®€å•çš„å­—ç¬¦ï¼Œå¹¶ä¸èƒ½èµ·åˆ°æ”»å‡»çš„ä½œç”¨ã€‚</li><li>å¯¹è¿›å…¥æ•°æ®åº“çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆ<code>&#39;&quot;\å°–æ‹¬å·&amp;*</code>;ç­‰ï¼‰è¿›è¡Œè½¬ä¹‰å¤„ç†ï¼Œæˆ–ç¼–ç è½¬æ¢ã€‚</li><li>åœ¨åº”ç”¨å‘å¸ƒä¹‹å‰å»ºè®®ä½¿ç”¨ä¸“ä¸šçš„SQLæ³¨å…¥æ£€æµ‹å·¥å…·è¿›è¡Œæ£€æµ‹ï¼Œä»¥åŠæ—¶ä¿®è¡¥è¢«å‘ç°çš„SQLæ³¨å…¥æ¼æ´ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šè¿™æ–¹é¢çš„å¼€æºå·¥å…·ï¼Œä¾‹å¦‚sqlmapã€SQLninjaç­‰ã€‚</li><li>é¿å…ç½‘ç«™æ‰“å°å‡ºSQLé”™è¯¯ä¿¡æ¯ï¼Œæ¯”å¦‚ç±»å‹é”™è¯¯ã€å­—æ®µä¸åŒ¹é…ç­‰ï¼ŒæŠŠä»£ç é‡Œçš„SQLè¯­å¥æš´éœ²å‡ºæ¥ï¼Œä»¥é˜²æ­¢æ”»å‡»è€…åˆ©ç”¨è¿™äº›é”™è¯¯ä¿¡æ¯è¿›è¡ŒSQLæ³¨å…¥ã€‚</li></ul><p>åœ¨ä¸Šå›¾å±•ç¤ºä¸­ï¼Œä½¿ç”¨äº†Java JDBCä¸­çš„<code>PreparedStatement</code>é¢„ç¼–è¯‘é¢„é˜²SQLæ³¨å…¥ï¼Œå¯ä»¥çœ‹åˆ°å°†æ‰€æœ‰è¾“å…¥éƒ½ä½œä¸ºäº†å­—ç¬¦ä¸²ï¼Œé¿å…æ‰§è¡Œæ¶æ„SQLã€‚</p><h1 id="DDOS"><a href="#DDOS" class="headerlink" title="DDOS"></a>DDOS</h1><h2 id="ä»€ä¹ˆæ˜¯DDOS"><a href="#ä»€ä¹ˆæ˜¯DDOS" class="headerlink" title="ä»€ä¹ˆæ˜¯DDOS"></a>ä»€ä¹ˆæ˜¯DDOS</h2><p>DDOSï¼šåˆ†å¸ƒå¼æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDistributed Denial of Serviceï¼‰ï¼Œç®€å•è¯´å°±æ˜¯å‘é€å¤§é‡è¯·æ±‚æ˜¯ä½¿æœåŠ¡å™¨ç˜«ç—ªã€‚DDosæ”»å‡»æ˜¯åœ¨DOSæ”»å‡»åŸºç¡€ä¸Šçš„ï¼Œå¯ä»¥é€šä¿—ç†è§£ï¼Œdosæ˜¯å•æŒ‘ï¼Œè€Œddosæ˜¯ç¾¤æ®´ï¼Œå› ä¸ºç°ä»£æŠ€æœ¯çš„å‘å±•ï¼Œdosæ”»å‡»çš„æ€ä¼¤åŠ›é™ä½ï¼Œæ‰€ä»¥å‡ºç°äº†DDOSï¼Œæ”»å‡»è€…å€ŸåŠ©å…¬å…±ç½‘ç»œï¼Œå°†å¤§æ•°é‡çš„è®¡ç®—æœºè®¾å¤‡è”åˆèµ·æ¥ï¼Œå‘ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡è¿›è¡Œæ”»å‡»ã€‚</p><p>åœ¨æŠ€æœ¯è§’åº¦ä¸Šï¼ŒDDoSæ”»å‡»å¯ä»¥é’ˆå¯¹ç½‘ç»œé€šè®¯åè®®çš„å„å±‚ï¼Œæ‰‹æ®µå¤§è‡´æœ‰ï¼šTCPç±»çš„SYN Floodã€ACK Floodï¼ŒUDPç±»çš„Fraggleã€Trinooï¼ŒDNS Query Floodï¼ŒICMP Floodï¼ŒSlowlorisç±»ç­‰ç­‰ã€‚ä¸€èˆ¬ä¼šæ ¹æ®æ”»å‡»ç›®æ ‡çš„æƒ…å†µï¼Œé’ˆå¯¹æ€§çš„æŠŠæŠ€æœ¯æ‰‹æ³•æ··åˆï¼Œä»¥è¾¾åˆ°æœ€ä½çš„æˆæœ¬æœ€éš¾é˜²å¾¡çš„ç›®çš„ï¼Œå¹¶ä¸”å¯ä»¥è¿›è¡Œåˆç†çš„èŠ‚å¥æ§åˆ¶ï¼Œä»¥åŠéšè—ä¿æŠ¤æ”»å‡»èµ„æºã€‚</p><p>ä¸‹é¢ä»‹ç»ä¸€ä¸‹TCPåè®®ä¸­çš„SYNæ”»å‡»ã€‚</p><h2 id="SYNæ”»å‡»"><a href="#SYNæ”»å‡»" class="headerlink" title="SYNæ”»å‡»"></a>SYNæ”»å‡»</h2><p>åœ¨ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨å‘é€ <code>SYN-ACK</code> ä¹‹åï¼Œæ”¶åˆ°å®¢æˆ·ç«¯çš„ <code>ACK</code> ä¹‹å‰çš„ TCP è¿æ¥ç§°ä¸ºåŠè¿æ¥(half-open connect)ã€‚æ­¤æ—¶æœåŠ¡å™¨å¤„äº <code>SYN_RCVD</code> çŠ¶æ€ã€‚å½“æ”¶åˆ° ACK åï¼ŒæœåŠ¡å™¨æ‰èƒ½è½¬å…¥ <code>ESTABLISHED</code> çŠ¶æ€.</p><p><code>SYN</code>æ”»å‡»æŒ‡çš„æ˜¯ï¼Œæ”»å‡»å®¢æˆ·ç«¯åœ¨çŸ­æ—¶é—´å†…ä¼ªé€ å¤§é‡ä¸å­˜åœ¨çš„IPåœ°å€ï¼Œå‘æœåŠ¡å™¨ä¸æ–­åœ°å‘é€<code>SYN</code>åŒ…ï¼ŒæœåŠ¡å™¨å›å¤ç¡®è®¤åŒ…ï¼Œå¹¶ç­‰å¾…å®¢æˆ·çš„ç¡®è®¤ã€‚ç”±äºæºåœ°å€æ˜¯ä¸å­˜åœ¨çš„ï¼ŒæœåŠ¡å™¨éœ€è¦ä¸æ–­çš„é‡å‘ç›´è‡³è¶…æ—¶ï¼Œè¿™äº›ä¼ªé€ çš„<code>SYN</code>åŒ…å°†é•¿æ—¶é—´å ç”¨æœªè¿æ¥é˜Ÿåˆ—ï¼Œæ­£å¸¸çš„<code>SYN</code>è¯·æ±‚è¢«ä¸¢å¼ƒï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿè¿è¡Œç¼“æ…¢ï¼Œä¸¥é‡è€…ä¼šå¼•èµ·ç½‘ç»œå µå¡ç”šè‡³ç³»ç»Ÿç˜«ç—ªã€‚</p><h2 id="å¦‚ä½•é¢„é˜²DDOS"><a href="#å¦‚ä½•é¢„é˜²DDOS" class="headerlink" title="å¦‚ä½•é¢„é˜²DDOS"></a>å¦‚ä½•é¢„é˜²DDOS</h2><p>é˜¿é‡Œå·´å·´çš„å®‰å…¨å›¢é˜Ÿåœ¨å®æˆ˜ä¸­å‘ç°ï¼ŒDDoS é˜²å¾¡äº§å“çš„æ ¸å¿ƒæ˜¯æ£€æµ‹æŠ€æœ¯å’Œæ¸…æ´—æŠ€æœ¯ã€‚æ£€æµ‹æŠ€æœ¯å°±æ˜¯æ£€æµ‹ç½‘ç«™æ˜¯å¦æ­£åœ¨é­å— DDoS æ”»å‡»ï¼Œè€Œæ¸…æ´—æŠ€æœ¯å°±æ˜¯æ¸…æ´—æ‰å¼‚å¸¸æµé‡ã€‚è€Œæ£€æµ‹æŠ€æœ¯çš„æ ¸å¿ƒåœ¨äºå¯¹ä¸šåŠ¡æ·±åˆ»çš„ç†è§£ï¼Œæ‰èƒ½å¿«é€Ÿç²¾ç¡®åˆ¤æ–­å‡ºæ˜¯å¦çœŸçš„å‘ç”Ÿäº† DDoS æ”»å‡»ã€‚æ¸…æ´—æŠ€æœ¯å¯¹æ£€æµ‹æ¥è®²ï¼Œä¸åŒçš„ä¸šåŠ¡åœºæ™¯ä¸‹è¦æ±‚çš„ç²’åº¦ä¸ä¸€æ ·ã€‚</p><h1 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h1><h2 id="ä»€ä¹ˆæ˜¯CSRF"><a href="#ä»€ä¹ˆæ˜¯CSRF" class="headerlink" title="ä»€ä¹ˆæ˜¯CSRF"></a>ä»€ä¹ˆæ˜¯CSRF</h2><p>CSRFï¼ˆCross-site request forgeryï¼‰ï¼Œä¸­æ–‡åç§°ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œä¹Ÿè¢«ç§°ä¸ºï¼šone click attack/session ridingï¼Œç¼©å†™ä¸ºï¼šCSRF/XSRFã€‚</p><p>ä½ è¿™å¯ä»¥è¿™ä¹ˆç†è§£CSRFæ”»å‡»ï¼šæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚CSRFèƒ½å¤Ÿåšçš„äº‹æƒ…åŒ…æ‹¬ï¼šä»¥ä½ åä¹‰å‘é€é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç›—å–ä½ çš„è´¦å·ï¼Œç”šè‡³äºè´­ä¹°å•†å“ï¼Œè™šæ‹Ÿè´§å¸è½¬è´¦â€¦â€¦é€ æˆçš„é—®é¢˜åŒ…æ‹¬ï¼šä¸ªäººéšç§æ³„éœ²ä»¥åŠè´¢äº§å®‰å…¨ã€‚</p><h2 id="CSRFçš„åŸç†"><a href="#CSRFçš„åŸç†" class="headerlink" title="CSRFçš„åŸç†"></a>CSRFçš„åŸç†</h2><p>ä¸‹å›¾ç®€å•é˜è¿°äº†CSRFæ”»å‡»çš„æ€<br><img src="https://images.morethink.cn/138ad4f05b47533bf46904dc165167cc.png" alt=""></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¦å®Œæˆä¸€æ¬¡CSRFæ”»å‡»ï¼Œå—å®³è€…å¿…é¡»ä¾æ¬¡å®Œæˆä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç™»å½•å—ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶åœ¨æœ¬åœ°ç”ŸæˆCookieã€‚</li><li>åœ¨ä¸ç™»å‡ºAçš„æƒ…å†µä¸‹ï¼Œè®¿é—®å±é™©ç½‘ç«™Bã€‚</li></ol><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¹Ÿè®¸ä¼šè¯´ï¼šâ€œå¦‚æœæˆ‘ä¸æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä¸€ä¸ªï¼Œæˆ‘å°±ä¸ä¼šå—åˆ°CSRFçš„æ”»å‡»â€ã€‚æ˜¯çš„ï¼Œç¡®å®å¦‚æ­¤ï¼Œä½†ä½ ä¸èƒ½ä¿è¯ä»¥ä¸‹æƒ…å†µä¸ä¼šå‘ç”Ÿï¼š</p><ol><li>ä½ ä¸èƒ½ä¿è¯ä½ ç™»å½•äº†ä¸€ä¸ªç½‘ç«™åï¼Œä¸å†æ‰“å¼€ä¸€ä¸ªtabé¡µé¢å¹¶è®¿é—®å¦å¤–çš„ç½‘ç«™ã€‚</li><li>ä½ ä¸èƒ½ä¿è¯ä½ å…³é—­æµè§ˆå™¨äº†åï¼Œä½ æœ¬åœ°çš„Cookieç«‹åˆ»è¿‡æœŸï¼Œä½ ä¸Šæ¬¡çš„ä¼šè¯å·²ç»ç»“æŸã€‚ï¼ˆäº‹å®ä¸Šï¼Œå…³é—­æµè§ˆå™¨ä¸èƒ½ç»“æŸä¸€ä¸ªä¼šè¯ï¼Œä½†å¤§å¤šæ•°äººéƒ½ä¼šé”™è¯¯çš„è®¤ä¸ºå…³é—­æµè§ˆå™¨å°±ç­‰äºé€€å‡ºç™»å½•/ç»“æŸä¼šè¯äº†â€¦â€¦ï¼‰</li><li>ä¸Šå›¾ä¸­æ‰€è°“çš„æ”»å‡»ç½‘ç«™ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå­˜åœ¨å…¶ä»–æ¼æ´çš„å¯ä¿¡ä»»çš„ç»å¸¸è¢«äººè®¿é—®çš„ç½‘ç«™ã€‚</li></ol><p>ä¸‹é¢è®²ä¸€è®²javaè§£å†³CSRFæ”»å‡»çš„æ–¹å¼ã€‚</p><h2 id="æ¨¡æ‹ŸCSRFæ”»å‡»"><a href="#æ¨¡æ‹ŸCSRFæ”»å‡»" class="headerlink" title="æ¨¡æ‹ŸCSRFæ”»å‡»"></a>æ¨¡æ‹ŸCSRFæ”»å‡»</h2><h3 id="ç™»å½•Aç½‘ç«™"><a href="#ç™»å½•Aç½‘ç«™" class="headerlink" title="ç™»å½•Aç½‘ç«™"></a>ç™»å½•Aç½‘ç«™</h3><p>ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯adminã€‚</p><p><code>http://localhost:8081/login.html</code>:<br><img src="https://images.morethink.cn/e298f8ef08869557b8fb60034f06bb80.png" alt=""></p><h3 id="ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­"><a href="#ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­" class="headerlink" title="ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­"></a>ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­</h3><p><code>http://localhost:8081/deletePost.html</code>:<br><img src="https://images.morethink.cn/897d358f2677d053bb9555ff69d112ac.png" alt=""></p><h3 id="ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™"><a href="#ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™" class="headerlink" title="ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™"></a>ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™</h3><p><code>http://localhost:8082/deletePost.html</code>:</p><p><img src="https://images.morethink.cn/csrf-attack.gif" alt=""></p><p>æ˜æ˜¾çœ‹åˆ°Bç½‘ç«™æ˜¯8082ç«¯å£ï¼ŒAç½‘ç«™æ˜¯8081ç«¯å£ï¼Œä½†æ˜¯Bç½‘ç«™çš„åˆ é™¤2å·å¸–å­åŠŸèƒ½ä¾ç„¶å®ç°ã€‚</p><h2 id="å¦‚ä½•é¢„é˜²CSRFæ”»å‡»"><a href="#å¦‚ä½•é¢„é˜²CSRFæ”»å‡»" class="headerlink" title="å¦‚ä½•é¢„é˜²CSRFæ”»å‡»"></a>å¦‚ä½•é¢„é˜²CSRFæ”»å‡»</h2><p>ç®€å•æ¥è¯´ï¼ŒCSRF å°±æ˜¯ç½‘ç«™ A å¯¹ç”¨æˆ·å»ºç«‹ä¿¡ä»»å…³ç³»åï¼Œåœ¨ç½‘ç«™ B ä¸Šåˆ©ç”¨è¿™ç§ä¿¡ä»»å…³ç³»ï¼Œè·¨ç«™ç‚¹å‘ç½‘ç«™ A å‘èµ·ä¸€äº›ä¼ªé€ çš„ç”¨æˆ·æ“ä½œè¯·æ±‚ï¼Œä»¥è¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</p><p>è€Œä¹‹æ‰€ä»¥å¯ä»¥å®Œæˆæ”»å‡»æ˜¯å› ä¸ºBå‘Aå‘èµ·æ”»å‡»çš„æ—¶å€™ä¼šæŠŠAç½‘ç«™çš„cookieå¸¦ç»™Aç½‘ç«™ï¼Œä¹Ÿå°±æ˜¯è¯´cookieå·²ç»ä¸å®‰å…¨äº†ã€‚</p><h3 id="é€šè¿‡Synchronizer-Tokens"><a href="#é€šè¿‡Synchronizer-Tokens" class="headerlink" title="é€šè¿‡Synchronizer Tokens"></a>é€šè¿‡Synchronizer Tokens</h3><p>Synchronizer Tokensï¼š åœ¨è¡¨å•é‡Œéšè—ä¸€ä¸ªéšæœºå˜åŒ–çš„ csrf_token csrf_token æäº¤åˆ°åå°è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯é€šè¿‡åˆ™å¯ä»¥ç»§ç»­æ‰§è¡Œæ“ä½œã€‚è¿™ç§æƒ…å†µæœ‰æ•ˆçš„ä¸»è¦åŸå› æ˜¯ç½‘ç«™ B æ‹¿ä¸åˆ°ç½‘ç«™ A è¡¨å•é‡Œçš„ csrf_token</p><p>è¿™ç§æ–¹å¼çš„ä½¿ç”¨æ¡ä»¶æ˜¯PHPå’ŒJSPç­‰ã€‚å› ä¸ºcookieå·²ç»ä¸å®‰å…¨äº†ï¼Œå› æ­¤æŠŠcsrf_tokenå€¼å­˜å‚¨åœ¨sessionä¸­ï¼Œç„¶åæ¯æ¬¡è¡¨å•æäº¤æ—¶éƒ½ä»sessionå–å‡ºæ¥æ”¾åˆ°formè¡¨å•çš„éšè—åŸŸä¸­ï¼Œè¿™æ ·Bç½‘ç«™ä¸å¯ä»¥å¾—åˆ°è¿™ä¸ªå­˜å‚¨åˆ°sessionä¸­çš„å€¼ã€‚</p><p>ä¸‹é¢æ˜¯JSPçš„ï¼š<br><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;input type="hidden" name="random_form" value=&lt;%=random%&gt;&gt;&lt;/input&gt;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯æˆ‘ç°åœ¨çš„æƒ…å†µæ˜¯htmlï¼Œä¸æ˜¯JSPï¼Œå¹¶ä¸èƒ½åŠ¨æ€çš„ä»sessionä¸­å–å‡ºcsrf_tokenå€¼ã€‚åªèƒ½é‡‡ç”¨åŠ å¯†çš„æ–¹å¼äº†ã€‚</p><h3 id="HashåŠ å¯†cookieä¸­csrf-tokenå€¼"><a href="#HashåŠ å¯†cookieä¸­csrf-tokenå€¼" class="headerlink" title="HashåŠ å¯†cookieä¸­csrf_tokenå€¼"></a>HashåŠ å¯†cookieä¸­csrf_tokenå€¼</h3><p>è¿™å¯èƒ½æ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå› ä¸ºæ”»å‡»è€…ä¸èƒ½è·å¾—ç¬¬ä¸‰æ–¹çš„Cookie(ç†è®ºä¸Š)ï¼Œæ‰€ä»¥è¡¨å•ä¸­çš„æ•°æ®ä¹Ÿå°±æ„é€ å¤±è´¥äº†ã€‚</p><p>æˆ‘é‡‡ç”¨çš„hashåŠ å¯†æ–¹æ³•æ˜¯JSå®ç°Javaçš„HashCodeæ–¹æ³•ï¼Œå¾—åˆ°hashå€¼ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨å…¶ä»–çš„hashç®—æ³•ã€‚</p><p>å‰ç«¯å‘åå°ä¼ é€’hashä¹‹åçš„csrf_tokenå€¼å’Œcookieä¸­çš„csrf_tokenå€¼ï¼Œåå°æ‹¿åˆ°cookieä¸­çš„csrf_tokenå€¼åå¾—åˆ°hashCodeå€¼ç„¶åä¸å‰ç«¯ä¼ è¿‡æ¥çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€æ ·åˆ™é€šè¿‡ã€‚</p><h4 id="ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­"><a href="#ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­" class="headerlink" title="ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­"></a>ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­</h4><p><code>http://localhost:8081/deletePost.html</code></p><p><img src="https://images.morethink.cn/2ac5eab98780646c6c36dcdc98fa50c7.png" alt=""></p><h4 id="Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†"><a href="#Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†" class="headerlink" title="Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†"></a>Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†</h4><p>æˆ‘ä»¬é€šè¿‡UserFilter.javaç»™æ”»å‡»è€…è¿”å›çš„æ˜¯403é”™è¯¯ï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç†è§£ç”¨æˆ·å®¢æˆ·ç«¯çš„è¯·æ±‚ä½†æ‹’ç»å¤„ç†ã€‚</p><p><code>http://localhost:8082/deletePost.html</code>:<br><img src="https://images.morethink.cn/csrf-attack-fail-failure.gif" alt=""></p><p>æ”»å‡»è€…ä¸èƒ½åˆ é™¤4å·å¸–å­ã€‚</p><p>å‰ç«¯ä»£ç ï¼š</p><p>deletePost.html</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>deletePost<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">deletePost</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> url = <span class="string">'/post/'</span> + <span class="built_in">document</span>.getElementById(<span class="string">"postId"</span>).value;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> csrf_token = <span class="built_in">document</span>.cookie.replace(<span class="regexp">/(?:(?:^|.*;\s*)csrf_token\s*\=\s*([^;]*).*$)|^.*$/</span>, <span class="string">"$1"</span>);</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'csrf_token='</span> + csrf_token);</span></span><br><span class="line"><span class="javascript">            $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                type: <span class="string">"post"</span>,<span class="comment">//è¯·æ±‚æ–¹å¼</span></span></span><br><span class="line"><span class="javascript">                url: url,  <span class="comment">//å‘é€è¯·æ±‚åœ°å€</span></span></span><br><span class="line"><span class="javascript">                timeout: <span class="number">30000</span>,<span class="comment">//è¶…æ—¶æ—¶é—´ï¼š30ç§’</span></span></span><br><span class="line"><span class="undefined">                data: &#123;</span></span><br><span class="line"><span class="javascript">                    <span class="string">"_method"</span>: <span class="string">"delete"</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="string">"csrf_token"</span>: hash(csrf_token) <span class="comment">// å¯¹csrf_tokenè¿›è¡ŒhashåŠ å¯†</span></span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                dataType: <span class="string">"json"</span>,<span class="comment">//è®¾ç½®è¿”å›æ•°æ®çš„æ ¼å¼</span></span></span><br><span class="line"><span class="javascript">                success: <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="keyword">if</span> (result.message == <span class="string">"success"</span>) &#123;</span></span><br><span class="line"><span class="javascript">                        $(<span class="string">"#result"</span>).text(<span class="string">"åˆ é™¤æˆåŠŸ"</span>);</span></span><br><span class="line"><span class="javascript">                    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                        $(<span class="string">"#result"</span>).text(<span class="string">"åˆ é™¤å¤±è´¥"</span>);</span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="javascript">                error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">//è¯·æ±‚å‡ºé”™çš„å¤„ç†</span></span></span><br><span class="line"><span class="javascript">                    $(<span class="string">"#result"</span>).text(<span class="string">"è¯·æ±‚å‡ºé”™"</span>);</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="comment">// javascriptçš„Stringåˆ°int(32ä½)çš„hashç®—æ³•</span></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">hash</span>(<span class="params">str</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> hash = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">if</span> (str.length == <span class="number">0</span>) <span class="keyword">return</span> hash;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; str.length; i++) &#123;</span></span><br><span class="line"><span class="undefined">                char = str.charCodeAt(i);</span></span><br><span class="line"><span class="undefined">                hash = ((hash &lt;&lt; 5) - hash) + char;</span></span><br><span class="line"><span class="javascript">                hash = hash &amp; hash; <span class="comment">// Convert to 32bit integer</span></span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> hash;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>åˆ é™¤å¸–å­<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">å¸–å­ç¼–å· ï¼š <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"postId"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"deletePost();"</span>&gt;</span>deletePost<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åå°ä»£ç ï¼š</p><p>UserInterceptor.java</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.morethink.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.morethink.util.JsonUtil;</span><br><span class="line"><span class="keyword">import</span> cn.morethink.util.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/1/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String method = request.getMethod();</span><br><span class="line">        System.out.println(method);</span><br><span class="line">        <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">"POST"</span>) || method.equalsIgnoreCase(<span class="string">"DELETE"</span>)</span><br><span class="line">                || method.equalsIgnoreCase(<span class="string">"PUT"</span>)) &#123;</span><br><span class="line">            String csrf_token = request.getParameter(<span class="string">"csrf_token"</span>);</span><br><span class="line">            Cookie[] cookies = request.getCookies();</span><br><span class="line">            <span class="keyword">if</span> (cookies != <span class="keyword">null</span> &amp;&amp; cookies.length &gt; <span class="number">0</span> &amp;&amp; csrf_token != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cookie.getName().equals(<span class="string">"csrf_token"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (Integer.valueOf(csrf_token) == cookie.getValue().hashCode()) &#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result(<span class="string">"403"</span>, <span class="string">"ä½ è¿˜æƒ³æ”»å‡»æˆ‘??????????"</span>, <span class="string">""</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        out.write(JsonUtil.toJson(result));</span><br><span class="line">        out.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ol><li>cookieå¿…é¡»è¦è®¾ç½®PATHæ‰å¯ä»¥ç”Ÿæ•ˆï¼Œå¦åˆ™åœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™æ— æ³•å¸¦ç»™æœåŠ¡å™¨ã€‚</li><li>Spring Boot å‡ºç°å¯åŠ¨æ‰¾ä¸åˆ°ä¸»ç±»çš„é—®é¢˜æ—¶å¯ä»¥mvn cleanä¸€ä¸‹ã€‚</li><li>Filterè®¾ç½®response.sendError(403)åœ¨Spring Bootæ²¡æœ‰æ•ˆæœã€‚</li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ä¸Šé¢ä¸€å…±æåˆ°äº†4ç§æ”»å‡»æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯XSSæ”»å‡»ï¼ˆå…³é”®æ˜¯è„šæœ¬ï¼Œåˆ©ç”¨æ¶æ„è„šæœ¬å‘èµ·æ”»å‡»ï¼‰ï¼ŒSQLæ³¨å…¥ï¼ˆå…³é”®æ˜¯é€šè¿‡ç”¨SQLè¯­å¥ä¼ªé€ å‚æ•°å‘å‡ºæ”»å‡»ï¼‰ï¼ŒDDOSæ”»å‡»ï¼ˆå…³é”®æ˜¯å‘å‡ºå¤§é‡è¯·æ±‚ï¼Œæœ€åä»¤æœåŠ¡å™¨å´©æºƒï¼‰ï¼ŒCSRFæ”»å‡»ï¼ˆå…³é”®æ˜¯å€ŸåŠ©æœ¬åœ°cookieè¿›è¡Œè®¤è¯ï¼Œä¼ªé€ å‘é€è¯·æ±‚ï¼‰ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://zhuanlan.zhihu.com/p/24249045" target="_blank" rel="noopener">XSSå®æˆ˜ï¼šæˆ‘æ˜¯å¦‚ä½•æ‹¿ä¸‹ä½ çš„ç™¾åº¦è´¦å·</a></li><li><a href="http://www.cnblogs.com/-new/p/7135814.html" target="_blank" rel="noopener">æ€»ç»“å‡ ç§å¸¸è§webæ”»å‡»æ‰‹æ®µåŠå…¶é˜²å¾¡æ–¹å¼</a></li><li><a href="https://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html" target="_blank" rel="noopener">æµ…è°ˆCSRFæ”»å‡»æ–¹å¼</a></li><li><a href="http://blog.csdn.net/zzhongcy/article/details/20133883" target="_blank" rel="noopener">jQueue åŠ¨æ€è®¾ç½®formè¡¨å•çš„actionå±æ€§çš„å€¼å’Œæ–¹æ³•</a></li><li><a href="https://www.thinksaas.cn/group/topic/304242/" target="_blank" rel="noopener">javascriptçš„Stringåˆ°int(32ä½)çš„hashç®—æ³•</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>GitåŒæ—¶pushåˆ°å¤šä¸ªè¿œç¨‹ä»“åº“</title>
      <link href="/Git%E5%90%8C%E6%97%B6push%E5%88%B0%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/"/>
      <url>/Git%E5%90%8C%E6%97%B6push%E5%88%B0%E5%A4%9A%E4%B8%AA%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p>æ·»åŠ ç¬¬äºŒä¸ªè¿œç¨‹åœ°å€æ—¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š<br><code>git remote set-url --add origin git@github.com:morethink/programming.git</code></p><p>æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯ï¼š<code>git remote -v</code></p><a id="more"></a><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">origingit@git.coding.net:morethink/programming.git (fetch)</span><br><span class="line">origingit@git.coding.net:morethink/programming.git (push)</span><br><span class="line">originhexo@MyHost2:/var/repo/gitbook.git (push)</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥åŒæ—¶ push åˆ°å¤šä¸ªè¿œç¨‹åœ°å€ï¼š<code>git push origin master</code></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Everything up-to-date</span><br><span class="line">Everything up-to-date</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Git </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>äºŒå‰æ ‘ä»å³è¾¹çœ‹åˆ°çš„èŠ‚ç‚¹</title>
      <link href="/%E4%BA%8C%E5%8F%89%E6%A0%91%E4%BB%8E%E5%8F%B3%E8%BE%B9%E7%9C%8B%E5%88%B0%E7%9A%84%E8%8A%82%E7%82%B9/"/>
      <url>/%E4%BA%8C%E5%8F%89%E6%A0%91%E4%BB%8E%E5%8F%B3%E8%BE%B9%E7%9C%8B%E5%88%B0%E7%9A%84%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å¯¹ LeetCode <a href="https://leetcode.com/problems/binary-tree-right-side-view/description/" target="_blank" rel="noopener">Binary Tree Right Side View</a> è§£æ³•çš„æ¢è®¨ã€‚</p><p>é¢˜ç›®ï¼š<br>Given a binary tree, imagine yourself standing on the right side of it, return the values of the nodes you can see ordered from top to bottom.<br><a id="more"></a><br>For example:<br>Given the following binary tree,<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">  1            &lt;---</span><br><span class="line"> /   \</span><br><span class="line">2     3         &lt;---</span><br><span class="line"> \     \</span><br><span class="line">  5     4       &lt;---</span><br></pre></td></tr></table></figure></p><p>You should return [1, 3, 4].</p><p>è§£æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å› ä¸ºé¢˜ç›®çš„äºŒå‰æ ‘å¹¶ä¸æ˜¯æ»¡äºŒå‰æ ‘ï¼Œæ‰€ä»¥é‡‡ç”¨å±‚åºéå†çš„æ–¹å¼ã€‚</span></span><br><span class="line"><span class="comment"> * å°†ä»¥å‰å±‚åºéå†ä¸­ä¸€ä¸ªä¸ªå‡ºé˜Ÿçš„æ–¹å¼å˜ä¸ºä¸€å±‚å±‚å‡ºé˜Ÿï¼Œ</span></span><br><span class="line"><span class="comment"> * è¿™æ ·å°±èƒ½å®šä½æœ€å³è¾¹çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> root</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">rightSideView</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    queue.offer(root);</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> size = queue.size();</span><br><span class="line">        <span class="comment">//å°†æ¯ä¸€å±‚çš„èŠ‚ç‚¹éƒ½å‡ºé˜Ÿ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            TreeNode treeNode = queue.poll();</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">0</span>) &#123;</span><br><span class="line">                list.add(treeNode.val);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (treeNode.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">                queue.offer(treeNode.right);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (treeNode.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">                queue.offer(treeNode.left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ±‚å°äºnçš„ç´ æ•°ä¸ªæ•°</title>
      <link href="/%E6%B1%82%E5%B0%8F%E4%BA%8En%E7%9A%84%E7%B4%A0%E6%95%B0%E4%B8%AA%E6%95%B0/"/>
      <url>/%E6%B1%82%E5%B0%8F%E4%BA%8En%E7%9A%84%E7%B4%A0%E6%95%B0%E4%B8%AA%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡æ˜¯å¯¹ LeetCode <a href="https://leetcode.com/problems/count-primes/description/" target="_blank" rel="noopener">Count Primes</a> è§£æ³•çš„æ¢è®¨ã€‚</p><p>é¢˜ç›®ï¼š<br>Count the number of prime numbers less than a non-negative number, n.</p><p>å°½ç®¡é¢˜ç›®å¹¶æ²¡æœ‰è¦æˆ‘ä»¬å†™ä¸€ä¸ªæœ€ä¼˜çš„ç®—æ³•ï¼Œä½†æ˜¯èº«ä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä¼˜åŒ–åº”è¯¥æ˜¯ä¸€ç§ä¹ æƒ¯ï¼Œåœ¨ç¼–ç¨‹çš„è¿‡ç¨‹ä¸­ï¼Œéšç€æ€è€ƒè¿›è¡Œä¼˜åŒ–ã€‚åªè¦æ±‚æˆ‘ä»¬æ»¡è¶³ç»™å®šçš„æ—¶é—´å’Œç©ºé—´å³å¯ã€‚</p><p>å¦‚æœä½ åªèƒ½æƒ³å‡ºä¸€ä¸ªæœ€ç®€å•çš„æ–¹æ³•ï¼Œéš¾é“ä½ ä¼šæœ‰ä»€ä¹ˆç«äº‰åŠ›å—ï¼Ÿ</p><a id="more"></a><h1 id="ç©·ä¸¾"><a href="#ç©·ä¸¾" class="headerlink" title="ç©·ä¸¾"></a>ç©·ä¸¾</h1><p>æœ€å¼€å§‹æˆ‘ç”¨çš„å°±æ˜¯è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è¯´è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§æ–¹æ³•äº†ï¼Œè€Œä¸”æœ€å¼€å§‹ï¼Œæˆ‘å°±æ˜¯æƒ³çš„è¿™ç§æ–¹æ³•ï¼Œè¯´æ˜ï¼šæˆ‘æ²¡æœ‰å¯¹è¿™ä¸ªé—®é¢˜è¿›è¡Œæ€è€ƒï¼Œæ²¡æœ‰å»ä¼˜åŒ–å®ƒï¼Œè€Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œå¦‚ä½•æé«˜æ•ˆç‡æ˜¯æ‹¿åˆ°ä¸€ä¸ªé—®é¢˜é¦–å…ˆè¦æ€è€ƒçš„äº‹æƒ…ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countPrimes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; i - <span class="number">1</span>; j++)</span><br><span class="line">            <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123;</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è·å–å¼€å§‹æ—¶</span></span><br><span class="line">    <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">"The num is "</span> + <span class="keyword">new</span> L_204_Count_Primes().countPrimes(<span class="number">2000000</span>));</span><br><span class="line">    <span class="keyword">long</span> endTime = System.currentTimeMillis();</span><br><span class="line">    <span class="comment">//è·å–ç»“æŸæ—¶é—´</span></span><br><span class="line">    System.out.println(<span class="string">"ç¨‹åºè¿è¡Œæ—¶é—´ï¼š "</span> + (endTime - startTime) + <span class="string">"ms"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ—¶é—´å¤ªé•¿ï¼Œå·²ç»ä¸èƒ½è®¡ç®—ã€‚</p></blockquote><h1 id="åªèƒ½æ˜¯å¥‡æ•°ä¸”å°äº-sqrt-n"><a href="#åªèƒ½æ˜¯å¥‡æ•°ä¸”å°äº-sqrt-n" class="headerlink" title="åªèƒ½æ˜¯å¥‡æ•°ä¸”å°äº$\sqrt{n}$"></a>åªèƒ½æ˜¯å¥‡æ•°ä¸”å°äº$\sqrt{n}$</h1><p>æ€è€ƒåå‘ç°</p><ol><li>ç´ æ•°ä¸€å®šæ˜¯å¥‡æ•°</li><li>è‹¥ n=ab æ˜¯ä¸ªåˆæ•°ï¼ˆå…¶ä¸­ a ä¸ b â‰  1ï¼‰, åˆ™å…¶ä¸­ä¸€ä¸ªçº¦æ•° a æˆ– b å¿…å®šè‡³å¤§ä¸º  $\sqrt{n}$.</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countPrimes2</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= (<span class="keyword">int</span>) Math.sqrt(i); j++)</span><br><span class="line">            <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123;</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>The num is 148933<br>ç¨‹åºè¿è¡Œæ—¶é—´ï¼š 1124ms</p></blockquote><h1 id="è¯•é™¤æ³•ï¼šæ•°å­¦çŸ¥è¯†çš„è¿ç”¨"><a href="#è¯•é™¤æ³•ï¼šæ•°å­¦çŸ¥è¯†çš„è¿ç”¨" class="headerlink" title="è¯•é™¤æ³•ï¼šæ•°å­¦çŸ¥è¯†çš„è¿ç”¨"></a>è¯•é™¤æ³•ï¼šæ•°å­¦çŸ¥è¯†çš„è¿ç”¨</h1><p>æŸ¥é˜… <a href="https://zh.wikipedia.org/wiki/%E7%AE%97%E6%9C%AF%E5%9F%BA%E6%9C%AC%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">ç®—æœ¯åŸºæœ¬å®šç†</a>å¯çŸ¥ï¼š</p><blockquote><p><strong>ç®—æœ¯åŸºæœ¬å®šç†</strong> :<br>æ¯ä¸ªå¤§äº1çš„æ•´æ•°å‡å¯å†™æˆä¸€ä¸ªä»¥ä¸Šçš„ç´ æ•°ä¹‹ä¹˜ç§¯ï¼Œä¸”é™¤äº†è´¨çº¦æ•°çš„æ’åºä¸åŒå¤–æ˜¯å”¯ä¸€çš„</p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥æ¯ä¸ªæ•°æ¥é™¤ä»¥å¾—åˆ°çš„ç´ æ•°ï¼Œè¿™æ ·å¯å¤§å¤§å‡å°‘è¿è¡Œæ¬¡æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countPrimes3</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//0 1 ä¸ç®—åšç´ æ•°,2ä¸€å®šæ˜¯ç´ æ•°</span></span><br><span class="line">    List&lt;Integer&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">boolean</span> flag;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt; n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        flag = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; list.size() &amp;&amp; list.get(j) &lt;= (<span class="keyword">int</span>) Math.sqrt(n); j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i % list.get(j) == <span class="number">0</span>) &#123;</span><br><span class="line">                flag = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            list.add(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>The num is 148933<br>ç¨‹åºè¿è¡Œæ—¶é—´ï¼š 383ms</p></blockquote><h1 id="ç­›é€‰æ³•"><a href="#ç­›é€‰æ³•" class="headerlink" title="ç­›é€‰æ³•"></a>ç­›é€‰æ³•</h1><blockquote><p>åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•ï¼Œç®€ç§°åŸƒæ°ç­›ï¼Œä¹Ÿæœ‰äººç§°ç´ æ•°ç­›ã€‚è¿™æ˜¯ä¸€ç§ç®€å•ä¸”å†å²æ‚ ä¹…çš„ç­›æ³•ï¼Œç”¨æ¥æ‰¾å‡ºä¸€å®šèŒƒå›´å†…æ‰€æœ‰çš„ç´ æ•°ã€‚</p><p>æ‰€ä½¿ç”¨çš„åŸç†æ˜¯ä»2å¼€å§‹ï¼Œå°†æ¯ä¸ªç´ æ•°çš„å„ä¸ªå€æ•°ï¼Œæ ‡è®°æˆåˆæ•°ã€‚ä¸€ä¸ªç´ æ•°çš„å„ä¸ªå€æ•°ï¼Œæ˜¯ä¸€ä¸ªå·®ä¸ºæ­¤ç´ æ•°æœ¬èº«çš„ç­‰å·®æ•°åˆ—ã€‚æ­¤ä¸ºè¿™ä¸ªç­›æ³•å’Œè¯•é™¤æ³•ä¸åŒçš„å…³é”®ä¹‹å¤„ï¼Œåè€…æ˜¯ä»¥ç´ æ•°æ¥æµ‹è¯•æ¯ä¸ªå¾…æµ‹æ•°èƒ½å¦è¢«æ•´é™¤ã€‚</p></blockquote><p>ç­›é€‰æ³•çš„ç­–ç•¥æ˜¯å°†ç´ æ•°çš„å€æ•°å…¨éƒ¨ç­›æ‰ï¼Œå‰©ä¸‹çš„å°±æ˜¯ç´ æ•°äº†ï¼Œä¸‹å›¾å¾ˆç”ŸåŠ¨çš„ä½“ç°äº†ç­›é€‰çš„è¿‡ç¨‹ï¼š</p><p><img src="https://images.morethink.cn/dcp5x843_338cbm3tmg7_b.gif" alt="" title="ç­›é€‰æ³•"></p><p>ç­›é€‰çš„è¿‡ç¨‹æ˜¯å…ˆç­›æ‰éç´ æ•°ï¼Œé’ˆå¯¹æœ¬æ–‡çš„é¢˜ç›®ï¼Œæ¯ç­›æ‰ä¸€ä¸ªï¼Œç´ æ•°æ•°é‡-1å³å¯ï¼Œä¸Šé¢è¯´è¿‡ç´ æ•°çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œé™¤äº†2ï¼Œå…¶å®ƒçš„ç´ æ•°éƒ½æ˜¯å¥‡æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€åœ¨å¥‡æ•°èŒƒå›´å†…ç­›é€‰å°±å¯ä»¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">countPrimes4</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//falseä»£è¡¨ç´ æ•°ï¼Œtrueä»£è¡¨éç´ æ•°</span></span><br><span class="line">    <span class="keyword">boolean</span>[] flags = <span class="keyword">new</span> <span class="keyword">boolean</span>[n];</span><br><span class="line">    <span class="comment">//0ä¸æ˜¯ç´ æ•°</span></span><br><span class="line">    flags[<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">    <span class="comment">//1ä¸æ˜¯ç´ æ•°</span></span><br><span class="line">    flags[<span class="number">1</span>] = <span class="keyword">true</span>;</span><br><span class="line">    <span class="keyword">int</span> num = n - <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= (<span class="keyword">int</span>) Math.sqrt(n); i++) &#123;</span><br><span class="line">        <span class="comment">//å½“iä¸ºç´ æ•°æ—¶ï¼Œiçš„æ‰€æœ‰å€æ•°éƒ½ä¸æ˜¯ç´ æ•°</span></span><br><span class="line">        <span class="keyword">if</span> (!flags[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span> * i; j &lt; n; j += i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!flags[j]) &#123;</span><br><span class="line">                    flags[j] = <span class="keyword">true</span>;</span><br><span class="line">                    num--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>The num is 148933<br>ç¨‹åºè¿è¡Œæ—¶é—´ï¼š 43ms</p></blockquote><p>å…¨éƒ¨ä»£ç æ”¾åœ¨ï¼š<br> <a href="https://github.com/morethink/algorithm/blob/master/src/algorithm/leetcode/L_204_Count_Primes.java" target="_blank" rel="noopener">https://github.com/morethink/algorithm/blob/master/src/algorithm/leetcode/L_204_Count_Primes.java</a></p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://program-think.blogspot.com/2011/12/prime-algorithm-1.html" target="_blank" rel="noopener">æ±‚è´¨æ•°ç®—æ³•çš„Nç§å¢ƒç•Œ[1] - è¯•é™¤æ³•å’Œåˆçº§ç­›æ³•</a></li><li><a href="http://blog.csdn.net/ghsau/article/details/78768157" target="_blank" rel="noopener"> æ±‚ç´ æ•°ä¸ªæ•°</a></li><li><a href="https://zh.wikipedia.org/wiki/%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95" target="_blank" rel="noopener">åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç´ æ•° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaå®ç°å•é“¾è¡¨çš„å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åº</title>
      <link href="/Java%E5%AE%9E%E7%8E%B0%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E5%92%8C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/"/>
      <url>/Java%E5%AE%9E%E7%8E%B0%E5%8D%95%E9%93%BE%E8%A1%A8%E7%9A%84%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E5%92%8C%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡æè¿°äº†LeetCode 148é¢˜ <a href="https://leetcode.com/problems/sort-list/description/" target="_blank" rel="noopener">sort-list</a> çš„è§£æ³•ã€‚</p><p>é¢˜ç›®æè¿°å¦‚ä¸‹:<br>Sort a linked list in O(n log n) time using constant space complexity.</p><p>é¢˜ç›®è¦æ±‚æˆ‘ä»¬åœ¨O(n log n)æ—¶é—´å¤æ‚åº¦ä¸‹å®Œæˆå¯¹å•é“¾è¡¨çš„æ’åºï¼Œæˆ‘ä»¬çŸ¥é“å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n log n)çš„æ’åºæ–¹æ³•æœ‰å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºå’Œå †æ’åºã€‚è€Œä¸€èˆ¬æ˜¯ç”¨æ•°ç»„æ¥å®ç°äºŒå‰å †ï¼Œå½“ç„¶å¯ä»¥ç”¨äºŒå‰æ ‘æ¥å®ç°ï¼Œä½†æ˜¯è¿™ä¹ˆåšå¤ªéº»çƒ¦ï¼Œè¿˜å¾—èŠ±è´¹é¢å¤–çš„ç©ºé—´æ„å»ºäºŒå‰æ ‘ï¼Œäºæ˜¯ä¸é‡‡ç”¨å †æ’åºã€‚<br><a id="more"></a><br>æ•…æœ¬æ–‡é‡‡ç”¨å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åºæ¥å¯¹å•é“¾è¡¨è¿›è¡Œæ’åºã€‚</p><h1 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h1><p>åœ¨ä¸€èˆ¬å®ç°çš„å¿«é€Ÿæ’åºä¸­ï¼Œæˆ‘ä»¬é€šè¿‡é¦–å°¾æŒ‡é’ˆæ¥å¯¹å…ƒç´ è¿›è¡Œåˆ‡åˆ†ï¼Œä¸‹é¢é‡‡ç”¨å¿«æ’çš„å¦ä¸€ç§æ–¹æ³•æ¥å¯¹å…ƒç´ è¿›è¡Œåˆ‡åˆ†ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªæŒ‡é’ˆp1å’Œp2ï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆå‡å¾€nextæ–¹å‘ç§»åŠ¨ï¼Œç§»åŠ¨çš„è¿‡ç¨‹ä¸­ä¿æŒp1ä¹‹å‰çš„keyéƒ½å°äºé€‰å®šçš„keyï¼Œp1å’Œp2ä¹‹é—´çš„keyéƒ½å¤§äºé€‰å®šçš„keyï¼Œé‚£ä¹ˆå½“p2èµ°åˆ°æœ«å°¾æ—¶äº¤æ¢p1ä¸keyå€¼ä¾¿å®Œæˆäº†ä¸€æ¬¡åˆ‡åˆ†ã€‚</p><p>å›¾ç¤ºå¦‚ä¸‹ï¼š<br><img src="http://img.blog.csdn.net/20140326225106296?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvZG91ZmVpX2Njc3Q=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt=""></p><p>ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">sortList</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é‡‡ç”¨å¿«é€Ÿæ’åº</span></span><br><span class="line">   quickSort(head, <span class="keyword">null</span>);</span><br><span class="line">   <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(ListNode head, ListNode end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head != end) &#123;</span><br><span class="line">        ListNode node = partion(head, end);</span><br><span class="line">        quickSort(head, node);</span><br><span class="line">        quickSort(node.next, end);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ListNode <span class="title">partion</span><span class="params">(ListNode head, ListNode end)</span> </span>&#123;</span><br><span class="line">    ListNode p1 = head, p2 = head.next;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//èµ°åˆ°æœ«å°¾æ‰åœ</span></span><br><span class="line">    <span class="keyword">while</span> (p2 != end) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤§äºkeyå€¼æ—¶ï¼Œp1å‘å‰èµ°ä¸€æ­¥ï¼Œäº¤æ¢p1ä¸p2çš„å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (p2.val &lt; head.val) &#123;</span><br><span class="line">            p1 = p1.next;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> temp = p1.val;</span><br><span class="line">            p1.val = p2.val;</span><br><span class="line">            p2.val = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å½“æœ‰åºæ—¶ï¼Œä¸äº¤æ¢p1å’Œkeyå€¼</span></span><br><span class="line">    <span class="keyword">if</span> (p1 != head) &#123;</span><br><span class="line">        <span class="keyword">int</span> temp = p1.val;</span><br><span class="line">        p1.val = head.val;</span><br><span class="line">        head.val = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h1><p>å½’å¹¶æ’åºåº”è¯¥ç®—æ˜¯é“¾è¡¨æ’åºæœ€ä½³çš„é€‰æ‹©äº†ï¼Œä¿è¯äº†æœ€å¥½å’Œæœ€åæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯nlognï¼Œè€Œä¸”å®ƒåœ¨æ•°ç»„æ’åºä¸­å¹¿å—è¯Ÿç—…çš„ç©ºé—´å¤æ‚åº¦åœ¨é“¾è¡¨æ’åºä¸­ä¹Ÿä»O(n)é™åˆ°äº†O(1)ã€‚</p><p>å½’å¹¶æ’åºçš„ä¸€èˆ¬æ­¥éª¤ä¸ºï¼š</p><ol><li>å°†å¾…æ’åºæ•°ç»„ï¼ˆé“¾è¡¨ï¼‰å–ä¸­ç‚¹å¹¶ä¸€åˆ†ä¸ºäºŒï¼›</li><li>é€’å½’åœ°å¯¹å·¦åŠéƒ¨åˆ†è¿›è¡Œå½’å¹¶æ’åºï¼›</li><li>é€’å½’åœ°å¯¹å³åŠéƒ¨åˆ†è¿›è¡Œå½’å¹¶æ’åºï¼›</li><li>å°†ä¸¤ä¸ªåŠéƒ¨åˆ†è¿›è¡Œåˆå¹¶ï¼ˆmergeï¼‰,å¾—åˆ°ç»“æœã€‚</li></ol><p>é¦–å…ˆç”¨å¿«æ…¢æŒ‡é’ˆ(å¿«æ…¢æŒ‡é’ˆæ€è·¯ï¼Œå¿«æŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œå¿«æŒ‡é’ˆåœ¨é“¾è¡¨æœ«å°¾æ—¶ï¼Œæ…¢æŒ‡é’ˆæ°å¥½åœ¨é“¾è¡¨ä¸­ç‚¹)çš„æ–¹æ³•æ‰¾åˆ°é“¾è¡¨ä¸­é—´èŠ‚ç‚¹ï¼Œç„¶åé€’å½’çš„å¯¹ä¸¤ä¸ªå­é“¾è¡¨æ’åºï¼ŒæŠŠä¸¤ä¸ªæ’å¥½åºçš„å­é“¾è¡¨åˆå¹¶æˆä¸€æ¡æœ‰åºçš„é“¾è¡¨ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">sortList</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//é‡‡ç”¨å½’å¹¶æ’åº</span></span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·å–ä¸­é—´ç»“ç‚¹</span></span><br><span class="line">    ListNode mid = getMid(head);</span><br><span class="line">    ListNode right = mid.next;</span><br><span class="line">    mid.next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="comment">//åˆå¹¶</span></span><br><span class="line">    <span class="keyword">return</span> mergeSort(sortList(head), sortList(right));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹,å¶æ•°æ—¶å–ä¸­é—´ç¬¬ä¸€ä¸ª</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">getMid</span><span class="params">(ListNode head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¿«æ…¢æŒ‡é’ˆ</span></span><br><span class="line">    ListNode slow = head, quick = head;</span><br><span class="line">    <span class="comment">//å¿«2æ­¥ï¼Œæ…¢ä¸€æ­¥</span></span><br><span class="line">    <span class="keyword">while</span> (quick.next != <span class="keyword">null</span> &amp;&amp; quick.next.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        slow = slow.next;</span><br><span class="line">        quick = quick.next.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> slow;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * å½’å¹¶ä¸¤ä¸ªæœ‰åºçš„é“¾è¡¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> ListNode <span class="title">mergeSort</span><span class="params">(ListNode head1, ListNode head2)</span> </span>&#123;</span><br><span class="line">    ListNode p1 = head1, p2 = head2, head;</span><br><span class="line">   <span class="comment">//å¾—åˆ°å¤´èŠ‚ç‚¹çš„æŒ‡å‘</span></span><br><span class="line">    <span class="keyword">if</span> (head1.val &lt; head2.val) &#123;</span><br><span class="line">        head = head1;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        head = head2;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ListNode p = head;</span><br><span class="line">    <span class="comment">//æ¯”è¾ƒé“¾è¡¨ä¸­çš„å€¼</span></span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span> &amp;&amp; p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (p1.val &lt;= p2.val) &#123;</span><br><span class="line">            p.next = p1;</span><br><span class="line">            p1 = p1.next;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            p.next = p2;</span><br><span class="line">            p2 = p2.next;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬äºŒæ¡é“¾è¡¨ç©ºäº†</span></span><br><span class="line">    <span class="keyword">if</span> (p1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p.next = p1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¬¬ä¸€æ¡é“¾è¡¨ç©ºäº†</span></span><br><span class="line">    <span class="keyword">if</span> (p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p.next = p2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç æ”¾åœ¨ï¼š<br><a href="https://github.com/morethink/algorithm/blob/master/src/main/java/algorithm/leetcode/L_148_SortList.java" target="_blank" rel="noopener">https://github.com/morethink/algorithm/blob/master/src/main/java/algorithm/leetcode/L_148_SortList.java</a></p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.cnblogs.com/TenosDoIt/p/3666585.html" target="_blank" rel="noopener">é“¾è¡¨æ’åºï¼ˆå†’æ³¡ã€é€‰æ‹©ã€æ’å…¥ã€å¿«æ’ã€å½’å¹¶ã€å¸Œå°”ã€å †æ’åºï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaå®ç°å…«å¤§æ’åºç®—æ³•</title>
      <link href="/Java%E5%AE%9E%E7%8E%B0%E5%85%AB%E5%A4%A7%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"/>
      <url>/Java%E5%AE%9E%E7%8E%B0%E5%85%AB%E5%A4%A7%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å¯¹å¸¸è§çš„æ’åºç®—æ³•è¿›è¡Œäº†æ€»ç»“ã€‚</p><p>å¸¸è§æ’åºç®—æ³•å¦‚ä¸‹ï¼š</p><ol><li><a href="#ç›´æ¥æ’å…¥æ’åº">ç›´æ¥æ’å…¥æ’åº</a></li><li><a href="#å¸Œå°”æ’åº">å¸Œå°”æ’åº</a></li><li><a href="#ç®€å•é€‰æ‹©æ’åº">ç®€å•é€‰æ‹©æ’åº</a></li><li><a href="#å †æ’åº">å †æ’åº</a></li><li><a href="#å†’æ³¡æ’åº">å†’æ³¡æ’åº</a></li><li><a href="#å¿«é€Ÿæ’åº">å¿«é€Ÿæ’åº</a></li><li><a href="#å½’å¹¶æ’åº">å½’å¹¶æ’åº</a></li><li><a href="#åŸºæ•°æ’åº">åŸºæ•°æ’åº</a></li></ol><a id="more"></a><p>å®ƒä»¬éƒ½å±äºå†…éƒ¨æ’åºï¼Œä¹Ÿå°±æ˜¯åªè€ƒè™‘æ•°æ®é‡è¾ƒå°ä»…éœ€è¦ä½¿ç”¨å†…å­˜çš„æ’åºç®—æ³•ï¼Œä»–ä»¬ä¹‹é—´å…³ç³»å¦‚ä¸‹ï¼š<br>$$<br>\begin{cases}å†…éƒ¨æ’åº \begin{cases}æ’å…¥æ’åº\begin{cases}ç›´æ¥æ’å…¥æ’åº\å¸Œå°”æ’åº\end{cases}\é€‰æ‹©æ’åº\begin{cases}ç®€å•é€‰æ‹©æ’åº\å †æ’åº\end{cases}\äº¤æ¢æ’åº\begin{cases}å†’æ³¡æ’åº\å¿«é€Ÿæ’åº \end{cases}\å½’å¹¶æ’åº\<br>åŸºæ•°æ’åº\end{cases}\å¤–éƒ¨æ’åº \end{cases}<br>$$</p><p>$$<br>\left{\begin{matrix}<br>å†…éƒ¨æ’åº\<br>å¤–éƒ¨æ’åº<br>\end{matrix}\right.<br>$$</p><p><strong>ç¨³å®šä¸éç¨³å®š</strong>:</p><p>å¦‚æœä¸€ä¸ªæ’åºç®—æ³•èƒ½å¤Ÿä¿ç•™æ•°ç»„ä¸­é‡å¤å…ƒç´ çš„ç›¸å¯¹ä½ç½®åˆ™å¯ä»¥è¢«ç§°ä¸ºæ˜¯ <strong>ç¨³å®š</strong> çš„ã€‚åä¹‹ï¼Œåˆ™æ˜¯ <strong>éç¨³å®š</strong> çš„ã€‚</p><h1 id="ç›´æ¥æ’å…¥æ’åº"><a href="#ç›´æ¥æ’å…¥æ’åº" class="headerlink" title="ç›´æ¥æ’å…¥æ’åº"></a>ç›´æ¥æ’å…¥æ’åº</h1><h2 id="åŸºæœ¬æ€æƒ³"><a href="#åŸºæœ¬æ€æƒ³" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>é€šå¸¸äººä»¬æ•´ç†æ¡¥ç‰Œçš„æ–¹æ³•æ˜¯ä¸€å¼ ä¸€å¼ çš„æ¥ï¼Œå°†æ¯ä¸€å¼ ç‰Œæ’å…¥åˆ°å…¶ä»–å·²ç»æœ‰åºçš„ç‰Œä¸­çš„é€‚å½“ä½ç½®ã€‚åœ¨è®¡ç®—æœºçš„å®ç°ä¸­ï¼Œä¸ºäº†è¦ç»™æ’å…¥çš„å…ƒç´ è…¾å‡ºç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶ä½™æ‰€æœ‰å…ƒç´ åœ¨æ’å…¥ä¹‹å‰éƒ½å‘å³ç§»åŠ¨ä¸€ä½ã€‚</p><h2 id="ç®—æ³•æè¿°"><a href="#ç®—æ³•æè¿°" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š</p><ol><li>ä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åº</li><li>å–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æ</li><li>å¦‚æœè¯¥å…ƒç´ ï¼ˆå·²æ’åºï¼‰å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®</li><li>é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®</li><li>å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®å</li><li>é‡å¤æ­¥éª¤2~5</li></ol><p>åŠ¨æ€æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://images.morethink.cn/28749729-ca072084-7503-11e7-881c-92aa915ce369.gif" alt=""></p><p><strong>æ³¨æ„</strong>ï¼š<br>å¦‚æœ <em>æ¯”è¾ƒæ“ä½œ</em> çš„ä»£ä»·æ¯” <em>äº¤æ¢æ“ä½œ</em> å¤§çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨<a href="https://zh.wikipedia.org/wiki/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E6%B3%95" target="_blank" rel="noopener">äºŒåˆ†æŸ¥æ‰¾æ³•</a>æ¥å‡å°‘ <em>æ¯”è¾ƒæ“ä½œ</em> çš„æ•°ç›®ã€‚è¯¥ç®—æ³•å¯ä»¥è®¤ä¸ºæ˜¯ <strong>æ’å…¥æ’åº</strong> çš„ä¸€ä¸ªå˜ç§ï¼Œç§°ä¸º<a href="https://zh.wikipedia.org/w/index.php?title=%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F&amp;action=edit&amp;redlink=1" target="_blank" rel="noopener">äºŒåˆ†æŸ¥æ‰¾æ’å…¥æ’åº</a>ã€‚</p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡äº¤æ¢è¿›è¡Œæ’å…¥æ’åºï¼Œå€Ÿé‰´å†’æ³¡æ’åº</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &gt; <span class="number">0</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &lt; a[j - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = a[j];</span><br><span class="line">                a[j] = a[j - <span class="number">1</span>];</span><br><span class="line">                a[j - <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šè¿‡å°†è¾ƒå¤§çš„å…ƒç´ éƒ½å‘å³ç§»åŠ¨è€Œä¸æ€»æ˜¯äº¤æ¢ä¸¤ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort2</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> num = a[i];</span><br><span class="line">        <span class="keyword">int</span> j;</span><br><span class="line">        <span class="keyword">for</span> (j = i; j &gt; <span class="number">0</span> &amp;&amp; num &lt; a[j]; j--) &#123;</span><br><span class="line">            a[j] = a[j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ"><a href="#å¤æ‚åº¦åˆ†æ" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ç›´æ¥æ’å…¥æ’åºå¤æ‚åº¦å¦‚ä¸‹ï¼š</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(1)</td></tr></tbody></table><h2 id="æ¯”è¾ƒä¸æ€»ç»“"><a href="#æ¯”è¾ƒä¸æ€»ç»“" class="headerlink" title="æ¯”è¾ƒä¸æ€»ç»“"></a>æ¯”è¾ƒä¸æ€»ç»“</h2><p>æ’å…¥æ’åºæ‰€éœ€çš„æ—¶é—´å–å†³äºè¾“å…¥å…ƒç´ çš„åˆå§‹é¡ºåºã€‚ä¾‹å¦‚ï¼Œå¯¹ä¸€ä¸ªå¾ˆå¤§ä¸”å…¶ä¸­çš„å…ƒç´ å·²ç»æœ‰åº(æˆ–æ¥è¿‘æœ‰åº)çš„æ•°ç»„è¿›è¡Œæ’åºå°†ä¼šæ¯”éšæœºé¡ºåºçš„æ•°ç»„æˆ–æ˜¯é€†åºæ•°ç»„è¿›è¡Œæ’åºè¦å¿«å¾—å¤šã€‚</p><h1 id="å¸Œå°”æ’åº"><a href="#å¸Œå°”æ’åº" class="headerlink" title="å¸Œå°”æ’åº"></a>å¸Œå°”æ’åº</h1><p>å¸Œå°”æ’åºï¼Œä¹Ÿç§° <strong>é€’å‡å¢é‡æ’åºç®—æ³•</strong>ï¼Œæ˜¯æ’å…¥æ’åºçš„ä¸€ç§æ›´é«˜æ•ˆçš„æ”¹è¿›ç‰ˆæœ¬ã€‚å¸Œå°”æ’åºæ˜¯ <strong>éç¨³å®šæ’åºç®—æ³•</strong>ã€‚</p><p>å¸Œå°”æ’åºæ˜¯åŸºäºæ’å…¥æ’åºçš„ä»¥ä¸‹ä¸¤ç‚¹æ€§è´¨è€Œæå‡ºæ”¹è¿›æ–¹æ³•çš„ï¼š</p><ul><li>æ’å…¥æ’åºåœ¨å¯¹å‡ ä¹å·²ç»æ’å¥½åºçš„æ•°æ®æ“ä½œæ—¶ï¼Œæ•ˆç‡é«˜ï¼Œå³å¯ä»¥è¾¾åˆ°çº¿æ€§æ’åºçš„æ•ˆç‡</li><li>ä½†æ’å…¥æ’åºä¸€èˆ¬æ¥è¯´æ˜¯ä½æ•ˆçš„ï¼Œå› ä¸ºæ’å…¥æ’åºæ¯æ¬¡åªèƒ½å°†æ•°æ®ç§»åŠ¨ä¸€</li></ul><p>å¸Œå°”æ’åºæ˜¯å…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå¾…æ•´ä¸ªåºåˆ—ä¸­çš„è®°å½•â€œåŸºæœ¬æœ‰åºâ€æ—¶ï¼Œå†å¯¹å…¨ä½“è®°å½•è¿›è¡Œä¾æ¬¡ç›´æ¥æ’å…¥æ’åºã€‚</p><h2 id="åŸºæœ¬æ€æƒ³-1"><a href="#åŸºæœ¬æ€æƒ³-1" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å°†å¾…æ’åºæ•°ç»„æŒ‰ç…§æ­¥é•¿gapè¿›è¡Œåˆ†ç»„ï¼Œç„¶åå°†æ¯ç»„çš„å…ƒç´ åˆ©ç”¨ç›´æ¥æ’å…¥æ’åºçš„æ–¹æ³•è¿›è¡Œæ’åºï¼›æ¯æ¬¡å†å°†gapæŠ˜åŠå‡å°ï¼Œå¾ªç¯ä¸Šè¿°æ“ä½œï¼›å½“gap=1æ—¶ï¼Œåˆ©ç”¨ç›´æ¥æ’å…¥ï¼Œå®Œæˆæ’åºã€‚</p><p>å¯ä»¥çœ‹åˆ°æ­¥é•¿çš„é€‰æ‹©æ˜¯å¸Œå°”æ’åºçš„é‡è¦éƒ¨åˆ†ã€‚åªè¦æœ€ç»ˆæ­¥é•¿ä¸º1ä»»ä½•æ­¥é•¿åºåˆ—éƒ½å¯ä»¥å·¥ä½œã€‚ä¸€èˆ¬æ¥è¯´æœ€ç®€å•çš„æ­¥é•¿å–å€¼æ˜¯<strong>åˆæ¬¡å–æ•°ç»„é•¿åº¦çš„ä¸€åŠ</strong>ä¸ºå¢é‡ï¼Œä¹‹åæ¯æ¬¡å†å‡åŠï¼Œç›´åˆ°å¢é‡ä¸º1ã€‚æ›´å¥½çš„æ­¥é•¿åºåˆ—å–å€¼å¯ä»¥å‚è€ƒ<a href="https://zh.wikipedia.org/wiki/%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F#.E6.AD.A5.E9.95.BF.E5.BA.8F.E5.88.97" target="_blank" rel="noopener">ç»´åŸºç™¾ç§‘</a>ã€‚</p><h2 id="ç®—æ³•æè¿°-1"><a href="#ç®—æ³•æè¿°-1" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><ol><li>é€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ— t1ï¼Œt2ï¼Œâ€¦â€¦ï¼Œtkï¼Œå…¶ä¸­ ti &gt; tj, tk = 1ï¼›</li><li>æŒ‰å¢é‡åºåˆ—ä¸ªæ•° kï¼Œå¯¹åºåˆ—è¿›è¡Œ k è¶Ÿæ’åºï¼›</li><li>æ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡ tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸º m çš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º 1 æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚</li></ol><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://images.morethink.cn/4697893fd8a952d01956e192640c1c3c.png" alt=""></p><h2 id="ä»£ç å®ç°-1"><a href="#ä»£ç å®ç°-1" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä¸‹é¢å‚è€ƒã€Šç®—æ³•ã€‹ä¸­ç»™å‡ºçš„æ­¥é•¿é€‰æ‹©ç­–ç•¥ï¼Œã€Šç®—æ³•ã€‹ä¸­ç»™å‡ºçš„è§£é‡Šæ˜¯</p><blockquote><p>ä¸‹é¢ä»£ç ä¸­é€’å¢åºåˆ—çš„è®¡ç®—å’Œä½¿ç”¨éƒ½å¾ˆç®€å•ï¼Œå’Œå¤æ‚é€’å¢åºåˆ—çš„æ€§èƒ½æ¥è¿‘ã€‚å½“å¯ä»¥è¯æ˜å¤æ‚çš„åºåˆ—åœ¨æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½è¦å¥½äºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„é€’å¢åºåˆ—ã€‚æ›´åŠ ä¼˜ç§€çš„é€’å¢åºåˆ—æœ‰å¾…æˆ‘ä»¬å»å‘ç°ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> length = a.length;</span><br><span class="line">    <span class="keyword">int</span> h = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (h &lt; length / <span class="number">3</span>) h = <span class="number">3</span> * h + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; h &gt;= <span class="number">1</span>; h /= <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length - h; i += h) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + h; j &gt; <span class="number">0</span>; j -= h) &#123;</span><br><span class="line">                <span class="keyword">if</span> (a[j] &lt; a[j - h]) &#123;</span><br><span class="line">                    <span class="keyword">int</span> temp = a[j];</span><br><span class="line">                    a[j] = a[j - h];</span><br><span class="line">                    a[j - h] = temp;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-1"><a href="#å¤æ‚åº¦åˆ†æ-1" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯å¸Œå°”æ’åºå¤æ‚åº¦:</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nlog2 n)</td><td>O(nlog2 n)</td><td>O(nlog2 n)</td><td>O(1)</td></tr></tbody></table><h2 id="æ€»ç»“ä¸æ€è€ƒ"><a href="#æ€»ç»“ä¸æ€è€ƒ" class="headerlink" title="æ€»ç»“ä¸æ€è€ƒ"></a>æ€»ç»“ä¸æ€è€ƒ</h2><p>å¸Œå°”æ’åºæ›´é«˜æ•ˆçš„åŸå› æ˜¯å®ƒæƒè¡¡äº†å­æ•°ç»„çš„è§„æ¨¡å’Œæœ‰åºæ€§ã€‚æ’åºä¹‹åˆï¼Œå„ä¸ªå­æ•°ç»„éƒ½å¾ˆçŸ­ï¼Œæ’åºä¹‹åå­æ•°ç»„éƒ½æ˜¯éƒ¨åˆ†æœ‰åºçš„ï¼Œè¿™ä¸¤ç§æƒ…å†µéƒ½å¾ˆé€‚åˆæ’å…¥æ’åºã€‚</p><h1 id="ç®€å•é€‰æ‹©æ’åº"><a href="#ç®€å•é€‰æ‹©æ’åº" class="headerlink" title="ç®€å•é€‰æ‹©æ’åº"></a>ç®€å•é€‰æ‹©æ’åº</h1><h2 id="åŸºæœ¬æ€æƒ³-2"><a href="#åŸºæœ¬æ€æƒ³-2" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>é€‰æ‹©æ’åºï¼ˆSelection sortï¼‰æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•ã€‚å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ã€‚é¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç„¶åï¼Œå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°ï¼ˆå¤§ï¼‰å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ã€‚</p><p>é€‰æ‹©æ’åºçš„ä¸»è¦ä¼˜ç‚¹ä¸æ•°æ®ç§»åŠ¨æœ‰å…³ã€‚å¦‚æœæŸä¸ªå…ƒç´ ä½äºæ­£ç¡®çš„æœ€ç»ˆä½ç½®ä¸Šï¼Œåˆ™å®ƒä¸ä¼šè¢«ç§»åŠ¨ã€‚é€‰æ‹©æ’åºæ¯æ¬¡äº¤æ¢ä¸€å¯¹å…ƒç´ ï¼Œå®ƒä»¬å½“ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå°†è¢«ç§»åˆ°å…¶æœ€ç»ˆä½ç½®ä¸Šï¼Œå› æ­¤å¯¹ nä¸ªå…ƒç´ çš„è¡¨è¿›è¡Œæ’åºæ€»å…±è¿›è¡Œè‡³å¤š n-1 æ¬¡äº¤æ¢ã€‚åœ¨æ‰€æœ‰çš„å®Œå…¨ä¾é äº¤æ¢å»ç§»åŠ¨å…ƒç´ çš„æ’åºæ–¹æ³•ä¸­ï¼Œé€‰æ‹©æ’åºå±äºéå¸¸å¥½çš„ä¸€ç§ã€‚</p><h2 id="ç®—æ³•æè¿°-2"><a href="#ç®—æ³•æè¿°-2" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><ol><li>ä»æœªæ’åºåºåˆ—ä¸­ï¼Œæ‰¾åˆ°å…³é”®å­—æœ€å°çš„å…ƒç´ </li><li>å¦‚æœæœ€å°å…ƒç´ ä¸æ˜¯æœªæ’åºåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå°†å…¶å’Œæœªæ’åºåºåˆ—ç¬¬ä¸€ä¸ªå…ƒç´ äº’æ¢</li><li>é‡å¤1ã€2æ­¥ï¼Œç›´åˆ°æ’åºç»“æŸã€‚</li></ol><p>åŠ¨å›¾æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š<br><img src="https://images.morethink.cn/28749720-90304278-7503-11e7-9bc8-e3b56539d8bf.gif" alt=""></p><h2 id="ä»£ç å®ç°-2"><a href="#ä»£ç å®ç°-2" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> min = i;</span><br><span class="line">        <span class="comment">//é€‰å‡ºä¹‹åå¾…æ’åºä¸­å€¼æœ€å°çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; a.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &lt; a[min]) &#123;</span><br><span class="line">                min = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æœ€å°å€¼ä¸ç­‰äºå½“å‰å€¼æ—¶è¿›è¡Œäº¤æ¢</span></span><br><span class="line">        <span class="keyword">if</span> (min != i) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = a[i];</span><br><span class="line">            a[i] = a[min];</span><br><span class="line">            a[min] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-2"><a href="#å¤æ‚åº¦åˆ†æ-2" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯é€‰æ‹©æ’åºå¤æ‚åº¦:</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(1)</td></tr></tbody></table><h2 id="æ€»ç»“ä¸æ€è€ƒ-1"><a href="#æ€»ç»“ä¸æ€è€ƒ-1" class="headerlink" title="æ€»ç»“ä¸æ€è€ƒ"></a>æ€»ç»“ä¸æ€è€ƒ</h2><p>é€‰æ‹©æ’åºçš„ç®€å•å’Œç›´è§‚åå‰¯å…¶å®ï¼Œè¿™ä¹Ÿé€ å°±äº†å®ƒâ€å‡ºäº†åçš„æ…¢æ€§å­â€ï¼Œæ— è®ºæ˜¯å“ªç§æƒ…å†µï¼Œå“ªæ€•åŸæ•°ç»„å·²æ’åºå®Œæˆï¼Œå®ƒä¹Ÿå°†èŠ±è´¹å°†è¿‘nÂ²/2æ¬¡éå†æ¥ç¡®è®¤ä¸€éã€‚å³ä¾¿æ˜¯è¿™æ ·ï¼Œå®ƒçš„æ’åºç»“æœä¹Ÿè¿˜æ˜¯ä¸ç¨³å®šçš„ã€‚ å”¯ä¸€å€¼å¾—é«˜å…´çš„æ˜¯ï¼Œå®ƒå¹¶ä¸è€—è´¹é¢å¤–çš„å†…å­˜ç©ºé—´ã€‚</p><h1 id="å †æ’åº"><a href="#å †æ’åº" class="headerlink" title="å †æ’åº"></a>å †æ’åº</h1><blockquote><p>1991å¹´çš„è®¡ç®—æœºå…ˆé©±å¥–è·å¾—è€…ã€æ–¯å¦ç¦å¤§å­¦è®¡ç®—æœºç§‘å­¦ç³»æ•™æˆç½—ä¼¯ç‰¹Â·å¼—æ´›ä¼Šå¾·(Robert Wï¼Floyd) å’Œå¨å»‰å§†æ–¯(Jï¼Williams) åœ¨1964å¹´å…±åŒå‘æ˜äº†è‘—åçš„å †æ’åºç®—æ³•(Heap Sort).</p></blockquote><p>å †çš„å®šä¹‰å¦‚ä¸‹ï¼š$n$ä¸ªå…ƒç´ çš„åºåˆ—{k1,k2,..,kn}<br>å½“ä¸”ä»…å½“æ»¡è¶³ä¸‹å…³ç³»æ—¶ï¼Œç§°ä¹‹ä¸ºå †ã€‚</p><p><img src="https://images.morethink.cn/a59e9c9d21c72944dac53b59b745a5cc.png" alt=""></p><p>æŠŠæ­¤åºåˆ—å¯¹åº”çš„äºŒç»´æ•°ç»„çœ‹æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ã€‚é‚£ä¹ˆå †çš„å«ä¹‰å°±æ˜¯ï¼š<strong>å®Œå…¨äºŒå‰æ ‘ä¸­ä»»ä½•ä¸€ä¸ªéå¶å­èŠ‚ç‚¹çš„å€¼å‡ä¸å¤§äºï¼ˆæˆ–ä¸å°äºï¼‰å…¶å·¦ï¼Œå³å­©å­èŠ‚ç‚¹çš„å€¼ã€‚</strong> ç”±ä¸Šè¿°æ€§è´¨å¯çŸ¥å¤§é¡¶å †çš„å †é¡¶çš„å…³é”®å­—è‚¯å®šæ˜¯æ‰€æœ‰å…³é”®å­—ä¸­æœ€å¤§çš„ï¼Œå°é¡¶å †çš„å †é¡¶çš„å…³é”®å­—æ˜¯æ‰€æœ‰å…³é”®å­—ä¸­æœ€å°çš„ã€‚å› æ­¤æˆ‘ä»¬å¯ä½¿ç”¨å¤§é¡¶å †è¿›è¡Œå‡åºæ’åº, ä½¿ç”¨å°é¡¶å †è¿›è¡Œé™åºæ’åºã€‚</p><h2 id="åŸºæœ¬æ€æƒ³-3"><a href="#åŸºæœ¬æ€æƒ³-3" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>æ­¤å¤„ä»¥å¤§é¡¶å †ä¸ºä¾‹ï¼Œå †æ’åºçš„è¿‡ç¨‹å°±æ˜¯å°†å¾…æ’åºçš„åºåˆ—æ„é€ æˆä¸€ä¸ªå †ï¼Œé€‰å‡ºå †ä¸­æœ€å¤§çš„ç§»èµ°ï¼Œå†æŠŠå‰©ä½™çš„å…ƒç´ è°ƒæ•´æˆå †ï¼Œæ‰¾å‡ºæœ€å¤§çš„å†ç§»èµ°ï¼Œé‡å¤ç›´è‡³æœ‰åºã€‚</p><h2 id="ç®—æ³•æè¿°-3"><a href="#ç®—æ³•æè¿°-3" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><ol><li>å…ˆå°†åˆå§‹åºåˆ—$K[1..n]$å»ºæˆä¸€ä¸ªå¤§é¡¶å †, é‚£ä¹ˆæ­¤æ—¶ç¬¬ä¸€ä¸ªå…ƒç´ $K_1$æœ€å¤§, æ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒº.</li><li>å†å°†å…³é”®å­—æœ€å¤§çš„è®°å½•$K_1$ (å³å †é¡¶, ç¬¬ä¸€ä¸ªå…ƒç´ )å’Œæ— åºåŒºçš„æœ€åä¸€ä¸ªè®°å½• $K_n$ äº¤æ¢, ç”±æ­¤å¾—åˆ°æ–°çš„æ— åºåŒº$K[1..n-1]$å’Œæœ‰åºåŒº$K[n]$, ä¸”æ»¡è¶³$K[1..n-1].keys \leqslant K[n].key$</li><li>äº¤æ¢$K_1$ å’Œ $K_n$ å, å †é¡¶å¯èƒ½è¿åå †æ€§è´¨, å› æ­¤éœ€å°†$K[1..n-1]$è°ƒæ•´ä¸ºå †. ç„¶åé‡å¤æ­¥éª¤2, ç›´åˆ°æ— åºåŒºåªæœ‰ä¸€ä¸ªå…ƒç´ æ—¶åœæ­¢ã€‚</li></ol><p>åŠ¨å›¾æ•ˆæœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="https://images.morethink.cn/heap_sort_gif.gif" alt="å †æ’åºè¿‡ç¨‹"></p><h2 id="ä»£ç å®ç°-3"><a href="#ä»£ç å®ç°-3" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ä»ç®—æ³•æè¿°æ¥çœ‹ï¼Œå †æ’åºéœ€è¦ä¸¤ä¸ªè¿‡ç¨‹ï¼Œä¸€æ˜¯å»ºç«‹å †ï¼ŒäºŒæ˜¯å †é¡¶ä¸å †çš„æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ä½ç½®ã€‚æ‰€ä»¥å †æ’åºæœ‰ä¸¤ä¸ªå‡½æ•°ç»„æˆã€‚ä¸€æ˜¯å»ºå †å‡½æ•°ï¼ŒäºŒæ˜¯åå¤è°ƒç”¨å»ºå †å‡½æ•°ä»¥é€‰æ‹©å‡ºå‰©ä½™æœªæ’å…ƒç´ ä¸­æœ€å¤§çš„æ•°æ¥å®ç°æ’åºçš„å‡½æ•°ã€‚</p><p>æ€»ç»“èµ·æ¥å°±æ˜¯å®šä¹‰äº†ä»¥ä¸‹å‡ ç§æ“ä½œï¼š</p><ul><li>æœ€å¤§å †è°ƒæ•´ï¼ˆMax_Heapifyï¼‰ï¼šå°†å †çš„æœ«ç«¯å­èŠ‚ç‚¹ä½œè°ƒæ•´ï¼Œä½¿å¾—å­èŠ‚ç‚¹æ°¸è¿œå°äºçˆ¶èŠ‚ç‚¹</li><li>åˆ›å»ºæœ€å¤§å †ï¼ˆBuild_Max_Heapï¼‰ï¼šå°†å †æ‰€æœ‰æ•°æ®é‡æ–°æ’åº</li><li>å †æ’åºï¼ˆHeapSortï¼‰ï¼šç§»é™¤ä½åœ¨ç¬¬ä¸€ä¸ªæ•°æ®çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶åšæœ€å¤§å †è°ƒæ•´çš„é€’å½’è¿ç®—</li></ul><p>å¯¹äºå †èŠ‚ç‚¹çš„è®¿é—®ï¼š</p><ul><li>çˆ¶èŠ‚ç‚¹içš„å·¦å­èŠ‚ç‚¹åœ¨ä½ç½®ï¼š<code>(2*i+1)</code>;</li><li>çˆ¶èŠ‚ç‚¹içš„å³å­èŠ‚ç‚¹åœ¨ä½ç½®ï¼š<code>(2*i+2)</code>;</li><li>å­èŠ‚ç‚¹içš„çˆ¶èŠ‚ç‚¹åœ¨ä½ç½®ï¼š<code>floor((i-1)/2)</code>;</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = a.length - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        max_heapify(a, i);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å †é¡¶å…ƒç´ (ç¬¬ä¸€ä¸ªå…ƒç´ )ä¸Knäº¤æ¢</span></span><br><span class="line">        <span class="keyword">int</span> temp = a[<span class="number">0</span>];</span><br><span class="line">        a[<span class="number">0</span>] = a[i];</span><br><span class="line">        a[i] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *  å°†æ•°ç»„å †åŒ–</span></span><br><span class="line"><span class="comment"> *  i = ç¬¬ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment"> *  ä»ç¬¬ä¸€ä¸ªéå¶å­èŠ‚ç‚¹å¼€å§‹å³å¯ã€‚æ— éœ€ä»æœ€åä¸€ä¸ªå¶å­èŠ‚ç‚¹å¼€å§‹ã€‚</span></span><br><span class="line"><span class="comment"> *  å¶å­èŠ‚ç‚¹å¯ä»¥çœ‹ä½œå·²ç¬¦åˆå †è¦æ±‚çš„èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹å°±æ˜¯å®ƒè‡ªå·±ä¸”è‡ªå·±ä»¥ä¸‹å€¼ä¸ºæœ€å¤§ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> a</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> n</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">max_heapify</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> child;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = (n - <span class="number">1</span>) / <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="comment">//å·¦å­èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line">        child = <span class="number">2</span> * i + <span class="number">1</span>;</span><br><span class="line">        <span class="comment">//å³å­èŠ‚ç‚¹å­˜åœ¨ä¸”å¤§äºå·¦å­èŠ‚ç‚¹ï¼Œchildå˜æˆå³å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (child != n &amp;&amp; a[child] &lt; a[child + <span class="number">1</span>]) &#123;</span><br><span class="line">            child++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//äº¤æ¢çˆ¶èŠ‚ç‚¹ä¸å·¦å³å­èŠ‚ç‚¹ä¸­çš„æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (a[i] &lt; a[child]) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = a[i];</span><br><span class="line">            a[i] = a[child];</span><br><span class="line">            a[child] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-3"><a href="#å¤æ‚åº¦åˆ†æ-3" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><ol><li>å»ºç«‹å †çš„è¿‡ç¨‹, ä»length/2 ä¸€ç›´å¤„ç†åˆ°0, æ—¶é—´å¤æ‚åº¦ä¸ºO(n);</li><li>è°ƒæ•´å †çš„è¿‡ç¨‹æ˜¯æ²¿ç€å †çš„çˆ¶å­èŠ‚ç‚¹è¿›è¡Œè°ƒæ•´, æ‰§è¡Œæ¬¡æ•°ä¸ºå †çš„æ·±åº¦, æ—¶é—´å¤æ‚åº¦ä¸ºO(lgn);</li><li>å †æ’åºçš„è¿‡ç¨‹ç”±næ¬¡ç¬¬2æ­¥å®Œæˆ, æ—¶é—´å¤æ‚åº¦ä¸ºO(nlgn).</li></ol><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>$O(n \log_{2}n)$</td><td>$O(n \log_{2}n)$</td><td>$O(n \log_{2}n)$</td><td>$O(1)$</td></tr></tbody></table><h2 id="æ€»ç»“ä¸æ€è€ƒ-2"><a href="#æ€»ç»“ä¸æ€è€ƒ-2" class="headerlink" title="æ€»ç»“ä¸æ€è€ƒ"></a>æ€»ç»“ä¸æ€è€ƒ</h2><p><strong>ç”±äºå †æ’åºä¸­åˆå§‹åŒ–å †çš„è¿‡ç¨‹æ¯”è¾ƒæ¬¡æ•°è¾ƒå¤š, å› æ­¤å®ƒä¸å¤ªé€‚ç”¨äºå°åºåˆ—</strong>ã€‚ åŒæ—¶ç”±äºå¤šæ¬¡ä»»æ„ä¸‹æ ‡ç›¸äº’äº¤æ¢ä½ç½®, ç›¸åŒå…ƒç´ ä¹‹é—´åŸæœ¬ç›¸å¯¹çš„é¡ºåºè¢«ç ´åäº†, å› æ­¤, å®ƒæ˜¯ä¸ç¨³å®šçš„æ’åºã€‚</p><h1 id="å†’æ³¡æ’åº"><a href="#å†’æ³¡æ’åº" class="headerlink" title="å†’æ³¡æ’åº"></a>å†’æ³¡æ’åº</h1><blockquote><p>æˆ‘æƒ³å¯¹äºå®ƒæ¯ä¸ªå­¦è¿‡Cè¯­è¨€çš„éƒ½ä¼šäº†è§£ï¼Œè¿™å¯èƒ½æ˜¯å¾ˆå¤šäººæ¥è§¦çš„ç¬¬ä¸€ä¸ªæ’åºç®—æ³•ã€‚</p></blockquote><h2 id="åŸºæœ¬æ€æƒ³-4"><a href="#åŸºæœ¬æ€æƒ³-4" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰æ˜¯ä¸€ç§ç®€å•çš„æ’åºç®—æ³•ã€‚å®ƒé‡å¤åœ°èµ°è®¿è¿‡è¦æ’åºçš„æ•°åˆ—ï¼Œä¸€æ¬¡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœä»–ä»¬çš„é¡ºåºé”™è¯¯å°±æŠŠä»–ä»¬äº¤æ¢è¿‡æ¥ã€‚èµ°è®¿æ•°åˆ—çš„å·¥ä½œæ˜¯é‡å¤åœ°è¿›è¡Œç›´åˆ°æ²¡æœ‰å†éœ€è¦äº¤æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´è¯¥æ•°åˆ—å·²ç»æ’åºå®Œæˆã€‚è¿™ä¸ªç®—æ³•çš„åå­—ç”±æ¥æ˜¯å› ä¸ºè¶Šå°çš„å…ƒç´ ä¼šç»ç”±äº¤æ¢æ…¢æ…¢â€œæµ®â€åˆ°æ•°åˆ—çš„é¡¶ç«¯ã€‚</p><h2 id="ç®—æ³•æè¿°-4"><a href="#ç®—æ³•æè¿°-4" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p>å†’æ³¡æ’åºç®—æ³•çš„è¿ä½œå¦‚ä¸‹ï¼š</p><ol><li>æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ ã€‚å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢ä»–ä»¬ä¸¤ä¸ªã€‚</li><li>å¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ã€‚è¿™æ­¥åšå®Œåï¼Œæœ€åçš„å…ƒç´ ä¼šæ˜¯æœ€å¤§çš„æ•°ã€‚</li><li>é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªã€‚</li><li>æŒç»­æ¯æ¬¡å¯¹è¶Šæ¥è¶Šå°‘çš„å…ƒç´ é‡å¤ä¸Šé¢çš„æ­¥éª¤ï¼Œç›´åˆ°æ²¡æœ‰ä»»ä½•ä¸€å¯¹æ•°å­—éœ€è¦æ¯”è¾ƒã€‚</li></ol><p><img src="https://images.morethink.cn/bubble.gif" alt=""></p><h2 id="ä»£ç å®ç°-4"><a href="#ä»£ç å®ç°-4" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¤–å±‚å¾ªç¯æ§åˆ¶æ¯”è¾ƒçš„æ¬¡æ•°</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">      <span class="comment">//å†…å±‚å¾ªç¯æ§åˆ¶åˆ°è¾¾ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; a.length - i - <span class="number">1</span>; j++) &#123;</span><br><span class="line">            <span class="comment">//å‰é¢çš„å…ƒç´ æ¯”åé¢å¤§å°±äº¤æ¢</span></span><br><span class="line">            <span class="keyword">if</span> (a[j] &gt; a[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = a[j];</span><br><span class="line">                a[j] = a[j + <span class="number">1</span>];</span><br><span class="line">                a[j + <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-4"><a href="#å¤æ‚åº¦åˆ†æ-4" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯å†’æ³¡æ’åºç®—æ³•å¤æ‚åº¦:</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nÂ²)</td><td>O(n)</td><td>O(nÂ²)</td><td>O(1)</td></tr></tbody></table><p>å†’æ³¡æ’åºæ˜¯æœ€å®¹æ˜“å®ç°çš„æ’åº, æœ€åçš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½éœ€è¦äº¤æ¢, å…±éœ€éå†å¹¶äº¤æ¢å°†è¿‘nÂ²/2æ¬¡, æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). æœ€ä½³çš„æƒ…å†µæ˜¯å†…å¾ªç¯éå†ä¸€æ¬¡åå‘ç°æ’åºæ˜¯å¯¹çš„, å› æ­¤é€€å‡ºå¾ªç¯, æ—¶é—´å¤æ‚åº¦ä¸ºO(n). å¹³å‡æ¥è®², æ—¶é—´å¤æ‚åº¦ä¸ºO(nÂ²). ç”±äºå†’æ³¡æ’åºä¸­åªæœ‰ç¼“å­˜çš„tempå˜é‡éœ€è¦å†…å­˜ç©ºé—´, å› æ­¤ç©ºé—´å¤æ‚åº¦ä¸ºå¸¸é‡O(1).</p><h2 id="æ€»ç»“ä¸æ€è€ƒ-3"><a href="#æ€»ç»“ä¸æ€è€ƒ-3" class="headerlink" title="æ€»ç»“ä¸æ€è€ƒ"></a>æ€»ç»“ä¸æ€è€ƒ</h2><p>ç”±äºå†’æ³¡æ’åºåªåœ¨ç›¸é‚»å…ƒç´ å¤§å°ä¸ç¬¦åˆè¦æ±‚æ—¶æ‰è°ƒæ¢ä»–ä»¬çš„ä½ç½®, å®ƒå¹¶ä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåº, å› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚</p><h1 id="å¿«é€Ÿæ’åº"><a href="#å¿«é€Ÿæ’åº" class="headerlink" title="å¿«é€Ÿæ’åº"></a>å¿«é€Ÿæ’åº</h1><p>å¿«é€Ÿæ’åºæ˜¯ç”±ä¸œå°¼Â·éœå°”æ‰€å‘å±•çš„ä¸€ç§æ’åºç®—æ³•ã€‚åœ¨å¹³å‡çŠ¶å†µä¸‹ï¼Œæ’åº n ä¸ªé¡¹ç›®è¦ ÎŸ(nlogn) æ¬¡æ¯”è¾ƒã€‚åœ¨æœ€åçŠ¶å†µä¸‹åˆ™éœ€è¦ ÎŸ(n2) æ¬¡æ¯”è¾ƒï¼Œä½†è¿™ç§çŠ¶å†µå¹¶ä¸å¸¸è§ã€‚äº‹å®ä¸Šï¼Œå¿«é€Ÿæ’åºé€šå¸¸æ˜æ˜¾æ¯”å…¶ä»– ÎŸ(nlogn) ç®—æ³•æ›´å¿«ï¼Œå› ä¸ºå®ƒçš„å†…éƒ¨å¾ªç¯ï¼ˆinner loopï¼‰å¯ä»¥åœ¨å¤§éƒ¨åˆ†çš„æ¶æ„ä¸Šå¾ˆæœ‰æ•ˆç‡åœ°è¢«å®ç°å‡ºæ¥ã€‚</p><h2 id="åŸºæœ¬æ€æƒ³-5"><a href="#åŸºæœ¬æ€æƒ³-5" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³ï¼š<strong>æŒ–å‘å¡«æ•°+åˆ†æ²»æ³•</strong>ã€‚</p><p>å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•ï¼ˆDivide and conquerï¼‰ç­–ç•¥æ¥æŠŠä¸€ä¸ªä¸²è¡Œï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­ä¸²è¡Œï¼ˆsub-listsï¼‰ã€‚</p><p>å¿«é€Ÿæ’åºåˆæ˜¯ä¸€ç§åˆ†è€Œæ²»ä¹‹æ€æƒ³åœ¨æ’åºç®—æ³•ä¸Šçš„å…¸å‹åº”ç”¨ã€‚æœ¬è´¨ä¸Šæ¥çœ‹ï¼Œå¿«é€Ÿæ’åºåº”è¯¥ç®—æ˜¯åœ¨å†’æ³¡æ’åºåŸºç¡€ä¸Šçš„é€’å½’åˆ†æ²»æ³•ã€‚</p><p>å¿«é€Ÿæ’åºçš„åå­—èµ·çš„æ˜¯ç®€å•ç²—æš´ï¼Œå› ä¸ºä¸€å¬åˆ°è¿™ä¸ªåå­—ä½ å°±çŸ¥é“å®ƒå­˜åœ¨çš„æ„ä¹‰ï¼Œå°±æ˜¯å¿«ï¼Œè€Œä¸”æ•ˆç‡é«˜ï¼å®ƒæ˜¯å¤„ç†å¤§æ•°æ®æœ€å¿«çš„æ’åºç®—æ³•ä¹‹ä¸€äº†ã€‚è™½ç„¶ Worst Case çš„æ—¶é—´å¤æ‚åº¦è¾¾åˆ°äº† O(nÂ²)ï¼Œä½†æ˜¯äººå®¶å°±æ˜¯ä¼˜ç§€ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æ¯”å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º O(n logn) çš„æ’åºç®—æ³•è¡¨ç°è¦æ›´å¥½ã€‚</p><h2 id="ç®—æ³•æè¿°-5"><a href="#ç®—æ³•æè¿°-5" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p>å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»ç­–ç•¥æ¥æŠŠä¸€ä¸ªåºåˆ—ï¼ˆlistï¼‰åˆ†ä¸ºä¸¤ä¸ªå­åºåˆ—ï¼ˆsub-listsï¼‰ã€‚æ­¥éª¤ä¸ºï¼š</p><ol><li>ä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºâ€åŸºå‡†â€ï¼ˆpivotï¼‰ã€‚</li><li>é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å°çš„å…ƒç´ æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰æ¯”åŸºå‡†å€¼å¤§çš„å…ƒç´ æ‘†åœ¨åŸºå‡†åé¢ï¼ˆç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹ï¼‰ã€‚åœ¨è¿™ä¸ªåˆ†åŒºç»“æŸä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ã€‚è¿™ä¸ªç§°ä¸ºåˆ†åŒºï¼ˆpartitionï¼‰æ“ä½œã€‚</li><li>é€’å½’åœ°ï¼ˆrecursivelyï¼‰æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºã€‚</li></ol><p>é€’å½’åˆ°æœ€åº•éƒ¨æ—¶ï¼Œæ•°åˆ—çš„å¤§å°æ˜¯é›¶æˆ–ä¸€ï¼Œä¹Ÿå°±æ˜¯å·²ç»æ’åºå¥½äº†ã€‚è¿™ä¸ªç®—æ³•ä¸€å®šä¼šç»“æŸï¼Œå› ä¸ºåœ¨æ¯æ¬¡çš„è¿­ä»£ï¼ˆiterationï¼‰ä¸­ï¼Œå®ƒè‡³å°‘ä¼šæŠŠä¸€ä¸ªå…ƒç´ æ‘†åˆ°å®ƒæœ€åçš„ä½ç½®å»ã€‚</p><p><img src="https://images.morethink.cn/quick-sort.gif" alt=""></p><h2 id="ä»£ç å®ç°-5"><a href="#ä»£ç å®ç°-5" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>ç”¨ä¼ªä»£ç æè¿°å¦‚ä¸‹ï¼š</p><ol><li><code>i = L; j = R;</code> å°†åŸºå‡†æ•°æŒ–å‡ºå½¢æˆç¬¬ä¸€ä¸ªå‘<code>a[i]</code>ã€‚</li><li><code>j--</code>ï¼Œç”±åå‘å‰æ‰¾æ¯”å®ƒå°çš„æ•°ï¼Œæ‰¾åˆ°åæŒ–å‡ºæ­¤æ•°å¡«å‰ä¸€ä¸ªå‘<code>a[i]</code>ä¸­ã€‚</li><li><code>i++</code>ï¼Œç”±å‰å‘åæ‰¾æ¯”å®ƒå¤§çš„æ•°ï¼Œæ‰¾åˆ°åä¹ŸæŒ–å‡ºæ­¤æ•°å¡«åˆ°å‰ä¸€ä¸ªå‘<code>a[j]</code>ä¸­ã€‚</li><li>å†é‡å¤æ‰§è¡Œ2ï¼Œ3äºŒæ­¥ï¼Œç›´åˆ°<code>i==j</code>ï¼Œå°†åŸºå‡†æ•°å¡«å…¥<code>a[i]</code>ä¸­</li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å·²ç»æ’å®Œ</span></span><br><span class="line">    <span class="keyword">if</span> (low &gt;= high) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = low;</span><br><span class="line">    <span class="keyword">int</span> right = high;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä¿å­˜åŸºå‡†å€¼</span></span><br><span class="line">    <span class="keyword">int</span> pivot = a[left];</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="comment">//ä»åå‘å‰æ‰¾åˆ°æ¯”åŸºå‡†å°çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[right] &gt;= pivot)</span><br><span class="line">            right--;</span><br><span class="line">        a[left] = a[right];</span><br><span class="line">        <span class="comment">//ä»å‰å¾€åæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[left] &lt;= pivot)</span><br><span class="line">            left++;</span><br><span class="line">        a[right] = a[left];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ”¾ç½®åŸºå‡†å€¼ï¼Œå‡†å¤‡åˆ†æ²»é€’å½’å¿«æ’</span></span><br><span class="line">    a[left] = pivot;</span><br><span class="line">    sort(a, low, left - <span class="number">1</span>);</span><br><span class="line">    sort(a, left + <span class="number">1</span>, high);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢æ˜¯é€’å½’ç‰ˆçš„å¿«é€Ÿæ’åºï¼šé€šè¿‡æŠŠåŸºå‡†æ’å…¥åˆ°åˆé€‚çš„ä½ç½®æ¥å®ç°åˆ†æ²»ï¼Œå¹¶é€’å½’åœ°å¯¹åˆ†æ²»åçš„ä¸¤ä¸ªåˆ’åˆ†ç»§ç»­å¿«æ’ã€‚é‚£ä¹ˆéé€’å½’ç‰ˆçš„å¿«æ’å¦‚ä½•å®ç°å‘¢ï¼Ÿ</p><p>å› ä¸º <strong>é€’å½’çš„æœ¬è´¨æ˜¯æ ˆ</strong> ï¼Œæ‰€ä»¥æˆ‘ä»¬éé€’å½’å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å€ŸåŠ©æ ˆæ¥ä¿å­˜ä¸­é—´å˜é‡å°±å¯ä»¥å®ç°éé€’å½’äº†ã€‚åœ¨è¿™é‡Œä¸­é—´å˜é‡ä¹Ÿå°±æ˜¯é€šè¿‡Pritationå‡½æ•°åˆ’åˆ†åŒºé—´ä¹‹ååˆ†æˆå·¦å³ä¸¤éƒ¨åˆ†çš„é¦–å°¾æŒ‡é’ˆï¼Œåªéœ€è¦ä¿å­˜è¿™ä¸¤éƒ¨åˆ†çš„é¦–å°¾æŒ‡é’ˆå³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sortByStack</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">    Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;Integer&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹çŠ¶æ€çš„å·¦å³æŒ‡é’ˆå…¥æ ˆ</span></span><br><span class="line">    stack.push(<span class="number">0</span>);</span><br><span class="line">    stack.push(a.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">        <span class="comment">//å‡ºæ ˆè¿›è¡Œåˆ’åˆ†</span></span><br><span class="line">        <span class="keyword">int</span> high = stack.pop();</span><br><span class="line">        <span class="keyword">int</span> low = stack.pop();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> pivotIndex = partition(a, low, high);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ä¿å­˜ä¸­é—´å˜é‡</span></span><br><span class="line">        <span class="keyword">if</span> (pivotIndex &gt; low) &#123;</span><br><span class="line">            stack.push(low);</span><br><span class="line">            stack.push(pivotIndex - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pivotIndex &lt; high &amp;&amp; pivotIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            stack.push(pivotIndex + <span class="number">1</span>);</span><br><span class="line">            stack.push(high);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">partition</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (low &gt;= high) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> left = low;</span><br><span class="line">    <span class="keyword">int</span> right = high;</span><br><span class="line">    <span class="comment">//ä¿å­˜åŸºå‡†çš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> pivot = a[left];</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="comment">//ä»åå‘å‰æ‰¾åˆ°æ¯”åŸºå‡†å°çš„å…ƒç´ ï¼Œæ’å…¥åˆ°åŸºå‡†ä½ç½®ä¸­</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[right] &gt;= pivot) &#123;</span><br><span class="line">            right--;</span><br><span class="line">        &#125;</span><br><span class="line">        a[left] = a[right];</span><br><span class="line">        <span class="comment">//ä»å‰å¾€åæ‰¾åˆ°æ¯”åŸºå‡†å¤§çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right &amp;&amp; a[left] &lt;= pivot) &#123;</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">        a[right] = a[left];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ”¾ç½®åŸºå‡†å€¼ï¼Œå‡†å¤‡åˆ†æ²»é€’å½’å¿«æ’</span></span><br><span class="line">    a[left] = pivot;</span><br><span class="line">    <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç®—æ³•æ”¹è¿›"><a href="#ç®—æ³•æ”¹è¿›" class="headerlink" title="ç®—æ³•æ”¹è¿›"></a>ç®—æ³•æ”¹è¿›</h2><h3 id="åˆ‡æ¢åˆ°æ’å…¥æ’åº"><a href="#åˆ‡æ¢åˆ°æ’å…¥æ’åº" class="headerlink" title="åˆ‡æ¢åˆ°æ’å…¥æ’åº"></a>åˆ‡æ¢åˆ°æ’å…¥æ’åº</h3><p>å’Œå¤§å¤šæ•°é€’å½’æ’åºç®—æ³•ä¸€æ ·ï¼Œæ”¹è¿›å¿«é€Ÿæ’åºæ€§èƒ½çš„ä¸€ä¸ªç®€å•æ–¹æ³•åŸºäºä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li>å¯¹äºå°æ•°ç»„ï¼Œå¿«é€Ÿæ’åºæ¯”æ’å…¥æ’åºæ…¢</li><li>å› ä¸ºé€’å½’ï¼Œå¿«é€Ÿæ’åºçš„sort()æ–¹æ³•åœ¨å°æ•°ç»„ä¸­å¶ä¼šè°ƒç”¨è‡ªå·±</li></ul><p>å› æ­¤ï¼Œåœ¨æ’åºå°æ•°ç»„æ—¶åº”è¯¥åˆ‡æ¢åˆ°æ’å…¥æ’åºã€‚</p><h3 id="ä¸‰è€…å–ä¸­æ³•"><a href="#ä¸‰è€…å–ä¸­æ³•" class="headerlink" title="ä¸‰è€…å–ä¸­æ³•"></a>ä¸‰è€…å–ä¸­æ³•</h3><p>å¿«é€Ÿæ’åºæ˜¯é€šå¸¸è¢«è®¤ä¸ºåœ¨åŒæ•°é‡çº§ï¼ˆO(nlog2n)ï¼‰çš„æ’åºæ–¹æ³•ä¸­å¹³å‡æ€§èƒ½æœ€å¥½çš„ã€‚ä½†è‹¥åˆå§‹åºåˆ—æŒ‰å…³é”®ç æœ‰åºæˆ–åŸºæœ¬æœ‰åºæ—¶ï¼Œå¿«æ’åºåè€Œèœ•åŒ–ä¸ºå†’æ³¡æ’åºã€‚ä¸ºæ”¹è¿›ä¹‹ï¼Œé€šå¸¸ä»¥â€œä¸‰è€…å–ä¸­æ³•â€æ¥é€‰å–åŸºå‡†è®°å½•ï¼Œå³å°†æ’åºåŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ä¸ä¸­ç‚¹ä¸‰ä¸ªè®°å½•å…³é”®ç å±…ä¸­çš„è°ƒæ•´ä¸ºæ”¯ç‚¹è®°å½•ã€‚</p><h3 id="ä¸‰å‘å¿«é€Ÿæ’åº"><a href="#ä¸‰å‘å¿«é€Ÿæ’åº" class="headerlink" title="ä¸‰å‘å¿«é€Ÿæ’åº"></a>ä¸‰å‘å¿«é€Ÿæ’åº</h3><p>å®é™…åº”ç”¨ä¸­ç»å¸¸ä¼šå‡ºç°å«æœ‰å¤§é‡é‡å¤å…ƒç´ çš„æ•°ç»„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…ƒç´ å…¨éƒ¨é‡å¤çš„å­æ•°ç»„å°±ä¸éœ€è¦ç»§ç»­æ’åºäº†ï¼Œä½†æˆ‘ä»¬çš„ç®—æ³•è¿˜ä¼šç»§ç»­å°†å®ƒåˆ‡åˆ†ä¸ºæ›´å°çš„æ•°ç»„ã€‚åœ¨æœ‰å¤§é‡é‡å¤å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œå¿«é€Ÿæ’åºçš„é€’å½’æ€§ä¼šä½¿å…ƒç´ å…¨éƒ¨é‡å¤çš„å­æ•°ç»„ç»å¸¸å‡ºç°ï¼Œè¿™å°±æœ‰å¾ˆå¤§çš„æ”¹è¿›æ½œåŠ›ï¼Œç»å½“å‰å®ç°çš„çº¿æ€§å¯¹æ•°çº§çš„æ€§èƒ½æé«˜åˆ°çº¿æ€§çº§åˆ«ã€‚</p><p><strong>ç®—æ³•æè¿°</strong>ï¼š</p><ul><li>åœ¨ltä¹‹å‰çš„(lo~lt-1)éƒ½å°äºä¸­é—´å€¼</li><li>åœ¨gtä¹‹å‰çš„(gt+1~hi)éƒ½å¤§äºä¸­é—´å€¼</li><li>åœ¨lt~i-1çš„éƒ½ç­‰äºä¸­é—´å€¼</li><li>åœ¨i~gtçš„éƒ½è¿˜ä¸ç¡®å®šï¼ˆæœ€ç»ˆiä¼šå¤§äºgtï¼Œå³ä¸ç¡®å®šçš„å°†ä¸å¤å­˜åœ¨ï¼‰</li></ul><p><img src="https://images.morethink.cn/9f4bd508a48664b472e5644e48c2be4b.png" alt=""></p><p><strong>ä»£ç å®ç°</strong>ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sortThreeWay</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> lo, <span class="keyword">int</span> hi)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lo &gt;= hi) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> v = a[lo], lt = lo, i = lo + <span class="number">1</span>, gt = hi;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= gt) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &lt; v) &#123;</span><br><span class="line">            swap(a, i++, lt++);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[i] &gt; v) &#123;</span><br><span class="line">            swap(a, i, gt--);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sortThreeWay(a, lo, lt - <span class="number">1</span>);</span><br><span class="line">    sortThreeWay(a, gt + <span class="number">1</span>, hi);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = a[i];</span><br><span class="line">    a[i] = a[j];</span><br><span class="line">    a[j] = t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-5"><a href="#å¤æ‚åº¦åˆ†æ-5" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯å¿«é€Ÿæ’åºç®—æ³•å¤æ‚åº¦:</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(nÂ²)</td><td>O(1)ï¼ˆåŸåœ°åˆ†åŒºé€’å½’ç‰ˆï¼‰</td></tr></tbody></table><h1 id="å½’å¹¶æ’åº"><a href="#å½’å¹¶æ’åº" class="headerlink" title="å½’å¹¶æ’åº"></a>å½’å¹¶æ’åº</h1><p>å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ï¼Œ1945å¹´ç”±çº¦ç¿°Â·å†¯Â·è¯ºä¼Šæ›¼é¦–æ¬¡æå‡ºã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ï¼Œä¸”å„å±‚åˆ†æ²»é€’å½’å¯ä»¥åŒæ—¶è¿›è¡Œã€‚</p><h2 id="åŸºæœ¬æ€æƒ³-6"><a href="#åŸºæœ¬æ€æƒ³-6" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å½’å¹¶æ’åºç®—æ³•æ˜¯å°†ä¸¤ä¸ªï¼ˆæˆ–ä¸¤ä¸ªä»¥ä¸Šï¼‰æœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæ–°çš„æœ‰åºè¡¨ï¼Œå³æŠŠå¾…æ’åºåºåˆ—åˆ†ä¸ºè‹¥å¹²ä¸ªå­åºåˆ—ï¼Œæ¯ä¸ªå­åºåˆ—æ˜¯æœ‰åºçš„ã€‚ç„¶åå†æŠŠæœ‰åºå­åºåˆ—åˆå¹¶ä¸ºæ•´ä½“æœ‰åºåºåˆ—ã€‚</p><p><img src="https://images.morethink.cn/merge.gif" alt="è¿™ä¸ªå›¾å¾ˆæœ‰æ¦‚æ‹¬æ€§ï¼Œæ¥è‡ªç»´åŸº"></p><h2 id="ç®—æ³•æè¿°-6"><a href="#ç®—æ³•æè¿°-6" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p><strong>å½’å¹¶æ’åºå¯é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°</strong>:</p><ul><li>è‡ªä¸Šè€Œä¸‹çš„é€’å½’</li><li>è‡ªä¸‹è€Œä¸Šçš„è¿­ä»£</li></ul><p><strong>é€’å½’æ³•</strong>ï¼ˆå‡è®¾åºåˆ—å…±æœ‰nä¸ªå…ƒç´ ï¼‰ï¼š</p><ol><li>å°†åºåˆ—æ¯ç›¸é‚»ä¸¤ä¸ªæ•°å­—è¿›è¡Œå½’å¹¶æ“ä½œï¼Œå½¢æˆ floor(n/2)ä¸ªåºåˆ—ï¼Œæ’åºåæ¯ä¸ªåºåˆ—åŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼›</li><li>å°†ä¸Šè¿°åºåˆ—å†æ¬¡å½’å¹¶ï¼Œå½¢æˆ floor(n/4)ä¸ªåºåˆ—ï¼Œæ¯ä¸ªåºåˆ—åŒ…å«å››ä¸ªå…ƒç´ ï¼›</li><li>é‡å¤æ­¥éª¤2ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ æ’åºå®Œæ¯•ã€‚</li></ol><p><img src="https://images.morethink.cn/merging-sort.gif" alt=""></p><p><strong>è¿­ä»£æ³•</strong></p><ol><li>ç”³è¯·ç©ºé—´ï¼Œä½¿å…¶å¤§å°ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—ä¹‹å’Œï¼Œè¯¥ç©ºé—´ç”¨æ¥å­˜æ”¾åˆå¹¶åçš„åºåˆ—</li><li>è®¾å®šä¸¤ä¸ªæŒ‡é’ˆï¼Œæœ€åˆä½ç½®åˆ†åˆ«ä¸ºä¸¤ä¸ªå·²ç»æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®</li><li>æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„å…ƒç´ ï¼Œé€‰æ‹©ç›¸å¯¹å°çš„å…ƒç´ æ”¾å…¥åˆ°åˆå¹¶ç©ºé—´ï¼Œå¹¶ç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä½ç½®</li><li>é‡å¤æ­¥éª¤3ç›´åˆ°æŸä¸€æŒ‡é’ˆåˆ°è¾¾åºåˆ—å°¾</li><li>å°†å¦ä¸€åºåˆ—å‰©ä¸‹çš„æ‰€æœ‰å…ƒç´ ç›´æ¥å¤åˆ¶åˆ°åˆå¹¶åºåˆ—å°¾</li></ol><h2 id="ä»£ç å®ç°-6"><a href="#ä»£ç å®ç°-6" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>å½’å¹¶æ’åºå…¶å®è¦åšä¸¤ä»¶äº‹ï¼š</p><ul><li>åˆ†è§£ï¼šå°†åºåˆ—æ¯æ¬¡æŠ˜åŠæ‹†åˆ†</li><li>åˆå¹¶ï¼šå°†åˆ’åˆ†åçš„åºåˆ—æ®µä¸¤ä¸¤æ’åºåˆå¹¶</li></ul><p>å› æ­¤ï¼Œå½’å¹¶æ’åºå®é™…ä¸Šå°±æ˜¯ä¸¤ä¸ªæ“ä½œï¼Œæ‹†åˆ†+åˆå¹¶</p><p>ä¸‹é¢æ˜¯é€’å½’çš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Merge</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å½’å¹¶æ‰€éœ€çš„è¾…åŠ©æ•°ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] aux;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä¸€æ¬¡æ€§åˆ†é…ç©ºé—´</span></span><br><span class="line">        aux = <span class="keyword">new</span> <span class="keyword">int</span>[a.length];</span><br><span class="line">        sort(a, <span class="number">0</span>, a.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (low &gt;= high) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (low + high) / <span class="number">2</span>;</span><br><span class="line">        <span class="comment">//å°†å·¦åŠè¾¹æ’åº</span></span><br><span class="line">        sort(a, low, mid);</span><br><span class="line">        <span class="comment">//å°†å³åŠè¾¹æ’åº</span></span><br><span class="line">        sort(a, mid + <span class="number">1</span>, high);</span><br><span class="line">        merge(a, low, mid, high);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¯¥æ–¹æ³•å…ˆå°†æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°aux[]ä¸­ï¼Œç„¶ååœ¨å½’å¹¶ä¼ša[]ä¸­ã€‚æ–¹æ³•å’‹å½’å¹¶æ—¶(ç¬¬äºŒä¸ªforå¾ªç¯)</span></span><br><span class="line"><span class="comment">     * è¿›è¡Œäº†4ä¸ªæ¡ä»¶åˆ¤æ–­ï¼š</span></span><br><span class="line"><span class="comment">     * - å·¦åŠè¾¹ç”¨å°½(å–å³åŠè¾¹çš„å…ƒç´ )</span></span><br><span class="line"><span class="comment">     * - å³åŠè¾¹ç”¨å°½(å–å·¦åŠè¾¹çš„å…ƒç´ )</span></span><br><span class="line"><span class="comment">     * - å³åŠè¾¹çš„å½“å‰å…ƒç´ å°äºå·¦åŠè¾¹çš„å½“å‰å…ƒç´ (å–å³åŠè¾¹çš„å…ƒç´ )</span></span><br><span class="line"><span class="comment">     * - å³åŠè¾¹çš„å½“å‰å…ƒç´ å¤§äºç­‰äºå·¦åŠè¾¹çš„å½“å‰å…ƒç´ (å–å·¦åŠè¾¹çš„å…ƒç´ )</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> a</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> low</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mid</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> high</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span>[] a, <span class="keyword">int</span> low, <span class="keyword">int</span> mid, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å°†a[low..mid]å’Œa[mid+1..high]å½’å¹¶</span></span><br><span class="line">        <span class="keyword">int</span> i = low, j = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = low; k &lt;= high; k++) &#123;</span><br><span class="line">            aux[k] = a[k];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = low; k &lt;= high; k++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; mid) &#123;</span><br><span class="line">                a[k] = aux[j++];</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (j &gt; high) &#123;</span><br><span class="line">                a[k] = aux[i++];</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (aux[j] &lt; aux[i]) &#123;</span><br><span class="line">                a[k] = aux[j++];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                a[k] = aux[i++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-6"><a href="#å¤æ‚åº¦åˆ†æ-6" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯å½’å¹¶æ’åºç®—æ³•å¤æ‚åº¦:</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(n)</td></tr></tbody></table><p>ä»æ•ˆç‡ä¸Šçœ‹ï¼Œå½’å¹¶æ’åºå¯ç®—æ˜¯æ’åºç®—æ³•ä¸­çš„â€ä½¼ä½¼è€…â€. å‡è®¾æ•°ç»„é•¿åº¦ä¸ºnï¼Œé‚£ä¹ˆæ‹†åˆ†æ•°ç»„å…±éœ€lognï¼Œ, åˆæ¯æ­¥éƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„åˆå¹¶å­æ•°ç»„çš„è¿‡ç¨‹ï¼Œ æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œ æ•…å…¶ç»¼åˆæ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚å¦ä¸€æ–¹é¢ï¼Œ å½’å¹¶æ’åºå¤šæ¬¡é€’å½’è¿‡ç¨‹ä¸­æ‹†åˆ†çš„å­æ•°ç»„éœ€è¦ä¿å­˜åœ¨å†…å­˜ç©ºé—´ï¼Œ å…¶ç©ºé—´å¤æ‚åº¦ä¸ºO(n)ã€‚</p><h2 id="æ€»ç»“ä¸æ€è€ƒ-4"><a href="#æ€»ç»“ä¸æ€è€ƒ-4" class="headerlink" title="æ€»ç»“ä¸æ€è€ƒ"></a>æ€»ç»“ä¸æ€è€ƒ</h2><p>å½’å¹¶æ’åºæœ€å¸å¼•äººçš„æ€§è´¨æ˜¯å®ƒèƒ½å¤Ÿä¿è¯å°†ä»»æ„é•¿åº¦ä¸ºNçš„æ•°ç»„æ’åºæ‰€éœ€æ—¶é—´å’ŒNlogNæˆæ­£æ¯”ï¼Œå®ƒçš„ä¸»è¦ç¼ºç‚¹åˆ™æ˜¯ä»–æ‰€éœ€çš„é¢å¤–ç©ºé—´å’ŒNæˆæ­£æ¯”ã€‚</p><h1 id="åŸºæ•°æ’åº"><a href="#åŸºæ•°æ’åº" class="headerlink" title="åŸºæ•°æ’åº"></a>åŸºæ•°æ’åº</h1><p>åŸºæ•°æ’åºçš„å‘æ˜å¯ä»¥è¿½æº¯åˆ°1887å¹´èµ«å°”æ›¼Â·ä½•ä¹ç¤¼åœ¨æ‰“å­”å¡ç‰‡åˆ¶è¡¨æœºï¼ˆTabulation Machineï¼‰, æ’åºå™¨æ¯æ¬¡åªèƒ½çœ‹åˆ°ä¸€ä¸ªåˆ—ã€‚å®ƒæ˜¯åŸºäºå…ƒç´ å€¼çš„æ¯ä¸ªä½ä¸Šçš„å­—ç¬¦æ¥æ’åºçš„ã€‚ å¯¹äºæ•°å­—è€Œè¨€å°±æ˜¯åˆ†åˆ«åŸºäºä¸ªä½ï¼Œåä½ï¼Œ ç™¾ä½æˆ–åƒä½ç­‰ç­‰æ•°å­—æ¥æ’åºã€‚</p><p>åŸºæ•°æ’åºï¼ˆRadix sortï¼‰æ˜¯ä¸€ç§éæ¯”è¾ƒå‹æ•´æ•°æ’åºç®—æ³•ï¼Œå…¶åŸç†æ˜¯å°†æ•´æ•°æŒ‰ä½æ•°åˆ‡å‰²æˆä¸åŒçš„æ•°å­—ï¼Œç„¶åæŒ‰æ¯ä¸ªä½æ•°åˆ†åˆ«æ¯”è¾ƒã€‚ç”±äºæ•´æ•°ä¹Ÿå¯ä»¥è¡¨è¾¾å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚åå­—æˆ–æ—¥æœŸï¼‰å’Œç‰¹å®šæ ¼å¼çš„æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥åŸºæ•°æ’åºä¹Ÿä¸æ˜¯åªèƒ½ä½¿ç”¨äºæ•´æ•°ã€‚</p><h2 id="åŸºæœ¬æ€æƒ³-7"><a href="#åŸºæœ¬æ€æƒ³-7" class="headerlink" title="åŸºæœ¬æ€æƒ³"></a>åŸºæœ¬æ€æƒ³</h2><p>å®ƒæ˜¯è¿™æ ·å®ç°çš„ï¼šå°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ï¼ˆæ­£æ•´æ•°ï¼‰ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥åï¼Œæ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</p><p>åŸºæ•°æ’åºæŒ‰ç…§ä¼˜å…ˆä»é«˜ä½æˆ–ä½ä½æ¥æ’åºæœ‰ä¸¤ç§å®ç°æ–¹æ¡ˆï¼š</p><ul><li><p><strong>MSDï¼ˆMost significant digitalï¼‰ ä»æœ€å·¦ä¾§é«˜ä½å¼€å§‹è¿›è¡Œæ’åº</strong>ã€‚å…ˆæŒ‰k1æ’åºåˆ†ç»„, åŒä¸€ç»„ä¸­è®°å½•, å…³é”®ç k1ç›¸ç­‰, å†å¯¹å„ç»„æŒ‰k2æ’åºåˆ†æˆå­ç»„, ä¹‹å, å¯¹åé¢çš„å…³é”®ç ç»§ç»­è¿™æ ·çš„æ’åºåˆ†ç»„, ç›´åˆ°æŒ‰æœ€æ¬¡ä½å…³é”®ç kdå¯¹å„å­ç»„æ’åºå. å†å°†å„ç»„è¿æ¥èµ·æ¥, ä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—ã€‚<em>MSDæ–¹å¼é€‚ç”¨äºä½æ•°å¤šçš„åºåˆ—</em>ã€‚</p></li><li><p><strong>LSD ï¼ˆLeast significant digitalï¼‰ä»æœ€å³ä¾§ä½ä½å¼€å§‹è¿›è¡Œæ’åº</strong>ã€‚å…ˆä»kdå¼€å§‹æ’åºï¼Œå†å¯¹kd-1è¿›è¡Œæ’åºï¼Œä¾æ¬¡é‡å¤ï¼Œç›´åˆ°å¯¹k1æ’åºåä¾¿å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—ã€‚<em>LSDæ–¹å¼é€‚ç”¨äºä½æ•°å°‘çš„åºåˆ—</em>ã€‚</p></li></ul><p><img src="https://images.morethink.cn/radix-sort_sample.gif" alt="åŸºæ•°æ’åºLSDåŠ¨å›¾æ¼”ç¤º"></p><h2 id="ç®—æ³•æè¿°-7"><a href="#ç®—æ³•æè¿°-7" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p>æˆ‘ä»¬ä»¥LSDä¸ºä¾‹ï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼š</p><ol><li>å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°ï¼›</li><li>arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„ï¼›</li><li>å¯¹radixè¿›è¡Œè®¡æ•°æ’åºï¼ˆåˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹ï¼‰ï¼›</li></ol><h2 id="ä»£ç å®ç°-7"><a href="#ä»£ç å®ç°-7" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>åŸºæ•°æ’åºï¼šé€šè¿‡åºåˆ—ä¸­å„ä¸ªå…ƒç´ çš„å€¼ï¼Œå¯¹æ’åºçš„Nä¸ªå…ƒç´ è¿›è¡Œè‹¥å¹²è¶Ÿçš„â€œåˆ†é…â€ä¸â€œæ”¶é›†â€æ¥å®ç°æ’åºã€‚</p><ul><li><p><strong>åˆ†é…</strong>ï¼šæˆ‘ä»¬å°†L[i]ä¸­çš„å…ƒç´ å–å‡ºï¼Œé¦–å…ˆç¡®å®šå…¶ä¸ªä½ä¸Šçš„æ•°å­—ï¼Œæ ¹æ®è¯¥æ•°å­—åˆ†é…åˆ°ä¸ä¹‹åºå·ç›¸åŒçš„æ¡¶ä¸­</p></li><li><p><strong>æ”¶é›†</strong>ï¼šå½“åºåˆ—ä¸­æ‰€æœ‰çš„å…ƒç´ éƒ½åˆ†é…åˆ°å¯¹åº”çš„æ¡¶ä¸­ï¼Œå†æŒ‰ç…§é¡ºåºä¾æ¬¡å°†æ¡¶ä¸­çš„å…ƒç´ æ”¶é›†å½¢æˆæ–°çš„ä¸€ä¸ªå¾…æ’åºåˆ—L[]ã€‚å¯¹æ–°å½¢æˆçš„åºåˆ—L[]é‡å¤æ‰§è¡Œåˆ†é…å’Œæ”¶é›†å…ƒç´ ä¸­çš„åä½ã€ç™¾ä½â€¦ç›´åˆ°åˆ†é…å®Œè¯¥åºåˆ—ä¸­çš„æœ€é«˜ä½ï¼Œåˆ™æ’åºç»“æŸ</p></li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span>[] arr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (arr.length &lt;= <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°</span></span><br><span class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (max &lt; arr[i]) &#123;</span><br><span class="line">            max = arr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> maxDigit = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (max / <span class="number">10</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        maxDigit++;</span><br><span class="line">        max = max / <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç”³è¯·ä¸€ä¸ªæ¡¶ç©ºé—´</span></span><br><span class="line">    <span class="keyword">int</span>[][] buckets = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>][arr.length];</span><br><span class="line">    <span class="keyword">int</span> base = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ä»ä½ä½åˆ°é«˜ä½ï¼Œå¯¹æ¯ä¸€ä½éå†ï¼Œå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxDigit; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] bktLen = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];        <span class="comment">//å­˜å‚¨å„ä¸ªæ¡¶ä¸­å­˜å‚¨å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ†é…ï¼šå°†æ‰€æœ‰å…ƒç´ åˆ†é…åˆ°æ¡¶ä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> whichBucket = (arr[j] % base) / (base / <span class="number">10</span>);</span><br><span class="line">            buckets[whichBucket][bktLen[whichBucket]] = arr[j];</span><br><span class="line">            bktLen[whichBucket]++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ”¶é›†ï¼šå°†ä¸åŒæ¡¶é‡Œæ•°æ®æŒ¨ä¸ªæå‡ºæ¥,ä¸ºä¸‹ä¸€è½®é«˜ä½æ’åºåšå‡†å¤‡,ç”±äºé è¿‘æ¡¶åº•çš„å…ƒç´ æ’åé å‰,å› æ­¤ä»æ¡¶åº•å…ˆæ</span></span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt; buckets.length; b++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; bktLen[b]; p++) &#123;</span><br><span class="line">                arr[k++] = buckets[b][p];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"Sorting: "</span> + Arrays.toString(arr));</span><br><span class="line">        base *= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤æ‚åº¦åˆ†æ-7"><a href="#å¤æ‚åº¦åˆ†æ-7" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>ä»¥ä¸‹æ˜¯åŸºæ•°æ’åºç®—æ³•å¤æ‚åº¦ï¼Œå…¶ä¸­kä¸ºæœ€å¤§æ•°çš„ä½æ•°ï¼š</p><table><thead><tr><th>å¹³å‡æ—¶é—´å¤æ‚åº¦</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>ç©ºé—´å¤æ‚åº¦</th></tr></thead><tbody><tr><td>O(d*(n+r))</td><td>O(d*(n+r))</td><td>O(d*(n+r))</td><td>O(n+r)</td></tr></tbody></table><p>å…¶ä¸­ï¼Œ<strong>d ä¸ºä½æ•°ï¼Œr ä¸ºåŸºæ•°ï¼Œn ä¸ºåŸæ•°ç»„ä¸ªæ•°</strong>ã€‚åœ¨åŸºæ•°æ’åºä¸­ï¼Œå› ä¸ºæ²¡æœ‰æ¯”è¾ƒæ“ä½œï¼Œæ‰€ä»¥åœ¨å¤æ‚ä¸Šï¼Œæœ€å¥½çš„æƒ…å†µä¸æœ€åçš„æƒ…å†µåœ¨æ—¶é—´ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œå‡ä¸º <code>O(d*(n + r))</code>ã€‚</p><h2 id="æ€»ç»“å’Œæ€è€ƒ"><a href="#æ€»ç»“å’Œæ€è€ƒ" class="headerlink" title="æ€»ç»“å’Œæ€è€ƒ"></a>æ€»ç»“å’Œæ€è€ƒ</h2><p>åŸºæ•°æ’åºæ›´é€‚åˆç”¨äºå¯¹æ—¶é—´, å­—ç¬¦ä¸²ç­‰è¿™äº› <strong>æ•´ä½“æƒå€¼æœªçŸ¥çš„æ•°æ®</strong> è¿›è¡Œæ’åºã€‚</p><p>åŸºæ•°æ’åºä¸æ”¹å˜ç›¸åŒå…ƒç´ ä¹‹é—´çš„ç›¸å¯¹é¡ºåºï¼Œå› æ­¤å®ƒæ˜¯ç¨³å®šçš„æ’åºç®—æ³•ã€‚</p><p><strong>åŸºæ•°æ’åº vs è®¡æ•°æ’åº vs æ¡¶æ’åº</strong></p><p>è¿™ä¸‰ç§æ’åºç®—æ³•éƒ½åˆ©ç”¨äº†æ¡¶çš„æ¦‚å¿µï¼Œä½†å¯¹æ¡¶çš„ä½¿ç”¨æ–¹æ³•ä¸Šæœ‰æ˜æ˜¾å·®å¼‚ï¼š</p><ol><li>åŸºæ•°æ’åºï¼šæ ¹æ®é”®å€¼çš„æ¯ä½æ•°å­—æ¥åˆ†é…æ¡¶</li><li>è®¡æ•°æ’åºï¼šæ¯ä¸ªæ¡¶åªå­˜å‚¨å•ä¸€é”®å€¼</li><li>æ¡¶æ’åºï¼šæ¯ä¸ªæ¡¶å­˜å‚¨ä¸€å®šèŒƒå›´çš„æ•°å€¼</li></ol><h1 id="å…«å¤§æ’åºç®—æ³•æ€»ç»“"><a href="#å…«å¤§æ’åºç®—æ³•æ€»ç»“" class="headerlink" title="å…«å¤§æ’åºç®—æ³•æ€»ç»“"></a>å…«å¤§æ’åºç®—æ³•æ€»ç»“</h1><p>å„ç§æ’åºæ€§èƒ½å¯¹æ¯”å¦‚ä¸‹:</p><table><thead><tr><th>æ’åºç±»å‹</th><th>å¹³å‡æƒ…å†µ</th><th>æœ€å¥½æƒ…å†µ</th><th>æœ€åæƒ…å†µ</th><th>è¾…åŠ©ç©ºé—´</th><th>ç¨³å®šæ€§</th></tr></thead><tbody><tr><td>å†’æ³¡æ’åº</td><td>O(nÂ²)</td><td>O(n)</td><td>O(nÂ²)</td><td>O(1)</td><td>ç¨³å®š</td></tr><tr><td>é€‰æ‹©æ’åº</td><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(nÂ²)</td><td>O(1)</td><td>ä¸ç¨³å®š</td></tr><tr><td>ç›´æ¥æ’å…¥æ’åº</td><td>O(nÂ²)</td><td>O(n)</td><td>O(nÂ²)</td><td>O(1)</td><td>ç¨³å®š</td></tr><tr><td>æŠ˜åŠæ’å…¥æ’åº</td><td>O(nÂ²)</td><td>O(n)</td><td>O(nÂ²)</td><td>O(1)</td><td>ç¨³å®š</td></tr><tr><td>å¸Œå°”æ’åº</td><td>O(n^1.3)</td><td>O(nlogn)</td><td>O(nÂ²)</td><td>O(1)</td><td>ä¸ç¨³å®š</td></tr><tr><td>å½’å¹¶æ’åº</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(n)</td><td>ç¨³å®š</td></tr><tr><td>å¿«é€Ÿæ’åº</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(nÂ²)</td><td>O(nlogâ‚‚n)</td><td>ä¸ç¨³å®š</td></tr><tr><td>å †æ’åº</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(nlogâ‚‚n)</td><td>O(1)</td><td>ä¸ç¨³å®š</td></tr><tr><td>è®¡æ•°æ’åº</td><td>O(n+k)</td><td>O(n+k)</td><td>O(n+k)</td><td>O(k)</td><td>ç¨³å®š</td></tr><tr><td>æ¡¶æ’åº</td><td>O(n+k)</td><td>O(n+k)</td><td>O(nÂ²)</td><td>O(n+k)</td><td>(ä¸)ç¨³å®š</td></tr><tr><td>åŸºæ•°æ’åº</td><td>O(d(n+k))</td><td>O(d(n+k))</td><td>O(d(n+kd))</td><td>O(n+kd)</td><td>ç¨³å®š</td></tr></tbody></table><p>ä»æ—¶é—´å¤æ‚åº¦æ¥è¯´ï¼š</p><ol><li>å¹³æ–¹é˜¶O(nÂ²)æ’åºï¼š<strong>å„ç±»ç®€å•æ’åºï¼šç›´æ¥æ’å…¥ã€ç›´æ¥é€‰æ‹©å’Œå†’æ³¡æ’åº</strong></li><li>çº¿æ€§å¯¹æ•°é˜¶O(nlogâ‚‚n)æ’åºï¼š<strong>å¿«é€Ÿæ’åºã€å †æ’åºå’Œå½’å¹¶æ’åº</strong></li><li>O(n1+Â§))æ’åºï¼ŒÂ§æ˜¯ä»‹äº0å’Œ1ä¹‹é—´çš„å¸¸æ•°ï¼š<strong>å¸Œå°”æ’åº</strong></li><li>çº¿æ€§é˜¶O(n)æ’åºï¼š<strong>åŸºæ•°æ’åºï¼Œæ­¤å¤–è¿˜æœ‰æ¡¶ã€ç®±æ’åº</strong></li></ol><p>è®ºæ˜¯å¦æœ‰åºçš„å½±å“ï¼š</p><ul><li>å½“åŸè¡¨æœ‰åºæˆ–åŸºæœ¬æœ‰åºæ—¶ï¼Œç›´æ¥æ’å…¥æ’åºå’Œå†’æ³¡æ’åºå°†å¤§å¤§å‡å°‘æ¯”è¾ƒæ¬¡æ•°å’Œç§»åŠ¨è®°å½•çš„æ¬¡æ•°ï¼Œæ—¶é—´å¤æ‚åº¦å¯é™è‡³Oï¼ˆnï¼‰ï¼›</li><li>è€Œå¿«é€Ÿæ’åºåˆ™ç›¸åï¼Œå½“åŸè¡¨åŸºæœ¬æœ‰åºæ—¶ï¼Œå°†èœ•åŒ–ä¸ºå†’æ³¡æ’åºï¼Œæ—¶é—´å¤æ‚åº¦æé«˜ä¸ºOï¼ˆn2ï¼‰ï¼›</li><li>åŸè¡¨æ˜¯å¦æœ‰åºï¼Œå¯¹ç®€å•é€‰æ‹©æ’åºã€å †æ’åºã€å½’å¹¶æ’åºå’ŒåŸºæ•°æ’åºçš„æ—¶é—´å¤æ‚åº¦å½±å“ä¸å¤§ã€‚</li></ul><p><img src="https://images.morethink.cn/sort-comparison.png" alt=""></p><p><a href="https://github.com/morethink/algorithm/tree/master/src/main/java/algorithm/sort" target="_blank" rel="noopener">ä»£ç åœ°å€</a></p><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ol><li>ã€Šç®—æ³•ã€‹ç¬¬å››ç‰ˆ</li><li>ç»´åŸºç™¾ç§‘</li><li><a href="https://itimetraveler.github.io/2017/07/18/%E5%85%AB%E5%A4%A7%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93%E4%B8%8Ejava%E5%AE%9E%E7%8E%B0/#%E4%B8%83%E3%80%81%E5%BD%92%E5%B9%B6%E6%8E%92%E5%BA%8F%EF%BC%88Merging-Sort%EF%BC%89" target="_blank" rel="noopener">å…«å¤§æ’åºç®—æ³•æ€»ç»“ä¸javaå®ç°</a></li><li><a href="https://segmentfault.com/a/1190000010413296#articleHeader33" target="_blank" rel="noopener">å‰ç«¯é¢è¯•å¿…å¤‡â€”â€”åå¤§ç»å…¸æ’åºç®—æ³•</a></li><li><a href="https://www.jianshu.com/p/8c915179fd02" target="_blank" rel="noopener">å¿…é¡»çŸ¥é“çš„å…«å¤§ç§æ’åºç®—æ³•ã€javaå®ç°ã€‘</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaå®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</title>
      <link href="/Java%E5%AE%9E%E7%8E%B0%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/"/>
      <url>/Java%E5%AE%9E%E7%8E%B0%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>äºŒåˆ†æŸ¥æ‰¾ï¼ˆbinary searchï¼‰ï¼Œä¹Ÿç§°æŠ˜åŠæœç´¢ï¼Œæ˜¯ä¸€ç§åœ¨ <strong>æœ‰åºæ•°ç»„</strong> ä¸­ <strong>æŸ¥æ‰¾æŸä¸€ç‰¹å®šå…ƒç´ </strong> çš„æœç´¢ç®—æ³•ã€‚æœç´¢è¿‡ç¨‹ä»æ•°ç»„çš„ä¸­é—´å…ƒç´ å¼€å§‹ï¼Œå¦‚æœä¸­é—´å…ƒç´ æ­£å¥½æ˜¯è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œåˆ™æœç´¢è¿‡ç¨‹ç»“æŸï¼›å¦‚æœæŸä¸€ç‰¹å®šå…ƒç´ å¤§äºæˆ–è€…å°äºä¸­é—´å…ƒç´ ï¼Œåˆ™åœ¨æ•°ç»„å¤§äºæˆ–å°äºä¸­é—´å…ƒç´ çš„é‚£ä¸€åŠä¸­æŸ¥æ‰¾ï¼Œè€Œä¸”è·Ÿå¼€å§‹ä¸€æ ·ä»ä¸­é—´å…ƒç´ å¼€å§‹æ¯”è¾ƒã€‚å¦‚æœåœ¨æŸä¸€æ­¥éª¤æ•°ç»„ä¸ºç©ºï¼Œåˆ™ä»£è¡¨æ‰¾ä¸åˆ°ã€‚è¿™ç§æœç´¢ç®—æ³•æ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½ä½¿æœç´¢èŒƒå›´ç¼©å°ä¸€åŠã€‚</p><ul><li><strong>æ—¶é—´å¤æ‚åº¦</strong>:æŠ˜åŠæœç´¢æ¯æ¬¡æŠŠæœç´¢åŒºåŸŸå‡å°‘ä¸€åŠï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ã€‚ï¼ˆnä»£è¡¨é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ï¼‰</li><li><strong>ç©ºé—´å¤æ‚åº¦</strong>: O(1)ã€‚è™½ä»¥é€’å½’å½¢å¼å®šä¹‰ï¼Œä½†æ˜¯å°¾é€’å½’ï¼Œå¯æ”¹å†™ä¸ºå¾ªç¯ã€‚</li></ul><a id="more"></a><h1 id="åŠ¨å›¾æ¼”ç¤º"><a href="#åŠ¨å›¾æ¼”ç¤º" class="headerlink" title="åŠ¨å›¾æ¼”ç¤º"></a>åŠ¨å›¾æ¼”ç¤º</h1><p><img src="https://images.morethink.cn/binary-search.gif" alt="binary-search" title="äºŒåˆ†æŸ¥æ‰¾"></p><h1 id="ä»£ç æè¿°"><a href="#ä»£ç æè¿°" class="headerlink" title="ä»£ç æè¿°"></a>ä»£ç æè¿°</h1><h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">binarysearch</span><span class="params">(<span class="keyword">int</span> array[], <span class="keyword">int</span> low, <span class="keyword">int</span> high, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (low &gt; high) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = low + (high - low) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (array[mid] &gt; target)</span><br><span class="line">        <span class="keyword">return</span> binarysearch(array, low, mid - <span class="number">1</span>, target);</span><br><span class="line">    <span class="keyword">if</span> (array[mid] &lt; target)</span><br><span class="line">        <span class="keyword">return</span> binarysearch(array, mid + <span class="number">1</span>, high, target);</span><br><span class="line">    <span class="keyword">return</span> mid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="éé€’å½’"><a href="#éé€’å½’" class="headerlink" title="éé€’å½’"></a>éé€’å½’</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsearchWithoutRecursion</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> low = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> high = a.length - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (low &lt;= high) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = low + (high - low) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (a[mid] &gt; key)</span><br><span class="line">            high = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[mid] &lt; key)</span><br><span class="line">            low = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äºŒåˆ†æŸ¥æ‰¾ä¸­å€¼çš„è®¡ç®—"><a href="#äºŒåˆ†æŸ¥æ‰¾ä¸­å€¼çš„è®¡ç®—" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾ä¸­å€¼çš„è®¡ç®—"></a>äºŒåˆ†æŸ¥æ‰¾ä¸­å€¼çš„è®¡ç®—</h1><p>è¿™æ˜¯ä¸€ä¸ªç»å…¸çš„è¯é¢˜ï¼Œå¦‚ä½•è®¡ç®—äºŒåˆ†æŸ¥æ‰¾ä¸­çš„ä¸­å€¼ï¼Ÿå¤§å®¶ä¸€èˆ¬ç»™å‡ºäº†ä¸¤ç§è®¡ç®—æ–¹æ³•ï¼š</p><ul><li>ç®—æ³•ä¸€ï¼š <code>mid = (low + high) / 2</code></li><li>ç®—æ³•äºŒï¼š <code>mid = low + (high â€“ low)/2</code></li></ul><p>ä¹çœ‹èµ·æ¥ï¼Œç®—æ³•ä¸€ç®€æ´ï¼Œç®—æ³•äºŒæå–ä¹‹åï¼Œè·Ÿç®—æ³•ä¸€æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ä½†æ˜¯å®é™…ä¸Šï¼ŒåŒºåˆ«æ˜¯å­˜åœ¨çš„ã€‚ç®—æ³•ä¸€çš„åšæ³•ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œ(low + high)å­˜åœ¨ç€æº¢å‡ºçš„é£é™©ï¼Œè¿›è€Œå¾—åˆ°é”™è¯¯çš„midç»“æœï¼Œå¯¼è‡´ç¨‹åºé”™è¯¯ã€‚è€Œç®—æ³•äºŒèƒ½å¤Ÿä¿è¯è®¡ç®—å‡ºæ¥çš„midï¼Œä¸€å®šå¤§äºlowï¼Œå°äºhighï¼Œä¸å­˜åœ¨æº¢å‡ºçš„é—®é¢˜ã€‚</p><h1 id="äºŒåˆ†æŸ¥æ‰¾æ³•çš„ç¼ºé™·"><a href="#äºŒåˆ†æŸ¥æ‰¾æ³•çš„ç¼ºé™·" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾æ³•çš„ç¼ºé™·"></a>äºŒåˆ†æŸ¥æ‰¾æ³•çš„ç¼ºé™·</h1><p>äºŒåˆ†æŸ¥æ‰¾æ³•çš„O(log n)è®©å®ƒæˆä¸ºååˆ†é«˜æ•ˆçš„ç®—æ³•ã€‚ä¸è¿‡å®ƒçš„ç¼ºé™·å´ä¹Ÿæ˜¯é‚£ä¹ˆæ˜æ˜¾çš„ã€‚å°±åœ¨å®ƒçš„é™å®šä¹‹ä¸Šï¼šå¿…é¡»æœ‰åºï¼Œæˆ‘ä»¬å¾ˆéš¾ä¿è¯æˆ‘ä»¬çš„æ•°ç»„éƒ½æ˜¯æœ‰åºçš„ã€‚å½“ç„¶å¯ä»¥åœ¨æ„å»ºæ•°ç»„çš„æ—¶å€™è¿›è¡Œæ’åºï¼Œå¯æ˜¯åˆè½åˆ°äº†ç¬¬äºŒä¸ªç“¶é¢ˆä¸Šï¼šå®ƒå¿…é¡»æ˜¯æ•°ç»„ã€‚</p><p>æ•°ç»„è¯»å–æ•ˆç‡æ˜¯O(1)ï¼Œå¯æ˜¯å®ƒçš„æ’å…¥å’Œåˆ é™¤æŸä¸ªå…ƒç´ çš„æ•ˆç‡å´æ˜¯O(n)ã€‚å› è€Œå¯¼è‡´æ„å»ºæœ‰åºæ•°ç»„å˜æˆä½æ•ˆçš„äº‹æƒ…ã€‚</p><p>è§£å†³è¿™äº›ç¼ºé™·é—®é¢˜æ›´å¥½çš„æ–¹æ³•åº”è¯¥æ˜¯ä½¿ç”¨äºŒå‰æŸ¥æ‰¾æ ‘äº†ï¼Œæœ€å¥½è‡ªç„¶æ˜¯è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘äº†ï¼Œæ—¢èƒ½é«˜æ•ˆçš„ï¼ˆO(n log n)ï¼‰æ„å»ºæœ‰åºå…ƒç´ é›†åˆï¼Œåˆèƒ½å¦‚åŒäºŒåˆ†æŸ¥æ‰¾æ³•ä¸€æ ·å¿«é€Ÿï¼ˆO(log n)ï¼‰çš„æœå¯»ç›®æ ‡æ•°ã€‚</p><p><strong>å‚è€ƒèµ„æ–™</strong>ï¼š</p><ol><li><a href="http://www.cnblogs.com/ider/archive/2012/04/01/binary_search.html" target="_blank" rel="noopener">äºŒåˆ†æŸ¥æ‰¾æ³•çš„å®ç°å’Œåº”ç”¨æ±‡æ€»</a></li><li><a href="http://hedengcheng.com/?p=595" target="_blank" rel="noopener">äºŒåˆ†æŸ¥æ‰¾(Binary Search)éœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Œä»¥åŠåœ¨æ•°æ®åº“å†…æ ¸ä¸­çš„å®ç°</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŸ¥æ‰¾ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Win10ä¸‹é€šè¿‡IISè°ƒè¯•ASPç¨‹åºé‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ</title>
      <link href="/Win10-through-the-IIS-debugging-ASP-program/"/>
      <url>/Win10-through-the-IIS-debugging-ASP-program/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘ç»´æŠ¤äº†ä»¥å‰åˆ«äººçš„å†™çš„ä¸€ä¸ªASPçš„ç³»ç»Ÿï¼Œè®°å½•ä¸€ä¸‹è°ƒè¯•è¿‡ç¨‹ä¸­çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆã€‚</p><h1 id="ç¯å¢ƒç¯‡"><a href="#ç¯å¢ƒç¯‡" class="headerlink" title="ç¯å¢ƒç¯‡"></a>ç¯å¢ƒç¯‡</h1><h1 id="ä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡-W3SVC-å·²ç»åœæ­¢"><a href="#ä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡-W3SVC-å·²ç»åœæ­¢" class="headerlink" title="ä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡(W3SVC)å·²ç»åœæ­¢"></a>ä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡(W3SVC)å·²ç»åœæ­¢</h1><p><strong>é—®é¢˜</strong>ï¼š<br>ä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡(W3SVC)å·²ç»åœæ­¢ã€‚é™¤éä¸‡ç»´ç½‘å‘å¸ƒæœåŠ¡(W3SVC)æ­£åœ¨è¿è¡Œ,å¦åˆ™æ— æ³•å¯åŠ¨ç½‘ç«™ã€‚</p><a id="more"></a><p><img src="https://images.morethink.cn/d479322a25d8c93f9bf481695af50858.png" alt=""></p><p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p><p>éœ€è¦å…ˆå¯åŠ¨æ•´ä¸ªåº”ç”¨ã€‚</p><p><img src="https://images.morethink.cn/31b0292ddbc24480229d1fbce590bb8e.png" alt=""></p><h1 id="IISæœåŠ¡"><a href="#IISæœåŠ¡" class="headerlink" title="IISæœåŠ¡"></a>IISæœåŠ¡</h1><p>æ§åˆ¶é¢æ¿&gt;&gt;ç¨‹åºå’ŒåŠŸèƒ½&gt;&gt;å¯åŠ¨æˆ–å…³é—­WindowsåŠŸèƒ½&gt;&gt;IISæœåŠ¡<br><img src="https://images.morethink.cn/729c9c06256b9029cadf7e00cbbfc667.png" alt=""></p><p>ä½†æ˜¯è¿™æ ·ä»…ä»…æ˜¯å¼€å¯äº†IISæœåŠ¡ï¼Œä¼šå‡ºç°Http500é”™è¯¯ï¼Œä¸èƒ½è¿è¡ŒASPç¨‹åºï¼Œå› ä¸ºIISæœåŠ¡å™¨é»˜è®¤å¹¶æ²¡æœ‰å¸®æˆ‘ä»¬é…ç½®ASPæˆ–è€…ASP.NETç¯å¢ƒï¼Œéœ€è¦è‡ªå·±æ‰‹åŠ¨é…ç½®(åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¯åŠ¨è¿‡å¤šæ¬¡ç”µè„‘)ã€‚</p><h1 id="é…ç½®ASPç¯å¢ƒ"><a href="#é…ç½®ASPç¯å¢ƒ" class="headerlink" title="é…ç½®ASPç¯å¢ƒ"></a>é…ç½®ASPç¯å¢ƒ</h1><p>ASPé…ç½®å¦‚ä¸‹ï¼š<br><img src="https://images.morethink.cn/a1339b7725b29585940ccd745fcd7512.png" alt=""></p><p>å¦‚æœéœ€è¦ASP.NETï¼Œéœ€è¦å¦‚ä¸‹é…ç½®ï¼š</p><p><img src="https://images.morethink.cn/8e827a63559409b25937857d136e236f.png" alt=""></p><h1 id="IIS7ä¸­å‡ºç°An-error-occurred-on-the-server-when-processing-the-URLé”™è¯¯"><a href="#IIS7ä¸­å‡ºç°An-error-occurred-on-the-server-when-processing-the-URLé”™è¯¯" class="headerlink" title="IIS7ä¸­å‡ºç°An error occurred on the server when processing the URLé”™è¯¯"></a>IIS7ä¸­å‡ºç°An error occurred on the server when processing the URLé”™è¯¯</h1><p><strong>é”™è¯¯æè¿°</strong>ï¼š<br>An error occurred on the server when processing the URL. Please contact the system administrator.If you are the system administrator please click here to find out more about this error.</p><ol><li>æ‰“å¼€æ§åˆ¶é¢æ¿â†’ç®¡ç†å·¥å…·â†’Internet ä¿¡æ¯æœåŠ¡(IIS)ç®¡ç†å™¨â†’åŒå‡»â€œASPâ€å›¾æ ‡<br><img src="https://images.morethink.cn/4cc9001c24f9705e91f4257074f8673c.png" alt=""></li><li>åœ¨å·¦è¾¹çš„çª—å£ä¸­æ‰¾åˆ°ä½ çš„ç½‘ç«™ï¼Œç„¶ååœ¨å³è¾¹çš„çª—å£ä¸­å±•å¼€â€œè°ƒè¯•å±æ€§â€ï¼ŒæŠŠâ€œå°†é”™è¯¯å‘é€åˆ°æµè§ˆå™¨â€è®¾ä¸ºTrueå³å¯<br><img src="https://images.morethink.cn/4a629fd49cf2edefc97cc61a7f1d0d4f.png" alt=""></li></ol><p>æ­¤æ—¶ä½ å†è¿è¡ŒASPç¨‹åºæ—¶å°±ä¼šçœ‹åˆ°å…·ä½“çš„é”™è¯¯äº†ï¼Œç„¶åå†æ ¹æ®é”™è¯¯æç¤ºè¿›è¡Œç›¸åº”çš„ä¿®æ”¹å³å¯ã€‚</p><h1 id="ä»£ç ç¯‡"><a href="#ä»£ç ç¯‡" class="headerlink" title="ä»£ç ç¯‡"></a>ä»£ç ç¯‡</h1><h1 id="ADODB-Connection-é”™è¯¯-â€˜800a0e7aâ€™"><a href="#ADODB-Connection-é”™è¯¯-â€˜800a0e7aâ€™" class="headerlink" title="ADODB.Connection é”™è¯¯ â€˜800a0e7aâ€™"></a>ADODB.Connection é”™è¯¯ â€˜800a0e7aâ€™</h1><p><strong>å…·ä½“é”™è¯¯</strong>ï¼š<br>ADODB.Connection é”™è¯¯ â€˜800a0e7aâ€™<br>æœªæ‰¾åˆ°æä¾›ç¨‹åºã€‚è¯¥ç¨‹åºå¯èƒ½æœªæ­£ç¡®å®‰è£…ã€‚</p><p><strong>åŸå› </strong>ï¼š</p><p>å› ä¸ºç³»ç»Ÿæ˜¯64ä½çš„win10ï¼Œæ‰€ä»¥ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>è§£å†³åŠæ³•</strong>ï¼š<br>æ‰¾åˆ°IISåº”ç”¨ç¨‹åºæ± ï¼Œâ€œè®¾ç½®åº”ç”¨ç¨‹åºæ± é»˜è®¤å±æ€§â€-&gt;â€œå¸¸è§„â€-&gt;â€å¯ç”¨ 32 ä½åº”ç”¨ç¨‹åºâ€ï¼Œè®¾ç½®ä¸º Trueã€‚</p><p><img src="https://images.morethink.cn/bb814d72e30f1a99899cc7e919fa774e.png" alt=""><br>height=â€100%â€ width=â€100%â€</p><p>style=â€width:757px; height:455px;â€<br>è¿™æ ·é—®é¢˜å°±è§£å†³äº†ã€‚</p><h1 id="ADODB-Recordset-é”™è¯¯-â€˜800a0cc1â€™"><a href="#ADODB-Recordset-é”™è¯¯-â€˜800a0cc1â€™" class="headerlink" title="ADODB.Recordset é”™è¯¯ â€˜800a0cc1â€™"></a>ADODB.Recordset é”™è¯¯ â€˜800a0cc1â€™</h1><p><strong>æè¿°</strong>ï¼š<br>ADODB.Recordset é”™è¯¯ â€˜800a0cc1â€™<br>åœ¨å¯¹åº”æ‰€éœ€åç§°æˆ–åºæ•°çš„é›†åˆä¸­ï¼Œæœªæ‰¾åˆ°é¡¹ç›®ã€‚</p><p><strong>è§£å†³</strong>ï¼š<br>ä¸€èˆ¬æ˜¯å­—æ®µå†™é”™äº†æˆ–è€…ï¼Œä½ çš„æ•°æ®åº“æ²¡æœ‰è¿™ä¸ªå­—æ®µã€‚</p><h1 id="iframeè‡ªé€‚åº”"><a href="#iframeè‡ªé€‚åº”" class="headerlink" title="iframeè‡ªé€‚åº”"></a>iframeè‡ªé€‚åº”</h1><p>JSä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//iframeé«˜åº¦è‡ªé€‚åº”</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IFrameReSize</span>(<span class="params">iframename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> pTar = <span class="built_in">document</span>.getElementByIdx_x_x(iframename);</span><br><span class="line">    <span class="keyword">if</span> (pTar) &#123; <span class="comment">//ff</span></span><br><span class="line">        <span class="keyword">if</span> (pTar.contentDocument &amp;&amp; pTar.contentDocument.body.offsetHeight) &#123;</span><br><span class="line">            pTar.height = pTar.contentDocument.body.offsetHeight;</span><br><span class="line">        &#125; <span class="comment">//ie</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (pTar.Document &amp;&amp; pTar.Document.body.scrollHeight) &#123;</span><br><span class="line"></span><br><span class="line">            pTar.height = pTar.Document.body.scrollHeight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//iframeå®½åº¦è‡ªé€‚åº”</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">IFrameReSizeWidth</span>(<span class="params">iframename</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> pTar = <span class="built_in">document</span>.getElementByIdx_x_x(iframename);</span><br><span class="line">    <span class="keyword">if</span> (pTar) &#123; <span class="comment">//ff</span></span><br><span class="line">        <span class="keyword">if</span> (pTar.contentDocument &amp;&amp; pTar.contentDocument.body.offsetWidth) &#123;</span><br><span class="line">            pTar.width = pTar.contentDocument.body.offsetWidth;</span><br><span class="line">        &#125; <span class="comment">//ie</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (pTar.Document &amp;&amp; pTar.Document.body.scrollWidth) &#123;</span><br><span class="line">            pTar.width = pTar.Document.body.scrollWidth;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>Iframeæ¡†é…ç½®ï¼š<br><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"Main.htm"</span> <span class="attr">scrolling</span>=<span class="string">"no"</span> <span class="attr">frameborder</span>=<span class="string">"0"</span> <span class="attr">height</span>=<span class="string">"100%"</span></span></span><br><span class="line"><span class="tag"><span class="attr">id</span>=<span class="string">"mainFrame"</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">onload</span>=<span class="string">'IFrameReSize("mainFrame");IFrameReSizeWidth("mainFrame");'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="ACCESSåˆ†é¡µ"><a href="#ACCESSåˆ†é¡µ" class="headerlink" title="ACCESSåˆ†é¡µ"></a>ACCESSåˆ†é¡µ</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> news <span class="keyword">where</span> nid <span class="keyword">between</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">min</span>(nid) <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> top <span class="number">4</span> nid <span class="keyword">from</span> newsdata <span class="keyword">order</span> <span class="keyword">by</span> nid <span class="keyword">desc</span>))</span><br><span class="line"><span class="keyword">and</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="keyword">min</span>(nid) <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> top <span class="number">1</span> nid <span class="keyword">from</span> newsdata <span class="keyword">order</span> <span class="keyword">by</span> nid <span class="keyword">desc</span>))</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> nid <span class="keyword">desc</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨topå’Œminå‡½æ•°åˆ†åˆ«æ‰¾å‡ºåˆ†é¡µçš„èµ·å§‹IDå’Œç»“æŸIDï¼Œå¦‚æœè¦æŒ‰ç…§å‡åºæ’åˆ—ï¼Œå°±è¦ç”¨topå’Œmaxæ¥æ‰¾å‡ºèµ·å§‹IDå’Œç»“æŸIDï¼Œä¹‹ååœ¨ä½¿ç”¨betweenè¯­å¥ç›´æ¥é€‰å–ã€‚æ³¨æ„ä¸‰ä¸ªåœ°æ–¹çš„æ’åºæ–¹å¼å¿…é¡»ä¸€è‡´ï¼ŒæŸ¥è¯¢æ¡ä»¶ä¹Ÿå¿…é¡»ä¸€è‡´ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.ljf.cn/archives/2281" target="_blank" rel="noopener">ç®€å•åˆé«˜æ•ˆçš„Accessåˆ†é¡µè¯­å¥</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IIS </tag>
            
            <tag> ASP </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nginxå‡ ç§è´Ÿè½½å‡è¡¡ç®—æ³•åŠé…ç½®å®ä¾‹</title>
      <link href="/Nginx-several-load-balancing-algorithm/"/>
      <url>/Nginx-several-load-balancing-algorithm/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡è£…è½½è‡ªï¼š <a href="https://yq.aliyun.com/articles/114683" target="_blank" rel="noopener">https://yq.aliyun.com/articles/114683</a></p><p>Nginxè´Ÿè½½å‡è¡¡ï¼ˆå·¥ä½œåœ¨ä¸ƒå±‚â€œåº”ç”¨å±‚â€ï¼‰åŠŸèƒ½ä¸»è¦æ˜¯é€šè¿‡upstreamæ¨¡å—å®ç°ï¼ŒNginxè´Ÿè½½å‡è¡¡é»˜è®¤å¯¹åç«¯æœåŠ¡å™¨æœ‰å¥åº·æ£€æµ‹çš„èƒ½åŠ›ï¼Œä»…é™äºç«¯å£æ£€æµ‹ï¼Œåœ¨åç«¯æœåŠ¡å™¨æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹è´Ÿè½½å‡è¡¡èƒ½åŠ›è¡¨ç°çªå‡ºã€‚</p><p>Nginxçš„å‡ ç§è´Ÿè½½å‡è¡¡ç®—æ³•ï¼š<br><a id="more"></a></p><ol><li>è½®è¯¢ï¼ˆé»˜è®¤ï¼‰ï¼šæ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æŸå°æœåŠ¡å™¨å®•æœºï¼Œåˆ™è‡ªåŠ¨å‰”é™¤æ•…éšœæœºå™¨ï¼Œä½¿ç”¨æˆ·è®¿é—®ä¸å—å½±å“ã€‚</li><li>weightï¼šæŒ‡å®šè½®è¯¢æƒé‡ï¼Œweightå€¼è¶Šå¤§ï¼Œåˆ†é…åˆ°çš„å‡ ç‡å°±è¶Šé«˜ï¼Œä¸»è¦ç”¨äºåç«¯æ¯å°æœåŠ¡å™¨æ€§èƒ½ä¸å‡è¡¡çš„æƒ…å†µã€‚</li><li>ip_hashï¼šæ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®IPçš„å“ˆå¸Œç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥æœ‰æ•ˆçš„è§£å†³åŠ¨æ€ç½‘é¡µå­˜åœ¨çš„sessionå…±äº«é—®é¢˜ã€‚</li><li>fairï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼šæ›´æ™ºèƒ½çš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œæ­¤ç®—æ³•å¯ä»¥æ ¹æ®é¡µé¢å¤§å°å’ŒåŠ è½½æ—¶é—´é•¿çŸ­æ™ºèƒ½åœ°è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨æ­¤è°ƒåº¦ç®—æ³•ï¼Œéœ€è¦Nginxçš„upstream_fairæ¨¡å—ã€‚</li><li>url_hashï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼šæŒ‰è®¿é—®URLçš„å“ˆå¸Œç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªURLå®šå‘åˆ°åŒä¸€å°åç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜åç«¯ç¼“å­˜æœåŠ¡å™¨çš„æ•ˆç‡ã€‚å¦‚æœæƒ³è¦ä½¿ç”¨æ­¤è°ƒåº¦ç®—æ³•ï¼Œéœ€è¦Nginxçš„hashè½¯ä»¶åŒ…ã€‚</li></ol><p>åœ¨upstreamæ¨¡å—ä¸­ï¼Œå¯ä»¥é€šè¿‡serverå‘½ä»¤æŒ‡å®šåç«¯æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£ï¼ŒåŒæ—¶è¿˜å¯ä»¥è®¾ç½®æ¯å°åç«¯æœåŠ¡å™¨åœ¨è´Ÿè½½å‡è¡¡è°ƒåº¦ä¸­çš„çŠ¶æ€ï¼Œå¸¸ç”¨çš„çŠ¶æ€æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>downï¼šè¡¨ç¤ºå½“å‰serveræš‚æ—¶ä¸å‚ä¸è´Ÿè½½å‡è¡¡ã€‚</li><li>backupï¼šé¢„ç•™çš„å¤‡ä»½æœºï¼Œå½“å…¶ä»–æ‰€æœ‰ébackupæœºå™¨å‡ºç°æ•…éšœæˆ–è€…ç¹å¿™çš„æ—¶å€™ï¼Œæ‰ä¼šè¯·æ±‚backupæœºå™¨ï¼Œè¿™å°æœºå™¨çš„è®¿é—®å‹åŠ›æœ€è½»ã€‚</li><li>max_failsï¼šå…è®¸è¯·æ±‚çš„å¤±è´¥æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1ï¼Œé…åˆfail_timeoutä¸€èµ·ä½¿ç”¨</li><li>fail_timeoutï¼šç»å†max_failsæ¬¡å¤±è´¥åï¼Œæš‚åœæœåŠ¡çš„æ—¶é—´ï¼Œé»˜è®¤ä¸º10sï¼ˆæŸä¸ªserverè¿æ¥å¤±è´¥äº†max_failsæ¬¡ï¼Œåˆ™nginxä¼šè®¤ä¸ºè¯¥serverä¸å·¥ä½œäº†ã€‚åŒæ—¶ï¼Œåœ¨æ¥ä¸‹æ¥çš„ fail_timeoutæ—¶é—´å†…ï¼Œnginxä¸å†å°†è¯·æ±‚åˆ†å‘ç»™å¤±æ•ˆçš„serverã€‚ï¼‰</li></ol><p>ä¸‹é¢æ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡çš„é…ç½®ç¤ºä¾‹ï¼Œè¿™é‡Œåªåˆ—å‡ºhttpé…ç½®æ®µï¼Œçœç•¥äº†å…¶ä»–éƒ¨åˆ†é…ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    upstream whsirserver &#123;</span><br><span class="line">    server 192.168.0.120:80 weight=5 max_fails=3 fail_timeout=20s;</span><br><span class="line">    server 192.168.0.121:80 weight=1 max_fails=3 fail_timeout=20s;</span><br><span class="line">    server 192.168.0.122:80 weight=3 max_fails=3 fail_timeout=20s;</span><br><span class="line">    server 192.168.0.123:80 weight=4 max_fails=3 fail_timeout=20s;</span><br><span class="line">    &#125;</span><br><span class="line">    server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name blog.whsir.com;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line">    root /data/www;</span><br><span class="line">        location / &#123;</span><br><span class="line">        proxy_pass http://whsirserver;</span><br><span class="line">        proxy_next_upstream http_500 http_502 error timeout invalid_header;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>upstreamè´Ÿè½½å‡è¡¡å¼€å§‹ï¼Œé€šè¿‡upstreamæŒ‡å®šäº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨çš„åç§°ä¸ºwhsirserverï¼Œè¿™ä¸ªåç§°å¯ä»¥è‡ªå·±å®šä¹‰ï¼Œåœ¨åé¢proxy_passç›´æ¥è°ƒç”¨å³å¯ã€‚</p><p>proxy_next_upstreamå‚æ•°ç”¨æ¥å®šä¹‰æ•…éšœè½¬ç§»ç­–ç•¥ï¼Œå½“åç«¯æœåŠ¡å™¨èŠ‚ç‚¹è¿”å›500ã€502å’Œæ‰§è¡Œè¶…æ—¶ç­‰é”™è¯¯æ—¶ï¼Œè‡ªåŠ¨å°†è¯·æ±‚è½¬å‘åˆ°upstreamè´Ÿè½½å‡è¡¡å™¨ä¸­çš„å¦ä¸€å°æœåŠ¡å™¨ï¼Œå®ç°æ•…éšœè½¬ç§»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> è´Ÿè½½å‡è¡¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaè§£å†³CSRFé—®é¢˜</title>
      <link href="/Java%E8%A7%A3%E5%86%B3CSRF%E9%97%AE%E9%A2%98/"/>
      <url>/Java%E8%A7%A3%E5%86%B3CSRF%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>é¡¹ç›®åœ°å€ï¼š <a href="https://github.com/morethink/web-security-csrf" target="_blank" rel="noopener">https://github.com/morethink/web-security-csrf</a></p><h1 id="CSRFæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#CSRFæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="CSRFæ˜¯ä»€ä¹ˆï¼Ÿ"></a>CSRFæ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>CSRFï¼ˆCross-site request forgeryï¼‰ï¼Œä¸­æ–‡åç§°ï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œä¹Ÿè¢«ç§°ä¸ºï¼šone click attack/session ridingï¼Œç¼©å†™ä¸ºï¼šCSRF/XSRFã€‚</p><h1 id="CSRFå¯ä»¥åšä»€ä¹ˆï¼Ÿ"><a href="#CSRFå¯ä»¥åšä»€ä¹ˆï¼Ÿ" class="headerlink" title="CSRFå¯ä»¥åšä»€ä¹ˆï¼Ÿ"></a>CSRFå¯ä»¥åšä»€ä¹ˆï¼Ÿ</h1><p>ä½ è¿™å¯ä»¥è¿™ä¹ˆç†è§£CSRFæ”»å‡»ï¼šæ”»å‡»è€…ç›—ç”¨äº†ä½ çš„èº«ä»½ï¼Œä»¥ä½ çš„åä¹‰å‘é€æ¶æ„è¯·æ±‚ã€‚CSRFèƒ½å¤Ÿåšçš„äº‹æƒ…åŒ…æ‹¬ï¼šä»¥ä½ åä¹‰å‘é€é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç›—å–ä½ çš„è´¦å·ï¼Œç”šè‡³äºè´­ä¹°å•†å“ï¼Œè™šæ‹Ÿè´§å¸è½¬è´¦â€¦â€¦é€ æˆçš„é—®é¢˜åŒ…æ‹¬ï¼šä¸ªäººéšç§æ³„éœ²ä»¥åŠè´¢äº§å®‰å…¨ã€‚</p><a id="more"></a><h1 id="CSRFçš„åŸç†"><a href="#CSRFçš„åŸç†" class="headerlink" title="CSRFçš„åŸç†"></a>CSRFçš„åŸç†</h1><p>ä¸‹å›¾ç®€å•é˜è¿°äº†CSRFæ”»å‡»çš„æ€<br><img src="https://images.morethink.cn/138ad4f05b47533bf46904dc165167cc.png" alt=""></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œè¦å®Œæˆä¸€æ¬¡CSRFæ”»å‡»ï¼Œå—å®³è€…å¿…é¡»ä¾æ¬¡å®Œæˆä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>ç™»å½•å—ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶åœ¨æœ¬åœ°ç”ŸæˆCookieã€‚</li><li>åœ¨ä¸ç™»å‡ºAçš„æƒ…å†µä¸‹ï¼Œè®¿é—®å±é™©ç½‘ç«™Bã€‚</li></ol><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ ä¹Ÿè®¸ä¼šè¯´ï¼šâ€œå¦‚æœæˆ‘ä¸æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶ä¸­çš„ä¸€ä¸ªï¼Œæˆ‘å°±ä¸ä¼šå—åˆ°CSRFçš„æ”»å‡»â€ã€‚æ˜¯çš„ï¼Œç¡®å®å¦‚æ­¤ï¼Œä½†ä½ ä¸èƒ½ä¿è¯ä»¥ä¸‹æƒ…å†µä¸ä¼šå‘ç”Ÿï¼š</p><ol><li>ä½ ä¸èƒ½ä¿è¯ä½ ç™»å½•äº†ä¸€ä¸ªç½‘ç«™åï¼Œä¸å†æ‰“å¼€ä¸€ä¸ªtabé¡µé¢å¹¶è®¿é—®å¦å¤–çš„ç½‘ç«™ã€‚</li><li>ä½ ä¸èƒ½ä¿è¯ä½ å…³é—­æµè§ˆå™¨äº†åï¼Œä½ æœ¬åœ°çš„Cookieç«‹åˆ»è¿‡æœŸï¼Œä½ ä¸Šæ¬¡çš„ä¼šè¯å·²ç»ç»“æŸã€‚ï¼ˆäº‹å®ä¸Šï¼Œå…³é—­æµè§ˆå™¨ä¸èƒ½ç»“æŸä¸€ä¸ªä¼šè¯ï¼Œä½†å¤§å¤šæ•°äººéƒ½ä¼šé”™è¯¯çš„è®¤ä¸ºå…³é—­æµè§ˆå™¨å°±ç­‰äºé€€å‡ºç™»å½•/ç»“æŸä¼šè¯äº†â€¦â€¦ï¼‰</li><li>ä¸Šå›¾ä¸­æ‰€è°“çš„æ”»å‡»ç½‘ç«™ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå­˜åœ¨å…¶ä»–æ¼æ´çš„å¯ä¿¡ä»»çš„ç»å¸¸è¢«äººè®¿é—®çš„ç½‘ç«™ã€‚</li></ol><p>ä¸‹é¢è®²ä¸€è®²javaè§£å†³CSRFæ”»å‡»çš„æ–¹å¼ã€‚</p><h1 id="æ¨¡æ‹ŸCSRFæ”»å‡»"><a href="#æ¨¡æ‹ŸCSRFæ”»å‡»" class="headerlink" title="æ¨¡æ‹ŸCSRFæ”»å‡»"></a>æ¨¡æ‹ŸCSRFæ”»å‡»</h1><h2 id="ç™»å½•Aç½‘ç«™"><a href="#ç™»å½•Aç½‘ç«™" class="headerlink" title="ç™»å½•Aç½‘ç«™"></a>ç™»å½•Aç½‘ç«™</h2><p>ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯adminã€‚</p><p><code>http://localhost:8081/login.html</code>:<br><img src="https://images.morethink.cn/e298f8ef08869557b8fb60034f06bb80.png" alt=""></p><h2 id="ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­"><a href="#ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­" class="headerlink" title="ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­"></a>ä½ æœ‰æƒé™åˆ é™¤1å·å¸–å­</h2><p><code>http://localhost:8081/deletePost.html</code>:<br><img src="https://images.morethink.cn/897d358f2677d053bb9555ff69d112ac.png" alt=""></p><h2 id="ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™"><a href="#ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™" class="headerlink" title="ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™"></a>ç™»å½•æœ‰CSRFæ”»å‡»Aç½‘ç«™çš„Bç½‘ç«™</h2><p><code>http://localhost:8082/deletePost.html</code>:</p><p><img src="https://images.morethink.cn/csrf-attack.gif" alt=""></p><p>æ˜æ˜¾çœ‹åˆ°Bç½‘ç«™æ˜¯8082ç«¯å£ï¼ŒAç½‘ç«™æ˜¯8081ç«¯å£ï¼Œä½†æ˜¯Bç½‘ç«™çš„åˆ é™¤2å·å¸–å­åŠŸèƒ½ä¾ç„¶å®ç°ã€‚</p><h1 id="é¢„é˜²CSRFæ”»å‡»"><a href="#é¢„é˜²CSRFæ”»å‡»" class="headerlink" title="é¢„é˜²CSRFæ”»å‡»"></a>é¢„é˜²CSRFæ”»å‡»</h1><p>ç®€å•æ¥è¯´ï¼ŒCSRF å°±æ˜¯ç½‘ç«™ A å¯¹ç”¨æˆ·å»ºç«‹ä¿¡ä»»å…³ç³»åï¼Œåœ¨ç½‘ç«™ B ä¸Šåˆ©ç”¨è¿™ç§ä¿¡ä»»å…³ç³»ï¼Œè·¨ç«™ç‚¹å‘ç½‘ç«™ A å‘èµ·ä¸€äº›ä¼ªé€ çš„ç”¨æˆ·æ“ä½œè¯·æ±‚ï¼Œä»¥è¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</p><p>è€Œä¹‹æ‰€ä»¥å¯ä»¥å®Œæˆæ”»å‡»æ˜¯å› ä¸ºBå‘Aå‘èµ·æ”»å‡»çš„æ—¶å€™ä¼šæŠŠAç½‘ç«™çš„cookieå¸¦ç»™Aç½‘ç«™ï¼Œä¹Ÿå°±æ˜¯è¯´cookieå·²ç»ä¸å®‰å…¨äº†ã€‚</p><h2 id="é€šè¿‡Synchronizer-Tokens"><a href="#é€šè¿‡Synchronizer-Tokens" class="headerlink" title="é€šè¿‡Synchronizer Tokens"></a>é€šè¿‡Synchronizer Tokens</h2><p>Synchronizer Tokensï¼š åœ¨è¡¨å•é‡Œéšè—ä¸€ä¸ªéšæœºå˜åŒ–çš„ csrf_token csrf_token æäº¤åˆ°åå°è¿›è¡ŒéªŒè¯ï¼Œå¦‚æœéªŒè¯é€šè¿‡åˆ™å¯ä»¥ç»§ç»­æ‰§è¡Œæ“ä½œã€‚è¿™ç§æƒ…å†µæœ‰æ•ˆçš„ä¸»è¦åŸå› æ˜¯ç½‘ç«™ B æ‹¿ä¸åˆ°ç½‘ç«™ A è¡¨å•é‡Œçš„ csrf_token</p><p>è¿™ç§æ–¹å¼çš„ä½¿ç”¨æ¡ä»¶æ˜¯PHPå’ŒJSPç­‰ã€‚å› ä¸ºcookieå·²ç»ä¸å®‰å…¨äº†ï¼Œå› æ­¤æŠŠcsrf_tokenå€¼å­˜å‚¨åœ¨sessionä¸­ï¼Œç„¶åæ¯æ¬¡è¡¨å•æäº¤æ—¶éƒ½ä»sessionå–å‡ºæ¥æ”¾åˆ°formè¡¨å•çš„éšè—åŸŸä¸­ï¼Œè¿™æ ·Bç½‘ç«™ä¸å¯ä»¥å¾—åˆ°è¿™ä¸ªå­˜å‚¨åˆ°sessionä¸­çš„å€¼ã€‚</p><p>ä¸‹é¢æ˜¯JSPçš„ï¼š<br><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&lt;input type="hidden" name="random_form" value=&lt;%=random%&gt;&gt;&lt;/input&gt;</span><br></pre></td></tr></table></figure></p><p>ä½†æ˜¯æˆ‘ç°åœ¨çš„æƒ…å†µæ˜¯htmlï¼Œä¸æ˜¯JSPï¼Œå¹¶ä¸èƒ½åŠ¨æ€çš„ä»sessionä¸­å–å‡ºcsrf_tokenå€¼ã€‚åªèƒ½é‡‡ç”¨åŠ å¯†çš„æ–¹å¼äº†ã€‚</p><h2 id="HashåŠ å¯†cookieä¸­csrf-tokenå€¼"><a href="#HashåŠ å¯†cookieä¸­csrf-tokenå€¼" class="headerlink" title="HashåŠ å¯†cookieä¸­csrf_tokenå€¼"></a>HashåŠ å¯†cookieä¸­csrf_tokenå€¼</h2><p>è¿™å¯èƒ½æ˜¯æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆäº†ï¼Œå› ä¸ºæ”»å‡»è€…ä¸èƒ½è·å¾—ç¬¬ä¸‰æ–¹çš„Cookie(ç†è®ºä¸Š)ï¼Œæ‰€ä»¥è¡¨å•ä¸­çš„æ•°æ®ä¹Ÿå°±æ„é€ å¤±è´¥äº†ã€‚</p><p>æˆ‘é‡‡ç”¨çš„hashåŠ å¯†æ–¹æ³•æ˜¯JSå®ç°Javaçš„HashCodeæ–¹æ³•ï¼Œå¾—åˆ°hashå€¼ï¼Œè¿™ä¸ªæ¯”è¾ƒç®€å•ã€‚ä¹Ÿå¯ä»¥é‡‡ç”¨å…¶ä»–çš„hashç®—æ³•ã€‚</p><p>å‰ç«¯å‘åå°ä¼ é€’hashä¹‹åçš„csrf_tokenå€¼å’Œcookieä¸­çš„csrf_tokenå€¼ï¼Œåå°æ‹¿åˆ°cookieä¸­çš„csrf_tokenå€¼åå¾—åˆ°hashCodeå€¼ç„¶åä¸å‰ç«¯ä¼ è¿‡æ¥çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€æ ·åˆ™é€šè¿‡ã€‚</p><h3 id="ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­"><a href="#ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­" class="headerlink" title="ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­"></a>ä½ æœ‰æƒé™åˆ é™¤3å·å¸–å­</h3><p><code>http://localhost:8081/deletePost.html</code></p><p><img src="https://images.morethink.cn/2ac5eab98780646c6c36dcdc98fa50c7.png" alt=""></p><h3 id="Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†"><a href="#Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†" class="headerlink" title="Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†"></a>Bç½‘ç«™çš„ä»–å·²ç»æ²¡æœ‰æƒé™äº†</h3><p>æˆ‘ä»¬é€šè¿‡UserFilter.javaç»™æ”»å‡»è€…è¿”å›çš„æ˜¯403é”™è¯¯ï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç†è§£ç”¨æˆ·å®¢æˆ·ç«¯çš„è¯·æ±‚ä½†æ‹’ç»å¤„ç†ã€‚</p><p><code>http://localhost:8082/deletePost.html</code>:<br><img src="https://images.morethink.cn/csrf-attack-fail-failure.gif" alt=""></p><p>æ”»å‡»è€…ä¸èƒ½åˆ é™¤4å·å¸–å­ã€‚</p><p>å‰ç«¯ä»£ç ï¼š</p><p>deletePost.html</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>deletePost<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        function deletePost() &#123;</span></span><br><span class="line"><span class="undefined">            var url = '/post/' + document.getElementById("postId").value;</span></span><br><span class="line"><span class="undefined">            var csrf_token = document.cookie.replace(/(?:(?:^|.*;\s*)csrf_token\s*\=\s*([^;]*).*$)|^.*$/, "$1");</span></span><br><span class="line"><span class="undefined">            console.log('csrf_token=' + csrf_token);</span></span><br><span class="line"><span class="undefined">            $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">                type: "post",//è¯·æ±‚æ–¹å¼</span></span><br><span class="line"><span class="undefined">                url: url,  //å‘é€è¯·æ±‚åœ°å€</span></span><br><span class="line"><span class="undefined">                timeout: 30000,//è¶…æ—¶æ—¶é—´ï¼š30ç§’</span></span><br><span class="line"><span class="undefined">                data: &#123;</span></span><br><span class="line"><span class="undefined">                    "_method": "delete",</span></span><br><span class="line"><span class="undefined">                    "csrf_token": hash(csrf_token) // å¯¹csrf_tokenè¿›è¡ŒhashåŠ å¯†</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                dataType: "json",//è®¾ç½®è¿”å›æ•°æ®çš„æ ¼å¼</span></span><br><span class="line"><span class="undefined">                success: function (result) &#123;</span></span><br><span class="line"><span class="undefined">                    if (result.message == "success") &#123;</span></span><br><span class="line"><span class="undefined">//                    window.location.href = "index.html";</span></span><br><span class="line"><span class="undefined">                        $("#result").text("åˆ é™¤æˆåŠŸ");</span></span><br><span class="line"><span class="undefined">                    &#125; else &#123;</span></span><br><span class="line"><span class="undefined">                        $("#result").text("åˆ é™¤å¤±è´¥");</span></span><br><span class="line"><span class="undefined">                    &#125;</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                error: function () &#123; //è¯·æ±‚å‡ºé”™çš„å¤„ç†</span></span><br><span class="line"><span class="undefined">                    $("#result").text("è¯·æ±‚å‡ºé”™");</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        // javascriptçš„Stringåˆ°int(32ä½)çš„hashç®—æ³•</span></span><br><span class="line"><span class="undefined">        function hash(str) &#123;</span></span><br><span class="line"><span class="undefined">            var hash = 0;</span></span><br><span class="line"><span class="undefined">            if (str.length == 0) return hash;</span></span><br><span class="line"><span class="undefined">            for (i = 0; i &lt; str.length; i++) &#123;</span></span><br><span class="line"><span class="undefined">                char = str.charCodeAt(i);</span></span><br><span class="line"><span class="undefined">                hash = ((hash &lt;&lt; 5) - hash) + char;</span></span><br><span class="line"><span class="undefined">                hash = hash &amp; hash; // Convert to 32bit integer</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">            return hash;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>åˆ é™¤å¸–å­<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">å¸–å­ç¼–å· ï¼š <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"postId"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"deletePost();"</span>&gt;</span>deletePost<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åå°ä»£ç ï¼š</p><p>UserInterceptor.java</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.morethink.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.morethink.util.JsonUtil;</span><br><span class="line"><span class="keyword">import</span> cn.morethink.util.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/1/4</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String method = request.getMethod();</span><br><span class="line">        System.out.println(method);</span><br><span class="line">        <span class="keyword">if</span> (method.equalsIgnoreCase(<span class="string">"POST"</span>) || method.equalsIgnoreCase(<span class="string">"DELETE"</span>)</span><br><span class="line">                || method.equalsIgnoreCase(<span class="string">"PUT"</span>)) &#123;</span><br><span class="line">            String csrf_token = request.getParameter(<span class="string">"csrf_token"</span>);</span><br><span class="line">            System.out.println(csrf_token + <span class="string">"1222222222222222222222222222222222222222222222"</span>);</span><br><span class="line">            Cookie[] cookies = request.getCookies();</span><br><span class="line">            <span class="keyword">if</span> (cookies != <span class="keyword">null</span> &amp;&amp; cookies.length &gt; <span class="number">0</span> &amp;&amp; csrf_token != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Cookie cookie : cookies) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cookie.getName().equals(<span class="string">"csrf_token"</span>)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (Integer.valueOf(csrf_token) == cookie.getValue().hashCode()) &#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result(<span class="string">"403"</span>, <span class="string">"ä½ è¿˜æƒ³æ”»å‡»æˆ‘??????????"</span>, <span class="string">""</span>);</span><br><span class="line">        PrintWriter out = response.getWriter();</span><br><span class="line">        out.write(JsonUtil.toJson(result));</span><br><span class="line">        out.close();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><ol><li>cookieå¿…é¡»è¦è®¾ç½®PATHæ‰å¯ä»¥ç”Ÿæ•ˆï¼Œå¦åˆ™åœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™æ— æ³•å¸¦ç»™æœåŠ¡å™¨ã€‚</li><li>Spring Boot å‡ºç°å¯åŠ¨æ‰¾ä¸åˆ°ä¸»ç±»çš„é—®é¢˜æ—¶å¯ä»¥mvn cleanä¸€ä¸‹ã€‚</li><li>Filterè®¾ç½®response.sendError(403)åœ¨Spring Bootæ²¡æœ‰æ•ˆæœã€‚</li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html" target="_blank" rel="noopener">æµ…è°ˆCSRFæ”»å‡»æ–¹å¼</a></li><li><a href="http://blog.csdn.net/zzhongcy/article/details/20133883" target="_blank" rel="noopener">jQueue åŠ¨æ€è®¾ç½®formè¡¨å•çš„actionå±æ€§çš„å€¼å’Œæ–¹æ³•</a></li><li><a href="https://www.thinksaas.cn/group/topic/304242/" target="_blank" rel="noopener">javascriptçš„Stringåˆ°int(32ä½)çš„hashç®—æ³•</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSRF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nginx Httpsé…ç½®ä¸å¸¦wwwè·³è½¬www</title>
      <link href="/Nginx-Https-no-www-jump-www/"/>
      <url>/Nginx-Https-no-www-jump-www/</url>
      
        <content type="html"><![CDATA[<p>æŠŠ morethink.cnå’Œ<a href="http://www.morethink.cnåˆå¹¶åˆ°ä¸€ä¸ªserverä¸Šå»ï¼Œä½¿ç”¨301æ°¸ä¹…é‡å®šå‘ã€‚" target="_blank" rel="noopener">www.morethink.cnåˆå¹¶åˆ°ä¸€ä¸ªserverä¸Šå»ï¼Œä½¿ç”¨301æ°¸ä¹…é‡å®šå‘ã€‚</a><br>ç„¶åå°† <a href="https://morethink.cn" target="_blank" rel="noopener">https://morethink.cn</a> è½¬åˆ° <a href="https://www.morethink.cn">https://www.morethink.cn</a> å»ã€‚ä¸è¿‡è¦åœ¨é…ç½®æ–‡ä»¶çš„ <code>server</code> <a href="https://www.morethink.cn">https://www.morethink.cn</a><br>ä¸Šé…ç½®default_server ssl;ã€‚<br>301æ°¸ä¹…é‡å®šå‘å¯ä»¥æŠŠæœç´¢å¼•æ“çš„æƒé‡å…¨éƒ¨é›†ä¸­åˆ° <a href="https://www.morethink.cn">https://www.morethink.cn</a> ä¸Šã€‚</p><a id="more"></a><p>é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name morethink.cn,www.morethink.cn;</span><br><span class="line">    return 301 https://www.morethink.cn$request_uri;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 443;</span><br><span class="line">    server_name morethink.cn;</span><br><span class="line">    return 301 https://www.morethink.cn$request_uri;</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 default_server ssl;</span><br><span class="line">    server_name  www.morethink.cn;</span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate 1_www.morethink.cn_bundle.crt;</span><br><span class="line">    ssl_certificate_key 2_www.morethink.cn.key;</span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    root         /var/www/hexo;</span><br><span class="line">    include /etc/nginx/default.d/*.conf;</span><br><span class="line">    error_page 404 /404.html;</span><br><span class="line">        location = /40x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="https://cloud.tencent.com/document/product/400/4143" target="_blank" rel="noopener">è…¾è®¯äº‘ Nginx Https è¯ä¹¦å®‰è£…æŒ‡å¼•</a></li><li><a href="https://docs.lvrui.io/2017/04/01/nginx%E9%85%8D%E7%BD%AEhttp%E5%BC%BA%E5%88%B6%E8%B7%B3%E8%BD%AChttps/" target="_blank" rel="noopener">nginxé…ç½®httpå¼ºåˆ¶è·³è½¬https</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Https </tag>
            
            <tag> Nginx </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é¢è¯•ä¸­çš„Https</title>
      <link href="/Https/"/>
      <url>/Https/</url>
      
        <content type="html"><![CDATA[<p>åœ¨Httpåè®®ä¸­æœ‰å¯èƒ½å­˜åœ¨ä¿¡æ¯çªƒå¬æˆ–èº«ä»½ä¼ªè£…çš„å®‰å…¨é—®é¢˜ã€‚ä½¿ç”¨HTTPSé€šä¿¡æœºåˆ¶å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢è¿™äº›é—®é¢˜ã€‚</p><h1 id="Https"><a href="#Https" class="headerlink" title="Https"></a>Https</h1><h2 id="Httpçš„ç¼ºç‚¹"><a href="#Httpçš„ç¼ºç‚¹" class="headerlink" title="Httpçš„ç¼ºç‚¹"></a>Httpçš„ç¼ºç‚¹</h2><ul><li>é€šä¿¡ä½¿ç”¨æ˜æ–‡(ä¸åŠ å¯†)ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ã€‚</li><li>ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£…ã€‚</li><li>æ— æ³•éªŒè¯æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹ã€‚</li></ul><p>è¿™äº›é—®é¢˜ä¸ä»…åœ¨Httpä¸Šå‡ºç°ï¼Œå…¶ä»–æœªåŠ å¯†çš„åè®®ä¸­ä¹Ÿä¼šå­˜åœ¨è¿™ç±»é—®é¢˜ã€‚</p><a id="more"></a><h2 id="ä»€ä¹ˆæ˜¯Https"><a href="#ä»€ä¹ˆæ˜¯Https" class="headerlink" title="ä»€ä¹ˆæ˜¯Https"></a>ä»€ä¹ˆæ˜¯Https</h2><p>Httpså¹¶éæ˜¯åº”ç”¨å±‚çš„ä¸€ç§æ–°çš„åè®®ã€‚åªæ˜¯Httpé€šä¿¡æ¥å£éƒ¨åˆ†ç”¨SSL(Secure Socket Layer)å’ŒTLS(Transport Layer Security)åè®®è€Œå·²ã€‚</p><p>é€šå¸¸ï¼ŒHttpç›´æ¥å’ŒTCPé€šä¿¡ã€‚å½“ä½¿ç”¨SSLæ—¶ï¼Œåˆ™æ¼”å˜æˆå…ˆå’ŒSSLåè®®é€šä¿¡ï¼Œå†ç”±SSLå’ŒTCPé€šä¿¡äº†ã€‚ç®€è¨€ä¹‹ï¼Œæ‰€è°“Httpsï¼Œå°±æ˜¯èº«æŠ«SSLè¿™å±‚åè®®å¤–å£³çš„Httpã€‚</p><p><img src="https://images.morethink.cn/0163388a23291dcc361c869f6f8ebc86.png" alt="" title="ä»€ä¹ˆæ˜¯Https"></p><h2 id="Httpsæœ‰ä»€ä¹ˆä½œç”¨"><a href="#Httpsæœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="Httpsæœ‰ä»€ä¹ˆä½œç”¨"></a>Httpsæœ‰ä»€ä¹ˆä½œç”¨</h2><p><code>Http+åŠ å¯†+è®¤è¯+å®Œæ•´æ€§ä¿æŠ¤ = Https</code></p><p>Httpsæœ‰ä»¥ä¸‹ä½œç”¨ï¼š</p><ul><li><strong>å†…å®¹åŠ å¯†</strong> å»ºç«‹ä¸€ä¸ªä¿¡æ¯å®‰å…¨é€šé“ï¼Œæ¥ä¿è¯æ•°æ®ä¼ è¾“çš„å®‰å…¨ã€‚</li><li><strong>èº«ä»½è®¤è¯</strong> ç¡®è®¤ç½‘ç«™çš„çœŸå®æ€§ã€‚</li><li><strong>æ•°æ®å®Œæ•´æ€§</strong> é˜²æ­¢å†…å®¹è¢«ç¬¬ä¸‰æ–¹å†’å……æˆ–è€…ç¯¡æ”¹ã€‚</li></ul><p>ä¸‹é¢å°±æ˜¯Httpsçš„æ•´ä¸ªæ¶æ„ï¼Œç°åœ¨çš„httpsåŸºæœ¬éƒ½ä½¿ç”¨TLSäº†ï¼Œå› ä¸ºæ›´åŠ å®‰å…¨ã€‚</p><h1 id="Https-åŠ å¯†"><a href="#Https-åŠ å¯†" class="headerlink" title="Https åŠ å¯†"></a>Https åŠ å¯†</h1><h2 id="å¯¹ç§°åŠ å¯†"><a href="#å¯¹ç§°åŠ å¯†" class="headerlink" title="å¯¹ç§°åŠ å¯†"></a>å¯¹ç§°åŠ å¯†</h2><p>å¯¹ç§°åŠ å¯†(ä¹Ÿå«ç§é’¥åŠ å¯†)æŒ‡åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒå¯†é’¥çš„åŠ å¯†ç®—æ³•ã€‚æœ‰æ—¶åˆå«ä¼ ç»Ÿå¯†ç ç®—æ³•ï¼Œå°±æ˜¯åŠ å¯†å¯†é’¥èƒ½å¤Ÿä»è§£å¯†å¯†é’¥ä¸­æ¨ç®—å‡ºæ¥ï¼ŒåŒæ—¶è§£å¯†å¯†é’¥ä¹Ÿå¯ä»¥ä»åŠ å¯†å¯†é’¥ä¸­æ¨ç®—å‡ºæ¥ã€‚è€Œåœ¨å¤§å¤šæ•°çš„å¯¹ç§°ç®—æ³•ä¸­ï¼Œ<strong>åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥æ˜¯ç›¸åŒçš„</strong>ï¼Œæ‰€ä»¥ä¹Ÿç§°è¿™ç§åŠ å¯†ç®—æ³•ä¸ºç§˜å¯†å¯†é’¥ç®—æ³•æˆ–å•å¯†é’¥ç®—æ³•ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨å¯¹ç§°åŠ å¯†åŠ å¯†Httpé€šä¿¡å†…å®¹ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨é€šä¿¡è¿‡ç¨‹ä¸­éƒ½å¿…é¡»çŸ¥é“ç§˜é’¥ï¼Œè€Œåœ¨å‘é€ç§˜é’¥çš„è¿‡ç¨‹ä¸­åˆæœ‰å¯èƒ½è¢«ç¬¬ä¸‰æ–¹ç›‘å¬ï¼Œä»è€Œè·å–åˆ°ç§˜é’¥ã€‚</p><h2 id="éå¯¹ç§°åŠ å¯†"><a href="#éå¯¹ç§°åŠ å¯†" class="headerlink" title="éå¯¹ç§°åŠ å¯†"></a>éå¯¹ç§°åŠ å¯†</h2><p>éå¯¹ç§°åŠ å¯†å¾ˆå¥½åœ°è§£å†³äº†å¯¹ç§°åŠ å¯†çš„å›°éš¾ã€‚</p><p>ä¸å¯¹ç§°åŠ å¯†ç®—æ³•ä¸åŒï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekeyï¼‰ï¼Œå¹¶ä¸”åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥æ˜¯æˆå¯¹å‡ºç°çš„ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•åœ¨åŠ å¯†å’Œè§£å¯†è¿‡ç¨‹ä½¿ç”¨äº†ä¸åŒçš„å¯†é’¥ï¼Œéå¯¹ç§°åŠ å¯†ä¹Ÿç§°ä¸ºå…¬é’¥åŠ å¯†ï¼Œåœ¨å¯†é’¥å¯¹ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªå¯†é’¥æ˜¯å¯¹å¤–å…¬å¼€çš„ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥è·å–åˆ°ï¼Œç§°ä¸ºå…¬é’¥ï¼Œå…¶ä¸­ä¸€ä¸ªå¯†é’¥æ˜¯ä¸å…¬å¼€çš„ç§°ä¸ºç§é’¥ã€‚ <strong>ç”¨å…¬é’¥åŠ å¯†çš„åªèƒ½ç”¨ç§é’¥è§£å¼€ï¼Œç”¨ç§é’¥åŠ å¯†çš„åªèƒ½ç”¨å…¬é’¥è§£å¼€</strong>ã€‚</p><p>éå¯¹ç§°åŠ å¯†çš„ç‰¹æ€§å†³å®šäº†æœåŠ¡å™¨ç”¨ç§é’¥åŠ å¯†çš„å†…å®¹å¹¶ä¸æ˜¯çœŸæ­£çš„åŠ å¯†ï¼Œå› ä¸ºå…¬é’¥æ‰€æœ‰äººéƒ½æœ‰ï¼Œæ‰€ä»¥æœåŠ¡å™¨çš„å¯†æ–‡èƒ½è¢«æ‰€æœ‰äººè§£æã€‚ä½†ç§é’¥åªæŒæ¡åœ¨æœåŠ¡å™¨æ‰‹ä¸Šï¼Œè¿™å°±å¸¦æ¥äº†ä¸¤ä¸ªå·¨å¤§çš„ä¼˜åŠ¿:</p><ol><li>æœåŠ¡å™¨ä¸‹å‘çš„å†…å®¹ä¸å¯èƒ½è¢«ä¼ªé€ ï¼Œå› ä¸ºåˆ«äººéƒ½æ²¡æœ‰ç§é’¥ï¼Œæ‰€ä»¥æ— æ³•åŠ å¯†ã€‚å¼ºè¡ŒåŠ å¯†çš„åæœæ˜¯å®¢æˆ·ç«¯ç”¨å…¬é’¥æ— æ³•è§£å¼€ã€‚</li><li>ä»»ä½•äººç”¨å…¬é’¥åŠ å¯†çš„å†…å®¹éƒ½æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå› ä¸ºç§é’¥åªæœ‰æœåŠ¡å™¨æœ‰ï¼Œä¹Ÿå°±æ˜¯åªæœ‰çœŸæ­£çš„æœåŠ¡å™¨å¯ä»¥çœ‹åˆ°è¢«åŠ å¯†çš„åŸæ–‡ã€‚</li></ol><p><strong>æ³¨æ„</strong>ï¼š<br>æƒ³è¦æ ¹æ®å¯†æ–‡å’Œå…¬é’¥ï¼Œæ¢å¤ä¿¡æ¯åŸæ–‡æ˜¯å¼‚å¸¸å›°éš¾çš„ï¼Œå› ä¸ºè§£å¯†è¿‡ç¨‹å°±æ˜¯åœ¨å¯¹ç¦»æ•£å¯¹æ•°è¿›è¡Œæ±‚å€¼ï¼Œè¿™å¹¶éè½»è€Œæ˜“ä¸¾å°±èƒ½åŠåˆ°ã€‚</p><p>å› æ­¤ï¼ŒHttpsé‡‡ç”¨å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ä¸¤è€…å¹¶ç”¨çš„æ··åˆåŠ å¯†æœºåˆ¶ã€‚</p><p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼ŒHttpsé€šè¿‡éå¯¹ç§°åŠ å¯†æ¥ä¼ é€’å¯¹ç§°åŠ å¯†çš„ç§˜é’¥</strong>ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥é‡‡ç”¨éå¯¹ç§°åŠ å¯†æ¥åŠ å¯†é€šä¿¡å†…å®¹ï¼Ÿ</p><p>éå¯¹ç§°åŠ å¯†å¤„ç†èµ·æ¥æ¯”å¯¹ç§°åŠ å¯†æ›´ä¸ºå¤æ‚ï¼Œå› æ­¤è‹¥åœ¨é€šä¿¡æ—¶ä½¿ç”¨éå¯¹ç§°åŠ å¯†ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚</p><h2 id="è¯ä¹¦çš„ç§é’¥åŠ å¯†å…¬é’¥"><a href="#è¯ä¹¦çš„ç§é’¥åŠ å¯†å…¬é’¥" class="headerlink" title="è¯ä¹¦çš„ç§é’¥åŠ å¯†å…¬é’¥"></a>è¯ä¹¦çš„ç§é’¥åŠ å¯†å…¬é’¥</h2><p>é—æ†¾çš„æ˜¯ï¼Œéå¯¹ç§°åŠ å¯†è¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜çš„ã€‚é‚£å°±æ˜¯æ— æ³•ä¿è¯å…¬é’¥æœ¬èº«å°±æ˜¯è´§çœŸä»·å®çš„å…¬é’¥ã€‚æ¯”å¦‚ï¼Œæ­£å‡†å¤‡å’ŒæŸå°æœåŠ¡å™¨å»ºç«‹éå¯¹ç§°åŠ å¯†ä¸‹çš„é€šä¿¡æ—¶ï¼Œå¦‚ä½•è¯æ˜æ”¶åˆ°çš„å…¬é’¥å°±æ˜¯åŸæ¥é¢„æƒ³çš„é‚£å°æœåŠ¡å™¨å‘è¡Œçš„å…¬é’¥ã€‚æˆ–è®¸åœ¨å…¬å¼€ç§˜é’¥ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒçœŸæ­£çš„å…¬é’¥å·²ç»è¢«äººæ›¿æ¢äº†ã€‚</p><p>é‚£æ€ä¹ˆåŠï¼Ÿ<br>å†åŠ å¯†ä¸€æ¬¡ã€‚</p><p><strong>æ¯ä¸€ä¸ªä½¿ç”¨ HTTPS çš„æœåŠ¡å™¨éƒ½å¿…é¡»å»ä¸“é—¨çš„è¯ä¹¦æœºæ„æ³¨å†Œä¸€ä¸ªè¯ä¹¦ï¼Œè¯ä¹¦ä¸­å­˜å‚¨äº†ç”¨æ•°å­—è¯ä¹¦æœºæ„ç§é’¥åŠ å¯†çš„å…¬é’¥ã€‚è¿™æ ·å®¢æˆ·ç«¯ç”¨æ•°å­—è¯ä¹¦æœºæ„çš„å…¬é’¥è§£å¯†å°±å¯ä»¥äº†</strong>ã€‚</p><p>è€Œæ•°å­—è¯ä¹¦æœºæ„çš„å…¬é’¥ä¼šç›´æ¥å†…ç½®åœ¨å„å¤§æ“ä½œç³»ç»Ÿ(æˆ–è€…æµè§ˆå™¨)çš„å‡ºå‚è®¾ç½®é‡Œã€‚æ‰€ä»¥å„ä¸ªå…¬å¸è¦å…ˆå»æ•°å­—è¯ä¹¦æœºæ„è®¤è¯ï¼Œç”³è¯·è¯ä¹¦ï¼Œç„¶åæ“ä½œç³»ç»Ÿåªä¼šå­˜å‚¨æ•°å­—è¯ä¹¦æœºæ„çš„å…¬é’¥ã€‚å› ä¸ºæ•°å­—è¯ä¹¦æœºæ„æ•°é‡æœ‰é™ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿå‚å•†ç›¸å¯¹æ¥è¯´å®¹æ˜“ç®¡ç†ã€‚</p><p><strong>æ€»ç»“</strong>ï¼š<br>Httpsé€šè¿‡éå¯¹ç§°åŠ å¯†(é€šå¸¸æ˜¯RSAç®—æ³•)åŠ å¯†å¯¹ç§°åŠ å¯†çš„ç§˜é’¥ï¼Œç„¶åä½¿ç”¨è¯ä¹¦æœºæ„çš„ç§é’¥åŠ å¯†éå¯¹ç§°åŠ å¯†çš„å…¬é’¥ï¼Œè€Œè¯ä¹¦æœºæ„çš„å…¬é’¥ä¼šå†…ç½®åœ¨æµè§ˆå™¨é‡Œï¼Œä»è€Œä¿è¯å³ä½¿è¢«ç¬¬ä¸‰æ–¹ç›‘å¬ï¼Œä¹Ÿå¯ä»¥ä¿è¯å®‰å…¨ã€‚</p><h1 id="SSL-ä¸-TLS"><a href="#SSL-ä¸-TLS" class="headerlink" title="SSL ä¸ TLS"></a>SSL ä¸ TLS</h1><h2 id="SSL-Secure-Socket-Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚"><a href="#SSL-Secure-Socket-Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚" class="headerlink" title="SSL (Secure Socket Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚)"></a>SSL (Secure Socket Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚)</h2><p>SSLä¸ºNetscapeæ‰€ç ”å‘ï¼Œç”¨ä»¥ä¿éšœåœ¨Internetä¸Šæ•°æ®ä¼ è¾“ä¹‹å®‰å…¨ï¼Œåˆ©ç”¨æ•°æ®åŠ å¯†(Encryption)æŠ€æœ¯ï¼Œå¯ç¡®ä¿æ•°æ®åœ¨ç½‘ç»œä¸Šä¹‹ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šè¢«æˆªå–ï¼Œå½“å‰ä¸º3.0ç‰ˆæœ¬ã€‚</p><p>SSLåè®®å¯åˆ†ä¸ºä¸¤å±‚ï¼š SSLè®°å½•åè®®ï¼ˆSSL Record Protocolï¼‰ï¼šå®ƒå»ºç«‹åœ¨å¯é çš„ä¼ è¾“åè®®ï¼ˆå¦‚TCPï¼‰ä¹‹ä¸Šï¼Œä¸ºé«˜å±‚åè®®æä¾›æ•°æ®å°è£…ã€å‹ç¼©ã€åŠ å¯†ç­‰åŸºæœ¬åŠŸèƒ½çš„æ”¯æŒã€‚ SSLæ¡æ‰‹åè®®ï¼ˆSSL Handshake Protocolï¼‰ï¼šå®ƒå»ºç«‹åœ¨SSLè®°å½•åè®®ä¹‹ä¸Šï¼Œç”¨äºåœ¨å®é™…çš„æ•°æ®ä¼ è¾“å¼€å§‹å‰ï¼Œé€šè®¯åŒæ–¹è¿›è¡Œèº«ä»½è®¤è¯ã€åå•†åŠ å¯†ç®—æ³•ã€äº¤æ¢åŠ å¯†å¯†é’¥ç­‰ã€‚</p><h2 id="TLS-Transport-Layer-Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®"><a href="#TLS-Transport-Layer-Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®" class="headerlink" title="TLS (Transport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®)"></a>TLS (Transport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®)</h2><p>ç”¨äºä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¿å¯†æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚<br>TLS 1.0æ˜¯IETFï¼ˆInternet Engineering Task Forceï¼ŒInternetå·¥ç¨‹ä»»åŠ¡ç»„ï¼‰åˆ¶å®šçš„ä¸€ç§æ–°çš„åè®®ï¼Œå®ƒå»ºç«‹åœ¨SSL 3.0åè®®è§„èŒƒä¹‹ä¸Šï¼Œæ˜¯SSL 3.0çš„åç»­ç‰ˆæœ¬ï¼Œå¯ä»¥ç†è§£ä¸ºSSL 3.1ï¼Œå®ƒæ˜¯å†™å…¥äº† RFC çš„ã€‚è¯¥åè®®ç”±ä¸¤å±‚ç»„æˆï¼š TLS è®°å½•åè®®ï¼ˆTLS Recordï¼‰å’Œ TLS æ¡æ‰‹åè®®ï¼ˆTLS Handshakeï¼‰ã€‚è¾ƒä½çš„å±‚ä¸º TLS è®°å½•åè®®ï¼Œä½äºæŸä¸ªå¯é çš„ä¼ è¾“åè®®ï¼ˆä¾‹å¦‚ TCPï¼‰ä¸Šé¢ã€‚</p><h2 id="SSL-TLSåè®®ä½œç”¨"><a href="#SSL-TLSåè®®ä½œç”¨" class="headerlink" title="SSL/TLSåè®®ä½œç”¨"></a>SSL/TLSåè®®ä½œç”¨</h2><ul><li>è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ï¼›</li><li>åŠ å¯†æ•°æ®ä»¥é˜²æ­¢æ•°æ®ä¸­é€”è¢«çªƒå–ï¼›</li><li>ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«æ”¹å˜ã€‚</li></ul><h2 id="TLSæ¯”SSLçš„ä¼˜åŠ¿"><a href="#TLSæ¯”SSLçš„ä¼˜åŠ¿" class="headerlink" title="TLSæ¯”SSLçš„ä¼˜åŠ¿"></a>TLSæ¯”SSLçš„ä¼˜åŠ¿</h2><ol><li>å¯¹äºæ¶ˆæ¯è®¤è¯ä½¿ç”¨å¯†é’¥æ•£åˆ—æ³•ï¼šTLS ä½¿ç”¨â€œæ¶ˆæ¯è®¤è¯ä»£ç çš„å¯†é’¥æ•£åˆ—æ³•â€ï¼ˆHMACï¼‰ï¼Œå½“è®°å½•åœ¨å¼€æ”¾çš„ç½‘ç»œï¼ˆå¦‚å› ç‰¹ç½‘ï¼‰ä¸Šä¼ é€æ—¶ï¼Œè¯¥ä»£ç ç¡®ä¿è®°å½•ä¸ä¼šè¢«å˜æ›´ã€‚SSLv3.0è¿˜æä¾›é”®æ§æ¶ˆæ¯è®¤è¯ï¼Œä½†HMACæ¯”SSLv3.0ä½¿ç”¨çš„ï¼ˆæ¶ˆæ¯è®¤è¯ä»£ç ï¼‰MAC åŠŸèƒ½æ›´å®‰å…¨ã€‚</li><li>å¢å¼ºçš„ä¼ªéšæœºåŠŸèƒ½ï¼ˆPRFï¼‰ï¼šPRFç”Ÿæˆå¯†é’¥æ•°æ®ã€‚åœ¨TLSä¸­ï¼ŒHMACå®šä¹‰PRFã€‚PRFä½¿ç”¨ä¸¤ç§æ•£åˆ—ç®—æ³•ä¿è¯å…¶å®‰å…¨æ€§ã€‚å¦‚æœä»»ä¸€ç®—æ³•æš´éœ²äº†ï¼Œåªè¦ç¬¬äºŒç§ç®—æ³•æœªæš´éœ²ï¼Œåˆ™æ•°æ®ä»ç„¶æ˜¯å®‰å…¨çš„ã€‚</li><li>æ”¹è¿›çš„å·²å®Œæˆæ¶ˆæ¯éªŒè¯ï¼šTLSå’ŒSSLv3.0éƒ½å¯¹ä¸¤ä¸ªç«¯ç‚¹æä¾›å·²å®Œæˆçš„æ¶ˆæ¯ï¼Œè¯¥æ¶ˆæ¯è®¤è¯äº¤æ¢çš„æ¶ˆæ¯æ²¡æœ‰è¢«å˜æ›´ã€‚ç„¶è€Œï¼ŒTLSå°†æ­¤å·²å®Œæˆæ¶ˆæ¯åŸºäºPRFå’ŒHMACå€¼ä¹‹ä¸Šï¼Œè¿™ä¹Ÿæ¯”SSLv3.0æ›´å®‰å…¨ã€‚</li><li>ä¸€è‡´è¯ä¹¦å¤„ç†ï¼šä¸SSLv3.0ä¸åŒï¼ŒTLSè¯•å›¾æŒ‡å®šå¿…é¡»åœ¨TLSä¹‹é—´å®ç°äº¤æ¢çš„è¯ä¹¦ç±»å‹ã€‚</li><li>ç‰¹å®šè­¦æŠ¥æ¶ˆæ¯ï¼šTLSæä¾›æ›´å¤šçš„ç‰¹å®šå’Œé™„åŠ è­¦æŠ¥ï¼Œä»¥æŒ‡ç¤ºä»»ä¸€ä¼šè¯ç«¯ç‚¹æ£€æµ‹åˆ°çš„é—®é¢˜ã€‚TLSè¿˜å¯¹ä½•æ—¶åº”è¯¥å‘é€æŸäº›è­¦æŠ¥è¿›è¡Œè®°å½•ã€‚</li></ol><h1 id="SSL-TLSçš„æ¡æ‰‹è¿‡ç¨‹"><a href="#SSL-TLSçš„æ¡æ‰‹è¿‡ç¨‹" class="headerlink" title="SSL/TLSçš„æ¡æ‰‹è¿‡ç¨‹"></a>SSL/TLSçš„æ¡æ‰‹è¿‡ç¨‹</h1><p>SSLä¸TLSæ¡æ‰‹æ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»æ¯ä¸€æ­¥çš„å…·ä½“å†…å®¹ï¼š</p><p><img src="https://images.morethink.cn/ea844ad80d80956a30095d5e4f39fd7b.png" alt="" title="httpsæ¡æ‰‹æµç¨‹å›¾"></p><h2 id="å®¢æˆ·ç«¯é¦–æ¬¡å‘å‡ºè¯·æ±‚"><a href="#å®¢æˆ·ç«¯é¦–æ¬¡å‘å‡ºè¯·æ±‚" class="headerlink" title="å®¢æˆ·ç«¯é¦–æ¬¡å‘å‡ºè¯·æ±‚"></a>å®¢æˆ·ç«¯é¦–æ¬¡å‘å‡ºè¯·æ±‚</h2><p>ç”±äºå®¢æˆ·ç«¯(å¦‚æµè§ˆå™¨)å¯¹ä¸€äº›åŠ è§£å¯†ç®—æ³•çš„æ”¯æŒç¨‹åº¦ä¸ä¸€æ ·ï¼Œä½†æ˜¯åœ¨TLSåè®®ä¼ è¾“è¿‡ç¨‹ä¸­å¿…é¡»ä½¿ç”¨åŒä¸€å¥—åŠ è§£å¯†ç®—æ³•æ‰èƒ½ä¿è¯æ•°æ®èƒ½å¤Ÿæ­£å¸¸çš„åŠ è§£å¯†ã€‚åœ¨TLSæ¡æ‰‹é˜¶æ®µï¼Œå®¢æˆ·ç«¯é¦–å…ˆè¦å‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œè‡ªå·±æ”¯æŒå“ªäº›åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯éœ€è¦å°†æœ¬åœ°æ”¯æŒçš„åŠ å¯†å¥—ä»¶(Cipher Suite)çš„åˆ—è¡¨ä¼ é€ç»™æœåŠ¡ç«¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®¢æˆ·ç«¯è¿˜è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°ä¸€æ–¹é¢éœ€è¦åœ¨å®¢æˆ·ç«¯ä¿å­˜ï¼Œå¦ä¸€æ–¹é¢éœ€è¦ä¼ é€ç»™æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯çš„éšæœºæ•°éœ€è¦è·ŸæœåŠ¡ç«¯äº§ç”Ÿçš„éšæœºæ•°ç»“åˆèµ·æ¥äº§ç”Ÿåé¢è¦è®²åˆ°çš„ Master Secret ã€‚</p><p><strong>å®¢æˆ·ç«¯éœ€è¦æä¾›å¦‚ä¸‹ä¿¡æ¯</strong>ï¼š</p><ul><li>æ”¯æŒçš„åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚TLS 1.0ç‰ˆ</li><li>ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼Œç¨åç”¨äºç”Ÿæˆâ€å¯¹è¯å¯†é’¥â€</li><li>æ”¯æŒçš„åŠ å¯†æ–¹æ³•ï¼Œæ¯”å¦‚RSAå…¬é’¥åŠ å¯†</li><li>æ”¯æŒçš„å‹ç¼©æ–¹æ³•</li></ul><h2 id="æœåŠ¡ç«¯é¦–æ¬¡å›åº”"><a href="#æœåŠ¡ç«¯é¦–æ¬¡å›åº”" class="headerlink" title="æœåŠ¡ç«¯é¦–æ¬¡å›åº”"></a>æœåŠ¡ç«¯é¦–æ¬¡å›åº”</h2><p>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„Client Helloä¹‹åï¼ŒæœåŠ¡ç«¯éœ€è¦ç¡®å®šåŠ å¯†åè®®çš„ç‰ˆæœ¬ï¼Œä»¥åŠåŠ å¯†çš„ç®—æ³•ï¼Œç„¶åä¹Ÿç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œä»¥åŠå°†è‡ªå·±çš„è¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯ä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œè¿™é‡Œçš„éšæœºæ•°æ˜¯æ•´ä¸ªè¿‡ç¨‹çš„ç¬¬äºŒä¸ªéšæœºæ•°ã€‚</p><p><strong>æœåŠ¡ç«¯éœ€è¦æä¾›çš„ä¿¡æ¯</strong>ï¼š</p><ul><li>åè®®çš„ç‰ˆæœ¬</li><li>åŠ å¯†çš„ç®—æ³•</li><li>éšæœºæ•°</li><li>æœåŠ¡å™¨è¯ä¹¦</li></ul><h2 id="å®¢æˆ·ç«¯å†æ¬¡å›åº”"><a href="#å®¢æˆ·ç«¯å†æ¬¡å›åº”" class="headerlink" title="å®¢æˆ·ç«¯å†æ¬¡å›åº”"></a>å®¢æˆ·ç«¯å†æ¬¡å›åº”</h2><p>å®¢æˆ·ç«¯é¦–å…ˆä¼šå¯¹æœåŠ¡å™¨ä¸‹å‘çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯é€šè¿‡ä¹‹åï¼Œåˆ™ä¼šç»§ç»­ä¸‹é¢çš„æ“ä½œï¼Œå®¢æˆ·ç«¯å†æ¬¡äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼ˆç¬¬ä¸‰ä¸ªéšæœºæ•°ï¼‰ï¼Œç„¶åä½¿ç”¨æœåŠ¡å™¨è¯ä¹¦ä¸­çš„å…¬é’¥è¿›è¡ŒåŠ å¯†ï¼Œä»¥åŠæ”¾ä¸€ä¸ªChangeCipherSpecæ¶ˆæ¯å³ç¼–ç æ”¹å˜çš„æ¶ˆæ¯ï¼Œè¿˜æœ‰æ•´ä¸ªå‰é¢æ‰€æœ‰æ¶ˆæ¯çš„hashå€¼ï¼Œè¿›è¡ŒæœåŠ¡å™¨éªŒè¯ï¼Œç„¶åç”¨æ–°ç§˜é’¥åŠ å¯†ä¸€æ®µæ•°æ®ä¸€å¹¶å‘é€åˆ°æœåŠ¡å™¨ï¼Œç¡®ä¿æ­£å¼é€šä¿¡å‰æ— è¯¯ã€‚</p><p>å®¢æˆ·ç«¯ä½¿ç”¨å‰é¢çš„ä¸¤ä¸ªéšæœºæ•°ä»¥åŠåˆšåˆšæ–°ç”Ÿæˆçš„æ–°éšæœºæ•°ï¼Œä½¿ç”¨ä¸æœåŠ¡å™¨ç¡®å®šçš„åŠ å¯†ç®—æ³•ï¼Œç”Ÿæˆä¸€ä¸ªSession Secretã€‚</p><h2 id="æœåŠ¡å™¨å†æ¬¡å“åº”"><a href="#æœåŠ¡å™¨å†æ¬¡å“åº”" class="headerlink" title="æœåŠ¡å™¨å†æ¬¡å“åº”"></a>æœåŠ¡å™¨å†æ¬¡å“åº”</h2><p>æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„ç¬¬ä¸‰ä¸ªéšæœºæ•°çš„ åŠ å¯†æ•°æ®ä¹‹åï¼Œä½¿ç”¨ç§é’¥å¯¹è¿™æ®µåŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œä¹Ÿä¼šä½¿ç”¨è·Ÿå®¢æˆ·ç«¯åŒæ ·çš„æ–¹å¼ç”Ÿæˆç§˜é’¥ï¼Œä¸€åˆ‡å‡†å¤‡å¥½ä¹‹åï¼Œä¹Ÿä¼šç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ChangeCipherSpecï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯å·²ç»åˆ‡æ¢åˆ°åå•†è¿‡çš„åŠ å¯†å¥—ä»¶çŠ¶æ€ï¼Œå‡†å¤‡ä½¿ç”¨åŠ å¯†å¥—ä»¶å’Œ Session SecretåŠ å¯†æ•°æ®äº†ã€‚ä¹‹åï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šä½¿ç”¨ Session Secret åŠ å¯†ä¸€æ®µ Finish æ¶ˆæ¯å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä»¥éªŒè¯ä¹‹å‰é€šè¿‡æ¡æ‰‹å»ºç«‹èµ·æ¥çš„åŠ è§£å¯†é€šé“æ˜¯å¦æˆåŠŸã€‚</p><h2 id="åç»­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´é€šä¿¡"><a href="#åç»­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´é€šä¿¡" class="headerlink" title="åç»­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´é€šä¿¡"></a>åç»­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é—´é€šä¿¡</h2><p>ç¡®å®šç§˜é’¥ä¹‹åï¼ŒæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯ä¹‹é—´å°±ä¼šé€šè¿‡å•†å®šçš„ç§˜é’¥åŠ å¯†æ¶ˆæ¯äº†ï¼Œè¿›è¡Œé€šè®¯äº†ã€‚æ•´ä¸ªæ¡æ‰‹è¿‡ç¨‹ä¹Ÿå°±åŸºæœ¬å®Œæˆäº†ã€‚</p><blockquote><p><strong>å€¼å¾—ç‰¹åˆ«æå‡ºçš„æ˜¯</strong>ï¼š</p><p>SSLåè®®åœ¨æ¡æ‰‹é˜¶æ®µä½¿ç”¨çš„æ˜¯éå¯¹ç§°åŠ å¯†ï¼Œåœ¨ä¼ è¾“é˜¶æ®µä½¿ç”¨çš„æ˜¯å¯¹ç§°åŠ å¯†ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨SSLä¸Šä¼ é€çš„æ•°æ®æ˜¯ä½¿ç”¨å¯¹ç§°å¯†é’¥åŠ å¯†çš„ï¼å› ä¸ºéå¯¹ç§°åŠ å¯†çš„é€Ÿåº¦ç¼“æ…¢ï¼Œè€—è´¹èµ„æºã€‚å…¶å®å½“å®¢æˆ·ç«¯å’Œä¸»æœºä½¿ç”¨éå¯¹ç§°åŠ å¯†æ–¹å¼å»ºç«‹è¿æ¥åï¼Œå®¢æˆ·ç«¯å’Œä¸»æœºå·²ç»å†³å®šå¥½äº†åœ¨ä¼ è¾“è¿‡ç¨‹ä½¿ç”¨çš„å¯¹ç§°åŠ å¯†ç®—æ³•å’Œå…³é”®çš„å¯¹ç§°åŠ å¯†å¯†é’¥ï¼Œç”±äºè¿™ä¸ªè¿‡ç¨‹æœ¬èº«æ˜¯å®‰å…¨å¯é çš„ï¼Œä¹Ÿå³å¯¹ç§°åŠ å¯†å¯†é’¥æ˜¯ä¸å¯èƒ½è¢«çªƒå–ç›—ç”¨çš„ï¼Œå› æ­¤ï¼Œä¿è¯äº†åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯¹æ•°æ®è¿›è¡Œå¯¹ç§°åŠ å¯†ä¹Ÿæ˜¯å®‰å…¨å¯é çš„ï¼Œå› ä¸ºé™¤äº†å®¢æˆ·ç«¯å’Œä¸»æœºä¹‹å¤–ï¼Œä¸å¯èƒ½æœ‰ç¬¬ä¸‰æ–¹çªƒå–å¹¶è§£å¯†å‡ºå¯¹ç§°åŠ å¯†å¯†é’¥ï¼å¦‚æœæœ‰äººçªƒå¬é€šä¿¡ï¼Œä»–å¯ä»¥çŸ¥é“åŒæ–¹é€‰æ‹©çš„åŠ å¯†æ–¹æ³•ï¼Œä»¥åŠä¸‰ä¸ªéšæœºæ•°ä¸­çš„ä¸¤ä¸ªã€‚æ•´ä¸ªé€šè¯çš„å®‰å…¨ï¼Œåªå–å†³äºç¬¬ä¸‰ä¸ªéšæœºæ•°ï¼ˆPremaster secretï¼‰èƒ½ä¸èƒ½è¢«ç ´è§£ã€‚</p></blockquote><h1 id="sessionçš„æ¢å¤"><a href="#sessionçš„æ¢å¤" class="headerlink" title="sessionçš„æ¢å¤"></a>sessionçš„æ¢å¤</h1><p>æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ¢å¤åŸæ¥çš„sessionï¼šä¸€ç§å«åšsession IDï¼Œå¦ä¸€ç§å«åšsession ticketã€‚</p><h2 id="session-ID"><a href="#session-ID" class="headerlink" title="session ID"></a>session ID</h2><p>session IDçš„æ€æƒ³å¾ˆç®€å•ï¼Œå°±æ˜¯æ¯ä¸€æ¬¡å¯¹è¯éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼ˆsession IDï¼‰ã€‚å¦‚æœå¯¹è¯ä¸­æ–­ï¼Œä¸‹æ¬¡é‡è¿çš„æ—¶å€™ï¼Œåªè¦å®¢æˆ·ç«¯ç»™å‡ºè¿™ä¸ªç¼–å·ï¼Œä¸”æœåŠ¡å™¨æœ‰è¿™ä¸ªç¼–å·çš„è®°å½•ï¼ŒåŒæ–¹å°±å¯ä»¥é‡æ–°ä½¿ç”¨å·²æœ‰çš„â€å¯¹è¯å¯†é’¥â€ï¼Œè€Œä¸å¿…é‡æ–°ç”Ÿæˆä¸€æŠŠã€‚</p><p>session IDæ˜¯ç›®å‰æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒçš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒçš„ç¼ºç‚¹åœ¨äºsession IDå¾€å¾€åªä¿ç•™åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚æ‰€ä»¥ï¼Œå¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚å‘åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œå°±æ— æ³•æ¢å¤å¯¹è¯ã€‚</p><h2 id="session-ticket"><a href="#session-ticket" class="headerlink" title="session ticket"></a>session ticket</h2><p>å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœåŠ¡å™¨åœ¨ä¸Šä¸€æ¬¡å¯¹è¯ä¸­å‘é€è¿‡æ¥çš„session ticketã€‚è¿™ä¸ªsession ticketæ˜¯åŠ å¯†çš„ï¼Œåªæœ‰æœåŠ¡å™¨æ‰èƒ½è§£å¯†ï¼Œå…¶ä¸­åŒ…æ‹¬æœ¬æ¬¡å¯¹è¯çš„ä¸»è¦ä¿¡æ¯ï¼Œæ¯”å¦‚å¯¹è¯å¯†é’¥å’ŒåŠ å¯†æ–¹æ³•ã€‚å½“æœåŠ¡å™¨æ”¶åˆ°session ticketä»¥åï¼Œè§£å¯†åå°±ä¸å¿…é‡æ–°ç”Ÿæˆå¯¹è¯å¯†é’¥äº†ã€‚</p><p><strong>ç›®å‰åªæœ‰Firefoxå’ŒChromeæµè§ˆå™¨æ”¯æŒ</strong>ã€‚</p><h1 id="Httpsçš„åŠ£åŠ¿"><a href="#Httpsçš„åŠ£åŠ¿" class="headerlink" title="Httpsçš„åŠ£åŠ¿"></a>Httpsçš„åŠ£åŠ¿</h1><p><strong>å¯¹æ•°æ®è¿›è¡ŒåŠ è§£å¯†å†³å®šäº†å®ƒæ¯”httpæ…¢</strong>ã€‚éœ€è¦è¿›è¡Œéå¯¹ç§°çš„åŠ è§£å¯†ï¼Œä¸”éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ã€‚é¦–æ¬¡è¿æ¥æ¯”è¾ƒæ…¢ç‚¹ï¼Œå½“ç„¶ç°åœ¨ä¹Ÿæœ‰å¾ˆå¤šçš„ä¼˜åŒ–ã€‚</p><p>å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¸ä¼šåœ¨æœ¬åœ°ä¿å­˜HTTPSç¼“å­˜ã€‚å®é™…ä¸Šï¼Œåªè¦åœ¨HTTPå¤´ä¸­ä½¿ç”¨ç‰¹å®šå‘½ä»¤ï¼ŒHTTPSæ˜¯å¯ä»¥ç¼“å­˜çš„ã€‚Firefoxé»˜è®¤åªåœ¨å†…å­˜ä¸­ç¼“å­˜HTTPSã€‚ä½†æ˜¯ï¼Œåªè¦å¤´å‘½ä»¤ä¸­æœ‰Cache-Control: Publicï¼Œç¼“å­˜å°±ä¼šè¢«å†™åˆ°ç¡¬ç›˜ä¸Šã€‚ IEåªè¦httpå¤´å…è®¸å°±å¯ä»¥ç¼“å­˜httpså†…å®¹ï¼Œç¼“å­˜ç­–ç•¥ä¸æ˜¯å¦ä½¿ç”¨HTTPSåè®®æ— å…³ã€‚</p><h1 id="HTTPSå’ŒHTTPçš„åŒºåˆ«"><a href="#HTTPSå’ŒHTTPçš„åŒºåˆ«" class="headerlink" title="HTTPSå’ŒHTTPçš„åŒºåˆ«"></a>HTTPSå’ŒHTTPçš„åŒºåˆ«</h1><ul><li>httpsåè®®éœ€è¦åˆ°CAç”³è¯·è¯ä¹¦ã€‚</li><li>httpæ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“ï¼›https åˆ™æ˜¯å…·æœ‰å®‰å…¨æ€§çš„sslåŠ å¯†ä¼ è¾“åè®®ã€‚</li><li>httpå’Œhttpsä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯80ï¼Œåè€…æ˜¯443ã€‚</li><li>httpçš„è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›HTTPSåè®®æ˜¯ç”±SSL+HTTPåè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯”httpåè®®å®‰å…¨ã€‚</li><li>httpé»˜è®¤ä½¿ç”¨80ç«¯å£ï¼Œhttpsé»˜è®¤ä½¿ç”¨443ç«¯å£</li></ul><h1 id="Pythonç­‰çˆ¬è™«æ€ä¹ˆå¤„ç†Https"><a href="#Pythonç­‰çˆ¬è™«æ€ä¹ˆå¤„ç†Https" class="headerlink" title="Pythonç­‰çˆ¬è™«æ€ä¹ˆå¤„ç†Https"></a>Pythonç­‰çˆ¬è™«æ€ä¹ˆå¤„ç†Https</h1><p>httpsæ‹¿çˆ¬è™«æ¯«æ— åŠæ³•ï¼Œæˆ–è€…è¯´httpså°±ä¸æ˜¯ä¸ºäº†åçˆ¬è™«çš„ã€‚httpsçš„ä½œç”¨æ˜¯ä¿è¯æœåŠ¡æºæˆä¿¡ã€‚æ¯”å¦‚ä½ è®¿é—®æ”¯ä»˜å®ï¼Œç½‘ç»œè¢«åŠ«æŒäº†ï¼Œä½ çœ‹åˆ°çš„å°±æ˜¯ä¸ªå‡ç½‘ç«™ï¼Œä¸€æ—¦ä½ ç™»å½•ï¼Œè´¦å·å°±æ³„éœ²äº†ã€‚ä½†ç”¨httpså°±èƒ½ä¿è¯ä½ è®¿é—®çš„ä¸€å®šæ˜¯çœŸçš„æ”¯ä»˜å®ç½‘ç«™ï¼Œè¿™æ˜¯ç”±CAè¯ä¹¦ä¿è¯çš„ã€‚å›è¿‡æ¥å†è¯´çˆ¬è™«ï¼Œçˆ¬è™«ä¼ªé€ çš„æ˜¯å®¢æˆ·ç«¯ï¼Œhttpsæ˜¯ä¸èƒ½ä¿è¯å®¢æˆ·ç«¯æ˜¯æˆä¿¡çš„ï¼Œä½ åªè¦æŒ‰ç…§sslåè®®è¿›è¡Œé€šä¿¡ï¼Œè¯¥æ€ä¹ˆçˆ¬æ•°æ®è¿˜æ˜¯æ€ä¹ˆçˆ¬ã€‚</p><p>httpsåè®®é‡Œæ•°æ®çš„ä¼ è¾“æ˜¯éœ€è¦ç»è¿‡åŠ å¯†çš„,åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°±ç»™çˆ¬è™«å¸¦æ¥äº†æŠ“åŒ…é—®é¢˜ï¼ŒæŠ“å‡ºæ¥çš„æ•°æ®ä¹Ÿæ˜¯ç»è¿‡åŠ å¯†çš„ï¼Œä¸èƒ½è§£æã€‚</p><p>ç†è®ºä¸Šæ˜¯ä¸è¡Œäº†ï¼Œå› ä¸ºhttpsä¿è¯çš„å°±æ˜¯æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ç›—å–ã€‚ä½†è§£å†³èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è®¾ç½®ä¸ªä»£ç†ä¼ªè£…ä¸€ä¸‹ï¼Œä»£ä»·å°±æ˜¯ä½ è¦å®‰è£…ä¸ªå‡è¯ä¹¦ï¼Œå½“ç„¶è¿™ä¹Ÿè‚¯å®šæ˜¯æ— æ‰€è°“çš„ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.wxtlife.com/2016/03/27/è¯¦è§£httpsæ˜¯å¦‚ä½•ç¡®ä¿å®‰å…¨çš„ï¼Ÿ/" target="_blank" rel="noopener">è¯¦è§£httpsæ˜¯å¦‚ä½•ç¡®ä¿å®‰å…¨çš„ï¼Ÿ</a></li><li><a href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html" target="_blank" rel="noopener">å›¾è§£SSL/TLSåè®®</a></li><li><a href="http://fullstack.blog/2017/03/12/%E4%B9%9D%E4%B8%AA%E9%97%AE%E9%A2%98%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%86%9F%E6%82%89HTTPS/#" target="_blank" rel="noopener">ä¹ä¸ªé—®é¢˜ä»å…¥é—¨åˆ°ç†Ÿæ‚‰HTTPS</a></li><li><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLSåè®®è¿è¡Œæœºåˆ¶çš„æ¦‚è¿°</a></li><li><a href="https://www.zhihu.com/question/54504923" target="_blank" rel="noopener">çˆ¬è™« https pythonï¼Ÿ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Https </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é¢è¯•ä¸­çš„DNS</title>
      <link href="/DNS/"/>
      <url>/DNS/</url>
      
        <content type="html"><![CDATA[<h1 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h1><p>å½“DNSå®¢æˆ·æœºéœ€è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨åç§°æ—¶ï¼Œå®ƒä¼šæŸ¥è¯¢DNSæœåŠ¡å™¨æ¥è§£æè¯¥åç§°ã€‚å®¢æˆ·æœºå‘é€çš„æ¯æ¡æŸ¥è¯¢ä¿¡æ¯åŒ…æ‹¬ä¸‰æ¡ä¿¡æ¯ï¼šæŒ‡å®šçš„DNSåŸŸåï¼ŒæŒ‡å®šçš„æŸ¥è¯¢ç±»å‹ï¼ŒDNSåŸŸåçš„æŒ‡å®šç±»åˆ«ã€‚</p><p>DNSåŸºäºUDPæœåŠ¡ï¼Œç«¯å£53ã€‚è¯¥åº”ç”¨ä¸€èˆ¬ä¸ç›´æ¥ä¸ºç”¨æˆ·ä½¿ç”¨ï¼Œè€Œæ˜¯ä¸ºå…¶ä»–åº”ç”¨æœåŠ¡ï¼Œå¦‚HTTPï¼ŒSMTPç­‰åœ¨å…¶ä¸­éœ€è¦å®Œæˆä¸»æœºååˆ°IPåœ°å€çš„è½¬æ¢ã€‚</p><a id="more"></a><h1 id="é€’å½’æŸ¥è¯¢ä¸è¿­ä»£æŸ¥è¯¢"><a href="#é€’å½’æŸ¥è¯¢ä¸è¿­ä»£æŸ¥è¯¢" class="headerlink" title="é€’å½’æŸ¥è¯¢ä¸è¿­ä»£æŸ¥è¯¢"></a>é€’å½’æŸ¥è¯¢ä¸è¿­ä»£æŸ¥è¯¢</h1><h2 id="é€’å½’æŸ¥è¯¢"><a href="#é€’å½’æŸ¥è¯¢" class="headerlink" title="é€’å½’æŸ¥è¯¢"></a>é€’å½’æŸ¥è¯¢</h2><p>é€’å½’æŸ¥è¯¢æ˜¯ä¸€ç§DNS æœåŠ¡å™¨çš„æŸ¥è¯¢æ¨¡å¼ï¼Œåœ¨è¯¥æ¨¡å¼ä¸‹DNS æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·æœºè¯·æ±‚ï¼Œå¿…é¡»ä½¿ç”¨ä¸€ä¸ªå‡†ç¡®çš„æŸ¥è¯¢ç»“æœå›å¤å®¢æˆ·æœºã€‚å¦‚æœDNS æœåŠ¡å™¨æœ¬åœ°æ²¡æœ‰å­˜å‚¨æŸ¥è¯¢DNS ä¿¡æ¯ï¼Œé‚£ä¹ˆè¯¥æœåŠ¡å™¨ä¼šè¯¢é—®å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶å°†è¿”å›çš„æŸ¥è¯¢ç»“æœæäº¤ç»™å®¢æˆ·æœºã€‚</p><p><img src="https://images.morethink.cn/af0045f9f3bdd144a2afc434cb8146f7.png" alt="" title="DNSé€’å½’æŸ¥è¯¢"></p><h2 id="è¿­ä»£æŸ¥è¯¢"><a href="#è¿­ä»£æŸ¥è¯¢" class="headerlink" title="è¿­ä»£æŸ¥è¯¢"></a>è¿­ä»£æŸ¥è¯¢</h2><p>DNS æœåŠ¡å™¨å¦å¤–ä¸€ç§æŸ¥è¯¢æ–¹å¼ä¸ºè¿­ä»£æŸ¥è¯¢ï¼ŒDNS æœåŠ¡å™¨ä¼šå‘å®¢æˆ·æœºæä¾›å…¶ä»–èƒ½å¤Ÿè§£ææŸ¥è¯¢è¯·æ±‚çš„DNS æœåŠ¡å™¨åœ°å€ï¼Œå½“å®¢æˆ·æœºå‘é€æŸ¥è¯¢è¯·æ±‚æ—¶ï¼ŒDNS æœåŠ¡å™¨å¹¶ä¸ç›´æ¥å›å¤æŸ¥è¯¢ç»“æœï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·æœºå¦ä¸€å°DNS æœåŠ¡å™¨åœ°å€ï¼Œå®¢æˆ·æœºå†å‘è¿™å°DNS æœåŠ¡å™¨æäº¤è¯·æ±‚ï¼Œä¾æ¬¡å¾ªç¯ç›´åˆ°è¿”å›æŸ¥è¯¢çš„ç»“æœä¸ºæ­¢ã€‚<br><img src="https://images.morethink.cn/9550ed36f993d88f2d54e5d9c6c9f487.png" alt="" title="DNSè¿­ä»£æŸ¥è¯¢"></p><p><strong>ä»å®¢æˆ·ç«¯åˆ°æœ¬åœ°DNSæœåŠ¡å™¨æ˜¯å±äºé€’å½’æŸ¥è¯¢ï¼Œè€ŒDNSæœåŠ¡å™¨ä¹‹é—´å°±æ˜¯çš„äº¤äº’æŸ¥è¯¢å°±æ˜¯è¿­ä»£æŸ¥è¯¢</strong>ã€‚</p><h1 id="DNSåŠ«æŒ"><a href="#DNSåŠ«æŒ" class="headerlink" title="DNSåŠ«æŒ"></a>DNSåŠ«æŒ</h1><p>DNSåŠ«æŒå°±æ˜¯é€šè¿‡åŠ«æŒäº†DNSæœåŠ¡å™¨ï¼Œé€šè¿‡æŸäº›æ‰‹æ®µå–å¾—æŸåŸŸåçš„è§£æè®°å½•æ§åˆ¶æƒï¼Œè¿›è€Œä¿®æ”¹æ­¤åŸŸåçš„è§£æç»“æœï¼Œå¯¼è‡´å¯¹è¯¥åŸŸåçš„è®¿é—®ç”±åŸIPåœ°å€è½¬å…¥åˆ°ä¿®æ”¹åçš„æŒ‡å®šIPï¼Œå…¶ç»“æœå°±æ˜¯å¯¹ç‰¹å®šçš„ç½‘å€ä¸èƒ½è®¿é—®æˆ–è®¿é—®çš„æ˜¯å‡ç½‘å€ï¼Œä»è€Œå®ç°çªƒå–èµ„æ–™æˆ–è€…ç ´ååŸæœ‰æ­£å¸¸æœåŠ¡çš„ç›®çš„ã€‚DNSåŠ«æŒé€šè¿‡ç¯¡æ”¹DNSæœåŠ¡å™¨ä¸Šçš„æ•°æ®è¿”å›ç»™ç”¨æˆ·ä¸€ä¸ªé”™è¯¯çš„æŸ¥è¯¢ç»“æœæ¥å®ç°çš„ã€‚</p><p>DNSåŠ«æŒç—‡çŠ¶ï¼šåœ¨æŸäº›åœ°åŒºçš„ç”¨æˆ·åœ¨æˆåŠŸè¿æ¥å®½å¸¦åï¼Œé¦–æ¬¡æ‰“å¼€ä»»ä½•é¡µé¢éƒ½æŒ‡å‘ISPæä¾›çš„â€œç”µä¿¡äº’è”æ˜Ÿç©ºâ€ã€â€œç½‘é€šé»„é¡µå¹¿å‘Šâ€ç­‰å†…å®¹é¡µé¢ã€‚è¿˜æœ‰å°±æ˜¯æ›¾ç»å‡ºç°è¿‡ç”¨æˆ·è®¿é—®GoogleåŸŸåçš„æ—¶å€™å‡ºç°äº†ç™¾åº¦çš„ç½‘ç«™ã€‚è¿™äº›éƒ½å±äºDNSåŠ«æŒã€‚</p><p><strong>è§£å†³æ–¹æ³•</strong></p><p>å¯¹äºDNSåŠ«æŒï¼Œå¯ä»¥é‡‡ç”¨ä½¿ç”¨å›½å¤–å…è´¹å…¬ç”¨çš„DNSæœåŠ¡å™¨è§£å†³ã€‚ä¾‹å¦‚OpenDNSï¼ˆ208.67.222.222ï¼‰æˆ–GoogleDNSï¼ˆ8.8.8.8ï¼‰ã€‚</p><p><strong>æ€»ç»“</strong></p><p>DNSåŠ«æŒå°±æ˜¯æŒ‡ç”¨æˆ·è®¿é—®ä¸€ä¸ªè¢«æ ‡è®°çš„åœ°å€æ—¶ï¼ŒDNSæœåŠ¡å™¨æ•…æ„å°†æ­¤åœ°å€æŒ‡å‘ä¸€ä¸ªé”™è¯¯çš„IPåœ°å€çš„è¡Œä¸ºã€‚èŒƒä¾‹ï¼Œç½‘é€šã€ç”µä¿¡ã€é“é€šçš„æŸäº›ç”¨æˆ·æœ‰æ—¶å€™ä¼šå‘ç°è‡ªå·±æ‰“ç®—è®¿é—®ä¸€ä¸ªåœ°å€ï¼Œå´è¢«è½¬å‘äº†å„ç§æ¨é€å¹¿å‘Šç­‰ç½‘ç«™ï¼Œè¿™å°±æ˜¯DNSåŠ«æŒã€‚</p><h1 id="DNSæ±¡æŸ“"><a href="#DNSæ±¡æŸ“" class="headerlink" title="DNSæ±¡æŸ“"></a>DNSæ±¡æŸ“</h1><p>DNSæ±¡æŸ“æ˜¯ä¸€ç§è®©ä¸€èˆ¬ç”¨æˆ·ç”±äºå¾—åˆ°è™šå‡ç›®æ ‡ä¸»æœºIPè€Œä¸èƒ½ä¸å…¶é€šä¿¡çš„æ–¹æ³•ï¼Œæ˜¯ä¸€ç§DNSç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆDNS cache poisoningï¼‰ã€‚</p><p>å…¶å·¥ä½œæ–¹å¼æ˜¯ï¼šç”±äºé€šå¸¸çš„DNSæŸ¥è¯¢æ²¡æœ‰ä»»ä½•è®¤è¯æœºåˆ¶ï¼Œè€Œä¸”DNSæŸ¥è¯¢é€šå¸¸åŸºäºçš„UDPæ˜¯æ— è¿æ¥ä¸å¯é çš„åè®®ï¼Œå› æ­¤DNSçš„æŸ¥è¯¢éå¸¸å®¹æ˜“è¢«ç¯¡æ”¹ï¼Œé€šè¿‡å¯¹UDPç«¯å£53ä¸Šçš„DNSæŸ¥è¯¢è¿›è¡Œå…¥ä¾µæ£€æµ‹ï¼Œä¸€ç»å‘ç°ä¸å…³é”®è¯ç›¸åŒ¹é…çš„è¯·æ±‚åˆ™ç«‹å³ä¼ªè£…æˆç›®æ ‡åŸŸåçš„è§£ææœåŠ¡å™¨ï¼ˆNSï¼ŒName Serverï¼‰ç»™æŸ¥è¯¢è€…è¿”å›è™šå‡ç»“æœã€‚</p><p>DNSæ±¡æŸ“å‘ç”Ÿåœ¨ç”¨æˆ·è¯·æ±‚çš„ç¬¬ä¸€æ­¥ä¸Šï¼Œç›´æ¥ä»åè®®ä¸Šå¯¹ç”¨æˆ·çš„DNSè¯·æ±‚è¿›è¡Œå¹²æ‰°ã€‚<br>DNSæ±¡æŸ“ç—‡çŠ¶ï¼šç›®å‰ä¸€äº›è¢«ç¦æ­¢è®¿é—®çš„ç½‘ç«™å¾ˆå¤šå°±æ˜¯é€šè¿‡DNSæ±¡æŸ“æ¥å®ç°çš„ï¼Œä¾‹å¦‚YouTubeã€Facebookç­‰ç½‘ç«™ã€‚</p><p><strong>è§£å†³åŠæ³•</strong>ï¼š</p><p>å¯¹äºDNSæ±¡æŸ“ï¼Œå¯ä»¥è¯´ï¼Œä¸ªäººç”¨æˆ·å¾ˆéš¾å•å•é è®¾ç½®è§£å†³ï¼Œé€šå¸¸å¯ä»¥ä½¿ç”¨VPNæˆ–è€…åŸŸåè¿œç¨‹è§£æçš„æ–¹æ³•è§£å†³ï¼Œä½†è¿™å¤§å¤šéœ€è¦è´­ä¹°ä»˜è´¹çš„VPNæˆ–SSHç­‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹Hostsçš„æ–¹æ³•ï¼Œæ‰‹åŠ¨è®¾ç½®åŸŸåæ­£ç¡®çš„IPåœ°å€ã€‚</p><p><strong>æ€»ç»“</strong>ï¼š</p><p>DNSæ±¡æŸ“ï¼ŒæŒ‡çš„æ˜¯ç”¨æˆ·è®¿é—®ä¸€ä¸ªåœ°å€ï¼Œå›½å†…çš„æœåŠ¡å™¨(éDNS)ç›‘æ§åˆ°ç”¨æˆ·è®¿é—®çš„å·²ç»è¢«æ ‡è®°åœ°å€æ—¶ï¼ŒæœåŠ¡å™¨ä¼ªè£…æˆDNSæœåŠ¡å™¨å‘ç”¨æˆ·å‘å›é”™è¯¯çš„åœ°å€çš„è¡Œä¸ºã€‚èŒƒä¾‹ï¼Œè®¿é—®Youtubeã€Facebookä¹‹ç±»ç½‘ç«™ç­‰å‡ºç°çš„çŠ¶å†µã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Javaä½¿ç”¨Openofficeå°†wordã€pptè½¬æ¢ä¸ºPDF</title>
      <link href="/Java-openoffice-pdf/"/>
      <url>/Java-openoffice-pdf/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘é¡¹ç›®ä¸­è¦å®ç°WORDçš„æ–‡ä»¶é¢„è§ˆåŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†WORDè½¬æ¢æˆPDFæˆ–è€…HTMLï¼Œç„¶åé€šè¿‡æµè§ˆå™¨é¢„è§ˆã€‚</p><h1 id="OpenOffice"><a href="#OpenOffice" class="headerlink" title="OpenOffice"></a>OpenOffice</h1><p>OpenOffice.org æ˜¯ä¸€å¥—è·¨å¹³å°çš„åŠå…¬å®¤è½¯ä»¶å¥—ä»¶ï¼Œèƒ½åœ¨ Windowsã€Linuxã€MacOS X (X11)ã€å’Œ Solaris ç­‰æ“ä½œç³»ç»Ÿä¸Šæ‰§è¡Œã€‚å®ƒä¸å„ä¸ªä¸»è¦çš„åŠå…¬å®¤è½¯ä»¶å¥—ä»¶å…¼å®¹ã€‚OpenOffice.org æ˜¯è‡ªç”±è½¯ä»¶ï¼Œä»»ä½•äººéƒ½å¯ä»¥å…è´¹ä¸‹è½½ã€ä½¿ç”¨ã€åŠæ¨å¹¿å®ƒã€‚</p><a id="more"></a><p><strong>ä¸‹è½½åœ°å€</strong></p><p><a href="http://www.openoffice.org/" target="_blank" rel="noopener">http://www.openoffice.org/</a></p><h1 id="JodConverter"><a href="#JodConverter" class="headerlink" title="JodConverter"></a>JodConverter</h1><p>jodconverter-2.2.2.zip ä¸‹è½½åœ°å€ï¼š<br><a href="http://sourceforge.net/projects/jodconverter/files/JODConverter/" target="_blank" rel="noopener">http://sourceforge.net/projects/jodconverter/files/JODConverter/</a></p><h1 id="Wordè½¬æ¢"><a href="#Wordè½¬æ¢" class="headerlink" title="Wordè½¬æ¢"></a>Wordè½¬æ¢</h1><p><strong>å¯åŠ¨OpenOfficeçš„æœåŠ¡</strong></p><p>è¿›å…¥openofficeå®‰è£…ç›®å½•ï¼Œé€šè¿‡cmdå¯åŠ¨ä¸€ä¸ªsofficeæœåŠ¡ï¼Œå¯åŠ¨çš„å‘½ä»¤æ˜¯<code>soffice -headless -accept=&quot;socket,host=127.0.0.1,port=8100;urp;&quot;</code>ã€‚</p><p>å¦‚æœè§‰å¾—åå°è¿è¡ŒOpenOfficeæœåŠ¡æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥é€šè¿‡</p><h1 id="è¿è¡Œä»£ç "><a href="#è¿è¡Œä»£ç " class="headerlink" title="è¿è¡Œä»£ç "></a>è¿è¡Œä»£ç </h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PDFDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">officeToPDF</span><span class="params">(String sourceFile, String destFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            File inputFile = <span class="keyword">new</span> File(sourceFile);</span><br><span class="line">            <span class="keyword">if</span> (!inputFile.exists()) &#123;</span><br><span class="line">                <span class="comment">// æ‰¾ä¸åˆ°æºæ–‡ä»¶, åˆ™è¿”å›false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å¦‚æœç›®æ ‡è·¯å¾„ä¸å­˜åœ¨, åˆ™æ–°å»ºè¯¥è·¯å¾„</span></span><br><span class="line">            File outputFile = <span class="keyword">new</span> File(destFile);</span><br><span class="line">            <span class="keyword">if</span> (!outputFile.getParentFile().exists()) &#123;</span><br><span class="line">                outputFile.getParentFile().mkdirs();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å¦‚æœç›®æ ‡æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™åˆ é™¤</span></span><br><span class="line">            <span class="keyword">if</span> (outputFile.exists()) &#123;</span><br><span class="line">                outputFile.delete();</span><br><span class="line">            &#125;</span><br><span class="line">            DateFormat df = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm"</span>);</span><br><span class="line">            OpenOfficeConnection connection = <span class="keyword">new</span> SocketOpenOfficeConnection(<span class="string">"127.0.0.1"</span>, <span class="number">8100</span>);</span><br><span class="line">            connection.connect();</span><br><span class="line">            <span class="comment">//ç”¨äºæµ‹è¯•openOfficeè¿æ¥æ—¶é—´</span></span><br><span class="line">            System.out.println(<span class="string">"è¿æ¥æ—¶é—´:"</span> + df.format(<span class="keyword">new</span> Date()));</span><br><span class="line">            DocumentConverter converter = <span class="keyword">new</span> StreamOpenOfficeDocumentConverter(</span><br><span class="line">                    connection);</span><br><span class="line">            converter.convert(inputFile, outputFile);</span><br><span class="line">            <span class="comment">//æµ‹è¯•wordè½¬PDFçš„è½¬æ¢æ—¶é—´</span></span><br><span class="line">            System.out.println(<span class="string">"è½¬æ¢æ—¶é—´:"</span> + df.format(<span class="keyword">new</span> Date()));</span><br><span class="line">            connection.disconnect();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ConnectException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            System.err.println(<span class="string">"openOfficeè¿æ¥å¤±è´¥ï¼è¯·æ£€æŸ¥IP,ç«¯å£"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        officeToPDF(<span class="string">"E:\\test.docx"</span>, <span class="string">"E:\\test.pdf"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Wordã€pptè½¬Html"><a href="#Wordã€pptè½¬Html" class="headerlink" title="Wordã€pptè½¬Html"></a>Wordã€pptè½¬Html</h1><p>åªéœ€è¦å°†åç¼€åä»<code>.pdf</code>æ”¹ä¸º<code>.html</code>å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    officeToPDF(<span class="string">"E:\\test.docx"</span>, <span class="string">"E:\\test.html"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Mavené…ç½®"><a href="#Mavené…ç½®" class="headerlink" title="Mavené…ç½®"></a>Mavené…ç½®</h1><p><strong>Mavenä¾èµ–</strong></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.artofsolving<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jodconverter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jurt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ridl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>juh<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.openoffice<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>unoil<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-jdk14<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Mavenåªæœ‰ 2.2.1ç‰ˆæœ¬ï¼Œ2.2.1ç‰ˆæœ¬æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸å…¼å®¹docxå’Œpptxï¼Œå¦‚æœä½ ä»¬ä¸ä½¿ç”¨jodconverter-2.2.2 ä¸­libï¼Œè€Œæƒ³è¦ä½¿ç”¨2.2.1ç‰ˆæœ¬ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹ <code>BasicDocumentFormatRegistry</code> ç±»ä¸­çš„ <code>getFormatByFileExtension</code>æ–¹æ³•ï¼š</p><ol><li>æ–°å»ºåŒ… <code>com.artofsolving.jodconverter</code></li><li>æ–°å»ºç±»<code>BasicDocumentFormatRegistry</code>ï¼Œå¤åˆ¶ä¸‹é¢ä»£ç </li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.artofsolving.jodconverter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2017/12/25</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BasicDocumentFormatRegistry</span> <span class="keyword">implements</span> <span class="title">DocumentFormatRegistry</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List documentFormats = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BasicDocumentFormatRegistry</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addDocumentFormat</span><span class="params">(DocumentFormat documentFormat)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.documentFormats.add(documentFormat);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> List <span class="title">getDocumentFormats</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.documentFormats;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DocumentFormat <span class="title">getFormatByFileExtension</span><span class="params">(String extension)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (extension == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (extension.indexOf(<span class="string">"doc"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                extension = <span class="string">"doc"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (extension.indexOf(<span class="string">"ppt"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                extension = <span class="string">"ppt"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (extension.indexOf(<span class="string">"xls"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                extension = <span class="string">"xls"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            String lowerExtension = extension.toLowerCase();</span><br><span class="line">            Iterator it = <span class="keyword">this</span>.documentFormats.iterator();</span><br><span class="line"></span><br><span class="line">            DocumentFormat format;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!it.hasNext()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                format = (DocumentFormat)it.next();</span><br><span class="line">            &#125; <span class="keyword">while</span>(!format.getFileExtension().equals(lowerExtension));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> format;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DocumentFormat <span class="title">getFormatByMimeType</span><span class="params">(String mimeType)</span> </span>&#123;</span><br><span class="line">        Iterator it = <span class="keyword">this</span>.documentFormats.iterator();</span><br><span class="line"></span><br><span class="line">        DocumentFormat format;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!it.hasNext()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            format = (DocumentFormat)it.next();</span><br><span class="line">        &#125; <span class="keyword">while</span>(!format.getMimeType().equals(mimeType));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> format;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å¢åŠ çš„éƒ¨åˆ†ï¼Œä»…ä»…å¢åŠ äº†å°†docxæŒ‰ç…§docçš„å¤„ç†æ–¹å¼å¤„ç†ã€‚è€Œ2.2.2ç‰ˆæœ¬å·²ç»é»˜è®¤å¢åŠ äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (extension.indexOf(<span class="string">"doc"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    extension = <span class="string">"doc"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (extension.indexOf(<span class="string">"ppt"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    extension = <span class="string">"ppt"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (extension.indexOf(<span class="string">"xls"</span>) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    extension = <span class="string">"xls"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://blog.csdn.net/yjclsx/article/details/51445546" target="_blank" rel="noopener">Javaå®ç°åœ¨çº¿é¢„è§ˆâ€“openOfficeå®ç°</a></li><li><a href="http://blog.csdn.net/qq_33571718/article/details/51154472" target="_blank" rel="noopener">Javaé¡¹ç›®ä¸­ä½¿ç”¨OpenOfficeè½¬PDF</a></li><li><a href="http://blog.csdn.net/make_a_difference/article/details/53771136###;" target="_blank" rel="noopener">javaä½¿ç”¨openofficeå°†officeç³»åˆ—æ–‡æ¡£è½¬æ¢ä¸ºPDF</a></li><li><a href="http://www.cnblogs.com/xxyfhjl/p/6773786.html" target="_blank" rel="noopener">java å¦‚ä½•å°† word,excel,pptå¦‚ä½•è½¬pdfâ€“jacob</a></li><li><a href="http://www.cnblogs.com/xxyfhjl/p/6775137.html" target="_blank" rel="noopener">java å¦‚ä½•å°† word,excel,pptå¦‚ä½•è½¬pdf â€“openoffice (1)</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PDF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å•ç‚¹ç™»å½•åŸç†ä¸ç®€å•å®ç°</title>
      <link href="/sso/"/>
      <url>/sso/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡è½¬è½½è‡ªï¼š <a href="https://www.cnblogs.com/ywlaker/p/6113927.html" target="_blank" rel="noopener">https://www.cnblogs.com/ywlaker/p/6113927.html</a></p><blockquote><p>ä½œè€…ï¼šå‡Œæ‰¿ä¸€<br>å‡ºå¤„ï¼š<a href="http://www.cnblogs.com/ywlaker/" target="_blank" rel="noopener">http://www.cnblogs.com/ywlaker/</a><br>å£°æ˜ï¼šæœ¬æ–‡ç‰ˆæƒå½’ä½œè€…å’Œåšå®¢å›­å…±æœ‰ï¼Œæ¬¢è¿è½¬è½½ï¼Œä½†è½¬è½½å¿…é¡»ä¿ç•™æ­¤æ®µå£°æ˜ï¼Œå¹¶åœ¨æ–‡ç« é¡µé¢æ˜æ˜¾ä½ç½®ç»™å‡ºåŸæ–‡é“¾æ¥ï¼Œå¦åˆ™ä½œè€…å°†ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ã€‚</p></blockquote><h1 id="å•ç³»ç»Ÿç™»å½•æœºåˆ¶"><a href="#å•ç³»ç»Ÿç™»å½•æœºåˆ¶" class="headerlink" title="å•ç³»ç»Ÿç™»å½•æœºåˆ¶"></a>å•ç³»ç»Ÿç™»å½•æœºåˆ¶</h1><p>webåº”ç”¨é‡‡ç”¨browser/serveræ¶æ„ï¼Œhttpä½œä¸ºé€šä¿¡åè®®ã€‚httpæ˜¯æ— çŠ¶æ€åè®®ï¼Œæµè§ˆå™¨çš„æ¯ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šç‹¬ç«‹å¤„ç†ï¼Œä¸ä¸ä¹‹å‰æˆ–ä¹‹åçš„è¯·æ±‚äº§ç”Ÿå…³è”ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨ä¸‹å›¾è¯´æ˜ï¼Œä¸‰æ¬¡è¯·æ±‚/å“åº”å¯¹ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ã€‚</p><p><img src="https://images.morethink.cn/02c5bff6aa0c8a04bbda6261bb0fbd7f.png" alt="" title="æ— çŠ¶æ€çš„Httpåè®®"></p><a id="more"></a><p>ä½†è¿™ä¹ŸåŒæ—¶æ„å‘³ç€ï¼Œä»»ä½•ç”¨æˆ·éƒ½èƒ½é€šè¿‡æµè§ˆå™¨è®¿é—®æœåŠ¡å™¨èµ„æºï¼Œå¦‚æœæƒ³ä¿æŠ¤æœåŠ¡å™¨çš„æŸäº›èµ„æºï¼Œå¿…é¡»é™åˆ¶æµè§ˆå™¨è¯·æ±‚ï¼›è¦é™åˆ¶æµè§ˆå™¨è¯·æ±‚ï¼Œå¿…é¡»é‰´åˆ«æµè§ˆå™¨è¯·æ±‚ï¼Œå“åº”åˆæ³•è¯·æ±‚ï¼Œå¿½ç•¥éæ³•è¯·æ±‚ï¼›è¦é‰´åˆ«æµè§ˆå™¨è¯·æ±‚ï¼Œå¿…é¡»æ¸…æ¥šæµè§ˆå™¨è¯·æ±‚çŠ¶æ€ã€‚æ—¢ç„¶httpåè®®æ— çŠ¶æ€ï¼Œé‚£å°±è®©æœåŠ¡å™¨å’Œæµè§ˆå™¨å…±åŒç»´æŠ¤ä¸€ä¸ªçŠ¶æ€å§ï¼è¿™å°±æ˜¯ä¼šè¯æœºåˆ¶ã€‚</p><h2 id="ä¼šè¯æœºåˆ¶"><a href="#ä¼šè¯æœºåˆ¶" class="headerlink" title="ä¼šè¯æœºåˆ¶"></a>ä¼šè¯æœºåˆ¶</h2><p>æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªä¼šè¯ï¼Œå¹¶å°†ä¼šè¯çš„idä½œä¸ºå“åº”çš„ä¸€éƒ¨åˆ†å‘é€ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨å­˜å‚¨ä¼šè¯idï¼Œå¹¶åœ¨åç»­ç¬¬äºŒæ¬¡å’Œç¬¬ä¸‰æ¬¡è¯·æ±‚ä¸­å¸¦ä¸Šä¼šè¯idï¼ŒæœåŠ¡å™¨å–å¾—è¯·æ±‚ä¸­çš„ä¼šè¯idå°±çŸ¥é“æ˜¯ä¸æ˜¯åŒä¸€ä¸ªç”¨æˆ·äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨ä¸‹å›¾è¯´æ˜ï¼Œåç»­è¯·æ±‚ä¸ç¬¬ä¸€æ¬¡è¯·æ±‚äº§ç”Ÿäº†å…³è”ã€‚</p><p><img src="https://images.morethink.cn/41970737be124812ef2b457d33aa38df.png" alt="" title="ä¼šè¯æœºåˆ¶"></p><p>æœåŠ¡å™¨åœ¨å†…å­˜ä¸­ä¿å­˜ä¼šè¯å¯¹è±¡ï¼Œæµè§ˆå™¨æ€ä¹ˆä¿å­˜ä¼šè¯idå‘¢ï¼Ÿ</p><p>ä½ å¯èƒ½ä¼šæƒ³åˆ°ä¸¤ç§æ–¹å¼</p><ul><li>è¯·æ±‚å‚æ•°</li><li>cookie</li></ul><p>å°†ä¼šè¯idä½œä¸ºæ¯ä¸€ä¸ªè¯·æ±‚çš„å‚æ•°ï¼ŒæœåŠ¡å™¨æ¥æ”¶è¯·æ±‚è‡ªç„¶èƒ½è§£æå‚æ•°è·å¾—ä¼šè¯idï¼Œå¹¶å€Ÿæ­¤åˆ¤æ–­æ˜¯å¦æ¥è‡ªåŒä¸€ä¼šè¯ï¼Œå¾ˆæ˜æ˜¾ï¼Œè¿™ç§æ–¹å¼ä¸é è°±ã€‚é‚£å°±æµè§ˆå™¨è‡ªå·±æ¥ç»´æŠ¤è¿™ä¸ªä¼šè¯idå§ï¼Œæ¯æ¬¡å‘é€httpè¯·æ±‚æ—¶æµè§ˆå™¨è‡ªåŠ¨å‘é€ä¼šè¯idï¼Œcookieæœºåˆ¶æ­£å¥½ç”¨æ¥åšè¿™ä»¶äº‹ã€‚cookieæ˜¯æµè§ˆå™¨ç”¨æ¥å­˜å‚¨å°‘é‡æ•°æ®çš„ä¸€ç§æœºåˆ¶ï¼Œæ•°æ®ä»¥â€key/valueâ€å½¢å¼å­˜å‚¨ï¼Œæµè§ˆå™¨å‘é€httpè¯·æ±‚æ—¶è‡ªåŠ¨é™„å¸¦cookieä¿¡æ¯ã€‚</p><p>tomcatä¼šè¯æœºåˆ¶å½“ç„¶ä¹Ÿå®ç°äº†cookieï¼Œè®¿é—®tomcatæœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨ä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸ªåä¸º<code>JSESSIONID</code>çš„cookieï¼Œè¿™å°±æ˜¯tomcatä¼šè¯æœºåˆ¶ç»´æŠ¤çš„ä¼šè¯idï¼Œä½¿ç”¨äº†cookieçš„è¯·æ±‚å“åº”è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://images.morethink.cn/61273ed59b80ddef53862a0cba5f83a0.png" alt="" title="JSESSIONID"></p><h2 id="ç™»å½•çŠ¶æ€"><a href="#ç™»å½•çŠ¶æ€" class="headerlink" title="ç™»å½•çŠ¶æ€"></a>ç™»å½•çŠ¶æ€</h2><p>æœ‰äº†ä¼šè¯æœºåˆ¶ï¼Œç™»å½•çŠ¶æ€å°±å¥½æ˜ç™½äº†ï¼Œæˆ‘ä»¬å‡è®¾æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨éœ€è¦è¾“å…¥ç”¨æˆ·åä¸å¯†ç éªŒè¯èº«ä»½ï¼ŒæœåŠ¡å™¨æ‹¿åˆ°ç”¨æˆ·åå¯†ç å»æ•°æ®åº“æ¯”å¯¹ï¼Œæ­£ç¡®çš„è¯è¯´æ˜å½“å‰æŒæœ‰è¿™ä¸ªä¼šè¯çš„ç”¨æˆ·æ˜¯åˆæ³•ç”¨æˆ·ï¼Œåº”è¯¥å°†è¿™ä¸ªä¼šè¯æ ‡è®°ä¸ºâ€œå·²æˆæƒâ€æˆ–è€…â€œå·²ç™»å½•â€ç­‰ç­‰ä¹‹ç±»çš„çŠ¶æ€ï¼Œæ—¢ç„¶æ˜¯ä¼šè¯çš„çŠ¶æ€ï¼Œè‡ªç„¶è¦ä¿å­˜åœ¨ä¼šè¯å¯¹è±¡ä¸­ï¼Œtomcatåœ¨ä¼šè¯å¯¹è±¡ä¸­è®¾ç½®ç™»å½•çŠ¶æ€å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpSession session = request.getSession();</span><br><span class="line">session.setAttribute(<span class="string">"isLogin"</span>, <span class="keyword">true</span>);</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·å†æ¬¡è®¿é—®æ—¶ï¼Œtomcatåœ¨ä¼šè¯å¯¹è±¡ä¸­æŸ¥çœ‹ç™»å½•çŠ¶æ€ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpSession session = request.getSession();</span><br><span class="line">session.getAttribute(<span class="string">"isLogin"</span>);</span><br></pre></td></tr></table></figure><p>å®ç°äº†ç™»å½•çŠ¶æ€çš„æµè§ˆå™¨è¯·æ±‚æœåŠ¡å™¨æ¨¡å‹å¦‚ä¸‹å›¾æè¿°ï¼š</p><p><img src="https://images.morethink.cn/39ec3914d68cc400fab2d251d84370e6.png" alt="" title="ç™»å½•çŠ¶æ€æ§åˆ¶"></p><p>æ¯æ¬¡è¯·æ±‚å—ä¿æŠ¤èµ„æºæ—¶éƒ½ä¼šæ£€æŸ¥ä¼šè¯å¯¹è±¡ä¸­çš„ç™»å½•çŠ¶æ€ï¼Œåªæœ‰ <code>isLogin=true</code> çš„ä¼šè¯æ‰èƒ½è®¿é—®ï¼Œç™»å½•æœºåˆ¶å› æ­¤è€Œå®ç°ã€‚</p><h1 id="å¤šç³»ç»Ÿçš„å¤æ‚æ€§"><a href="#å¤šç³»ç»Ÿçš„å¤æ‚æ€§" class="headerlink" title="å¤šç³»ç»Ÿçš„å¤æ‚æ€§"></a>å¤šç³»ç»Ÿçš„å¤æ‚æ€§</h1><p>webç³»ç»Ÿæ—©å·²ä»ä¹…è¿œçš„å•ç³»ç»Ÿå‘å±•æˆä¸ºå¦‚ä»Šç”±å¤šç³»ç»Ÿç»„æˆçš„åº”ç”¨ç¾¤ï¼Œé¢å¯¹å¦‚æ­¤ä¼—å¤šçš„ç³»ç»Ÿï¼Œç”¨æˆ·éš¾é“è¦ä¸€ä¸ªä¸€ä¸ªç™»å½•ã€ç„¶åä¸€ä¸ªä¸€ä¸ªæ³¨é”€å—ï¼Ÿå°±åƒä¸‹å›¾æè¿°çš„è¿™æ ·</p><p><img src="https://images.morethink.cn/1c722018d9dfd78b8623a1c5c50cd740.png" alt="" title="å¤šç³»ç»Ÿ"></p><p><strong>webç³»ç»Ÿç”±å•ç³»ç»Ÿå‘å±•æˆå¤šç³»ç»Ÿç»„æˆçš„åº”ç”¨ç¾¤ï¼Œå¤æ‚æ€§åº”è¯¥ç”±ç³»ç»Ÿå†…éƒ¨æ‰¿æ‹…ï¼Œè€Œä¸æ˜¯ç”¨æˆ·ã€‚æ— è®ºwebç³»ç»Ÿå†…éƒ¨å¤šä¹ˆå¤æ‚ï¼Œå¯¹ç”¨æˆ·è€Œè¨€ï¼Œéƒ½æ˜¯ä¸€ä¸ªç»Ÿä¸€çš„æ•´ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨æˆ·è®¿é—®webç³»ç»Ÿçš„æ•´ä¸ªåº”ç”¨ç¾¤ä¸è®¿é—®å•ä¸ªç³»ç»Ÿä¸€æ ·ï¼Œç™»å½•/æ³¨é”€åªè¦ä¸€æ¬¡å°±å¤Ÿäº†</strong>ã€‚</p><p><img src="https://images.morethink.cn/33e912634f234d469982fd25afac8e2a.png" alt="" title="å•ç³»ç»Ÿçš„ç™»å½•"></p><p><strong><em>è™½ç„¶å•ç³»ç»Ÿçš„ç™»å½•è§£å†³æ–¹æ¡ˆå¾ˆå®Œç¾ï¼Œä½†å¯¹äºå¤šç³»ç»Ÿåº”ç”¨ç¾¤å·²ç»ä¸å†é€‚ç”¨äº†ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</em></strong></p><p>å•ç³»ç»Ÿç™»å½•è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒæ˜¯cookieï¼Œcookieæºå¸¦ä¼šè¯idåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´ç»´æŠ¤ä¼šè¯çŠ¶æ€ã€‚ä½†cookieæ˜¯æœ‰é™åˆ¶çš„ï¼Œè¿™ä¸ªé™åˆ¶å°±æ˜¯cookieçš„åŸŸï¼ˆé€šå¸¸å¯¹åº”ç½‘ç«™çš„åŸŸåï¼‰ï¼Œæµè§ˆå™¨å‘é€httpè¯·æ±‚æ—¶ä¼šè‡ªåŠ¨æºå¸¦ä¸è¯¥åŸŸåŒ¹é…çš„cookieï¼Œè€Œä¸æ˜¯æ‰€æœ‰cookieã€‚</p><p><img src="https://images.morethink.cn/3d3db13c2cab0ba0863b8ecfe4c3f7b2.png" alt="" title="å¤¸åŸŸå"></p><h2 id="å­åŸŸåcookieå…±äº«å®Œæˆå•ç‚¹ç™»å½•"><a href="#å­åŸŸåcookieå…±äº«å®Œæˆå•ç‚¹ç™»å½•" class="headerlink" title="å­åŸŸåcookieå…±äº«å®Œæˆå•ç‚¹ç™»å½•"></a>å­åŸŸåcookieå…±äº«å®Œæˆå•ç‚¹ç™»å½•</h2><p>æ—¢ç„¶è¿™æ ·ï¼Œä¸ºä»€ä¹ˆä¸å°†webåº”ç”¨ç¾¤ä¸­æ‰€æœ‰å­ç³»ç»Ÿçš„åŸŸåç»Ÿä¸€åœ¨ä¸€ä¸ªé¡¶çº§åŸŸåä¸‹ï¼Œä¾‹å¦‚â€œ<code>*.baidu.com</code>â€ï¼Œç„¶åå°†å®ƒä»¬çš„cookieåŸŸè®¾ç½®ä¸ºâ€œbaidu.comâ€ï¼Œè¿™ç§åšæ³•ç†è®ºä¸Šæ˜¯å¯ä»¥çš„ï¼Œç”šè‡³æ—©æœŸå¾ˆå¤šå¤šç³»ç»Ÿç™»å½•å°±é‡‡ç”¨è¿™ç§åŒåŸŸåå…±äº«cookieçš„æ–¹å¼ã€‚</p><p>ç„¶è€Œï¼Œå¯è¡Œå¹¶ä¸ä»£è¡¨å¥½ï¼Œå…±äº«cookieçš„æ–¹å¼å­˜åœ¨ä¼—å¤šå±€é™ã€‚</p><ol><li>é¦–å…ˆï¼Œåº”ç”¨ç¾¤åŸŸåå¾—ç»Ÿä¸€ã€‚</li><li>å…¶æ¬¡ï¼Œåº”ç”¨ç¾¤å„ç³»ç»Ÿä½¿ç”¨çš„æŠ€æœ¯ï¼ˆè‡³å°‘æ˜¯webæœåŠ¡å™¨ï¼‰è¦ç›¸åŒï¼Œä¸ç„¶cookieçš„keyå€¼ï¼ˆtomcatä¸ºJSESSIONIDï¼‰ä¸åŒï¼Œæ— æ³•ç»´æŒä¼šè¯ï¼Œå…±äº«cookieçš„æ–¹å¼æ˜¯æ— æ³•å®ç°è·¨è¯­è¨€æŠ€æœ¯å¹³å°ç™»å½•çš„ï¼Œæ¯”å¦‚javaã€phpã€.netç³»ç»Ÿä¹‹é—´ã€‚</li><li>ç¬¬ä¸‰ï¼Œcookieæœ¬èº«ä¸å®‰å…¨ã€‚</li></ol><p>é™¤ä¸Šé¢ä¹‹å¤–ï¼Œå¦‚æœæˆ‘ä»¬åœ¨<code>session</code>å­˜æ”¾çš„æ˜¯<code>User</code>å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨å…¨å±€cookieå…±äº«<code>JSESSIONID</code>å€¼ï¼Œæ¯ä¸€ä¸ªå­åŸŸåå°±å¯ä»¥è®¿é—®åŒä¸€ä¸ªsessionï¼Œç™»å½•æˆåŠŸåä¿å­˜ä¸€ä¸ªuserå¯¹è±¡ï¼Œæ³¨é”€åå°±ç§»é™¤è¿™ä¸ªuserå¯¹è±¡ã€‚sessionä¸­çš„userå¯¹è±¡å¿…é¡»å…ˆåºåˆ—åŒ–ä¿å­˜åˆ°redisä¸­ï¼Œå¹¶ä¸”æ¯æ¬¡è®¿é—®çš„æ—¶å€™ï¼Œéƒ½éœ€è¦å»redisä¸­å–å‡ºsessionï¼Œå¹¶ä¸”é‡æ–°åºåˆ—åŒ–æˆuserå¯¹è±¡ã€‚<strong>è¿™æ ·ä¼šé€ æˆé¢å¤–çš„æ¶ˆè€—</strong>ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§å…¨æ–°çš„ç™»å½•æ–¹å¼æ¥å®ç°å¤šç³»ç»Ÿåº”ç”¨ç¾¤çš„ç™»å½•ï¼Œè¿™å°±æ˜¯å•ç‚¹ç™»å½•ã€‚</p><h1 id="å•ç‚¹ç™»å½•"><a href="#å•ç‚¹ç™»å½•" class="headerlink" title="å•ç‚¹ç™»å½•"></a>å•ç‚¹ç™»å½•</h1><p><strong>ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•</strong>ï¼Ÿ</p><p>å•ç‚¹ç™»å½•å…¨ç§°Single Sign Onï¼ˆä»¥ä¸‹ç®€ç§°SSOï¼‰ï¼Œæ˜¯æŒ‡åœ¨å¤šç³»ç»Ÿåº”ç”¨ç¾¤ä¸­ç™»å½•ä¸€ä¸ªç³»ç»Ÿï¼Œä¾¿å¯åœ¨å…¶ä»–æ‰€æœ‰ç³»ç»Ÿä¸­å¾—åˆ°æˆæƒè€Œæ— éœ€å†æ¬¡ç™»å½•ï¼ŒåŒ…æ‹¬å•ç‚¹ç™»å½•ä¸å•ç‚¹æ³¨é”€ä¸¤éƒ¨åˆ†ã€‚</p><h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><p>ç›¸æ¯”äºå•ç³»ç»Ÿç™»å½•ï¼Œssoéœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„è®¤è¯ä¸­å¿ƒï¼Œåªæœ‰è®¤è¯ä¸­å¿ƒèƒ½æ¥å—ç”¨æˆ·çš„ç”¨æˆ·åå¯†ç ç­‰å®‰å…¨ä¿¡æ¯ï¼Œå…¶ä»–ç³»ç»Ÿä¸æä¾›ç™»å½•å…¥å£ï¼Œåªæ¥å—è®¤è¯ä¸­å¿ƒçš„é—´æ¥æˆæƒã€‚é—´æ¥æˆæƒé€šè¿‡ä»¤ç‰Œå®ç°ï¼Œssoè®¤è¯ä¸­å¿ƒéªŒè¯ç”¨æˆ·çš„ç”¨æˆ·åå¯†ç æ²¡é—®é¢˜ï¼Œåˆ›å»ºæˆæƒä»¤ç‰Œï¼Œåœ¨æ¥ä¸‹æ¥çš„è·³è½¬è¿‡ç¨‹ä¸­ï¼Œæˆæƒä»¤ç‰Œä½œä¸ºå‚æ•°å‘é€ç»™å„ä¸ªå­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿæ‹¿åˆ°ä»¤ç‰Œï¼Œå³å¾—åˆ°äº†æˆæƒï¼Œå¯ä»¥å€Ÿæ­¤åˆ›å»ºå±€éƒ¨ä¼šè¯ï¼Œå±€éƒ¨ä¼šè¯ç™»å½•æ–¹å¼ä¸å•ç³»ç»Ÿçš„ç™»å½•æ–¹å¼ç›¸åŒã€‚</p><p>è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å•ç‚¹ç™»å½•çš„åŸç†ï¼Œç”¨ä¸‹å›¾è¯´æ˜ï¼š</p><p><img src="https://images.morethink.cn/797930-20161203152650974-276822362.png" alt="" title="å•ç‚¹ç™»å½•"></p><p>ä¸‹é¢å¯¹ä¸Šå›¾ç®€è¦æè¿°ï¼š</p><ol><li>ç”¨æˆ·è®¿é—®ç³»ç»Ÿ1çš„å—ä¿æŠ¤èµ„æºï¼Œç³»ç»Ÿ1å‘ç°ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒå‘ç°ç”¨æˆ·æœªç™»å½•ï¼Œå°†ç”¨æˆ·å¼•å¯¼è‡³ç™»å½•é¡µé¢ã€‚</li><li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå¯†ç æäº¤ç™»å½•ç”³è¯·ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒç”¨æˆ·ä¿¡æ¯ï¼Œåˆ›å»ºç”¨æˆ·ä¸ssoè®¤è¯ä¸­å¿ƒä¹‹é—´çš„ä¼šè¯ï¼Œç§°ä¸ºå…¨å±€ä¼šè¯ï¼ŒåŒæ—¶åˆ›å»ºæˆæƒä»¤ç‰Œã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒå¸¦ç€ä»¤ç‰Œè·³è½¬ä¼šæœ€åˆçš„è¯·æ±‚åœ°å€ï¼ˆç³»ç»Ÿ1ï¼‰ã€‚</li><li>ç³»ç»Ÿ1æ‹¿åˆ°ä»¤ç‰Œï¼Œå»ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œï¼Œè¿”å›æœ‰æ•ˆï¼Œæ³¨å†Œç³»ç»Ÿ1ã€‚</li><li>ç³»ç»Ÿ1ä½¿ç”¨è¯¥ä»¤ç‰Œåˆ›å»ºä¸ç”¨æˆ·çš„ä¼šè¯ï¼Œç§°ä¸ºå±€éƒ¨ä¼šè¯ï¼Œè¿”å›å—ä¿æŠ¤èµ„æºã€‚</li><li>ç”¨æˆ·è®¿é—®ç³»ç»Ÿ2çš„å—ä¿æŠ¤èµ„æºã€‚</li><li>ç³»ç»Ÿ2å‘ç°ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒï¼Œå¹¶å°†è‡ªå·±çš„åœ°å€ä½œä¸ºå‚æ•°ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒå‘ç°ç”¨æˆ·å·²ç™»å½•ï¼Œè·³è½¬å›ç³»ç»Ÿ2çš„åœ°å€ï¼Œå¹¶é™„ä¸Šä»¤ç‰Œã€‚</li><li>ç³»ç»Ÿ2æ‹¿åˆ°ä»¤ç‰Œï¼Œå»ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œï¼Œè¿”å›æœ‰æ•ˆï¼Œæ³¨å†Œç³»ç»Ÿ2ã€‚</li><li>ç³»ç»Ÿ2ä½¿ç”¨è¯¥ä»¤ç‰Œåˆ›å»ºä¸ç”¨æˆ·çš„å±€éƒ¨ä¼šè¯ï¼Œè¿”å›å—ä¿æŠ¤èµ„æºã€‚</li></ol><p>ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œä¼šä¸ssoè®¤è¯ä¸­å¿ƒåŠå„ä¸ªå­ç³»ç»Ÿå»ºç«‹ä¼šè¯ï¼Œç”¨æˆ·ä¸ssoè®¤è¯ä¸­å¿ƒå»ºç«‹çš„ä¼šè¯ç§°ä¸ºå…¨å±€ä¼šè¯ï¼Œç”¨æˆ·ä¸å„ä¸ªå­ç³»ç»Ÿå»ºç«‹çš„ä¼šè¯ç§°ä¸ºå±€éƒ¨ä¼šè¯ï¼Œå±€éƒ¨ä¼šè¯å»ºç«‹ä¹‹åï¼Œç”¨æˆ·è®¿é—®å­ç³»ç»Ÿå—ä¿æŠ¤èµ„æºå°†ä¸å†é€šè¿‡ssoè®¤è¯ä¸­å¿ƒï¼Œå…¨å±€ä¼šè¯ä¸å±€éƒ¨ä¼šè¯æœ‰å¦‚ä¸‹çº¦æŸå…³ç³»ï¼š</p><ul><li>å±€éƒ¨ä¼šè¯å­˜åœ¨ï¼Œå…¨å±€ä¼šè¯ä¸€å®šå­˜åœ¨ã€‚</li><li>å…¨å±€ä¼šè¯å­˜åœ¨ï¼Œå±€éƒ¨ä¼šè¯ä¸ä¸€å®šå­˜åœ¨ã€‚</li><li>å…¨å±€ä¼šè¯é”€æ¯ï¼Œå±€éƒ¨ä¼šè¯å¿…é¡»é”€æ¯ã€‚</li></ul><p>ä½ å¯ä»¥é€šè¿‡åšå®¢å›­ã€ç™¾åº¦ã€csdnã€æ·˜å®ç­‰ç½‘ç«™çš„ç™»å½•è¿‡ç¨‹åŠ æ·±å¯¹å•ç‚¹ç™»å½•çš„ç†è§£ï¼Œæ³¨æ„è§‚å¯Ÿç™»å½•è¿‡ç¨‹ä¸­çš„è·³è½¬urlä¸å‚æ•°</p><h2 id="æ³¨é”€"><a href="#æ³¨é”€" class="headerlink" title="æ³¨é”€"></a>æ³¨é”€</h2><p>å•ç‚¹ç™»å½•è‡ªç„¶ä¹Ÿè¦å•ç‚¹æ³¨é”€ï¼Œåœ¨ä¸€ä¸ªå­ç³»ç»Ÿä¸­æ³¨é”€ï¼Œæ‰€æœ‰å­ç³»ç»Ÿçš„ä¼šè¯éƒ½å°†è¢«é”€æ¯ï¼Œç”¨ä¸‹é¢çš„å›¾æ¥è¯´æ˜ï¼š</p><p><img src="https://images.morethink.cn/797930-20161129155242271-222889796.png" alt="" title="å•ç‚¹æ³¨é”€"></p><p>ssoè®¤è¯ä¸­å¿ƒä¸€ç›´ç›‘å¬å…¨å±€ä¼šè¯çš„çŠ¶æ€ï¼Œä¸€æ—¦å…¨å±€ä¼šè¯é”€æ¯ï¼Œç›‘å¬å™¨å°†é€šçŸ¥æ‰€æœ‰æ³¨å†Œç³»ç»Ÿæ‰§è¡Œæ³¨é”€æ“ä½œ</p><p>ä¸‹é¢å¯¹ä¸Šå›¾ç®€è¦è¯´æ˜ï¼š</p><ol><li>ç”¨æˆ·å‘ç³»ç»Ÿ1å‘èµ·æ³¨é”€è¯·æ±‚ã€‚</li><li>ç³»ç»Ÿ1æ ¹æ®ç”¨æˆ·ä¸ç³»ç»Ÿ1å»ºç«‹çš„ä¼šè¯idæ‹¿åˆ°ä»¤ç‰Œï¼Œå‘ssoè®¤è¯ä¸­å¿ƒå‘èµ·æ³¨é”€è¯·æ±‚ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒä»¤ç‰Œæœ‰æ•ˆï¼Œé”€æ¯å…¨å±€ä¼šè¯ï¼ŒåŒæ—¶å–å‡ºæ‰€æœ‰ç”¨æ­¤ä»¤ç‰Œæ³¨å†Œçš„ç³»ç»Ÿåœ°å€ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒå‘æ‰€æœ‰æ³¨å†Œç³»ç»Ÿå‘èµ·æ³¨é”€è¯·æ±‚ã€‚</li><li>å„æ³¨å†Œç³»ç»Ÿæ¥æ”¶ssoè®¤è¯ä¸­å¿ƒçš„æ³¨é”€è¯·æ±‚ï¼Œé”€æ¯å±€éƒ¨ä¼šè¯ã€‚</li><li>ssoè®¤è¯ä¸­å¿ƒå¼•å¯¼ç”¨æˆ·è‡³ç™»å½•é¡µé¢ã€‚</li></ol><h2 id="éƒ¨ç½²å›¾"><a href="#éƒ¨ç½²å›¾" class="headerlink" title="éƒ¨ç½²å›¾"></a>éƒ¨ç½²å›¾</h2><p>å•ç‚¹ç™»å½•æ¶‰åŠssoè®¤è¯ä¸­å¿ƒä¸ä¼—å­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿä¸ssoè®¤è¯ä¸­å¿ƒéœ€è¦é€šä¿¡ä»¥äº¤æ¢ä»¤ç‰Œã€æ ¡éªŒä»¤ç‰ŒåŠå‘èµ·æ³¨é”€è¯·æ±‚ï¼Œå› è€Œå­ç³»ç»Ÿå¿…é¡»é›†æˆssoçš„å®¢æˆ·ç«¯ï¼Œssoè®¤è¯ä¸­å¿ƒåˆ™æ˜¯ssoæœåŠ¡ç«¯ï¼Œæ•´ä¸ªå•ç‚¹ç™»å½•è¿‡ç¨‹å®è´¨æ˜¯ssoå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šä¿¡çš„è¿‡ç¨‹ï¼Œç”¨ä¸‹å›¾æè¿°ï¼š</p><p><img src="https://images.morethink.cn/797930-20161129155244646-2067469767.png" alt="" title="éƒ¨ç½²å›¾"></p><p>ssoè®¤è¯ä¸­å¿ƒä¸ssoå®¢æˆ·ç«¯é€šä¿¡æ–¹å¼æœ‰å¤šç§ï¼Œè¿™é‡Œä»¥ç®€å•å¥½ç”¨çš„httpClientä¸ºä¾‹ï¼Œweb serviceã€rpcã€restful apiéƒ½å¯ä»¥ã€‚</p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>åªæ˜¯ç®€è¦ä»‹ç»ä¸‹åŸºäºjavaçš„å®ç°è¿‡ç¨‹ï¼Œä¸æä¾›å®Œæ•´æºç ï¼Œæ˜ç™½äº†åŸç†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬å¯ä»¥è‡ªå·±å®ç°ã€‚ssoé‡‡ç”¨å®¢æˆ·ç«¯/æœåŠ¡ç«¯æ¶æ„ï¼Œæˆ‘ä»¬å…ˆçœ‹sso-clientä¸sso-serverè¦å®ç°çš„åŠŸèƒ½ï¼ˆä¸‹é¢ï¼šssoè®¤è¯ä¸­å¿ƒ=sso-serverï¼‰ã€‚</p><h3 id="sso-client"><a href="#sso-client" class="headerlink" title="sso-client"></a>sso-client</h3><ol><li>æ‹¦æˆªå­ç³»ç»Ÿæœªç™»å½•ç”¨æˆ·è¯·æ±‚ï¼Œè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒã€‚</li><li>æ¥æ”¶å¹¶å­˜å‚¨ssoè®¤è¯ä¸­å¿ƒå‘é€çš„ä»¤ç‰Œã€‚</li><li>ä¸sso-serveré€šä¿¡ï¼Œæ ¡éªŒä»¤ç‰Œçš„æœ‰æ•ˆæ€§ã€‚</li><li>å»ºç«‹å±€éƒ¨ä¼šè¯ã€‚</li><li>æ‹¦æˆªç”¨æˆ·æ³¨é”€è¯·æ±‚ï¼Œå‘ssoè®¤è¯ä¸­å¿ƒå‘é€æ³¨é”€è¯·æ±‚ã€‚</li><li>æ¥æ”¶ssoè®¤è¯ä¸­å¿ƒå‘å‡ºçš„æ³¨é”€è¯·æ±‚ï¼Œé”€æ¯å±€éƒ¨ä¼šè¯ã€‚</li></ol><h3 id="sso-server"><a href="#sso-server" class="headerlink" title="sso-server"></a>sso-server</h3><ol><li>éªŒè¯ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ã€‚</li><li>åˆ›å»ºå…¨å±€ä¼šè¯ã€‚</li><li>åˆ›å»ºæˆæƒä»¤ç‰Œã€‚</li><li>ä¸sso-clienté€šä¿¡å‘é€ä»¤ç‰Œã€‚</li><li>æ ¡éªŒsso-clientä»¤ç‰Œæœ‰æ•ˆæ€§ã€‚</li><li>ç³»ç»Ÿæ³¨å†Œã€‚</li><li>æ¥æ”¶sso-clientæ³¨é”€è¯·æ±‚ï¼Œæ³¨é”€æ‰€æœ‰ä¼šè¯ã€‚</li></ol><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŒ‰ç…§åŸç†æ¥ä¸€æ­¥æ­¥å®ç°ssoå§ï¼</p><h2 id="sso-clientæ‹¦æˆªæœªç™»å½•è¯·æ±‚"><a href="#sso-clientæ‹¦æˆªæœªç™»å½•è¯·æ±‚" class="headerlink" title="sso-clientæ‹¦æˆªæœªç™»å½•è¯·æ±‚"></a>sso-clientæ‹¦æˆªæœªç™»å½•è¯·æ±‚</h2><p>javaæ‹¦æˆªè¯·æ±‚çš„æ–¹å¼æœ‰servletã€filterã€listenerä¸‰ç§æ–¹å¼ï¼Œæˆ‘ä»¬é‡‡ç”¨filterã€‚åœ¨sso-clientä¸­æ–°å»ºLoginFilter.javaç±»å¹¶å®ç°Filteræ¥å£ï¼Œåœ¨doFilter()æ–¹æ³•ä¸­åŠ å…¥å¯¹æœªç™»å½•ç”¨æˆ·çš„æ‹¦æˆªï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">    HttpServletRequest req = (HttpServletRequest) request;</span><br><span class="line">    HttpServletResponse res = (HttpServletResponse) response;</span><br><span class="line">    HttpSession session = req.getSession();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (session.getAttribute(<span class="string">"isLogin"</span>)) &#123;</span><br><span class="line">        chain.doFilter(request, response);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒ</span></span><br><span class="line">    res.sendRedirect(<span class="string">"sso-server-url-with-system-url"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="sso-serveræ‹¦æˆªæœªç™»å½•è¯·æ±‚"><a href="#sso-serveræ‹¦æˆªæœªç™»å½•è¯·æ±‚" class="headerlink" title="sso-serveræ‹¦æˆªæœªç™»å½•è¯·æ±‚"></a>sso-serveræ‹¦æˆªæœªç™»å½•è¯·æ±‚</h2><p>æ‹¦æˆªä»sso-clientè·³è½¬è‡³ssoè®¤è¯ä¸­å¿ƒçš„æœªç™»å½•è¯·æ±‚ï¼Œè·³è½¬è‡³ç™»å½•é¡µé¢ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸sso-clientå®Œå…¨ä¸€æ ·ã€‚</p><h2 id="sso-serveréªŒè¯ç”¨æˆ·ç™»å½•ä¿¡æ¯"><a href="#sso-serveréªŒè¯ç”¨æˆ·ç™»å½•ä¿¡æ¯" class="headerlink" title="sso-serveréªŒè¯ç”¨æˆ·ç™»å½•ä¿¡æ¯"></a>sso-serveréªŒè¯ç”¨æˆ·ç™»å½•ä¿¡æ¯</h2><p>ç”¨æˆ·åœ¨ç™»å½•é¡µé¢è¾“å…¥ç”¨æˆ·åå¯†ç ï¼Œè¯·æ±‚ç™»å½•ï¼Œssoè®¤è¯ä¸­å¿ƒæ ¡éªŒç”¨æˆ·ä¿¡æ¯ï¼Œæ ¡éªŒæˆåŠŸï¼Œå°†ä¼šè¯çŠ¶æ€æ ‡è®°ä¸ºâ€œå·²ç™»å½•â€ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(String username, String password, HttpServletRequest req)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.checkLoginInfo(username, password);</span><br><span class="line">    req.getSession().setAttribute(<span class="string">"isLogin"</span>, <span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="sso-serveråˆ›å»ºæˆæƒä»¤ç‰Œ"><a href="#sso-serveråˆ›å»ºæˆæƒä»¤ç‰Œ" class="headerlink" title="sso-serveråˆ›å»ºæˆæƒä»¤ç‰Œ"></a>sso-serveråˆ›å»ºæˆæƒä»¤ç‰Œ</h2><p>æˆæƒä»¤ç‰Œæ˜¯ä¸€ä¸²éšæœºå­—ç¬¦ï¼Œä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼ç”Ÿæˆéƒ½æ²¡æœ‰å…³ç³»ï¼Œåªè¦ä¸é‡å¤ã€ä¸æ˜“ä¼ªé€ å³å¯ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String token = UUID.randomUUID().toString();</span><br></pre></td></tr></table></figure><h2 id="sso-clientå–å¾—ä»¤ç‰Œå¹¶æ ¡éªŒ"><a href="#sso-clientå–å¾—ä»¤ç‰Œå¹¶æ ¡éªŒ" class="headerlink" title="sso-clientå–å¾—ä»¤ç‰Œå¹¶æ ¡éªŒ"></a>sso-clientå–å¾—ä»¤ç‰Œå¹¶æ ¡éªŒ</h2><p>ssoè®¤è¯ä¸­å¿ƒç™»å½•åï¼Œè·³è½¬å›å­ç³»ç»Ÿå¹¶é™„ä¸Šä»¤ç‰Œï¼Œå­ç³»ç»Ÿï¼ˆsso-clientï¼‰å–å¾—ä»¤ç‰Œï¼Œç„¶åå»ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒï¼Œåœ¨LoginFilter.javaçš„doFilter()ä¸­æ·»åŠ å‡ è¡Œï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¯·æ±‚é™„å¸¦tokenå‚æ•°</span></span><br><span class="line">String token = req.getParameter(<span class="string">"token"</span>);</span><br><span class="line"><span class="keyword">if</span> (token != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="comment">// å»ssoè®¤è¯ä¸­å¿ƒæ ¡éªŒtoken</span></span><br><span class="line">    <span class="keyword">boolean</span> verifyResult = <span class="keyword">this</span>.verify(<span class="string">"sso-server-verify-url"</span>, token);</span><br><span class="line">    <span class="keyword">if</span> (!verifyResult) &#123;</span><br><span class="line">        res.sendRedirect(<span class="string">"sso-server-url"</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>verify()æ–¹æ³•ä½¿ç”¨httpClientå®ç°ï¼Œè¿™é‡Œä»…ç®€ç•¥ä»‹ç»ï¼ŒhttpClientè¯¦ç»†ä½¿ç”¨æ–¹æ³•è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpPost httpPost = <span class="keyword">new</span> HttpPost(<span class="string">"sso-server-verify-url-with-token"</span>);</span><br><span class="line">HttpResponse httpResponse = httpClient.execute(httpPost);</span><br></pre></td></tr></table></figure><h2 id="sso-serveræ¥æ”¶å¹¶å¤„ç†æ ¡éªŒä»¤ç‰Œè¯·æ±‚"><a href="#sso-serveræ¥æ”¶å¹¶å¤„ç†æ ¡éªŒä»¤ç‰Œè¯·æ±‚" class="headerlink" title="sso-serveræ¥æ”¶å¹¶å¤„ç†æ ¡éªŒä»¤ç‰Œè¯·æ±‚"></a>sso-serveræ¥æ”¶å¹¶å¤„ç†æ ¡éªŒä»¤ç‰Œè¯·æ±‚</h2><ul><li><p>ç”¨æˆ·åœ¨ssoè®¤è¯ä¸­å¿ƒç™»å½•æˆåŠŸåï¼Œsso-serveråˆ›å»ºæˆæƒä»¤ç‰Œå¹¶å­˜å‚¨è¯¥ä»¤ç‰Œï¼Œæ‰€ä»¥ï¼Œsso-serverå¯¹ä»¤ç‰Œçš„æ ¡éªŒå°±æ˜¯å»æŸ¥æ‰¾è¿™ä¸ªä»¤ç‰Œæ˜¯å¦å­˜åœ¨ä»¥åŠæ˜¯å¦è¿‡æœŸï¼Œä»¤ç‰Œæ ¡éªŒæˆåŠŸåsso-serverå°†å‘é€æ ¡éªŒè¯·æ±‚çš„ç³»ç»Ÿæ³¨å†Œåˆ°ssoè®¤è¯ä¸­å¿ƒï¼ˆå°±æ˜¯å­˜å‚¨èµ·æ¥çš„æ„æ€ï¼‰</p></li><li><p>ä»¤ç‰Œä¸æ³¨å†Œç³»ç»Ÿåœ°å€é€šå¸¸å­˜å‚¨åœ¨key-valueæ•°æ®åº“ï¼ˆå¦‚redisï¼‰ä¸­ï¼Œrediså¯ä»¥ä¸ºkeyè®¾ç½®æœ‰æ•ˆæ—¶é—´ä¹Ÿå°±æ˜¯ä»¤ç‰Œçš„æœ‰æ•ˆæœŸã€‚redisè¿è¡Œåœ¨å†…å­˜ä¸­ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œæ­£å¥½sso-serverä¸éœ€è¦æŒä¹…åŒ–ä»»ä½•æ•°æ®ã€‚</p></li><li><p>ä»¤ç‰Œä¸æ³¨å†Œç³»ç»Ÿåœ°å€å¯ä»¥ç”¨ä¸‹å›¾æè¿°çš„ç»“æ„å­˜å‚¨åœ¨redisä¸­ï¼Œå¯èƒ½ä½ ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¦å­˜å‚¨è¿™äº›ç³»ç»Ÿçš„åœ°å€ï¼Ÿå¦‚æœä¸å­˜å‚¨ï¼Œæ³¨é”€çš„æ—¶å€™å°±éº»çƒ¦äº†ï¼Œç”¨æˆ·å‘ssoè®¤è¯ä¸­å¿ƒæäº¤æ³¨é”€è¯·æ±‚ï¼Œssoè®¤è¯ä¸­å¿ƒæ³¨é”€å…¨å±€ä¼šè¯ï¼Œä½†ä¸çŸ¥é“å“ªäº›ç³»ç»Ÿç”¨æ­¤å…¨å±€ä¼šè¯å»ºç«‹äº†è‡ªå·±çš„å±€éƒ¨ä¼šè¯ï¼Œä¹Ÿä¸çŸ¥é“è¦å‘å“ªäº›å­ç³»ç»Ÿå‘é€æ³¨é”€è¯·æ±‚æ³¨é”€å±€éƒ¨ä¼šè¯ã€‚</p></li></ul><p><img src="https://images.morethink.cn/797930-20161129155245506-1069288802.png" alt=""></p><h2 id="sso-clientæ ¡éªŒä»¤ç‰ŒæˆåŠŸåˆ›å»ºå±€éƒ¨ä¼šè¯"><a href="#sso-clientæ ¡éªŒä»¤ç‰ŒæˆåŠŸåˆ›å»ºå±€éƒ¨ä¼šè¯" class="headerlink" title="sso-clientæ ¡éªŒä»¤ç‰ŒæˆåŠŸåˆ›å»ºå±€éƒ¨ä¼šè¯"></a>sso-clientæ ¡éªŒä»¤ç‰ŒæˆåŠŸåˆ›å»ºå±€éƒ¨ä¼šè¯</h2><p>ä»¤ç‰Œæ ¡éªŒæˆåŠŸåï¼Œsso-clientå°†å½“å‰å±€éƒ¨ä¼šè¯æ ‡è®°ä¸ºâ€œå·²ç™»å½•â€ï¼Œä¿®æ”¹LoginFilter.javaï¼Œæ·»åŠ å‡ è¡Œï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (verifyResult) &#123;</span><br><span class="line">    session.setAttribute(<span class="string">"isLogin"</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>sso-clientè¿˜éœ€å°†å½“å‰ä¼šè¯idä¸ä»¤ç‰Œç»‘å®šï¼Œè¡¨ç¤ºè¿™ä¸ªä¼šè¯çš„ç™»å½•çŠ¶æ€ä¸ä»¤ç‰Œç›¸å…³ï¼Œæ­¤å…³ç³»å¯ä»¥ç”¨javaçš„hashmapä¿å­˜ï¼Œä¿å­˜çš„æ•°æ®ç”¨æ¥å¤„ç†ssoè®¤è¯ä¸­å¿ƒå‘æ¥çš„æ³¨é”€è¯·æ±‚</p><h2 id="æ³¨é”€è¿‡ç¨‹"><a href="#æ³¨é”€è¿‡ç¨‹" class="headerlink" title="æ³¨é”€è¿‡ç¨‹"></a>æ³¨é”€è¿‡ç¨‹</h2><p>ç”¨æˆ·å‘å­ç³»ç»Ÿå‘é€å¸¦æœ‰â€œlogoutâ€å‚æ•°çš„è¯·æ±‚ï¼ˆæ³¨é”€è¯·æ±‚ï¼‰ï¼Œsso-clientæ‹¦æˆªå™¨æ‹¦æˆªè¯¥è¯·æ±‚ï¼Œå‘ssoè®¤è¯ä¸­å¿ƒå‘èµ·æ³¨é”€è¯·æ±‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String logout = req.getParameter(<span class="string">"logout"</span>);</span><br><span class="line"><span class="keyword">if</span> (logout != <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.ssoServer.logout(token);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ssoè®¤è¯ä¸­å¿ƒä¹Ÿç”¨åŒæ ·çš„æ–¹å¼è¯†åˆ«å‡ºsso-clientçš„è¯·æ±‚æ˜¯æ³¨é”€è¯·æ±‚ï¼ˆå¸¦æœ‰â€œlogoutâ€å‚æ•°ï¼‰ï¼Œssoè®¤è¯ä¸­å¿ƒæ³¨é”€å…¨å±€ä¼šè¯ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/logout"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">logout</span><span class="params">(HttpServletRequest req)</span> </span>&#123;</span><br><span class="line">    HttpSession session = req.getSession();</span><br><span class="line">    <span class="keyword">if</span> (session != <span class="keyword">null</span>) &#123;</span><br><span class="line">        session.invalidate();<span class="comment">//è§¦å‘LogoutListener</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"redirect:/"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ssoè®¤è¯ä¸­å¿ƒæœ‰ä¸€ä¸ªå…¨å±€ä¼šè¯çš„ç›‘å¬å™¨ï¼Œä¸€æ—¦å…¨å±€ä¼šè¯æ³¨é”€ï¼Œå°†é€šçŸ¥æ‰€æœ‰æ³¨å†Œç³»ç»Ÿæ³¨é”€</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogoutListener</span> <span class="keyword">implements</span> <span class="title">HttpSessionListener</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionCreated</span><span class="params">(HttpSessionEvent event)</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDestroyed</span><span class="params">(HttpSessionEvent event)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//é€šè¿‡httpClientå‘æ‰€æœ‰æ³¨å†Œç³»ç»Ÿå‘é€æ³¨é”€è¯·æ±‚</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä»£ç éƒ¨ç½²"><a href="#ä»£ç éƒ¨ç½²" class="headerlink" title="ä»£ç éƒ¨ç½²"></a>ä»£ç éƒ¨ç½²</h1><p>GitHubåœ°å€ï¼š <a href="https://github.com/morethink/simple-sso.git" target="_blank" rel="noopener">https://github.com/morethink/simple-sso.git</a></p><h2 id="IDEAéƒ¨ç½²"><a href="#IDEAéƒ¨ç½²" class="headerlink" title="IDEAéƒ¨ç½²"></a>IDEAéƒ¨ç½²</h2><p><img src="https://images.morethink.cn/3a48b1deaaecd4dc74377a5eacec4a08.png" alt=""><br><img src="https://images.morethink.cn/d341e21bdb77889efae518d35d754b34.png" alt=""><br><img src="https://images.morethink.cn/1439e11d0b2659b62780e887bd22b20f.png" alt=""></p><h2 id="å•ç‚¹ç™»å½•-1"><a href="#å•ç‚¹ç™»å½•-1" class="headerlink" title="å•ç‚¹ç™»å½•"></a>å•ç‚¹ç™»å½•</h2><p><strong>è®¿é—®aç³»ç»Ÿ</strong>ï¼š</p><p><a href="http://localhost/a/test" target="_blank" rel="noopener">http://localhost/a/test</a></p><p><img src="https://images.morethink.cn/a743f4b854fb7f82bf4855112de304de.png" alt=""></p><p><strong>è®¿é—®bç³»ç»Ÿ</strong>ï¼š</p><p><a href="http://localhost/b/test" target="_blank" rel="noopener">http://localhost/b/test</a></p><p><img src="https://images.morethink.cn/e619435d561a998088a6d11a4ecc22cc.png" alt=""></p><p><strong>aç³»ç»Ÿç™»å½•æˆåŠŸ</strong>ï¼š</p><p><img src="https://images.morethink.cn/07a3bf0aefd180dfaa5779ba740998b4.png" alt=""></p><p><strong>bç³»ç»ŸåŒæ—¶ä¹Ÿç™»å½•æˆåŠŸ</strong>:</p><p><img src="https://images.morethink.cn/e504ce5c9dc7e9e70303b9f3f54d20c2.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å•ç‚¹ç™»å½• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é¢è¯•ä¸­çš„TCPåè®®</title>
      <link href="/TCP/"/>
      <url>/TCP/</url>
      
        <content type="html"><![CDATA[<h1 id="TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"><a href="#TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"></a>TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</h1><h2 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h2><p>TCPè¿æ¥æ˜¯é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹æ¥è¿æ¥çš„ã€‚</p><p><strong>ç¬¬ä¸€æ¬¡æ¡æ‰‹</strong></p><p>å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¿æ¥è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€åŒæ­¥åºåˆ—æ ‡å·<code>SYN</code>åˆ°æœåŠ¡å™¨ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è®¾<code>SYN</code>ä¸ºxï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼Œè¿™æ—¶å®¢æˆ·ç«¯çš„çŠ¶æ€ä¸º<code>SYN_SENT</code>ã€‚</p><a id="more"></a><p><strong>ç¬¬äºŒæ¬¡æ¡æ‰‹</strong></p><p>å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„<code>SYN</code>åï¼ŒæœåŠ¡å™¨è¦åšçš„æ˜¯ç¡®è®¤å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„<code>SYN</code>ï¼Œåœ¨è¿™é‡ŒæœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…<code>ACK</code>ï¼Œè¿™é‡Œçš„<code>ACK</code>ä¸ºx+1ï¼Œæ„æ€æ˜¯è¯´â€œæˆ‘æ”¶åˆ°äº†ä½ å‘é€çš„<code>SYN</code>äº†â€ï¼ŒåŒæ—¶ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª<code>SYN</code>åŒ…ï¼Œè¿™é‡Œæˆ‘ä»¬è®¾<code>SYN</code>ä¸ºyã€‚è¿™æ—¶æœåŠ¡å™¨çš„çŠ¶æ€ä¸º<code>SYN_RECV</code>ã€‚</p><p>ä¸€å¥è¯ï¼ŒæœåŠ¡å™¨ç«¯å‘é€<code>SYN</code>å’Œ<code>ACK</code>ä¸¤ä¸ªåŒ…ã€‚</p><p><strong>ç¬¬ä¸‰æ¬¡æ¡æ‰‹</strong></p><p>å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å‘é€çš„<code>SYN</code>å’Œ<code>ACK</code>åŒ…åï¼Œéœ€å‘æœåŠ¡å™¨å‘é€ç¡®è®¤åŒ…<code>ACK</code>ï¼Œâ€œæˆ‘ä¹Ÿæ”¶åˆ°ä½ å‘é€çš„<code>SYN</code>äº†ï¼Œæˆ‘è¿™å°±ç»™ä½ å‘ä¸ªç¡®è®¤è¿‡å»ï¼Œç„¶åæˆ‘ä»¬å³èƒ½åˆä½“äº†â€ï¼Œè¿™é‡Œçš„<code>ACK</code>ä¸ºy+1ï¼Œå‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„çŠ¶æ€ä¸º<code>ESTABLISH</code>ï¼Œå³TCPè¿æ¥æˆåŠŸã€‚</p><p>åœ¨ä¸‰æ¬¡æ¡æ‰‹ä¸­ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½å‘é€ä¸¤ä¸ªåŒ…<code>SYN</code>å’Œ<code>ACK</code>ï¼Œåªä¸è¿‡æœåŠ¡å™¨ç«¯çš„ä¸¤ä¸ªåŒ…æ˜¯ä¸€æ¬¡æ€§å‘è¿‡æ¥çš„ï¼Œå®¢æˆ·ç«¯çš„ä¸¤ä¸ªåŒ…æ˜¯åˆ†ä¸¤æ¬¡å‘é€çš„ã€‚</p><p><img src="https://images.morethink.cn/092017231747399.jpg" alt="" title="TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"></p><h2 id="å››æ¬¡æŒ¥æ‰‹"><a href="#å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="å››æ¬¡æŒ¥æ‰‹"></a>å››æ¬¡æŒ¥æ‰‹</h2><p>å½“Aç«¯å’ŒBç«¯è¦æ–­å¼€è¿æ¥æ—¶ï¼Œéœ€è¦å››æ¬¡æ¡æ‰‹ï¼Œè¿™é‡Œç§°ä¸ºå››æ¬¡æŒ¥æ‰‹ã€‚</p><p>æ–­å¼€è¿æ¥è¯·æ±‚å¯ä»¥ç”±å®¢æˆ·ç«¯å‘å‡ºï¼Œä¹Ÿå¯ä»¥ç”±æœåŠ¡å™¨ç«¯å‘å‡ºï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ç§°Aç«¯å‘Bç«¯è¯·æ±‚æ–­å¼€è¿æ¥ã€‚</p><p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹</strong></p><p>Aç«¯å‘Bç«¯è¯·æ±‚æ–­å¼€è¿æ¥æ—¶ä¼šå‘Bç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰<code>FIN</code>æ ‡è®°çš„æŠ¥æ–‡æ®µï¼Œè¿™é‡Œçš„<code>FIN</code>æ˜¯<code>Finish</code>çš„æ„æ€ã€‚</p><p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹</strong></p><p>Bç«¯æ”¶åˆ°Aå‘é€çš„<code>FIN</code>åï¼ŒBæ®µç°åœ¨å¯èƒ½ç°åœ¨è¿˜æœ‰æ•°æ®æ²¡æœ‰ä¼ å®Œï¼Œæ‰€ä»¥Bç«¯å¹¶ä¸ä¼šé©¬ä¸Šå‘Aç«¯å‘é€<code>FIN</code>ï¼Œè€Œæ˜¯å…ˆå‘é€ä¸€ä¸ªç¡®è®¤åºå·<code>ACK</code>ï¼Œæ„æ€æ˜¯è¯´â€œä½ å‘çš„æ–­å¼€è¿æ¥è¯·æ±‚æˆ‘æ”¶åˆ°äº†ï¼Œä½†æ˜¯æˆ‘ç°åœ¨è¿˜æœ‰æ•°æ®æ²¡æœ‰å‘å®Œï¼Œè¯·ç¨ç­‰ä¸€ä¸‹å‘—â€ã€‚</p><p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</strong></p><p>å½“Bç«¯çš„äº‹æƒ…å¿™å®Œäº†ï¼Œé‚£ä¹ˆæ­¤æ—¶Bç«¯å°±å¯ä»¥æ–­å¼€è¿æ¥äº†ï¼Œæ­¤æ—¶Bç«¯å‘Aç«¯å‘é€<code>FIN</code>åºå·ï¼Œæ„æ€æ˜¯è¿™æ¬¡å¯ä»¥æ–­å¼€è¿æ¥äº†ã€‚</p><p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹</strong></p><p>Aç«¯æ”¶åˆ°Bç«¯å‘é€çš„<code>FIN</code>åï¼Œä¼šå‘Bç«¯å‘é€ç¡®è®¤<code>ACK</code>ï¼Œç„¶åç»è¿‡ä¸¤ä¸ªMSLæ—¶é•¿åæ–­å¼€è¿æ¥ã€‚</p><p>MSLæ˜¯Maximum Segment Lifetimeï¼Œæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´ï¼Œ2ä¸ªMSLæ˜¯æŠ¥æ–‡æ®µå‘é€å’Œæ¥æ”¶çš„æœ€é•¿æ—¶é—´ã€‚</p><h2 id="ä¸¤æ¬¡æ¡æ‰‹å¯ä»¥ä¹ˆï¼Ÿ"><a href="#ä¸¤æ¬¡æ¡æ‰‹å¯ä»¥ä¹ˆï¼Ÿ" class="headerlink" title="ä¸¤æ¬¡æ¡æ‰‹å¯ä»¥ä¹ˆï¼Ÿ"></a>ä¸¤æ¬¡æ¡æ‰‹å¯ä»¥ä¹ˆï¼Ÿ</h2><p>TCPè¿æ¥æ—¶æ˜¯ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆä¸¤æ¬¡æ¡æ‰‹å¯è¡Œå—ï¼Ÿ</p><p>åœ¨è°¢å¸Œä»è‘—ã€Šè®¡ç®—æœºç½‘ç»œã€‹ç¬¬å…­ç‰ˆä¸­è®²â€ä¸‰æ¬¡æ¡æ‰‹â€çš„ç›®çš„æ˜¯â€ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ã€‚</p><p>å‡å®šå‡ºç°ä¸€ç§å¼‚å¸¸æƒ…å†µä¸‹ï¼šclientå‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œç»“ç‚¹é•¿æ—¶é—´çš„æ»ç•™äº†ï¼Œä»¥è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾serverã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µã€‚ä½†serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå°±è¯¯è®¤ä¸ºæ˜¯clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ã€‚äºæ˜¯å°±å‘clientå‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ã€‚å‡è®¾ä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦serverå‘å‡ºç¡®è®¤ï¼Œæ–°çš„è¿æ¥å°±å»ºç«‹äº†ã€‚ç”±äºç°åœ¨clientå¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šç†ç¬serverçš„ç¡®è®¤ï¼Œä¹Ÿä¸ä¼šå‘serverå‘é€<code>ACK</code>åŒ…ã€‚è¿™æ ·å°±ä¼šç™½ç™½æµªè´¹èµ„æºã€‚</p><p>è€Œç»è¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½æœ‰åº”æœ‰ç­”ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿TCPæ­£ç¡®è¿æ¥ã€‚</p><h2 id="ä¸ºä»€ä¹ˆTCPè¿æ¥æ˜¯ä¸‰æ¬¡ï¼ŒæŒ¥æ‰‹ç¡®æ˜¯å››æ¬¡ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆTCPè¿æ¥æ˜¯ä¸‰æ¬¡ï¼ŒæŒ¥æ‰‹ç¡®æ˜¯å››æ¬¡ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆTCPè¿æ¥æ˜¯ä¸‰æ¬¡ï¼ŒæŒ¥æ‰‹ç¡®æ˜¯å››æ¬¡ï¼Ÿ"></a>ä¸ºä»€ä¹ˆTCPè¿æ¥æ˜¯ä¸‰æ¬¡ï¼ŒæŒ¥æ‰‹ç¡®æ˜¯å››æ¬¡ï¼Ÿ</h2><p>åœ¨TCPè¿æ¥ä¸­ï¼ŒæœåŠ¡å™¨ç«¯çš„<code>SYN</code>å’Œ<code>ACK</code>å‘å®¢æˆ·ç«¯å‘é€æ˜¯ä¸€æ¬¡æ€§å‘é€çš„ï¼Œè€Œåœ¨æ–­å¼€è¿æ¥çš„è¿‡ç¨‹ä¸­ï¼ŒBç«¯å‘Aç«¯å‘é€çš„<code>ACK</code>å’Œ<code>FIN</code>æ˜¯æ˜¯åˆ†ä¸¤æ¬¡å‘é€çš„ã€‚å› ä¸ºåœ¨Bç«¯æ¥æ”¶åˆ°Aç«¯çš„<code>FIN</code>åï¼ŒBç«¯å¯èƒ½è¿˜æœ‰æ•°æ®è¦ä¼ è¾“ï¼Œæ‰€ä»¥å…ˆå‘é€<code>ACK</code>ï¼Œç­‰Bç«¯å¤„ç†å®Œè‡ªå·±çš„äº‹æƒ…åå°±å¯ä»¥å‘é€<code>FIN</code>æ–­å¼€è¿æ¥äº†ã€‚</p><h2 id="ä¸ºä»€ä¹ˆåœ¨ç¬¬å››æ¬¡æŒ¥æ‰‹åä¼šæœ‰2ä¸ªMSLçš„å»¶æ—¶ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆåœ¨ç¬¬å››æ¬¡æŒ¥æ‰‹åä¼šæœ‰2ä¸ªMSLçš„å»¶æ—¶ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆåœ¨ç¬¬å››æ¬¡æŒ¥æ‰‹åä¼šæœ‰2ä¸ªMSLçš„å»¶æ—¶ï¼Ÿ"></a>ä¸ºä»€ä¹ˆåœ¨ç¬¬å››æ¬¡æŒ¥æ‰‹åä¼šæœ‰2ä¸ªMSLçš„å»¶æ—¶ï¼Ÿ</h2><p>å‰æ–‡è¯´åˆ°:<br>MSLæ˜¯Maximum Segment Lifetimeï¼Œæœ€å¤§æŠ¥æ–‡æ®µç”Ÿå­˜æ—¶é—´ï¼Œ2ä¸ªMSLæ˜¯æŠ¥æ–‡æ®µå‘é€å’Œæ¥æ”¶çš„æœ€é•¿æ—¶é—´ã€‚</p><p>å‡å®šç½‘ç»œä¸å¯é ï¼Œé‚£ä¹ˆç¬¬å››æ¬¡å‘é€çš„<code>ACK</code>å¯èƒ½ä¸¢å¤±ï¼Œå³Bç«¯æ— æ³•æ”¶åˆ°è¿™ä¸ª<code>ACK</code>ï¼Œå¦‚æœBç«¯æ”¶ä¸åˆ°è¿™ä¸ªç¡®è®¤<code>ACK</code>ï¼ŒBç«¯ä¼šå®šæ—¶å‘Aç«¯é‡å¤å‘é€<code>FIN</code>ï¼Œç›´åˆ°Bç«¯æ”¶åˆ°Açš„ç¡®è®¤<code>ACK</code>ã€‚æ‰€ä»¥è¿™ä¸ª2MSLå°±æ˜¯ç”¨æ¥å¤„ç†è¿™ä¸ªå¯èƒ½ä¸¢å¤±çš„<code>ACK</code>çš„ã€‚</p><h1 id="TCPæµé‡æ§åˆ¶"><a href="#TCPæµé‡æ§åˆ¶" class="headerlink" title="TCPæµé‡æ§åˆ¶"></a>TCPæµé‡æ§åˆ¶</h1><p>ä¸€èˆ¬è¯´æ¥ï¼Œæˆ‘ä»¬æ€»æ˜¯å¸Œæœ›æ•°æ®ä¼ è¾“å¾—æ›´å¿«ä¸€äº›ã€‚ä½†å¦‚æœå‘é€æ–¹æŠŠæ•°æ®å‘é€å¾—è¿‡å¿«ï¼Œæ¥æ”¶æ–¹å¯èƒ½æ¥ä¸åŠæ¥æ”¶ï¼Œè¿™å°±ä¼šé€ æˆæ•°æ®çš„ä¸¢å¤±ã€‚æ‰€è°“ <strong>æµé‡æ§åˆ¶(flow contrl)</strong> å°±æ˜¯ <strong>è®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶</strong> ã€‚</p><p>TCPåˆ©ç”¨æ»‘åŠ¨çª—å£æœºåˆ¶å®ç°å¯¹å‘é€æ–¹çš„æµé‡æ§åˆ¶ï¼Œå‘é€æ–¹çš„å‘é€çª—å£ä¸å¯ä»¥å¤§äºæ¥æ”¶æ–¹ç»™å‡ºçš„æ¥æ”¶çª—å£çš„å¤§å°ã€‚çª—å£ä¸¤ä¸ªè¾¹æ²¿çš„ç›¸å¯¹è¿åŠ¨å¢åŠ æˆ–å‡å°‘äº†çª—å£çš„å¤§å°ã€‚å½“æ¥æ”¶æ–¹æ²¡æœ‰ç¼“å­˜å¯ç”¨ï¼Œä¼šå‘é€é›¶çª—å£å¤§å°çš„æŠ¥æ–‡ï¼Œæ­¤æ—¶å‘é€æ–¹ä¸èƒ½å¤Ÿå‘é€ä»»ä½•æ•°æ®ã€‚</p><p>TCPçš„çª—å£å•ä½æ˜¯å­—èŠ‚ï¼Œä¸æ˜¯æŠ¥æ–‡æ®µã€‚</p><h2 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h2><p>æ»‘åŠ¨çª—å£åè®®æ˜¯ä¼ è¾“å±‚è¿›è¡Œæµæ§çš„ä¸€ç§æªæ–½ï¼Œæ¥æ”¶æ–¹é€šè¿‡é€šå‘Šå‘é€æ–¹è‡ªå·±çš„çª—å£å¤§å°ï¼Œä»è€Œæ§åˆ¶å‘é€æ–¹çš„å‘é€é€Ÿåº¦ï¼Œä»è€Œè¾¾åˆ°é˜²æ­¢å‘é€æ–¹å‘é€é€Ÿåº¦è¿‡å¿«è€Œå¯¼è‡´è‡ªå·±è¢«æ·¹æ²¡çš„ç›®çš„ã€‚</p><p>TCPæ»‘åŠ¨çª—å£åˆ†ä¸ºæ¥å—çª—å£ï¼Œå‘é€çª—å£ã€‚</p><p>å¯¹ACKçš„å†è®¤è¯†ï¼Œacké€šå¸¸è¢«ç†è§£ä¸ºæ”¶åˆ°æ•°æ®åç»™å‡ºçš„ä¸€ä¸ªç¡®è®¤ACKï¼ŒACKåŒ…å«ä¸¤ä¸ªéå¸¸é‡è¦çš„ä¿¡æ¯ï¼š</p><ol><li>æœŸæœ›æ¥æ”¶åˆ°çš„ä¸‹ä¸€å­—èŠ‚çš„åºå·nï¼Œè¯¥nä»£è¡¨æ¥æ”¶æ–¹å·²ç»æ¥æ”¶åˆ°äº†å‰n-1å­—èŠ‚æ•°æ®ï¼Œæ­¤æ—¶å¦‚æœæ¥æ”¶æ–¹æ”¶åˆ°ç¬¬n+1å­—èŠ‚æ•°æ®è€Œä¸æ˜¯ç¬¬nå­—èŠ‚æ•°æ®ï¼Œæ¥æ”¶æ–¹æ˜¯ä¸ä¼šå‘é€åºå·ä¸ºn+2çš„ACKçš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚æ¥æ”¶ç«¯æ”¶åˆ°1-1024å­—èŠ‚ï¼Œå®ƒä¼šå‘é€ä¸€ä¸ªç¡®è®¤å·ä¸º1025çš„ACK,ä½†æ˜¯æ¥ä¸‹æ¥æ”¶åˆ°çš„æ˜¯2049-3072ï¼Œå®ƒæ˜¯ä¸ä¼šå‘é€ç¡®è®¤å·ä¸º3072çš„ACK,è€Œä¾æ—§å‘é€1025çš„ACKã€‚</li><li>æ˜¯å½“å‰çš„çª—å£å¤§å°mï¼Œå¦‚æ­¤å‘é€æ–¹åœ¨æ¥æ”¶åˆ°ACKåŒ…å«çš„è¿™ä¸¤ä¸ªæ•°æ®åå°±å¯ä»¥è®¡ç®—å‡ºè¿˜å¯ä»¥å‘é€å¤šå°‘å­—èŠ‚çš„æ•°æ®ç»™å¯¹æ–¹ï¼Œå‡å®šå½“å‰å‘é€æ–¹å·²å‘é€åˆ°ç¬¬xå­—èŠ‚ï¼Œåˆ™å¯ä»¥å‘é€çš„å­—èŠ‚æ•°å°±æ˜¯y=m-(x-n).</li></ol><p>é‡ç‚¹ï¼š<br>å‘é€æ–¹æ ¹æ®æ”¶åˆ°ACKå½“ä¸­çš„æœŸæœ›æ”¶åˆ°çš„ä¸‹ä¸€ä¸ªå­—èŠ‚çš„åºå·nä»¥åŠçª—å£mï¼Œè¿˜æœ‰å½“å‰å·²ç»å‘é€çš„å­—èŠ‚åºå·xï¼Œç®—å‡ºè¿˜å¯ä»¥å‘é€çš„å­—èŠ‚æ•°ã€‚</p><p>æ»‘åŠ¨çª—å£åè®®å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://images.morethink.cn/cf6a1ce659c9b81d49a4ae3ccc3c2df5.png" alt=""></p><p>åœ¨è¿™ä¸ªå›¾ä¸­ï¼Œæˆ‘ä»¬å°†å­—èŠ‚ä»1è‡³11è¿›è¡Œæ ‡å·ã€‚æ¥æ”¶æ–¹é€šå‘Šçš„çª—å£ç§°ä¸ºæå‡ºçš„çª—å£ï¼Œå®ƒè¦†ç›–äº†ä»ç¬¬4å­—èŠ‚åˆ°ç¬¬9å­—èŠ‚çš„åŒºåŸŸï¼Œè¡¨æ˜æ¥æ”¶æ–¹å·²ç»ç¡®è®¤äº†åŒ…æ‹¬ç¬¬3å­—èŠ‚åœ¨å†…çš„æ•°æ®ï¼Œä¸”é€šå‘Šçª—å£å¤§å°ä¸º6ã€‚æˆ‘ä»¬çŸ¥é“çª—å£å¤§å°æ˜¯ä¸ç¡®è®¤åºå·ç›¸å¯¹åº”çš„ã€‚å‘é€æ–¹è®¡ç®—å®ƒçš„å¯ç”¨çª—å£ï¼Œè¯¥çª—å£è¡¨æ˜å¤šå°‘æ•°æ®å¯ä»¥ç«‹å³è¢«å‘é€ã€‚å½“æ¥æ”¶æ–¹ç¡®è®¤æ•°æ®åï¼Œè¿™ä¸ªæ»‘åŠ¨çª—å£ä¸æ—¶åœ°å‘å³ç§»åŠ¨ã€‚çª—å£ä¸¤ä¸ªè¾¹æ²¿çš„ç›¸å¯¹è¿åŠ¨å¢åŠ æˆ–å‡å°‘äº†çª—å£çš„å¤§å°ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‰ä¸ªæœ¯è¯­æ¥æè¿°çª—å£å·¦å³è¾¹æ²¿çš„è¿åŠ¨ï¼š</p><ul><li>çª—å£å·¦è¾¹æ²¿å‘å³è¾¹æ²¿é è¿‘ä¸ºçª—å£åˆæ‹¢ã€‚è¿™ç§ç°è±¡å‘ç”Ÿåœ¨æ•°æ®è¢«å‘é€å’Œç¡®è®¤æ—¶ã€‚</li><li>å½“çª—å£å³è¾¹æ²¿å‘å³ç§»åŠ¨æ—¶å°†å…è®¸å‘é€æ›´å¤šçš„æ•°æ®ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºçª—å£å¼ å¼€ã€‚è¿™ç§ç°è±¡å‘ç”Ÿåœ¨å¦ä¸€ç«¯çš„æ¥æ”¶è¿›ç¨‹è¯»å–å·²ç»ç¡®è®¤çš„æ•°æ®å¹¶é‡Šæ”¾äº†T C Pçš„æ¥æ”¶ç¼“å­˜æ—¶ã€‚</li><li>å½“å³è¾¹ç¼˜å‘å·¦ç§»åŠ¨æ—¶ï¼Œç§°ä¹‹ä¸ºçª—å£æ”¶ç¼©ã€‚</li></ul><p>æ¯ä¸ªTCPè¿æ¥æœ‰å‘é€çª—å£å’Œæ¥æ”¶çª—å£è¿™ä¸¤ä¸ªçª—å£ã€‚</p><p>TCPæ˜¯åŒå·¥çš„åè®®ï¼Œä¼šè¯çš„åŒæ–¹éƒ½å¯ä»¥åŒæ—¶æ¥æ”¶ã€å‘é€æ•°æ®ã€‚</p><p>TCPä¼šè¯çš„åŒæ–¹éƒ½å„è‡ªç»´æŠ¤ä¸€ä¸ªâ€œå‘é€çª—å£â€å’Œä¸€ä¸ªâ€œæ¥æ”¶çª—å£â€ã€‚å…¶ä¸­å„è‡ªçš„â€œæ¥æ”¶çª—å£â€å¤§å°å–å†³äºåº”ç”¨ã€ç³»ç»Ÿã€ç¡¬ä»¶çš„é™åˆ¶ï¼ˆTCPä¼ è¾“é€Ÿç‡ä¸èƒ½å¤§äºåº”ç”¨çš„æ•°æ®å¤„ç†é€Ÿç‡ï¼‰ã€‚å„è‡ªçš„â€œå‘é€çª—å£â€åˆ™è¦æ±‚å–å†³äºå¯¹ç«¯é€šå‘Šçš„â€œæ¥æ”¶çª—å£â€ï¼Œè¦æ±‚ç›¸åŒã€‚</p><h1 id="TCPæ‹¥å¡æ§åˆ¶"><a href="#TCPæ‹¥å¡æ§åˆ¶" class="headerlink" title="TCPæ‹¥å¡æ§åˆ¶"></a>TCPæ‹¥å¡æ§åˆ¶</h1><p>åœ¨è®¡ç®—æœºç½‘ç»œä¸­çš„é“¾è·¯å®¹é‡(å³å¸¦å®½)ã€äº¤æ¢èŠ‚ç‚¹ä¸­çš„ç¼“å­˜å’Œå¤„ç†æœºç­‰ï¼Œéƒ½æ˜¯ç½‘ç»œä¸­çš„èµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±ä¼šå˜åã€‚è¿™ç§æƒ…å†µå°±å«åš <strong>æ‹¥å¡</strong>ã€‚</p><p><strong>æ‹¥å¡æ§åˆ¶</strong> å°±æ˜¯ <strong>é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½</strong>ã€‚</p><p>æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œå’Œæµé‡æ§åˆ¶ä¸åŒï¼Œæµé‡æ§åˆ¶æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ã€‚</p><p>è¿›è¡Œæ‹¥å¡æ§åˆ¶çš„å››ç§ç®—æ³•ï¼š</p><ol><li>æ…¢å¼€å§‹ï¼ˆSlow-start)</li><li>æ‹¥å¡é¿å…ï¼ˆCongestion Avoidance)</li><li>å¿«é‡ä¼ ï¼ˆFast Restrangsmit)</li><li>å¿«æ¢å¤ï¼ˆFast Recoveryï¼‰ã€‚</li></ol><h2 id="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"><a href="#æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…" class="headerlink" title="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></a>æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…</h2><p>å‘é€æ–¹ç»´æŒä¸€ä¸ªå«åšæ‹¥å¡çª—å£cwndï¼ˆcongestion windowï¼‰çš„çŠ¶æ€å˜é‡ã€‚æ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°åœ¨å˜åŒ–ã€‚å‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ï¼Œå¦å¤–è€ƒè™‘åˆ°æ¥å—æ–¹çš„æ¥æ”¶èƒ½åŠ›ï¼Œå‘é€çª—å£å¯èƒ½å°äºæ‹¥å¡çª—å£ã€‚</p><p>æ…¢å¼€å§‹ç®—æ³•çš„æ€è·¯å°±æ˜¯ï¼Œä¸è¦ä¸€å¼€å§‹å°±å‘é€å¤§é‡çš„æ•°æ®ï¼Œå…ˆæ¢æµ‹ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ç”±å°åˆ°å¤§é€æ¸å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°ã€‚åœ¨ä¸€å¼€å§‹å‘é€æ–¹å…ˆè®¾ç½®cwnd=1ï¼Œ<strong>æ¯ç»è¿‡ä¸€æ¬¡ä¼ è¾“è½®æ¬¡ä¹‹åæ‹¥å¡çª—å£å°±åŠ å€ï¼ˆ2çš„æŒ‡æ•°å€å¢åŠ ï¼‰</strong>ã€‚</p><p>ä¸ºäº†é˜²æ­¢çª—å£cwndå¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œè¿˜éœ€è®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™ssthreshçŠ¶æ€å˜é‡ã€‚ssthreshçš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><ul><li>å½“cwnd&lt;ssthreshæ—¶ï¼Œä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ã€‚</li><li>å½“cwnd&gt;ssthreshæ—¶ï¼Œæ”¹ç”¨æ‹¥å¡é¿å…ç®—æ³•ã€‚</li><li>å½“cwnd=ssthreshæ—¶ï¼Œæ—¢å¯ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ï¼Œä¹Ÿå¯ä½¿ç”¨æ‹¥å¡ç®—æ³•ã€‚</li></ul><p>æ‹¥å¡é¿å…ç®—æ³•è®©æ‹¥å¡çª—å£ç¼“æ…¢å¢é•¿ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´RTTå°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£cwndåŠ 1ï¼Œè€Œä¸æ˜¯åŠ å€ã€‚<strong>è¿™æ ·æ‹¥å¡çª—å£æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿</strong>ï¼Œæ¯”æ…¢å¼€å§‹ç®—æ³•çš„æ‹¥å¡çª—å£å¢é•¿é€Ÿç‡ç¼“æ…¢å¾—å¤šã€‚</p><p>æ— è®ºæ˜¯åœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‘é€æ–¹åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼ˆ<strong>å…¶æ ¹æ®å°±æ˜¯æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œè™½ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤å¯èƒ½æ˜¯å…¶ä»–åŸå› çš„åˆ†ç»„ä¸¢å¤±ï¼Œä½†æ˜¯å› ä¸ºæ— æ³•åˆ¤å®šï¼Œæ‰€ä»¥éƒ½å½“åšæ‹¥å¡æ¥å¤„ç†</strong>ï¼‰ï¼Œå°±æŠŠæ…¢å¼€å§‹é—¨é™è®¾ç½®ä¸ºå‡ºç°æ‹¥å¡æ—¶çš„å‘é€çª—å£å¤§å°çš„ä¸€åŠã€‚ç„¶åæŠŠæ‹¥å¡çª—å£è®¾ç½®ä¸º1ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚</p><p><img src="https://images.morethink.cn/13101915439696.jpg" alt="" title="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></p><h2 id="å¿«é‡ä¼ å’Œå¿«æ¢å¤"><a href="#å¿«é‡ä¼ å’Œå¿«æ¢å¤" class="headerlink" title="å¿«é‡ä¼ å’Œå¿«æ¢å¤"></a>å¿«é‡ä¼ å’Œå¿«æ¢å¤</h2><p>å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰è€Œä¸è¦ç­‰åˆ°è‡ªå·±å‘é€æ•°æ®æ—¶æå¸¦ç¡®è®¤ã€‚å¿«é‡ä¼ ç®—æ³•è§„å®šï¼Œå‘é€æ–¹åªè¦ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±åº”å½“ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚ç”±äºå‘é€æ–¹èƒ½ <strong>å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µ</strong>ï¼Œå› æ­¤é‡‡ç”¨å¿«é‡ä¼ ç®—æ³•åå¯ä»¥ä½¿æ•´ä¸ªç½‘ç»œçš„ååé‡æé«˜çº¦20%ã€‚</p><p>å¿«æ¢å¤ç®—æ³•ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªè¦ç‚¹:</p><ol><li>å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠssthreshé—¨é™å‡åŠã€‚<strong>ä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•</strong>ã€‚</li><li><strong>è€ƒè™‘åˆ°å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†cwndè®¾ç½®ä¸ºssthreshçš„å¤§å°ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•</strong>ã€‚</li></ol><p><img src="https://images.morethink.cn/c6f967f1bbd18ddafcfef14669c8fca7.png" alt="" title="å¿«é‡ä¼ å’Œå¿«æ¢å¤ç®—æ³•"></p><h1 id="TCPå’ŒUDPçš„åŒºåˆ«"><a href="#TCPå’ŒUDPçš„åŒºåˆ«" class="headerlink" title="TCPå’ŒUDPçš„åŒºåˆ«"></a>TCPå’ŒUDPçš„åŒºåˆ«</h1><ul><li>TCPé¢å‘è¿æ¥ï¼ŒUDPé¢å‘éè¿æ¥å³å‘é€æ•°æ®å‰ä¸éœ€è¦å»ºç«‹é“¾æ¥ã€‚<ul><li>é¢å‘è¿æ¥çš„æœåŠ¡ï¼Œé€šä¿¡åŒæ–¹åœ¨è¿›è¡Œé€šä¿¡ä¹‹å‰ï¼Œè¦å…ˆåœ¨åŒæ–¹å»ºç«‹èµ·ä¸€ä¸ªå®Œæ•´çš„å¯ä»¥å½¼æ­¤æ²Ÿé€šçš„é€šé“ï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªè¿æ¥çš„æƒ…å†µä¸€ç›´å¯ä»¥è¢«å®æ—¶åœ°ç›‘æ§å’Œç®¡ç†ã€‚</li><li>éé¢å‘è¿æ¥çš„æœåŠ¡ï¼Œä¸éœ€è¦é¢„å…ˆå»ºç«‹ä¸€ä¸ªè”ç»œä¸¤ä¸ªé€šä¿¡èŠ‚ç‚¹çš„è¿æ¥ï¼Œéœ€è¦é€šä¿¡çš„æ—¶å€™ï¼Œå‘é€èŠ‚ç‚¹å°±å¯ä»¥å¾€ç½‘ç»œä¸Šå‘é€ä¿¡æ¯ï¼Œè®©ä¿¡æ¯è‡ªä¸»åœ°åœ¨ç½‘ç»œä¸Šå»ä¼ ï¼Œä¸€èˆ¬åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­ä¸å†åŠ ä»¥ç›‘æ§ã€‚</li></ul></li><li>TCPæä¾›å¯é çš„æœåŠ¡ï¼ˆæ•°æ®ä¼ è¾“ï¼‰ï¼ŒUDPæ— æ³•ä¿è¯ã€‚</li><li>TCPé¢å‘å­—èŠ‚æµï¼ŒUDPé¢å‘æŠ¥æ–‡ã€‚</li><li>TCPæ•°æ®ä¼ è¾“æ…¢ï¼ŒUDPæ•°æ®ä¼ è¾“å¿«ã€‚</li></ul><p><strong>æ³¨æ„</strong>ï¼š</p><p>TCP å¹¶ä¸èƒ½ä¿è¯æ•°æ®ä¸€å®šä¼šè¢«å¯¹æ–¹æ¥æ”¶åˆ°ï¼Œå› ä¸ºè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚</p><p>TCPçš„å¯é æ€§åº”è¯¥æ˜¯ç›¸å¯¹äºUDPä¸å¯é ä¼ è¾“æ¥è¯´çš„ï¼Œå› ä¸ºUDPæä¾›çš„æ˜¯ä¸å¯é çš„æ•°æ®æŠ¥æœåŠ¡ï¼Œä¸ä¿è¯æ•°æ®æŠ¥èƒ½åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œå¯èƒ½ä¼šæœ‰ä¸¢å¤±ï¼›å¦å¤–å¤„äºä¼ è¾“å±‚ä¹‹ä¸‹çš„IPå±‚ä¹Ÿæ˜¯ä¸å¯é çš„ï¼Œä»…æä¾›å°½åŠ›è€Œä¸ºçš„ç«¯åˆ°ç«¯æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆbest-effort delivery serviceï¼‰ï¼Œä¸ä½œä»»ä½•ä¿è¯ã€‚</p><p>æ‰€ä»¥TCPçš„å¯é æ€§æ˜¯æŒ‡åŸºäºä¸å¯é çš„IPå±‚åœ¨ä¼ è¾“å±‚æä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œå¦‚æœæœ‰å¯èƒ½ï¼Œå°±æŠŠæ•°æ®é€’é€åˆ°æ¥æ”¶æ–¹ï¼Œå¦åˆ™å°±ï¼ˆé€šè¿‡æ”¾å¼ƒé‡ä¼ å¹¶ä¸”ä¸­æ–­è¿æ¥è¿™ä¸€æ‰‹æ®µï¼‰é€šçŸ¥ç”¨æˆ·ã€‚å› æ­¤å‡†ç¡®è¯´ TCP ä¹Ÿä¸æ˜¯ 100% å¯é çš„åè®®ï¼Œå®ƒæ‰€èƒ½æä¾›çš„æ˜¯æ•°æ®çš„å¯é é€’é€æˆ–æ•…éšœçš„å¯é é€šçŸ¥ã€‚</p><p>å®ç°TCPçš„å¯é ä¼ è¾“æœ‰ä»¥ä¸‹æœºåˆ¶ï¼š</p><ol><li>æ ¡éªŒå’Œï¼ˆæ ¡éªŒæ•°æ®æ˜¯å¦æŸåï¼‰</li><li>å®šæ—¶å™¨ï¼ˆåˆ†ç»„ä¸¢å¤±åˆ™é‡ä¼ ï¼‰</li><li>åºå·ï¼ˆç”¨äºæ£€æµ‹ä¸¢å¤±çš„åˆ†ç»„å’Œå†—ä½™çš„åˆ†ç»„ï¼‰</li><li>ç¡®è®¤ï¼ˆæ¥æ”¶æ–¹å‘ŠçŸ¥å‘é€æ–¹æ­£ç¡®æ¥æ”¶åˆ†ç»„ä»¥åŠæœŸæœ›çš„ä¸‹ä¸€ä¸ªåˆ†ç»„ï¼‰</li><li>å¦å®šç¡®è®¤ï¼ˆæ¥æ”¶æ–¹é€šçŸ¥å‘é€æ–¹æœªè¢«æ­£ç¡®æ¥æ”¶çš„åˆ†ç»„ï¼‰</li><li>çª—å£å’Œæµæ°´çº¿ï¼ˆç”¨äºå¢åŠ ä¿¡é“çš„ååé‡ï¼‰ã€‚</li></ol><p>è‡³äºæ•°æ®æ˜¯å¦åœ¨ä¸­é€”è¢«ä¿®æ”¹æˆ–è€…è¢«çªƒå¬ï¼Œè¿™åº”è¯¥æ˜¯å±äºå®‰å…¨æ€§é—®é¢˜ã€‚æé«˜å®‰å…¨æ€§æœ€æ ¹æœ¬çš„åŠæ³•å°±æ˜¯åŠ å¯†æ•°æ®ï¼Œæ¯”å¦‚è¿œç¨‹ç™»å½•ç”¨sshè€Œételnetã€‚</p><h1 id="TCPã€UDPå¯¹åº”çš„åè®®"><a href="#TCPã€UDPå¯¹åº”çš„åè®®" class="headerlink" title="TCPã€UDPå¯¹åº”çš„åè®®"></a>TCPã€UDPå¯¹åº”çš„åè®®</h1><h2 id="TCPå¯¹åº”çš„åè®®"><a href="#TCPå¯¹åº”çš„åè®®" class="headerlink" title="TCPå¯¹åº”çš„åè®®"></a>TCPå¯¹åº”çš„åè®®</h2><ol><li>FTPï¼šå®šä¹‰äº†æ–‡ä»¶ä¼ è¾“åè®®ï¼Œä½¿ç”¨21ç«¯å£ã€‚</li><li>Telnetï¼šä¸€ç§ç”¨äºè¿œç¨‹ç™»é™†çš„ç«¯å£ï¼Œä½¿ç”¨23ç«¯å£ï¼Œç”¨æˆ·å¯ä»¥ä»¥è‡ªå·±çš„èº«ä»½è¿œç¨‹è¿æ¥åˆ°è®¡ç®—æœºä¸Šï¼Œå¯æä¾›åŸºäºDOSæ¨¡å¼ä¸‹çš„é€šä¿¡æœåŠ¡ã€‚</li><li>SMTPï¼šé‚®ä»¶ä¼ é€åè®®ï¼Œç”¨äºå‘é€é‚®ä»¶ã€‚æœåŠ¡å™¨å¼€æ”¾çš„æ˜¯25å·ç«¯å£ã€‚</li><li>POP3ï¼šå®ƒæ˜¯å’ŒSMTPå¯¹åº”ï¼ŒPOP3ç”¨äºæ¥æ”¶é‚®ä»¶ã€‚POP3åè®®æ‰€ç”¨çš„æ˜¯110ç«¯å£ã€‚</li><li>HTTPï¼šæ˜¯ä»WebæœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚</li></ol><h2 id="UDPå¯¹åº”çš„åè®®"><a href="#UDPå¯¹åº”çš„åè®®" class="headerlink" title="UDPå¯¹åº”çš„åè®®"></a>UDPå¯¹åº”çš„åè®®</h2><ol><li>DNSï¼šç”¨äºåŸŸåè§£ææœåŠ¡ï¼Œå°†åŸŸååœ°å€è½¬æ¢ä¸ºIPåœ°å€ã€‚DNSç”¨çš„æ˜¯53å·ç«¯å£ã€‚</li><li>SNMPï¼šç®€å•ç½‘ç»œç®¡ç†åè®®ï¼Œä½¿ç”¨161å·ç«¯å£ï¼Œæ˜¯ç”¨æ¥ç®¡ç†ç½‘ç»œè®¾å¤‡çš„ã€‚ç”±äºç½‘ç»œè®¾å¤‡å¾ˆå¤šï¼Œæ— è¿æ¥çš„æœåŠ¡å°±ä½“ç°å‡ºå…¶ä¼˜åŠ¿ã€‚</li><li>TFTP(Trival File Transfer Protocal)ï¼Œç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼Œè¯¥åè®®åœ¨ç†ŸçŸ¥ç«¯å£69ä¸Šä½¿ç”¨UDPæœåŠ¡ã€‚</li></ol><h1 id="SYNæ”»å‡»"><a href="#SYNæ”»å‡»" class="headerlink" title="SYNæ”»å‡»"></a><code>SYN</code>æ”»å‡»</h1><h2 id="ä»€ä¹ˆæ˜¯-SYN-æ”»å‡»ï¼ˆSYN-Floodï¼‰ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-SYN-æ”»å‡»ï¼ˆSYN-Floodï¼‰ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ SYN æ”»å‡»ï¼ˆSYN Floodï¼‰ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ <code>SYN</code> æ”»å‡»ï¼ˆSYN Floodï¼‰ï¼Ÿ</h2><p>åœ¨ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨å‘é€ <code>SYN-ACK</code> ä¹‹åï¼Œæ”¶åˆ°å®¢æˆ·ç«¯çš„ <code>ACK</code> ä¹‹å‰çš„ TCP è¿æ¥ç§°ä¸ºåŠè¿æ¥(half-open connect)ã€‚æ­¤æ—¶æœåŠ¡å™¨å¤„äº <code>SYN_RCVD</code> çŠ¶æ€ã€‚å½“æ”¶åˆ° ACK åï¼ŒæœåŠ¡å™¨æ‰èƒ½è½¬å…¥ <code>ESTABLISHED</code> çŠ¶æ€.</p><p><code>SYN</code>æ”»å‡»æŒ‡çš„æ˜¯ï¼Œæ”»å‡»å®¢æˆ·ç«¯åœ¨çŸ­æ—¶é—´å†…ä¼ªé€ å¤§é‡ä¸å­˜åœ¨çš„IPåœ°å€ï¼Œå‘æœåŠ¡å™¨ä¸æ–­åœ°å‘é€<code>SYN</code>åŒ…ï¼ŒæœåŠ¡å™¨å›å¤ç¡®è®¤åŒ…ï¼Œå¹¶ç­‰å¾…å®¢æˆ·çš„ç¡®è®¤ã€‚ç”±äºæºåœ°å€æ˜¯ä¸å­˜åœ¨çš„ï¼ŒæœåŠ¡å™¨éœ€è¦ä¸æ–­çš„é‡å‘ç›´è‡³è¶…æ—¶ï¼Œè¿™äº›ä¼ªé€ çš„<code>SYN</code>åŒ…å°†é•¿æ—¶é—´å ç”¨æœªè¿æ¥é˜Ÿåˆ—ï¼Œæ­£å¸¸çš„<code>SYN</code>è¯·æ±‚è¢«ä¸¢å¼ƒï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿè¿è¡Œç¼“æ…¢ï¼Œä¸¥é‡è€…ä¼šå¼•èµ·ç½‘ç»œå µå¡ç”šè‡³ç³»ç»Ÿç˜«ç—ªã€‚</p><p><code>SYN</code> æ”»å‡»æ˜¯ä¸€ç§å…¸å‹çš„ <code>DoS/DDoS</code> æ”»å‡»ã€‚</p><h2 id="å¦‚ä½•æ£€æµ‹-SYN-æ”»å‡»ï¼Ÿ"><a href="#å¦‚ä½•æ£€æµ‹-SYN-æ”»å‡»ï¼Ÿ" class="headerlink" title="å¦‚ä½•æ£€æµ‹ SYN æ”»å‡»ï¼Ÿ"></a>å¦‚ä½•æ£€æµ‹ <code>SYN</code> æ”»å‡»ï¼Ÿ</h2><p>æ£€æµ‹ <code>SYN</code> æ”»å‡»éå¸¸çš„æ–¹ä¾¿ï¼Œå½“ä½ åœ¨æœåŠ¡å™¨ä¸Šçœ‹åˆ°å¤§é‡çš„åŠè¿æ¥çŠ¶æ€æ—¶ï¼Œç‰¹åˆ«æ˜¯æºIPåœ°å€æ˜¯éšæœºçš„ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ–­å®šè¿™æ˜¯ä¸€æ¬¡<code>SYN</code>æ”»å‡»ã€‚åœ¨ <code>Linux/Unix</code> ä¸Šå¯ä»¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ <code>netstats</code> å‘½ä»¤æ¥æ£€æµ‹ <code>SYN</code> æ”»å‡»ã€‚</p><h2 id="å¦‚ä½•é˜²å¾¡-SYN-æ”»å‡»ï¼Ÿ"><a href="#å¦‚ä½•é˜²å¾¡-SYN-æ”»å‡»ï¼Ÿ" class="headerlink" title="å¦‚ä½•é˜²å¾¡ SYN æ”»å‡»ï¼Ÿ"></a>å¦‚ä½•é˜²å¾¡ <code>SYN</code> æ”»å‡»ï¼Ÿ</h2><p><code>SYN</code>æ”»å‡»ä¸èƒ½å®Œå…¨è¢«é˜»æ­¢ï¼Œé™¤éå°†TCPåè®®é‡æ–°è®¾è®¡ã€‚æˆ‘ä»¬æ‰€åšçš„æ˜¯å°½å¯èƒ½çš„å‡è½»<code>SYN</code>æ”»å‡»çš„å±å®³ï¼Œå¸¸è§çš„é˜²å¾¡<code>SYN</code> æ”»å‡»çš„æ–¹æ³•æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li>ç¼©çŸ­è¶…æ—¶ï¼ˆ<code>SYN</code> Timeoutï¼‰æ—¶é—´</li><li>å¢åŠ æœ€å¤§åŠè¿æ¥æ•°</li><li>è¿‡æ»¤ç½‘å…³é˜²æŠ¤</li><li><code>SYN</code> cookiesæŠ€æœ¯</li></ul>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SpringMVC çŸ¥è¯†æ•´ç†</title>
      <link href="/SpringMVC-Knowledge-finishing/"/>
      <url>/SpringMVC-Knowledge-finishing/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringMVCæ¶æ„è®¾è®¡"><a href="#SpringMVCæ¶æ„è®¾è®¡" class="headerlink" title="SpringMVCæ¶æ„è®¾è®¡"></a>SpringMVCæ¶æ„è®¾è®¡</h1><p><strong>MVCæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼</strong>ï¼Œå®ƒæŠŠä¸šåŠ¡çš„å®ç°å’Œå±•ç¤ºç›¸åˆ†ç¦»ã€‚</p><p><img src="https://images.morethink.cn/ddbf6d71cefe533f850b5466b583cfc0.png" alt="" title="SpringMVCæ¶æ„"></p><a id="more"></a><h1 id="SpringMVCä¸struts2çš„åŒºåˆ«"><a href="#SpringMVCä¸struts2çš„åŒºåˆ«" class="headerlink" title="SpringMVCä¸struts2çš„åŒºåˆ«"></a>SpringMVCä¸struts2çš„åŒºåˆ«</h1><ol><li><strong>Struts2æ˜¯ç±»çº§åˆ«çš„æ‹¦æˆª</strong>ï¼Œ ä¸€ä¸ªç±»å¯¹åº”ä¸€ä¸ªrequestä¸Šä¸‹æ–‡ï¼Œ<strong>SpringMVCæ˜¯æ–¹æ³•çº§åˆ«çš„æ‹¦æˆª</strong>ï¼Œä¸€ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªrequestä¸Šä¸‹æ–‡ï¼Œè€Œæ–¹æ³•åŒæ—¶åˆè·Ÿä¸€ä¸ªurlå¯¹åº”,æ‰€ä»¥è¯´ä»æ¶æ„æœ¬èº«ä¸ŠSpringMVCå°±å®¹æ˜“å®ç°restful url,è€Œstruts2çš„æ¶æ„å®ç°èµ·æ¥è¦è´¹åŠ²ï¼Œå› ä¸ºStruts2ä¸­Actionçš„ä¸€ä¸ªæ–¹æ³•å¯ä»¥å¯¹åº”ä¸€ä¸ªurlï¼Œè€Œå…¶ç±»å±æ€§å´è¢«æ‰€æœ‰æ–¹æ³•å…±äº«ï¼Œè¿™ä¹Ÿå°±æ— æ³•ç”¨æ³¨è§£æˆ–å…¶ä»–æ–¹å¼æ ‡è¯†å…¶æ‰€å±æ–¹æ³•äº†ã€‚</li><li><strong>springmvcå¯ä»¥è¿›è¡Œå•ä¾‹å¼€å‘</strong>ï¼Œå¹¶ä¸”å»ºè®®ä½¿ç”¨å•ä¾‹å¼€å‘ï¼Œstruts2é€šè¿‡ç±»çš„æˆå‘˜å˜é‡æ¥æ”¶å‚æ•°ï¼Œæ— æ³•ä½¿ç”¨å•ä¾‹ï¼Œåªèƒ½ä½¿ç”¨å¤šä¾‹ã€‚</li><li>ç”±äºStruts2éœ€è¦é’ˆå¯¹æ¯ä¸ªrequestè¿›è¡Œå°è£…ï¼ŒæŠŠrequestï¼Œsessionç­‰servletç”Ÿå‘½å‘¨æœŸçš„å˜é‡å°è£…æˆä¸€ä¸ªä¸€ä¸ªMapï¼Œä¾›ç»™æ¯ä¸ªActionä½¿ç”¨ï¼Œå¹¶ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥åœ¨åŸåˆ™ä¸Šï¼Œæ˜¯æ¯”è¾ƒè€—è´¹å†…å­˜çš„ã€‚</li><li><strong>æ‹¦æˆªå™¨å®ç°æœºåˆ¶ä¸Š</strong>ï¼ŒStruts2æœ‰ä»¥è‡ªå·±çš„interceptoræœºåˆ¶ï¼ŒSpringMVCç”¨çš„æ˜¯ç‹¬ç«‹çš„AOPæ–¹å¼ï¼Œè¿™æ ·å¯¼è‡´Struts2çš„é…ç½®æ–‡ä»¶é‡è¿˜æ˜¯æ¯”SpringMVCå¤§ã€‚</li><li>servletå’Œfilterçš„åŒºåˆ«äº†ã€‚</li><li>SpringMVCé›†æˆäº†Ajaxï¼Œä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œåªéœ€ä¸€ä¸ªæ³¨è§£<code>@ResponseBody</code>å°±å¯ä»¥å®ç°ï¼Œç„¶åç›´æ¥è¿”å›å“åº”æ–‡æœ¬å³å¯ï¼Œè€ŒStruts2æ‹¦æˆªå™¨é›†æˆäº†Ajaxï¼Œåœ¨Actionä¸­å¤„ç†æ—¶ä¸€èˆ¬å¿…é¡»å®‰è£…æ’ä»¶æˆ–è€…è‡ªå·±å†™ä»£ç é›†æˆè¿›å»ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿç›¸å¯¹ä¸æ–¹ä¾¿ã€‚</li><li>SpringMVCéªŒè¯æ”¯æŒJSR303ï¼Œå¤„ç†èµ·æ¥ç›¸å¯¹æ›´åŠ çµæ´»æ–¹ä¾¿ï¼Œè€ŒStruts2éªŒè¯æ¯”è¾ƒç¹çï¼Œæ„Ÿè§‰å¤ªçƒ¦ä¹±ã€‚</li><li>spring MVCå’ŒSpringæ˜¯æ— ç¼çš„ã€‚ä»è¿™ä¸ªé¡¹ç›®çš„ç®¡ç†å’Œå®‰å…¨ä¸Šä¹Ÿæ¯”Struts2é«˜ï¼ˆå½“ç„¶Struts2ä¹Ÿå¯ä»¥é€šè¿‡ä¸åŒçš„ç›®å½•ç»“æ„å’Œç›¸å…³é…ç½®åšåˆ°SpringMVCä¸€æ ·çš„æ•ˆæœï¼Œä½†æ˜¯éœ€è¦xmlé…ç½®çš„åœ°æ–¹ä¸å°‘ï¼‰ã€‚</li><li>è®¾è®¡æ€æƒ³ä¸Šï¼ŒStruts2æ›´åŠ ç¬¦åˆOOPçš„ç¼–ç¨‹æ€æƒ³ï¼Œ SpringMVCå°±æ¯”è¾ƒè°¨æ…ï¼Œåœ¨servletä¸Šæ‰©å±•ã€‚</li><li>SpringMVCå¼€å‘æ•ˆç‡å’Œæ€§èƒ½é«˜äºStruts2ã€‚</li><li>SpringMVCå¯ä»¥è®¤ä¸ºå·²ç»100%é›¶é…ç½®ã€‚</li></ol><h1 id="SpringAOPæ•´åˆSpringMVC"><a href="#SpringAOPæ•´åˆSpringMVC" class="headerlink" title="SpringAOPæ•´åˆSpringMVC"></a>SpringAOPæ•´åˆSpringMVC</h1><p>springå®¹å™¨ä¸æ³¨å†Œcontrollerå±‚ç»„ä»¶ï¼Œcontrollerç»„ä»¶ç”±springMVCå®¹å™¨å•ç‹¬æ³¨å†Œã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">// applicationContext.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.shuyun.channel"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.web.bind.annotation.RestController"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.web.bind.annotation.ControllerAdvice"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// springmvc-servlet.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.shuyun.channel"</span> <span class="attr">use-default-filters</span>=<span class="string">"false"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.stereotype.Controller"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.web.bind.annotation.RestController"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">"annotation"</span> <span class="attr">expression</span>=<span class="string">"org.springframework.web.bind.annotation.ControllerAdvice"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼š</p><p>å…³äº<code>&lt;context:annotation-config /&gt;</code>å’Œ <code>&lt;context:component-scan /&gt;</code>:</p><p><strong>component-scanä¼šè‡ªåŠ¨åŠ ä¸Šannotation-configåŠŸèƒ½ï¼Œæœ‰äº†component-scanä¸ç”¨å†å†™annotation-configäº†</strong>ã€‚å‚è§springå®˜æ–¹reference</p><h1 id="é…ç½®å±‚æ¬¡åŒ–Springå®¹å™¨"><a href="#é…ç½®å±‚æ¬¡åŒ–Springå®¹å™¨" class="headerlink" title="é…ç½®å±‚æ¬¡åŒ–Springå®¹å™¨"></a>é…ç½®å±‚æ¬¡åŒ–Springå®¹å™¨</h1><p>å‚è€ƒ <a href="http://blog.csdn.net/skyhitnow/article/details/43731493" target="_blank" rel="noopener">é…ç½®å±‚æ¬¡åŒ–Springå®¹å™¨</a></p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¼€å‘åŸºäºspringçš„Webåº”ç”¨æ—¶ï¼Œé€šå¸¸ä½¿ç”¨ä¸¤ä¸ªIoCå®¹å™¨ï¼Œä¸€ä¸ªæ˜¯ç”±DispatchServletåˆå§‹åŒ–çš„WebApplicationContext,ä¸€ä¸ªæ˜¯ç”±ContextLoaderListeneråˆå§‹åŒ–çš„ApplicationContextã€‚å¯¹äºSpringå®¹å™¨ï¼ŒSpringçš„å®˜æ–¹å‚è€ƒæ‰‹å†Œè¯¦ç»†åœ°è®²è§£äº†ä¾èµ–æ³¨å…¥çš„é…ç½®æ–¹å¼ï¼Œå¯¹äºå®¹å™¨æœ¬èº«çš„é…ç½®å’Œå¤šä¸ªå®¹å™¨ä¹‹é—´çš„å…³ç³»å´ä¸æ›¾æåŠã€‚äºæ˜¯ï¼Œå¾ˆå¤šäººä»¥ä¸ºåœ¨ä¸€ä¸ªåº”ç”¨ä¸­åªæœ‰ä¸€ä¸ªå…¨å±€çš„Springå®¹å™¨ï¼Œæˆ–è€…ä¸äº†è§£MVCä½¿ç”¨çš„WebApplicationContextå’Œæ ¹ApplicationContextçš„å…³ç³»ã€‚</p><p>é€šè¿‡æŸ¥çœ‹Springçš„æºç å’ŒAPI,å‘ç°Springå¯ä»¥é…ç½®ä¸ºå¤šä¸ªå®¹å™¨ï¼Œå®¹å™¨ä¹‹é—´å¯ä»¥é…ç½®ä¸ºå±‚çº§å…³ç³»ï¼Œä¸€ä¸ªæ ¹å®¹å™¨å¯ä»¥é…ç½®è®¸å¤šå­å®¹å™¨ï¼Œå­å®¹å™¨è¿˜å¯ä»¥é…ç½®å­å®¹å™¨ï¼Œä»è€Œå½¢æˆä¸€ä¸ªå•æ ¹çš„å±‚æ¬¡åŒ–ç»“æ„ã€‚å¯¹äºè¯¥å®¹å™¨ç»“æ„ä¸­çš„æ¯ä¸ªå®¹å™¨ï¼Œåœ¨å…¶ä¸­æŸ¥æ‰¾ç‰¹å®šçš„beanæ—¶ï¼Œä¼šé¦–å…ˆåœ¨æœ¬å®¹å™¨å†…æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°å¯¹åº”çš„bean,å°±è¿”å›è¯¥beanï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šä»ç›´æ¥çˆ¶å®¹å™¨ä¸­å»æŸ¥æ‰¾ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ ¹å®¹å™¨ä¸ºæ­¢ã€‚</p><p>ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä»å­å®¹å™¨ä¸­å¯ä»¥å–å¾—çˆ¶å®¹å™¨ä¸­é…ç½®çš„beanï¼Œè€Œçˆ¶å®¹å™¨ä¸­ä¸èƒ½å¤Ÿå–å¾—å­å®¹å™¨ä¸­çš„beanã€‚</p><p>åœ¨Spring MVCä¸­WebApplicationContexté…ç½®ä¸ºæ ¹ApplicationContextçš„å­å®¹å™¨ï¼Œæ‰€ä»¥ï¼ŒMVCä½¿ç”¨çš„å®¹å™¨ä¸­èƒ½å¤Ÿå–å¾—æ ¹ApplicationContextä¸­çš„beanã€‚<strong>åœ¨ä¸€ä¸ªwebç¨‹åºä¸­å¯ä»¥é…ç½®å¤šä¸ªDispatchSerlvetï¼Œæ¯ä¸ªServletå¯¹åº”ä¸€ä¸ªå®¹å™¨</strong>ï¼Œæ‰€æœ‰è¿™äº›å®¹å™¨éƒ½ä½œä¸ºæ ¹å®¹å™¨çš„å­å®¹å™¨ï¼Œè¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠé€šç”¨çš„beanæ”¾åœ¨æ ¹å®¹å™¨ä¸­ï¼Œè€Œé’ˆå¯¹ç‰¹å®šDispatchServletçš„beanï¼Œå¯ä»¥æ”¾åœ¨å„è‡ªçš„å­å®¹å™¨ä¸­ã€‚</p><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><ul><li><p>Controllerçš„æ–¹æ³•ä¸­éœ€è¦æ¥å—ä¸€ä¸ªSpring MVCæä¾›çš„MultipartFileæ¥å£ä½œä¸ºæ–¹æ³•çš„å‚æ•°ï¼Œè¯¥å‚æ•°æ¥æ”¶å‰å°è¡¨å•typeä¸ºfileæäº¤çš„å¯¹è±¡ï¼Œä½¿ç”¨<code>@RequestParam</code>æ³¨è§£æŒ‡æ˜å‚æ•°ï¼Œé‚£ä¹ˆSpringå°±ä¼šè‡ªåŠ¨å°†è¡¨å•ä¼ é€’è¿‡æ¥çš„å¯¹è±¡çš„ç±»å‹è½¬æ¢ä¸ºMultipartFileç±»å‹ã€‚</p></li><li><p>MultipartFileä¸­æä¾›äº†getName()ã€getSize()ã€getByte()<br>getContentType()ã€isEmpty()ã€getInputStream()ã€getOriginalFilename()æ–¹æ³•æ¥è®¿é—®æ–‡ä»¶ã€‚getOriginalFilename()æ–¹æ³•æ˜¯è·å–æœ€åˆæ–‡ä»¶åï¼Œå³æœ¬åœ°æ–‡ä»¶åã€‚</p></li><li>åœ¨Controlleræ–¹æ³•ä¸­ä½¿ç”¨FileUtilsä¸‹çš„copyInputStreamToFile(InputStream in,File file)æ–¹æ³•æ¥å®Œæˆæ–‡ä»¶çš„æ‹·è´.ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶æ‹·è´æºçš„è¾“å…¥æµ,ç›´æ¥ä½¿ç”¨MultipartFileä¸‹çš„getInputStream()æ–¹æ³•.ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡ä»¶å°†è¦ä¿å­˜çš„ä½ç½®.</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/doUpload"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">doUpload</span><span class="params">(@RequestParam(<span class="string">"file"</span>)</span> MultipartFile file) <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!file.isEmpty()) &#123;</span><br><span class="line">        FileUtils.copyInputStreamToFile(file.getInputStream(), <span class="keyword">new</span> File(<span class="string">"E://"</span>, file.getOriginalFilename()));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.SUCCESS_RESULT;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Jackson"><a href="#Jackson" class="headerlink" title="Jackson"></a>Jackson</h1><ul><li><a href="https://www.mkyong.com/java/how-to-enable-pretty-print-json-output-jackson/" target="_blank" rel="noopener">How to enable pretty print JSON output (Jackson)</a></li><li><a href="https://www.mkyong.com/java/jackson-2-convert-java-object-to-from-json/" target="_blank" rel="noopener">Jackson 2 â€“ Convert Java Object to / from JSON</a></li><li><a href="http://www.cnblogs.com/fangjian0423/p/springMVC-xml-json-convert.html" target="_blank" rel="noopener">SpringMVCå…³äºjsonã€xmlè‡ªåŠ¨è½¬æ¢çš„åŸç†ç ”ç©¶(é™„å¸¦æºç åˆ†æ)</a></li></ul><h1 id="SpringMVCæ‹¦æˆªå™¨"><a href="#SpringMVCæ‹¦æˆªå™¨" class="headerlink" title="SpringMVCæ‹¦æˆªå™¨"></a>SpringMVCæ‹¦æˆªå™¨</h1><p>æ‹¦æˆªå™¨å¥½æ¯”ä½ è¦å»å–ç»ï¼Œé‚£ä¹ˆï¼Œä½ å°±å¿…é¡»ç»è¿‡ä¹ä¹å…«åä¸€å…³ï¼Œä¸»è¦ç”¨æ¥è§£å†³è¯·æ±‚çš„å…±æ€§é—®é¢˜ï¼Œå¦‚ï¼šä¹±ç é—®é¢˜ã€æƒé™éªŒè¯é—®é¢˜ç­‰</p><p>å®ç°SpringMVCæ‹¦æˆªå™¨çš„ä¸‰ä¸ªæ­¥éª¤</p><ol><li>åˆ›å»ºä¸€ä¸ªå®ç°HandlerInterceptoræ¥å£ï¼Œå¹¶å®ç°æ¥å£çš„æ–¹æ³•çš„ç±»</li><li><p>å°†åˆ›å»ºçš„æ‹¦æˆªå™¨æ³¨å†Œåˆ°SpringMVCçš„é…ç½®æ–‡ä»¶ä¸­å®ç°æ³¨å†Œ</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvcï¼šinterceptors</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"è·¯å¾„ä¸‹çš„ç±»"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvcï¼šinterceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>é…ç½®æ‹¦æˆªå™¨çš„æ‹¦æˆªè§„åˆ™ï¼š</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvcï¼šinterceptors</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">mvcï¼šinterceptor</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"æ‹¦æˆªçš„action"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"è·¯å¾„ä¸‹çš„ç±»"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">mvcï¼šinterceptor</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvcï¼šinterceptors</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>æ‹¦æˆªå™¨ä¸­ä¸‰ä¸ªæ–¹æ³•çš„ä»‹ç»ï¼š</p><ol><li>preHandle()æ–¹æ³•æ˜¯å¦å°†å½“å‰è¯·æ±‚æ‹¦æˆªä¸‹æ¥ã€‚ï¼ˆè¿”å›trueè¯·æ±‚ç»§ç»­è¿è¡Œï¼Œè¿”å›falseè¯·æ±‚ç»ˆæ­¢ï¼ˆåŒ…æ‹¬actionå±‚ä¹Ÿä¼šç»ˆæ­¢ï¼‰ï¼ŒObject argä»£è¡¨è¢«æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ã€‚ï¼‰</li><li>postHandle()æ–¹æ³•çš„ModelAndViewå¯¹è±¡å¯ä»¥æ”¹å˜å‘å¾€çš„è§†å›¾æˆ–ä¿®æ”¹å‘å¾€è§†å›¾çš„ä¿¡æ¯ã€‚</li><li>afterCompletion()æ–¹æ³•è¡¨ç¤ºè§†å›¾æ˜¾ç¤ºä¹‹ååœ¨æ‰§è¡Œè¯¥æ–¹æ³•ã€‚ï¼ˆä¸€èˆ¬ç”¨äºèµ„æºçš„é”€æ¯ï¼‰</li></ol><h2 id="æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨"><a href="#æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨" class="headerlink" title="æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨"></a>æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨</h2><p>å…±åŒï¼šä»–ä»¬éƒ½æ˜¯ç”¨æ¥æ£€æŸ¥ç¨‹åºçš„å…±åŒåœºæ™¯ï¼Œåªä¸è¿‡æ‹¦æˆªå™¨æ˜¯é¢å‘Actionçš„ï¼Œè¿‡æ»¤å™¨æ˜¯é¢å‘æ•´ä¸ªwebåº”ç”¨çš„ã€‚</p><ol><li>è§£å†³æƒé™éªŒè¯é—®é¢˜</li><li>è§£å†³ä¹±ç é—®é¢˜</li></ol><p>æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«ï¼š</p><ol><li>æ‹¦æˆªå™¨æ˜¯åŸºäºjavaçš„åå°„æœºåˆ¶çš„ï¼Œè€Œè¿‡æ»¤å™¨æ˜¯åŸºäºå‡½æ•°å›è°ƒã€‚</li><li>æ‹¦æˆªå™¨ä¸ä¾èµ–ä¸servletå®¹å™¨ï¼Œè¿‡æ»¤å™¨ä¾èµ–ä¸servletå®¹å™¨ã€‚</li><li>æ‹¦æˆªå™¨åªèƒ½å¯¹actionè¯·æ±‚èµ·ä½œç”¨ï¼Œè€Œè¿‡æ»¤å™¨åˆ™å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è¯·æ±‚èµ·ä½œç”¨ã€‚</li><li>æ‹¦æˆªå™¨å¯ä»¥è®¿é—®actionä¸Šä¸‹æ–‡ã€<strong>å€¼æ ˆ</strong> é‡Œçš„å¯¹è±¡ï¼Œè€Œè¿‡æ»¤å™¨ä¸èƒ½è®¿é—®ã€‚</li><li>åœ¨actionçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ‹¦æˆªå™¨å¯ä»¥å¤šæ¬¡è¢«è°ƒç”¨ï¼Œè€Œè¿‡æ»¤å™¨åªèƒ½åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ä¸€æ¬¡ã€‚</li><li><strong>æ‹¦æˆªå™¨å¯ä»¥è·å–IOCå®¹å™¨ä¸­çš„å„ä¸ªbeanï¼Œè€Œè¿‡æ»¤å™¨å°±ä¸è¡Œï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œåœ¨æ‹¦æˆªå™¨é‡Œæ³¨å…¥ä¸€ä¸ªserviceï¼Œå¯ä»¥è°ƒç”¨ä¸šåŠ¡é€»è¾‘</strong>ã€‚</li></ol><h2 id="æ‹¦æˆªå™¨æ–¹æ³•çš„ä½œç”¨é¡ºåº"><a href="#æ‹¦æˆªå™¨æ–¹æ³•çš„ä½œç”¨é¡ºåº" class="headerlink" title="æ‹¦æˆªå™¨æ–¹æ³•çš„ä½œç”¨é¡ºåº"></a>æ‹¦æˆªå™¨æ–¹æ³•çš„ä½œç”¨é¡ºåº</h2><p><img src="https://images.morethink.cn/a23b0321f130d0b064094c2b9e1e15a6.png" alt="" title="æ‹¦æˆªå™¨æ–¹æ³•çš„ä½œç”¨é¡ºåº"></p><p>æ‹¦æˆªå™¨çš„å…¶å®ƒå®ç°æ–¹å¼ï¼š</p><ol><li>æ‹¦æˆªå™¨çš„ç±»è¿˜å¯ä»¥é€šè¿‡å®ç°WebRequestInterceptorï¼ˆHandlerInterceptorï¼‰æ¥å£æ¥ç¼–å†™ã€‚</li><li>å‘SpringMVCæ¡†æ¶æ³¨å†Œçš„å†™æ³•ä¸å˜ã€‚</li><li>å¼Šç«¯ï¼špreHandleræ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œä¸èƒ½ç»ˆæ­¢è¯·æ±‚ã€‚</li></ol><p>Psï¼šå»ºè®®ä½¿ç”¨åŠŸèƒ½æ›´å¼ºå¤§çš„å®ç°æ–¹å¼ï¼Œå®ç°HandlerInterceptoræ¥å£ã€‚</p><h1 id="Spring4å¢åŠ åŠŸèƒ½"><a href="#Spring4å¢åŠ åŠŸèƒ½" class="headerlink" title="Spring4å¢åŠ åŠŸèƒ½"></a>Spring4å¢åŠ åŠŸèƒ½</h1><p>Spring4ä¸»è¦åœ¨WebæœåŠ¡æ–¹é¢æœ‰ä¸‹é¢ä¸¤ä¸ªæ–¹é¢æå‡ï¼š</p><ol><li>æ§åˆ¶å™¨ä½¿ç”¨<code>@ResponseBody</code>å’Œ <code>@RestController</code>ã€‚</li><li>å¼‚æ­¥è°ƒç”¨ã€‚</li></ol><h1 id="Springæ•´åˆStruts2"><a href="#Springæ•´åˆStruts2" class="headerlink" title="Springæ•´åˆStruts2"></a>Springæ•´åˆStruts2</h1><p>Springé»˜è®¤æ˜¯å•ä¾‹ï¼ŒStruts2é»˜è®¤æ˜¯å¤šå®ä¾‹çš„ã€‚</p><p>å¦‚æœæ˜¯springé…ç½®æ–‡ä»¶ä¸­çš„ beançš„åå­—çš„è¯å°±æ˜¯springåˆ›å»ºï¼Œé‚£ä¹ˆå•å®ä¾‹è¿˜æ˜¯å¤šå®ä¾‹å°±ç”±springçš„action Beanä¸­çš„ä¸šåŠ¡é€»è¾‘æ§åˆ¶å™¨ç±»æ˜¯å¦é…ç½®ä¸ºscope=â€prototypeâ€ï¼Œæœ‰å°±æ˜¯å¤šå®ä¾‹çš„ï¼Œæ²¡æœ‰å°±æ˜¯å•å®ä¾‹çš„ï¼Œé¡ºåºæ˜¯å…ˆä»springä¸­æ‰¾ï¼Œæ‰¾ä¸åˆ°å†ä»strutsé…ç½®æ–‡ä»¶ä¸­æ‰¾ã€‚</p><ol><li><p>å¯¹äºæ— Springæ’ä»¶ï¼ˆStruts2-spring-plugin-XXX.jarï¼‰çš„æ•´åˆæ–¹å¼ï¼Œéœ€è¦åœ¨springçš„action Beanä¸­åŠ ä¸šåŠ¡é€»è¾‘æ§åˆ¶å™¨ç±»é…scope=â€prototypeâ€ã€‚</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">class</span>=<span class="string">"modle.User"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>/&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>å¯¹äºæœ‰Springæ’ä»¶ï¼ˆStruts2-spring-plugin-XXX.jarï¼‰çš„æ•´åˆæ–¹å¼ï¼šåç¼–è¯‘StrutsSpringObjectFactoryä»¥åŠç›¸å…³çš„ä»£ç æ‰å‘ç°ï¼Œå¦‚æœåœ¨struts actionçš„é…ç½®æ–‡ä»¶ <code>&lt;action name=&quot;..&quot; class=&quot;..&quot;/&gt;</code> ä¸­classå†™çš„å¦‚æœæ˜¯å®Œæ•´çš„åŒ…åå’Œç±»åçš„è¯å°±æ˜¯strutsåˆ›å»ºactionå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å¤šå®ä¾‹çš„ï¼›</p></li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.cnblogs.com/sunniest/p/4555801.html" target="_blank" rel="noopener">å²ä¸Šæœ€å…¨æœ€å¼ºSpringMVCè¯¦ç»†ç¤ºä¾‹å®æˆ˜æ•™ç¨‹</a></li><li><a href="https://www.tianmaying.com/tutorial/spring-mvc-quickstart" target="_blank" rel="noopener">Spring MVCå¿«é€Ÿå…¥é—¨</a></li><li><a href="https://docs.spring.io/spring/docs/current/spring-framework-reference/html/mvc.html" target="_blank" rel="noopener">Web MVC framework - Part VI. The Web</a></li><li><a href="http://snowolf.iteye.com/blog/1628861" target="_blank" rel="noopener">Spring æ³¨è§£å­¦ä¹ æ‰‹æœ­ï¼ˆä¸ƒï¼‰ è¡¥é—â€”â€”@ResponseBodyï¼Œ@RequestBodyï¼Œ@PathVariable</a></li><li><a href="https://github.com/kuitos/kuitos.github.io/issues/9" target="_blank" rel="noopener">SpringMVC4.1ä¹‹Controllerå±‚æœ€ä½³å®è·µ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>SpringMVC å‚æ•°ç»‘å®šæ³¨è§£è§£æ</title>
      <link href="/SpringMVC-Annotation/"/>
      <url>/SpringMVC-Annotation/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»äº†ç”¨äºå‚æ•°ç»‘å®šçš„ç›¸å…³æ³¨è§£ã€‚</p><p>ç»‘å®šï¼šå°†è¯·æ±‚ä¸­çš„å­—æ®µæŒ‰ç…§åå­—åŒ¹é…çš„åŸåˆ™å¡«å…¥æ¨¡å‹å¯¹è±¡ã€‚</p><p>SpringMVCå°±è·ŸStruts2ä¸€æ ·ï¼Œé€šè¿‡æ‹¦æˆªå™¨è¿›è¡Œå‚æ•°åŒ¹é…ã€‚</p><p>ä»£ç åœ¨ <a href="https://github.com/morethink/MySpringMVC" target="_blank" rel="noopener">https://github.com/morethink/MySpringMVC</a></p><h1 id="URIæ¨¡æ¿å˜é‡"><a href="#URIæ¨¡æ¿å˜é‡" class="headerlink" title="URIæ¨¡æ¿å˜é‡"></a>URIæ¨¡æ¿å˜é‡</h1><p>è¿™é‡ŒæŒ‡uri templateä¸­variable(è·¯å¾„å˜é‡)ï¼Œä¸å«queryStringéƒ¨åˆ†<br><a id="more"></a></p><h2 id="PathVariable"><a href="#PathVariable" class="headerlink" title="@PathVariable"></a><code>@PathVariable</code></h2><p>å½“ä½¿ç”¨<code>@RequestMapping</code> URI template æ ·å¼æ˜ å°„æ—¶ï¼Œ å³ someUrl/{paramId}, è¿™æ—¶çš„paramIdå¯é€šè¿‡ <code>@Pathvariable</code>æ³¨è§£ç»‘å®šå®ƒä¼ è¿‡æ¥çš„å€¼åˆ°æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/users"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">getUser</span><span class="params">(@PathVariable <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.successResult(<span class="string">"123456"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸Šé¢ä»£ç æŠŠURI template ä¸­å˜é‡ ownerIdçš„å€¼å’ŒpetIdçš„å€¼ï¼Œç»‘å®šåˆ°æ–¹æ³•çš„å‚æ•°ä¸Šã€‚<strong>è‹¥æ–¹æ³•å‚æ•°åç§°å’Œéœ€è¦ç»‘å®šçš„uri templateä¸­å˜é‡åç§°ä¸ä¸€è‡´ï¼Œéœ€è¦åœ¨@PathVariable(â€œnameâ€)æŒ‡å®šuri templateä¸­çš„åç§°</strong>ã€‚</p><h1 id="è¯·æ±‚å¤´"><a href="#è¯·æ±‚å¤´" class="headerlink" title="è¯·æ±‚å¤´"></a>è¯·æ±‚å¤´</h1><h2 id="RequestHeader"><a href="#RequestHeader" class="headerlink" title="@RequestHeader"></a><code>@RequestHeader</code></h2><p><code>@RequestHeader</code> æ³¨è§£ï¼Œå¯ä»¥æŠŠRequestè¯·æ±‚headeréƒ¨åˆ†çš„å€¼ç»‘å®šåˆ°æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><p>è¿™æ˜¯ä¸€ä¸ªRequest çš„headeréƒ¨åˆ†ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Accept-Encoding:gzip, deflate, br</span><br><span class="line">Accept-Language:zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="line">Cache-Control:max-age=0</span><br><span class="line">Connection:keep-alive</span><br><span class="line">Host:localhost:8080</span><br><span class="line">Upgrade-Insecure-Requests:1</span><br><span class="line">User-Agent:Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/62.0.3202.62 Safari/537.36</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/getRequestHeader"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getRequestHeader</span><span class="params">(@RequestHeader(<span class="string">"Accept-Encoding"</span>)</span> String encoding) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(encoding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ï¼ŒæŠŠrequest headeréƒ¨åˆ†çš„ Accept-Encodingçš„å€¼ï¼Œç»‘å®šåˆ°å‚æ•°encodingä¸Šã€‚</p><h2 id="CookieValue"><a href="#CookieValue" class="headerlink" title="@CookieValue"></a><code>@CookieValue</code></h2><p>å¯ä»¥æŠŠRequest headerä¸­å…³äºcookieçš„å€¼ç»‘å®šåˆ°æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p><p>ä¾‹å¦‚æœ‰å¦‚ä¸‹Cookieå€¼ï¼š<br><code>JSESSIONID=588DC770E582A3189B7E6210102EAE02</code><br>å‚æ•°ç»‘å®šçš„ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/getCookie"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getCookie</span><span class="params">(@CookieValue(<span class="string">"JSESSIONID"</span>)</span> String cookie) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(cookie);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³æŠŠJSESSIONIDçš„å€¼ç»‘å®šåˆ°å‚æ•°cookieä¸Šã€‚</p><h1 id="è¯·æ±‚ä½“"><a href="#è¯·æ±‚ä½“" class="headerlink" title="è¯·æ±‚ä½“"></a>è¯·æ±‚ä½“</h1><h2 id="RequestParam"><a href="#RequestParam" class="headerlink" title="@RequestParam"></a><code>@RequestParam</code></h2><ul><li>å¸¸ç”¨æ¥å¤„ç†ç®€å•ç±»å‹çš„ç»‘å®šï¼Œé€šè¿‡Request.getParameter() è·å–çš„Stringå¯ç›´æ¥è½¬æ¢ä¸ºç®€å•ç±»å‹çš„æƒ…å†µï¼ˆ Stringâ€“&gt; ç®€å•ç±»å‹çš„è½¬æ¢æ“ä½œç”±ConversionServiceé…ç½®çš„è½¬æ¢å™¨æ¥å®Œæˆï¼‰ï¼›å› ä¸ºä½¿ç”¨request.getParameter()æ–¹å¼è·å–å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥å¤„ç†get æ–¹å¼ä¸­queryStringçš„å€¼ï¼Œä¹Ÿå¯ä»¥å¤„ç†postæ–¹å¼ä¸­ body dataçš„å€¼ï¼›</li><li><strong>ç”¨æ¥å¤„ç†Content-Type: ä¸º <code>application/x-www-form-urlencoded</code>ç¼–ç çš„å†…å®¹ï¼Œæäº¤æ–¹å¼GETã€POST</strong>ï¼›</li><li>è¯¥æ³¨è§£æœ‰ä¸¤ä¸ªå±æ€§ï¼š valueã€requiredï¼› valueç”¨æ¥æŒ‡å®šè¦ä¼ å…¥å€¼çš„idåç§°ï¼Œrequiredç”¨æ¥æŒ‡ç¤ºå‚æ•°æ˜¯å¦å¿…é¡»ç»‘å®šï¼›</li></ul><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/tesRequestParam"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">tesRequestParam</span><span class="params">(@RequestParam(<span class="string">"username"</span>)</span> String username) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(username);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a><code>@RequestBody</code></h2><p>è¯¥æ³¨è§£å¸¸ç”¨æ¥å¤„ç†Content-Type: ä¸æ˜¯application/x-www-form-urlencodedç¼–ç çš„å†…å®¹ï¼Œä¾‹å¦‚application/json, application/xmlç­‰ï¼›</p><p>å®ƒæ˜¯é€šè¿‡ä½¿ç”¨HandlerAdapter é…ç½®çš„HttpMessageConvertersæ¥è§£æpost data bodyï¼Œç„¶åç»‘å®šåˆ°ç›¸åº”çš„beanä¸Šçš„ã€‚</p><p>å› ä¸ºé…ç½®æœ‰FormHttpMessageConverterï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨æ¥å¤„ç† application/x-www-form-urlencodedçš„å†…å®¹ï¼Œå¤„ç†å®Œçš„ç»“æœæ”¾åœ¨ä¸€ä¸ªMultiValueMap&lt;String, String&gt;é‡Œï¼Œè¿™ç§æƒ…å†µåœ¨æŸäº›ç‰¹æ®Šéœ€æ±‚ä¸‹ä½¿ç”¨ï¼Œè¯¦æƒ…æŸ¥çœ‹FormHttpMessageConverter api;</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@PostMapping(&quot;/tesRequestBody&quot;)</span><br><span class="line">public Result tesRequestBody(@RequestBody User user) &#123;</span><br><span class="line"></span><br><span class="line">    return ResultUtil.successResult(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæˆªå›¾ï¼š</p><p><img src="https://images.morethink.cn/f918dd11d4630c479a25548cca70acc2.png" alt="" title="Content-Type:application/json"></p><h2 id="RequestBodyé€šè¿‡listæ¥æ”¶å¯¹è±¡æ•°ç»„"><a href="#RequestBodyé€šè¿‡listæ¥æ”¶å¯¹è±¡æ•°ç»„" class="headerlink" title="@RequestBodyé€šè¿‡listæ¥æ”¶å¯¹è±¡æ•°ç»„"></a><code>@RequestBody</code>é€šè¿‡listæ¥æ”¶å¯¹è±¡æ•°ç»„</h2><p>åœ¨æˆ‘ä»¬ä¼ é€’å¯¹è±¡çš„æ—¶å€™ï¼Œæ— è®º<code>Content-Type</code>æ˜¯<code>x-www-form-urlencoded</code>è¿˜æ˜¯<code>application/json</code>å…¶å®æ²¡æœ‰å¤šå¤§çš„å…³ç³»ï¼Œå¯æ˜¯å½“æˆ‘ä»¬éœ€è¦ä¼ é€’å¯¹è±¡æ•°ç»„çš„æ—¶å€™ï¼Œè¡¨å•ç¼–ç å°±ä¸è¡Œäº†ï¼Œè¿™æ—¶æˆ‘ä»¬æ˜¯å¯ä»¥é‡‡ç”¨jsonä¼ é€’ï¼Œç„¶ååå°ä½¿ç”¨<code>@RequestBody</code>æ³¨è§£ï¼Œé€šè¿‡listæ¥æ”¶æ¥å¯¹è±¡æ•°ç»„ã€‚</p><p>å‰ç«¯ä»£ç ï¼š</p><p>index.html<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ‰“å¼€é¡µé¢æ—¶è¿è¡Œ</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> users = [];</span><br><span class="line">    <span class="keyword">var</span> user1 = &#123;<span class="string">"username"</span>: <span class="string">"dd"</span>, <span class="string">"password"</span>: <span class="string">"123"</span>&#125;;</span><br><span class="line">    <span class="keyword">var</span> user2 = &#123;<span class="string">"username"</span>: <span class="string">"gg"</span>, <span class="string">"password"</span>: <span class="string">"123"</span>&#125;;</span><br><span class="line">    users.push(user1);</span><br><span class="line">    users.push(user2);</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"POST"</span>,</span><br><span class="line">        url: <span class="string">"users/saveUsers"</span>,</span><br><span class="line">        timeout: <span class="number">30000</span>,</span><br><span class="line">        dataType: <span class="string">"json"</span>,</span><br><span class="line">        contentType: <span class="string">"application/json"</span>,</span><br><span class="line">        data: <span class="built_in">JSON</span>.stringify(users),</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="comment">//å°†è¿”å›çš„æ•°æ®å±•ç¤ºæˆtable</span></span><br><span class="line">            showTable(data);</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">//è¯·æ±‚å‡ºé”™çš„å¤„ç†</span></span><br><span class="line">            $(<span class="string">"#result"</span>).text(<span class="string">"è¯·æ±‚å‡ºé”™"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>åå°ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"saveUsers"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">saveUsers</span><span class="params">(@RequestBody List&lt;User&gt; users)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœæˆªå›¾ï¼š</p><p><img src="https://images.morethink.cn/2161af7bd2378ca110347dd73a4ecf94.png" alt="" title="è¡¨æ ¼å±•ç¤ºæ•°æ®"></p><h1 id="SessionAttribute"><a href="#SessionAttribute" class="headerlink" title="@SessionAttribute"></a><code>@SessionAttribute</code></h1><p>è¯¥æ³¨è§£ç”¨æ¥ç»‘å®šHttpSessionä¸­çš„attributeå¯¹è±¡çš„å€¼ï¼Œä¾¿äºåœ¨æ–¹æ³•ä¸­çš„å‚æ•°é‡Œä½¿ç”¨ã€‚è¯¥æ³¨è§£æœ‰valueã€typesä¸¤ä¸ªå±æ€§ï¼Œå¯ä»¥é€šè¿‡åå­—å’Œç±»å‹æŒ‡å®šè¦ä½¿ç”¨çš„attribute å¯¹è±¡</p><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/setSessionAttribute"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">setSessionAttribute</span><span class="params">(HttpSession session, String attribute)</span> </span>&#123;</span><br><span class="line">    session.setAttribute(<span class="string">"attribute"</span>, attribute);</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.SUCCESS_RESULT;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/getSessionAttribute"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getSessionAttribute</span><span class="params">(@SessionAttribute(<span class="string">"attribute"</span>)</span> String attribute) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(attribute);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é¦–å…ˆç»™sessionæ·»åŠ ä¸€ä¸ªattributeï¼Œç„¶åå†å–å‡ºè¿™ä¸ªattributeã€‚</p><p><img src="https://images.morethink.cn/03f2cfd9da78e5abd39254a7cc7c21d7.png" alt="" title="æ·»åŠ å±æ€§"></p><p><img src="https://images.morethink.cn/6d17bbc4aeb10b48e4593ca5e82f3ca9.png" alt="" title="å¾—åˆ°å±æ€§"></p><h1 id="ModelAttribute"><a href="#ModelAttribute" class="headerlink" title="@ModelAttribute"></a><code>@ModelAttribute</code></h1><p>@ModelAttributeæ ‡æ³¨å¯è¢«åº”ç”¨åœ¨æ–¹æ³•æˆ–æ–¹æ³•å‚æ•°ä¸Šã€‚</p><h2 id="æ–¹æ³•ä½¿ç”¨-ModelAttributeæ ‡æ³¨"><a href="#æ–¹æ³•ä½¿ç”¨-ModelAttributeæ ‡æ³¨" class="headerlink" title="æ–¹æ³•ä½¿ç”¨@ModelAttributeæ ‡æ³¨"></a>æ–¹æ³•ä½¿ç”¨@ModelAttributeæ ‡æ³¨</h2><p>æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šçš„<code>@ModelAttribute</code>è¯´æ˜æ–¹æ³•æ˜¯ç”¨äºæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§åˆ°modelä¸Šã€‚è¿™æ ·çš„æ–¹æ³•èƒ½æ¥å—ä¸<code>@RequestMapping</code>æ ‡æ³¨ç›¸åŒçš„å‚æ•°ç±»å‹ï¼Œåªä¸è¿‡ä¸èƒ½ç›´æ¥è¢«æ˜ å°„åˆ°å…·ä½“çš„è¯·æ±‚ä¸Šã€‚</p><p>åœ¨åŒä¸€ä¸ªæ§åˆ¶å™¨ä¸­ï¼Œæ ‡æ³¨äº†<code>@ModelAttribute</code>çš„æ–¹æ³•å®é™…ä¸Šä¼šåœ¨<code>@RequestMapping</code>æ–¹æ³•ä¹‹å‰è¢«è°ƒç”¨ã€‚</p><p>ä»¥ä¸‹æ˜¯ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add one attribute</span></span><br><span class="line"><span class="comment">// The return value of the method is added to the model under the name "account"</span></span><br><span class="line"><span class="comment">// You can customize the name via @ModelAttribute("myAccount")</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ModelAttribute</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Account <span class="title">addAccount</span><span class="params">(@RequestParam String number)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> accountManager.findAccount(number);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Add multiple attributes</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ModelAttribute</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">populateModel</span><span class="params">(@RequestParam String number, Model model)</span> </span>&#123;</span><br><span class="line">    model.addAttribute(accountManager.findAccount(number));</span><br><span class="line">    <span class="comment">// add more ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong><code>@ModelAttribute</code>æ–¹æ³•é€šå¸¸è¢«ç”¨æ¥å¡«å……ä¸€äº›å…¬å…±éœ€è¦çš„å±æ€§æˆ–æ•°æ®</strong>ï¼Œæ¯”å¦‚ä¸€ä¸ªä¸‹æ‹‰åˆ—è¡¨æ‰€é¢„è®¾çš„å‡ ç§çŠ¶æ€ï¼Œæˆ–è€…å® ç‰©çš„å‡ ç§ç±»å‹ï¼Œæˆ–è€…å»å–å¾—ä¸€ä¸ªHTMLè¡¨å•æ¸²æŸ“æ‰€éœ€è¦çš„å‘½ä»¤å¯¹è±¡ï¼Œæ¯”å¦‚Accountç­‰ã€‚</p><p>@ModelAttributeæ ‡æ³¨æ–¹æ³•æœ‰ä¸¤ç§é£æ ¼ï¼š</p><ul><li>åœ¨ç¬¬ä¸€ç§å†™æ³•ä¸­ï¼Œæ–¹æ³•é€šè¿‡è¿”å›å€¼çš„æ–¹å¼é»˜è®¤åœ°å°†æ·»åŠ ä¸€ä¸ªå±æ€§ï¼›</li><li>åœ¨ç¬¬äºŒç§å†™æ³•ä¸­ï¼Œæ–¹æ³•æ¥æ”¶ä¸€ä¸ªModelå¯¹è±¡ï¼Œç„¶åå¯ä»¥å‘å…¶ä¸­æ·»åŠ ä»»æ„æ•°é‡çš„å±æ€§ã€‚</li></ul><p>å¯ä»¥åœ¨æ ¹æ®éœ€è¦ï¼Œåœ¨ä¸¤ç§é£æ ¼ä¸­é€‰æ‹©åˆé€‚çš„ä¸€ç§ã€‚</p><p><strong>ä¸€ä¸ªæ§åˆ¶å™¨å¯ä»¥æ‹¥æœ‰å¤šä¸ª<code>@ModelAttribute</code>æ–¹æ³•ã€‚åŒä¸ªæ§åˆ¶å™¨å†…çš„æ‰€æœ‰è¿™äº›æ–¹æ³•ï¼Œéƒ½ä¼šåœ¨<code>@RequestMapping</code>æ–¹æ³•ä¹‹å‰è¢«è°ƒç”¨ã€‚</strong></p><p><code>@ModelAttribute</code>æ–¹æ³•ä¹Ÿå¯ä»¥å®šä¹‰åœ¨<code>@ControllerAdvice</code>æ ‡æ³¨çš„ç±»ä¸­ï¼Œå¹¶ä¸”è¿™äº›<code>@ModelAttribute</code>å¯ä»¥åŒæ—¶å¯¹è®¸å¤šæ§åˆ¶å™¨ç”Ÿæ•ˆã€‚</p><p>å±æ€§åæ²¡æœ‰è¢«æ˜¾å¼æŒ‡å®šçš„æ—¶å€™åˆå½“å¦‚ä½•å‘¢ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¡†æ¶å°†æ ¹æ®å±æ€§çš„ç±»å‹ç»™äºˆä¸€ä¸ªé»˜è®¤åç§°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè‹¥æ–¹æ³•è¿”å›ä¸€ä¸ªAccountç±»å‹çš„å¯¹è±¡ï¼Œåˆ™é»˜è®¤çš„å±æ€§åä¸ºâ€accountâ€ã€‚å¯ä»¥é€šè¿‡è®¾ç½®@ModelAttributeæ ‡æ³¨çš„å€¼æ¥æ”¹å˜é»˜è®¤å€¼ã€‚å½“å‘Modelä¸­ç›´æ¥æ·»åŠ å±æ€§æ—¶ï¼Œè¯·ä½¿ç”¨åˆé€‚çš„é‡è½½æ–¹æ³•addAttribute(..)-å³å¸¦æˆ–ä¸å¸¦å±æ€§åçš„æ–¹æ³•ã€‚</p><p>@ModelAttributeæ ‡æ³¨ä¹Ÿå¯ä»¥è¢«ç”¨åœ¨<code>@RequestMapping</code>æ–¹æ³•ä¸Šã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>@RequestMapping</code>æ–¹æ³•çš„è¿”å›å€¼å°†ä¼šè¢«è§£é‡Šä¸ºmodelçš„ä¸€ä¸ªå±æ€§ï¼Œè€Œéä¸€ä¸ªè§†å›¾åï¼Œæ­¤æ—¶è§†å›¾åå°†ä»¥è§†å›¾å‘½åçº¦å®šæ¥æ–¹å¼æ¥ç¡®å®šã€‚</p><h2 id="æ–¹æ³•å‚æ•°ä½¿ç”¨-ModelAttributeæ ‡æ³¨"><a href="#æ–¹æ³•å‚æ•°ä½¿ç”¨-ModelAttributeæ ‡æ³¨" class="headerlink" title="æ–¹æ³•å‚æ•°ä½¿ç”¨@ModelAttributeæ ‡æ³¨"></a>æ–¹æ³•å‚æ•°ä½¿ç”¨<code>@ModelAttribute</code>æ ‡æ³¨</h2><p><strong>æ ‡æ³¨åœ¨æ–¹æ³•å‚æ•°ä¸Šçš„<code>@ModelAttribute</code>è¯´æ˜äº†è¯¥æ–¹æ³•å‚æ•°çš„å€¼å°†ç”±modelä¸­å–å¾—ã€‚å¦‚æœmodelä¸­æ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆè¯¥å‚æ•°ä¼šå…ˆè¢«å®ä¾‹åŒ–ï¼Œç„¶åè¢«æ·»åŠ åˆ°modelä¸­ã€‚åœ¨modelä¸­å­˜åœ¨ä»¥åï¼Œè¯·æ±‚ä¸­æ‰€æœ‰åç§°åŒ¹é…çš„å‚æ•°éƒ½ä¼šå¡«å……åˆ°è¯¥å‚æ•°ä¸­ã€‚</strong></p><p>è¿™åœ¨Spring MVCä¸­è¢«ç§°ä¸ºæ•°æ®ç»‘å®šï¼Œä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¸ç”¨æ¯æ¬¡éƒ½æ‰‹åŠ¨ä»è¡¨æ ¼æ•°æ®ä¸­è½¬æ¢è¿™äº›å­—æ®µæ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">saveUser</span><span class="params">(@ModelAttribute User user)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ResultUtil.successResult(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šé¢çš„ä»£ç ä¸ºä¾‹ï¼Œè¿™ä¸ªUserç±»å‹çš„å®ä¾‹å¯èƒ½æ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿæœ‰å‡ ç§å¯èƒ½:</p><ul><li>å®ƒå¯èƒ½å› ä¸º<code>@SessionAttributes</code>æ ‡æ³¨çš„ä½¿ç”¨å·²ç»å­˜åœ¨äºmodelä¸­</li><li>å®ƒå¯èƒ½å› ä¸ºåœ¨åŒä¸ªæ§åˆ¶å™¨ä¸­ä½¿ç”¨äº†<code>@ModelAttribute</code>æ–¹æ³•å·²ç»å­˜åœ¨äºmodelä¸­ï¼Œæ­£å¦‚ä¸Šä¸€å°èŠ‚æ‰€å™è¿°çš„</li><li>å®ƒå¯èƒ½æ˜¯ç”±URIæ¨¡æ¿å˜é‡å’Œç±»å‹è½¬æ¢ä¸­å–å¾—çš„</li><li>å®ƒå¯èƒ½æ˜¯è°ƒç”¨äº†è‡ªèº«çš„é»˜è®¤æ„é€ å™¨è¢«å®ä¾‹åŒ–å‡ºæ¥çš„</li></ul><p>@ModelAttributeæ–¹æ³•å¸¸ç”¨äºä»æ•°æ®åº“ä¸­å–ä¸€ä¸ªå±æ€§å€¼ï¼Œè¯¥å€¼å¯èƒ½é€šè¿‡<code>@SessionAttributes</code>æ ‡æ³¨åœ¨è¯·æ±‚ä¸­é—´ä¼ é€’ã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨URIæ¨¡æ¿å˜é‡å’Œç±»å‹è½¬æ¢çš„æ–¹å¼æ¥å–å¾—ä¸€ä¸ªå±æ€§æ˜¯æ›´æ–¹ä¾¿çš„æ–¹å¼ã€‚</p><h1 id="åœ¨ä¸ç»™å®šæ³¨è§£çš„æƒ…å†µä¸‹ï¼Œå‚æ•°æ˜¯æ€æ ·ç»‘å®šçš„ï¼Ÿ"><a href="#åœ¨ä¸ç»™å®šæ³¨è§£çš„æƒ…å†µä¸‹ï¼Œå‚æ•°æ˜¯æ€æ ·ç»‘å®šçš„ï¼Ÿ" class="headerlink" title="åœ¨ä¸ç»™å®šæ³¨è§£çš„æƒ…å†µä¸‹ï¼Œå‚æ•°æ˜¯æ€æ ·ç»‘å®šçš„ï¼Ÿ"></a>åœ¨ä¸ç»™å®šæ³¨è§£çš„æƒ…å†µä¸‹ï¼Œå‚æ•°æ˜¯æ€æ ·ç»‘å®šçš„ï¼Ÿ</h1><p>é€šè¿‡åˆ†æ<code>AnnotationMethodHandlerAdapter</code>å’Œ<code>RequestMappingHandlerAdapter</code>çš„æºä»£ç å‘ç°ï¼Œæ–¹æ³•çš„å‚æ•°åœ¨ä¸ç»™å®šå‚æ•°çš„æƒ…å†µä¸‹ï¼š</p><ul><li>è‹¥è¦ç»‘å®šçš„å¯¹è±¡æ—¶ç®€å•ç±»å‹ï¼šè°ƒç”¨<code>@RequestParam</code>æ¥å¤„ç†çš„ã€‚<br>è¿™é‡Œçš„ç®€å•ç±»å‹æŒ‡Javaçš„åŸå§‹ç±»å‹(boolean, int ç­‰)ã€åŸå§‹ç±»å‹å¯¹è±¡ï¼ˆBoolean, Intç­‰ï¼‰ã€Stringã€Dateç­‰ConversionServiceé‡Œå¯ä»¥ç›´æ¥Stringè½¬æ¢æˆç›®æ ‡å¯¹è±¡çš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰ç‰¹åˆ«éœ€æ±‚ï¼Œä¸æ¨èä½¿ç”¨<code>@RequestParam</code>ã€‚</li><li>è‹¥è¦ç»‘å®šçš„å¯¹è±¡æ—¶å¤æ‚ç±»å‹ï¼šè°ƒç”¨<code>@ModelAttribute</code>æ¥å¤„ç†çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸éœ€è¦ä»modelæˆ–è€…sessionä¸­å¾—åˆ°æ•°æ®ï¼Œ@ModelAttributeå¯ä»¥ä¸ä½¿ç”¨ã€‚</li></ul><h1 id="RequestMappingæ”¯æŒçš„æ–¹æ³•å‚æ•°"><a href="#RequestMappingæ”¯æŒçš„æ–¹æ³•å‚æ•°" class="headerlink" title="@RequestMappingæ”¯æŒçš„æ–¹æ³•å‚æ•°"></a><code>@RequestMapping</code>æ”¯æŒçš„æ–¹æ³•å‚æ•°</h1><p>ä¸‹é¢è¿™äº›å‚æ•°Springåœ¨è°ƒç”¨è¯·æ±‚æ–¹æ³•çš„æ—¶å€™ä¼šè‡ªåŠ¨ç»™å®ƒä»¬èµ‹å€¼ï¼Œæ‰€ä»¥å½“åœ¨è¯·æ±‚æ–¹æ³•ä¸­éœ€è¦ä½¿ç”¨åˆ°è¿™äº›å¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥åœ¨æ–¹æ³•ä¸Šç»™å®šä¸€ä¸ªæ–¹æ³•å‚æ•°çš„ç”³æ˜ï¼Œç„¶ååœ¨æ–¹æ³•ä½“é‡Œé¢ç›´æ¥ç”¨å°±å¯ä»¥äº†ã€‚</p><ol><li>HttpServlet å¯¹è±¡ï¼Œä¸»è¦åŒ…æ‹¬HttpServletRequest ã€HttpServletResponse å’ŒHttpSession å¯¹è±¡ã€‚ ä½†æ˜¯æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯åœ¨ä½¿ç”¨HttpSession å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœæ­¤æ—¶HttpSession å¯¹è±¡è¿˜æ²¡æœ‰å»ºç«‹èµ·æ¥çš„è¯å°±ä¼šæœ‰é—®é¢˜ã€‚</li><li>Spring è‡ªå·±çš„WebRequest å¯¹è±¡ã€‚ ä½¿ç”¨è¯¥å¯¹è±¡å¯ä»¥è®¿é—®åˆ°å­˜æ”¾åœ¨HttpServletRequest å’ŒHttpSession ä¸­çš„å±æ€§å€¼ã€‚</li><li>InputStream ã€OutputStream ã€Reader å’ŒWriter ã€‚ InputStream å’ŒReader æ˜¯é’ˆå¯¹HttpServletRequest è€Œè¨€çš„ï¼Œå¯ä»¥ä»é‡Œé¢å–æ•°æ®ï¼›OutputStream å’ŒWriter æ˜¯é’ˆå¯¹HttpServletResponse è€Œè¨€çš„ï¼Œå¯ä»¥å¾€é‡Œé¢å†™æ•°æ®ã€‚</li><li>ä½¿ç”¨<code>@PathVariable</code> ã€<code>@RequestParam</code> ã€<code>@CookieValue</code> å’Œ <code>@RequestHeader</code> æ ‡è®°çš„å‚æ•°ã€‚</li><li>ä½¿ç”¨<code>@ModelAttribute</code> æ ‡è®°çš„å‚æ•°ã€‚</li><li>java.util.Map ã€Spring å°è£…çš„Model å’ŒModelMap ã€‚ è¿™äº›éƒ½å¯ä»¥ç”¨æ¥å°è£…æ¨¡å‹æ•°æ®ï¼Œç”¨æ¥ç»™è§†å›¾åšå±•ç¤ºã€‚</li><li>å®ä½“ç±»ã€‚ å¯ä»¥ç”¨æ¥æ¥æ”¶ä¸Šä¼ çš„å‚æ•°ã€‚</li><li>Spring å°è£…çš„MultipartFile ã€‚ ç”¨æ¥æ¥æ”¶ä¸Šä¼ æ–‡ä»¶çš„ã€‚</li><li>Spring å°è£…çš„Errors å’ŒBindingResult å¯¹è±¡ã€‚ è¿™ä¸¤ä¸ªå¯¹è±¡å‚æ•°å¿…é¡»ç´§æ¥åœ¨éœ€è¦éªŒè¯çš„å®ä½“å¯¹è±¡å‚æ•°ä¹‹åï¼Œå®ƒé‡Œé¢åŒ…å«äº†å®ä½“å¯¹è±¡çš„éªŒè¯ç»“æœã€‚</li></ol><h1 id="ä¸€ä¸ªå‚æ•°ä¼ å¤šä¸ªå€¼"><a href="#ä¸€ä¸ªå‚æ•°ä¼ å¤šä¸ªå€¼" class="headerlink" title="ä¸€ä¸ªå‚æ•°ä¼ å¤šä¸ªå€¼"></a>ä¸€ä¸ªå‚æ•°ä¼ å¤šä¸ªå€¼</h1><p>åœ¨æµè§ˆå™¨è¾“å…¥æ­¤URL<code>http://localhost:8080/admin/login.action?username=geek&amp;password=geek&amp;password=geek</code></p><p>ç»“æœå¾—åˆ°çš„å¯¹è±¡ä¸º ï¼š <code>Manager{username=&#39;geek&#39;, password=&#39;geek,geek&#39;}</code></p><p><strong>å‚è€ƒæ–‡æ¡£</strong>:</p><ol><li><a href="http://blog.csdn.net/walkerjong/article/details/7946109" target="_blank" rel="noopener">@RequestParam @RequestBody @PathVariable ç­‰å‚æ•°ç»‘å®šæ³¨è§£è¯¦è§£</a></li><li><a href="https://segmentfault.com/a/1190000005670764#articleHeader8" target="_blank" rel="noopener">SpringMVCä¹‹Controllerå¸¸ç”¨æ³¨è§£åŠŸèƒ½å…¨è§£æ</a></li><li><a href="http://wangwengcn.iteye.com/blog/1677024" target="_blank" rel="noopener">@ModelAttributeä½¿ç”¨è¯¦è§£</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Rediså’ŒMemcachedåŒºåˆ«</title>
      <link href="/Redis-and-Memcached-difference/"/>
      <url>/Redis-and-Memcached-difference/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡å‚è€ƒ <a href="http://blog.51cto.com/gnucto/998509" target="_blank" rel="noopener">Redisä¸Memcachedçš„åŒºåˆ«</a>ã€‚</p><p>å¦‚æœç®€å•åœ°æ¯”è¾ƒRedisä¸Memcachedçš„åŒºåˆ«ï¼Œå¤§å¤šæ•°éƒ½ä¼šå¾—åˆ°ä»¥ä¸‹è§‚ç‚¹ï¼š</p><ol><li>Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„k/vç±»å‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æ„çš„å­˜å‚¨ã€‚</li><li>Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚</li><li>Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿æŒåœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚</li></ol><p>æŠ›å¼€è¿™äº›ï¼Œå¯ä»¥æ·±å…¥åˆ°Rediså†…éƒ¨æ„é€ å»è§‚å¯Ÿæ›´åŠ æœ¬è´¨çš„åŒºåˆ«ï¼Œç†è§£Redisçš„è®¾è®¡ã€‚</p><a id="more"></a><h1 id="ç½‘ç»œIOæ¨¡å‹"><a href="#ç½‘ç»œIOæ¨¡å‹" class="headerlink" title="ç½‘ç»œIOæ¨¡å‹"></a>ç½‘ç»œIOæ¨¡å‹</h1><h2 id="Memcachedç½‘ç»œIOæ¨¡å‹"><a href="#Memcachedç½‘ç»œIOæ¨¡å‹" class="headerlink" title="Memcachedç½‘ç»œIOæ¨¡å‹"></a>Memcachedç½‘ç»œIOæ¨¡å‹</h2><p>Memcachedæ˜¯ <strong>å¤šçº¿ç¨‹éé˜»å¡IOå¤ç”¨</strong> çš„ç½‘ç»œæ¨¡å‹ï¼Œåˆ†ä¸ºç›‘å¬ä¸»çº¿ç¨‹å’Œworkerå­çº¿ç¨‹ï¼Œç›‘å¬çº¿ç¨‹ç›‘å¬ç½‘ç»œè¿æ¥ï¼Œæ¥å—è¯·æ±‚åï¼Œå°†è¿æ¥æè¿°å­—pipeä¼ é€’ç»™workerçº¿ç¨‹ï¼Œè¿›è¡Œè¯»å†™IO, ç½‘ç»œå±‚ä½¿ç”¨libeventå°è£…çš„äº‹ä»¶åº“ï¼Œå¤šçº¿ç¨‹æ¨¡å‹å¯ä»¥å‘æŒ¥å¤šæ ¸ä½œç”¨ï¼Œä½†æ˜¯å¼•å…¥äº†cache coherencyå’Œé”çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼ŒMemcachedæœ€å¸¸ç”¨çš„stats å‘½ä»¤ï¼Œå®é™…Memcachedæ‰€æœ‰æ“ä½œéƒ½è¦å¯¹è¿™ä¸ªå…¨å±€å˜é‡åŠ é”ï¼Œè¿›è¡Œè®¡æ•°ç­‰å·¥ä½œï¼Œå¸¦æ¥äº†æ€§èƒ½æŸè€—ã€‚</p><p><img src="https://images.morethink.cn/0dcb499bd022cea2069865875decc2b7.png" alt="" title="Memcachedç½‘ç»œIOæ¨¡å‹"></p><h2 id="Redisç½‘ç»œIOæ¨¡å‹"><a href="#Redisç½‘ç»œIOæ¨¡å‹" class="headerlink" title="Redisç½‘ç»œIOæ¨¡å‹"></a>Redisç½‘ç»œIOæ¨¡å‹</h2><p>Redisä½¿ç”¨ <strong>å•çº¿ç¨‹éé˜»å¡IOå¤ç”¨</strong> æ¨¡å‹ï¼Œè‡ªå·±å°è£…äº†ä¸€ä¸ªç®€å•çš„AeEventäº‹ä»¶å¤„ç†æ¡†æ¶ï¼Œä¸»è¦å®ç°äº†epollã€kqueueå’Œselectï¼Œå¯¹äºå•çº¯åªæœ‰IOæ“ä½œæ¥è¯´ï¼Œå•çº¿ç¨‹å¯ä»¥å°†é€Ÿåº¦ä¼˜åŠ¿å‘æŒ¥åˆ°æœ€å¤§ï¼Œä½†æ˜¯ <strong>Redisä¹Ÿæä¾›äº†ä¸€äº›ç®€å•çš„è®¡ç®—åŠŸèƒ½ï¼Œæ¯”å¦‚æ’åºã€èšåˆç­‰ï¼Œå¯¹äºè¿™äº›æ“ä½œï¼Œå•çº¿ç¨‹æ¨¡å‹å®é™…ä¼šä¸¥é‡å½±å“æ•´ä½“ååé‡ï¼ŒCPUè®¡ç®—è¿‡ç¨‹ä¸­ï¼Œæ•´ä¸ªIOè°ƒåº¦éƒ½æ˜¯è¢«é˜»å¡ä½çš„</strong>ã€‚</p><h1 id="å†…å­˜ç®¡ç†æ–¹é¢"><a href="#å†…å­˜ç®¡ç†æ–¹é¢" class="headerlink" title="å†…å­˜ç®¡ç†æ–¹é¢"></a>å†…å­˜ç®¡ç†æ–¹é¢</h1><ul><li>Memcachedä½¿ç”¨é¢„åˆ†é…çš„å†…å­˜æ± çš„æ–¹å¼ï¼Œä½¿ç”¨slabå’Œå¤§å°ä¸åŒçš„chunkæ¥ç®¡ç†å†…å­˜ï¼ŒItemæ ¹æ®å¤§å°é€‰æ‹©åˆé€‚çš„chunkå­˜å‚¨ï¼Œå†…å­˜æ± çš„æ–¹å¼å¯ä»¥çœå»ç”³è¯·/é‡Šæ”¾å†…å­˜çš„å¼€é”€ï¼Œå¹¶ä¸”èƒ½å‡å°å†…å­˜ç¢ç‰‡äº§ç”Ÿï¼Œä½†è¿™ç§æ–¹å¼ä¹Ÿä¼šå¸¦æ¥ä¸€å®šç¨‹åº¦ä¸Šçš„ç©ºé—´æµªè´¹ï¼Œå¹¶ä¸”åœ¨å†…å­˜ä»ç„¶æœ‰å¾ˆå¤§ç©ºé—´æ—¶ï¼Œæ–°çš„æ•°æ®ä¹Ÿå¯èƒ½ä¼šè¢«å‰”é™¤ï¼ŒåŸå› å¯ä»¥å‚è€ƒTimyangçš„æ–‡ç« ï¼š <a href="http://timyang.net/data/Memcached-lru-evictions/" target="_blank" rel="noopener">http://timyang.net/data/Memcached-lru-evictions/</a></li><li>Redisä½¿ç”¨ç°åœºç”³è¯·å†…å­˜çš„æ–¹å¼æ¥å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”å¾ˆå°‘ä½¿ç”¨free-listç­‰æ–¹å¼æ¥ä¼˜åŒ–å†…å­˜åˆ†é…ï¼Œä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå­˜åœ¨å†…å­˜ç¢ç‰‡ï¼ŒRedisè·Ÿæ®å­˜å‚¨å‘½ä»¤å‚æ•°ï¼Œä¼šæŠŠå¸¦è¿‡æœŸæ—¶é—´çš„æ•°æ®å•ç‹¬å­˜æ”¾åœ¨ä¸€èµ·ï¼Œå¹¶æŠŠå®ƒä»¬ç§°ä¸ºä¸´æ—¶æ•°æ®ï¼Œéä¸´æ—¶æ•°æ®æ˜¯æ°¸è¿œä¸ä¼šè¢«å‰”é™¤çš„ï¼Œå³ä¾¿ç‰©ç†å†…å­˜ä¸å¤Ÿï¼Œå¯¼è‡´swapä¹Ÿä¸ä¼šå‰”é™¤ä»»ä½•éä¸´æ—¶æ•°æ®(ä½†ä¼šå°è¯•å‰”é™¤éƒ¨åˆ†ä¸´æ—¶æ•°æ®)ï¼Œè¿™ç‚¹ä¸Š <strong>Redisæ›´é€‚åˆä½œä¸ºå­˜å‚¨è€Œä¸æ˜¯cache</strong>ã€‚</li></ul><h1 id="æ•°æ®ä¸€è‡´æ€§é—®é¢˜"><a href="#æ•°æ®ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="æ•°æ®ä¸€è‡´æ€§é—®é¢˜"></a>æ•°æ®ä¸€è‡´æ€§é—®é¢˜</h1><ul><li>Memcachedæä¾›äº†caså‘½ä»¤ï¼Œå¯ä»¥ä¿è¯å¤šä¸ªå¹¶å‘è®¿é—®æ“ä½œåŒä¸€ä»½æ•°æ®çš„ä¸€è‡´æ€§é—®é¢˜ã€‚</li><li>Redisæ²¡æœ‰æä¾›caså‘½ä»¤ï¼Œå¹¶ä¸èƒ½ä¿è¯è¿™ç‚¹ï¼Œä¸è¿‡Redisæä¾›äº†äº‹åŠ¡çš„åŠŸèƒ½ï¼Œå¯ä»¥ä¿è¯ä¸€ä¸²å‘½ä»¤çš„åŸå­æ€§ï¼Œä¸­é—´ä¸ä¼šè¢«ä»»ä½•æ“ä½œæ‰“æ–­ã€‚</li></ul><h1 id="é›†ç¾¤ç®¡ç†çš„ä¸åŒ"><a href="#é›†ç¾¤ç®¡ç†çš„ä¸åŒ" class="headerlink" title="é›†ç¾¤ç®¡ç†çš„ä¸åŒ"></a>é›†ç¾¤ç®¡ç†çš„ä¸åŒ</h1><p>Memcachedæ˜¯å…¨å†…å­˜çš„æ•°æ®ç¼“å†²ç³»ç»Ÿï¼ŒRedisè™½ç„¶æ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œä½†æ˜¯å…¨å†…å­˜æ¯•ç«Ÿæ‰æ˜¯å…¶é«˜æ€§èƒ½çš„æœ¬è´¨ã€‚ä½œä¸ºåŸºäºå†…å­˜çš„å­˜å‚¨ç³»ç»Ÿæ¥è¯´ï¼Œæœºå™¨ç‰©ç†å†…å­˜çš„å¤§å°å°±æ˜¯ç³»ç»Ÿèƒ½å¤Ÿå®¹çº³çš„æœ€å¤§æ•°æ®é‡ã€‚å¦‚æœéœ€è¦å¤„ç†çš„æ•°æ®é‡è¶…è¿‡äº†å•å°æœºå™¨çš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå°±éœ€è¦æ„å»ºåˆ†å¸ƒå¼é›†ç¾¤æ¥æ‰©å±•å­˜å‚¨èƒ½åŠ›ã€‚</p><h2 id="åˆ†å¸ƒå¼Memcached"><a href="#åˆ†å¸ƒå¼Memcached" class="headerlink" title="åˆ†å¸ƒå¼Memcached"></a>åˆ†å¸ƒå¼Memcached</h2><p><strong>Memcachedæœ¬èº«å¹¶ä¸æ”¯æŒåˆ†å¸ƒå¼</strong>ï¼Œå› æ­¤åªèƒ½åœ¨å®¢æˆ·ç«¯é€šè¿‡åƒä¸€è‡´æ€§å“ˆå¸Œè¿™æ ·çš„åˆ†å¸ƒå¼ç®—æ³•æ¥å®ç°Memcachedçš„åˆ†å¸ƒå¼å­˜å‚¨ã€‚ä¸‹å›¾ç»™å‡ºäº†Memcachedçš„åˆ†å¸ƒå¼å­˜å‚¨å®ç°æ¶æ„ã€‚å½“å®¢æˆ·ç«¯å‘Memcachedé›†ç¾¤å‘é€æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆä¼šé€šè¿‡å†…ç½®çš„åˆ†å¸ƒå¼ç®—æ³•è®¡ç®—å‡ºè¯¥æ¡æ•°æ®çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œç„¶åæ•°æ®ä¼šç›´æ¥å‘é€åˆ°è¯¥èŠ‚ç‚¹ä¸Šå­˜å‚¨ã€‚ä½†å®¢æˆ·ç«¯æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒåŒæ ·è¦è®¡ç®—å‡ºæŸ¥è¯¢æ•°æ®æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œç„¶åç›´æ¥å‘è¯¥èŠ‚ç‚¹å‘é€æŸ¥è¯¢è¯·æ±‚ä»¥è·å–æ•°æ®ã€‚</p><p><img src="https://images.morethink.cn/b4dc233573a34d272d52a270ff01d3f8.png" alt="" title="åˆ†å¸ƒå¼Memcached"></p><h2 id="Redis-Cluster"><a href="#Redis-Cluster" class="headerlink" title="Redis Cluster"></a>Redis Cluster</h2><p>ç›¸è¾ƒäºMemcachedåªèƒ½é‡‡ç”¨å®¢æˆ·ç«¯å®ç°åˆ†å¸ƒå¼å­˜å‚¨ï¼ŒRedisæ›´åå‘äºåœ¨æœåŠ¡å™¨ç«¯æ„å»ºåˆ†å¸ƒå¼å­˜å‚¨ã€‚æœ€æ–°ç‰ˆæœ¬çš„Rediså·²ç»æ”¯æŒäº†åˆ†å¸ƒå¼å­˜å‚¨åŠŸèƒ½ã€‚Redis Clusteræ˜¯ä¸€ä¸ªå®ç°äº†åˆ†å¸ƒå¼ä¸”å…è®¸å•ç‚¹æ•…éšœçš„Redisé«˜çº§ç‰ˆæœ¬ï¼Œå®ƒæ²¡æœ‰ä¸­å¿ƒèŠ‚ç‚¹ï¼Œå…·æœ‰çº¿æ€§å¯ä¼¸ç¼©çš„åŠŸèƒ½ã€‚ä¸‹å›¾ç»™å‡ºRedis Clusterçš„åˆ†å¸ƒå¼å­˜å‚¨æ¶æ„ï¼Œå…¶ä¸­èŠ‚ç‚¹ä¸èŠ‚ç‚¹ä¹‹é—´é€šè¿‡äºŒè¿›åˆ¶åè®®è¿›è¡Œé€šä¿¡ï¼ŒèŠ‚ç‚¹ä¸å®¢æˆ·ç«¯ä¹‹é—´é€šè¿‡asciiåè®®è¿›è¡Œé€šä¿¡ã€‚åœ¨æ•°æ®çš„æ”¾ç½®ç­–ç•¥ä¸Šï¼ŒRedis Clusterå°†æ•´ä¸ªkeyçš„æ•°å€¼åŸŸåˆ†æˆ4096ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šå¯ä»¥å­˜å‚¨ä¸€ä¸ªæˆ–å¤šä¸ªå“ˆå¸Œæ§½ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰Redis Clusteræ”¯æŒçš„æœ€å¤§èŠ‚ç‚¹æ•°å°±æ˜¯4096ã€‚Redis Clusterä½¿ç”¨çš„åˆ†å¸ƒå¼ç®—æ³•ä¹Ÿå¾ˆç®€å•ï¼š<code>crc16( key ) %HASH_SLOTS_NUMBER</code>ã€‚</p><p><img src="https://images.morethink.cn/ecb156696a22333a19ea5647b7eaefcc.png" alt="" title="Redis-Cluster"></p><p>ä¸ºäº†ä¿è¯å•ç‚¹æ•…éšœä¸‹çš„æ•°æ®å¯ç”¨æ€§ï¼ŒRedis Clusterå¼•å…¥äº†MasterèŠ‚ç‚¹å’ŒSlaveèŠ‚ç‚¹ã€‚åœ¨Redis Clusterä¸­ï¼Œæ¯ä¸ªMasterèŠ‚ç‚¹éƒ½ä¼šæœ‰å¯¹åº”çš„ä¸¤ä¸ªç”¨äºå†—ä½™çš„SlaveèŠ‚ç‚¹ã€‚è¿™æ ·åœ¨æ•´ä¸ªé›†ç¾¤ä¸­ï¼Œä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹çš„å®•æœºéƒ½ä¸ä¼šå¯¼è‡´æ•°æ®çš„ä¸å¯ç”¨ã€‚å½“MasterèŠ‚ç‚¹é€€å‡ºåï¼Œé›†ç¾¤ä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªSlaveèŠ‚ç‚¹æˆä¸ºæ–°çš„MasterèŠ‚ç‚¹ã€‚</p><p><img src="https://images.morethink.cn/c7b06587ee2b47925a540cc1c10ca44f.png" alt="" title="Redis-Cluster-2"></p><h1 id="å­˜å‚¨æ–¹å¼åŠå…¶å®ƒæ–¹é¢"><a href="#å­˜å‚¨æ–¹å¼åŠå…¶å®ƒæ–¹é¢" class="headerlink" title="å­˜å‚¨æ–¹å¼åŠå…¶å®ƒæ–¹é¢"></a>å­˜å‚¨æ–¹å¼åŠå…¶å®ƒæ–¹é¢</h1><ul><li>MemcachedåŸºæœ¬åªæ”¯æŒç®€å•çš„key-valueå­˜å‚¨ï¼Œä¸æ”¯æŒæšä¸¾ï¼Œä¸æ”¯æŒæŒä¹…åŒ–å’Œå¤åˆ¶ç­‰åŠŸèƒ½</li><li>Redisé™¤key/valueä¹‹å¤–ï¼Œè¿˜æ”¯æŒlist,set,sorted set,hashç­‰ä¼—å¤šæ•°æ®ç»“æ„ï¼Œæä¾›äº†KEYSè¿›è¡Œæšä¸¾æ“ä½œï¼Œä½†ä¸èƒ½åœ¨çº¿ä¸Šä½¿ç”¨ï¼Œå¦‚æœéœ€è¦æšä¸¾çº¿ä¸Šæ•°æ®ï¼ŒRedisæä¾›äº†å·¥å…·å¯ä»¥ç›´æ¥æ‰«æå…¶dumpæ–‡ä»¶ï¼Œæšä¸¾å‡ºæ‰€æœ‰æ•°æ®ï¼ŒRedisè¿˜åŒæ—¶æä¾›äº†æŒä¹…åŒ–å’Œå¤åˆ¶ç­‰åŠŸèƒ½ã€‚</li></ul><p><strong>æ ¹æ®ä»¥ä¸Šæ¯”è¾ƒä¸éš¾çœ‹å‡ºï¼Œå½“æˆ‘ä»¬ä¸å¸Œæœ›æ•°æ®è¢«è¸¢å‡ºï¼Œæˆ–è€…éœ€è¦é™¤key/valueä¹‹å¤–çš„æ›´å¤šæ•°æ®ç±»å‹æ—¶ï¼Œæˆ–è€…éœ€è¦è½åœ°åŠŸèƒ½æ—¶ï¼Œä½¿ç”¨Redisæ¯”ä½¿ç”¨Memcachedæ›´åˆé€‚</strong>ã€‚</p><h1 id="å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜æ•ˆ"><a href="#å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜æ•ˆ" class="headerlink" title="å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜æ•ˆ"></a>å•çº¿ç¨‹çš„Redisä¸ºä»€ä¹ˆè¿™ä¹ˆé«˜æ•ˆ</h1><h2 id="å•çº¿ç¨‹æ¨¡å‹"><a href="#å•çº¿ç¨‹æ¨¡å‹" class="headerlink" title="å•çº¿ç¨‹æ¨¡å‹"></a>å•çº¿ç¨‹æ¨¡å‹</h2><p>Rediså®¢æˆ·ç«¯å¯¹æœåŠ¡ç«¯çš„æ¯æ¬¡è°ƒç”¨éƒ½ç»å†äº†å‘é€å‘½ä»¤ï¼Œæ‰§è¡Œå‘½ä»¤ï¼Œè¿”å›ç»“æœä¸‰ä¸ªè¿‡ç¨‹ã€‚å…¶ä¸­æ‰§è¡Œå‘½ä»¤é˜¶æ®µï¼Œç”±äºRedisæ˜¯å•çº¿ç¨‹æ¥å¤„ç†å‘½ä»¤çš„ï¼Œæ‰€æœ‰æ¯ä¸€æ¡åˆ°è¾¾æœåŠ¡ç«¯çš„å‘½ä»¤ä¸ä¼šç«‹åˆ»æ‰§è¡Œï¼Œæ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šè¿›å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç„¶åé€ä¸ªè¢«æ‰§è¡Œã€‚å¹¶ä¸”å¤šä¸ªå®¢æˆ·ç«¯å‘é€çš„å‘½ä»¤çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„ã€‚ä½†æ˜¯å¯ä»¥ç¡®å®šçš„æ˜¯ä¸ä¼šæœ‰ä¸¤æ¡å‘½ä»¤è¢«åŒæ—¶æ‰§è¡Œï¼Œä¸ä¼šäº§ç”Ÿå¹¶å‘é—®é¢˜ï¼Œè¿™å°±æ˜¯Redisçš„å•çº¿ç¨‹åŸºæœ¬æ¨¡å‹ã€‚</p><h2 id="å•çº¿ç¨‹æ¨¡å‹æ¯ç§’ä¸‡çº§åˆ«å¤„ç†èƒ½åŠ›çš„åŸå› "><a href="#å•çº¿ç¨‹æ¨¡å‹æ¯ç§’ä¸‡çº§åˆ«å¤„ç†èƒ½åŠ›çš„åŸå› " class="headerlink" title="å•çº¿ç¨‹æ¨¡å‹æ¯ç§’ä¸‡çº§åˆ«å¤„ç†èƒ½åŠ›çš„åŸå› "></a>å•çº¿ç¨‹æ¨¡å‹æ¯ç§’ä¸‡çº§åˆ«å¤„ç†èƒ½åŠ›çš„åŸå› </h2><ol><li>çº¯å†…å­˜è®¿é—®ã€‚æ•°æ®å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œå†…å­˜çš„å“åº”æ—¶é—´å¤§çº¦æ˜¯100çº³ç§’ï¼Œè¿™æ˜¯Redisæ¯ç§’ä¸‡äº¿çº§åˆ«è®¿é—®çš„é‡è¦åŸºç¡€ã€‚</li><li>éé˜»å¡I/Oï¼ŒRedisé‡‡ç”¨epollåšä¸ºI/Oå¤šè·¯å¤ç”¨æŠ€æœ¯çš„å®ç°ï¼Œå†åŠ ä¸ŠRedisè‡ªèº«çš„äº‹ä»¶å¤„ç†æ¨¡å‹å°†epollä¸­çš„è¿æ¥ï¼Œè¯»å†™ï¼Œå…³é—­éƒ½è½¬æ¢ä¸ºäº†æ—¶é—´ï¼Œä¸åœ¨I/Oä¸Šæµªè´¹è¿‡å¤šçš„æ—¶é—´ã€‚</li><li>å•çº¿ç¨‹é¿å…äº†çº¿ç¨‹åˆ‡æ¢å’Œç«æ€äº§ç”Ÿçš„æ¶ˆè€—ã€‚</li><li>Redisé‡‡ç”¨å•çº¿ç¨‹æ¨¡å‹ï¼Œæ¯æ¡å‘½ä»¤æ‰§è¡Œå¦‚æœå ç”¨å¤§é‡æ—¶é—´ï¼Œä¼šé€ æˆå…¶ä»–çº¿ç¨‹é˜»å¡ï¼Œå¯¹äºRedisè¿™ç§é«˜æ€§èƒ½æœåŠ¡æ˜¯è‡´å‘½çš„ï¼Œæ‰€ä»¥Redisæ˜¯é¢å‘é«˜é€Ÿæ‰§è¡Œçš„æ•°æ®åº“ã€‚</li></ol><p><strong>æ€»ç»“</strong>ï¼š<br>ã€€ã€€1. Redisä½¿ç”¨æœ€ä½³æ–¹å¼æ˜¯å…¨éƒ¨æ•°æ®in-memoryã€‚<br>ã€€ã€€2. Redisæ›´å¤šåœºæ™¯æ˜¯ä½œä¸ºMemcachedçš„æ›¿ä»£è€…æ¥ä½¿ç”¨ã€‚<br>ã€€ã€€3. å½“éœ€è¦é™¤key/valueä¹‹å¤–çš„æ›´å¤šæ•°æ®ç±»å‹æ”¯æŒæ—¶ï¼Œä½¿ç”¨Redisæ›´åˆé€‚ã€‚<br>ã€€ã€€4. å½“å­˜å‚¨çš„æ•°æ®ä¸èƒ½è¢«å‰”é™¤æ—¶ï¼Œä½¿ç”¨Redisæ›´åˆé€‚ã€‚<br>ã€€ã€€5. éœ€è¦åˆ†å¸ƒå¼éƒ¨ç½²æ—¶ï¼Œä½¿ç”¨Redisæ›´åˆé€‚ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://blog.51cto.com/gnucto/998509" target="_blank" rel="noopener">Redisä¸Memcachedçš„åŒºåˆ«</a></li><li><a href="https://www.biaodianfu.com/redis-vs-memcached.html?spm=5176.100239.blogcont238409.17.w1SLGA" target="_blank" rel="noopener">Rediså’ŒMemcachedçš„åŒºåˆ«</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
            <tag> Memcached </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¸¸ç”¨ç¼–ç¨‹å·¥å…·å¿«æ·é”®æ•´ç†</title>
      <link href="/Common-programming-tools-shortcut-keys/"/>
      <url>/Common-programming-tools-shortcut-keys/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä¸»è¦æ•´ç†å¸¸ç”¨ç¼–ç¨‹å·¥å…·çš„å¿«æ·é”®ã€‚</p><a id="more"></a><h1 id="Navicat-for-mysql-å¿«æ·é”®"><a href="#Navicat-for-mysql-å¿«æ·é”®" class="headerlink" title="Navicat for mysql å¿«æ·é”®"></a>Navicat for mysql å¿«æ·é”®</h1><ol><li>Ctrl+Q           æ‰“å¼€æŸ¥è¯¢çª—å£</li><li>Ctrl+/            æ³¨é‡Šsqlè¯­å¥</li><li>Ctrl+Shift +/  è§£é™¤æ³¨é‡Š</li><li>Ctrl+R           è¿è¡ŒæŸ¥è¯¢çª—å£çš„sqlè¯­å¥</li><li>Ctrl+Shift+R   åªè¿è¡Œé€‰ä¸­çš„sqlè¯­å¥</li><li>F6               æ‰“å¼€ä¸€ä¸ªmysqlå‘½ä»¤è¡Œçª—å£</li><li>Ctrl+L            åˆ é™¤ä¸€è¡Œ</li><li>Ctrl+N           æ‰“å¼€ä¸€ä¸ªæ–°çš„æŸ¥è¯¢çª—å£</li><li>Ctrl+W          å…³é—­ä¸€ä¸ªæŸ¥è¯¢çª—å£</li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
            <tag> æ•ˆç‡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SpringMVCæ•°æ®éªŒè¯(AOPå¤„ç†Errorså’Œæ–¹æ³•éªŒè¯)</title>
      <link href="/SpringMVC-Bean-Validation/"/>
      <url>/SpringMVC-Bean-Validation/</url>
      
        <content type="html"><![CDATA[<p>ä»€ä¹ˆæ˜¯JSR303ï¼Ÿ</p><p>JSR 303 â€“ Bean Validation æ˜¯ä¸€ä¸ªæ•°æ®éªŒè¯çš„è§„èŒƒï¼Œ2009 å¹´ 11 æœˆç¡®å®šæœ€ç»ˆæ–¹æ¡ˆã€‚<br>Hibernate Validator æ˜¯ Bean Validation çš„æœ€ä½³å®è·µã€‚</p><p>ä¸ºä»€ä¹ˆä½¿ç”¨JSRï¼Œæ¾è€¦åˆï¼Œè®©ä¸šåŠ¡ä»£ç çš„èŒè´£æ›´åŠ æ¸…æ™°ã€‚</p><p>æ¾è€¦åˆå°±æ˜¯èŒè´£æ›´åŠ æ¸…æ™°ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„èŒè´£ï¼Œå¦‚æœä½ çš„ä»£ç è¿›è¡Œæ”¹åŠ¨ï¼Œæˆ‘ä¸ç”¨æ”¹åŠ¨æˆ–è€…ä»…ä»…å°‘é‡æ”¹åŠ¨å°±å¯ä»¥å‘å¸ƒå’Œéƒ¨ç½²ã€‚<br><a id="more"></a></p><h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><h2 id="maven-é…ç½®"><a href="#maven-é…ç½®" class="headerlink" title="maven é…ç½®"></a>maven é…ç½®</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- JSR 303 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.validation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>validation-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.0.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Hibernate validator--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.hibernate<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hibernate-validator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.0.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="SpringMVC-é…ç½®"><a href="#SpringMVC-é…ç½®" class="headerlink" title="SpringMVC é…ç½®"></a>SpringMVC é…ç½®</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">validator</span>=<span class="string">"validator"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®æ ¡éªŒå™¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validator"</span> <span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ ¡éªŒå™¨ï¼Œä½¿ç”¨Hibernateæ ¡éªŒå™¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"providerClass"</span> <span class="attr">value</span>=<span class="string">"org.hibernate.validator.HibernateValidator"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŒ‡å®šæ ¡éªŒä½¿ç”¨çš„èµ„æºæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶ä¸­é…ç½®æ ¡éªŒé”™è¯¯ä¿¡æ¯ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™é»˜è®¤ä½¿ç”¨classpathä¸‹é¢çš„ValidationMessages.propertiesæ–‡ä»¶ï¼Œ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationMessageSource"</span> <span class="attr">ref</span>=<span class="string">"messageSource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ ¡éªŒé”™è¯¯ä¿¡æ¯é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¸é…ç½®ï¼Œç›´æ¥ä½¿ç”¨æ³¨è§£ä¸­çš„messageå³å¯ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"messageSource"</span> <span class="attr">class</span>=<span class="string">"org.springframework.context.support.ReloadableResourceBundleMessageSource"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- èµ„æºæ–‡ä»¶å --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basenames"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:messageSource<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- èµ„æºæ–‡ä»¶ç¼–ç æ ¼å¼ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"fileEncodings"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å¯¹èµ„æºæ–‡ä»¶å†…å®¹ç¼“å­˜æ—¶é—´ï¼Œå•ä½ç§’ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cacheSeconds"</span> <span class="attr">value</span>=<span class="string">"120"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="å¸¸ç”¨æ ¡éªŒæ³¨è§£"><a href="#å¸¸ç”¨æ ¡éªŒæ³¨è§£" class="headerlink" title="å¸¸ç”¨æ ¡éªŒæ³¨è§£"></a>å¸¸ç”¨æ ¡éªŒæ³¨è§£</h1><table><thead><tr><th>æ³¨è§£</th><th>è¿è¡Œæ—¶æ£€æŸ¥</th></tr></thead><tbody><tr><td>@AssertFalse</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºfalse</td></tr><tr><td>@AssertTrue</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºtrue</td></tr><tr><td>@DecimalMax(value)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</td></tr><tr><td>@DecimalMin(Value)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</td></tr><tr><td>@Digits(integer=, fraction=)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»åœ¨å¯æ¥å—çš„èŒƒå›´å†…</td></tr><tr><td>@Future</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»æ˜¯æ—¥æœŸï¼Œæ£€æŸ¥ç»™å®šçš„æ—¥æœŸæ˜¯å¦æ¯”ç°åœ¨æ™š</td></tr><tr><td>@Max(value)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</td></tr><tr><td>@Min(value)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</td></tr><tr><td>@NotNull</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ä¸ºnull</td></tr><tr><td>@Null</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ä¸ºnull</td></tr><tr><td>@Past(java.util.Date/Calendar)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»è¿‡å»çš„æ—¥æœŸï¼Œæ£€æŸ¥æ ‡æ³¨å¯¹è±¡ä¸­çš„å€¼è¡¨ç¤ºçš„æ—¥æœŸæ¯”å½“å‰æ—©</td></tr><tr><td>@Pattern(regex=, flag=)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ£€æŸ¥è¯¥å­—ç¬¦ä¸²æ˜¯å¦èƒ½å¤Ÿåœ¨matchæŒ‡å®šçš„æƒ…å†µä¸‹è¢«regexå®šä¹‰çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</td></tr><tr><td>@Size(min=, max=)</td><td>è¢«æ³¨è§£çš„å…ƒç´ å¿…é¡»åœ¨åˆ¶å®šçš„èŒƒå›´(æ•°æ®ç±»å‹:String, Collection, Map and arrays)</td></tr><tr><td>@Valid</td><td>é€’å½’çš„å¯¹å…³è”å¯¹è±¡è¿›è¡Œæ ¡éªŒ, å¦‚æœå…³è”å¯¹è±¡æ˜¯ä¸ªé›†åˆæˆ–è€…æ•°ç»„, é‚£ä¹ˆå¯¹å…¶ä¸­çš„å…ƒç´ è¿›è¡Œé€’å½’æ ¡éªŒ,å¦‚æœæ˜¯ä¸€ä¸ªmap,åˆ™å¯¹å…¶ä¸­çš„å€¼éƒ¨åˆ†è¿›è¡Œæ ¡éªŒ</td></tr><tr><td>@CreditCardNumber</td><td>å¯¹ä¿¡ç”¨å¡å·è¿›è¡Œä¸€ä¸ªå¤§è‡´çš„éªŒè¯</td></tr><tr><td>@Email</td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ç”µå­é‚®ç®±åœ°å€</td></tr><tr><td>@Length(min=, max=)</td><td>è¢«æ³¨è§£çš„å¯¹è±¡å¿…é¡»æ˜¯å­—ç¬¦ä¸²çš„å¤§å°å¿…é¡»åœ¨åˆ¶å®šçš„èŒƒå›´å†…</td></tr><tr><td>@NotBlank</td><td>è¢«æ³¨è§£çš„å¯¹è±¡å¿…é¡»ä¸ºå­—ç¬¦ä¸²ï¼Œä¸èƒ½ä¸ºç©ºï¼Œæ£€æŸ¥æ—¶ä¼šå°†ç©ºæ ¼å¿½ç•¥</td></tr><tr><td>@NotEmpty</td><td>è¢«æ³¨é‡Šçš„å¯¹è±¡å¿…é¡»ä¸ä¸ºç©º(æ•°æ®:String,Collection,Map,arrays)</td></tr><tr><td>@Range(min=, max=)</td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†… (æ•°æ®ï¼šBigDecimal, BigInteger, String, byte, short, int, long and åŸå§‹ç±»å‹çš„åŒ…è£…ç±» )</td></tr><tr><td>@URL(protocol=, host=, port=, regexp=, flags=)</td><td>è¢«æ³¨è§£çš„å¯¹è±¡å¿…é¡»æ˜¯å­—ç¬¦ä¸²ï¼Œæ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„URLï¼Œå¦‚æœæä¾›äº†protocolï¼Œhostç­‰ï¼Œåˆ™è¯¥URLè¿˜éœ€æ»¡è¶³æä¾›çš„æ¡ä»¶</td></tr><tr><td></td></tr></tbody></table><h1 id="BeanéªŒè¯"><a href="#BeanéªŒè¯" class="headerlink" title="BeanéªŒè¯"></a>BeanéªŒè¯</h1><p>é¦–å…ˆå‘æˆ‘ä»¬çš„beanä¸­æ·»åŠ æ³¨è§£ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotEmpty</span>(message = <span class="string">"ç”¨æˆ·åä¸ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="meta">@NotEmpty</span>(message = <span class="string">"å¯†ç ä¸ä¸ºç©º"</span>)</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">// getter å’Œ setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Controller</code>ä¸­é…ç½®:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(@Validated User user, Errors errors)</span> </span>&#123;</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="keyword">if</span> (errors.hasErrors()) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.messageResult(errors);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.SUCCESS_RESULT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åªéœ€è¦åœ¨è¦æ ¡éªŒçš„beanå‰é¢æ·»åŠ <code>@Validated</code>ï¼Œåœ¨éœ€è¦æ ¡éªŒçš„beanåé¢æ·»åŠ <code>Errors</code>å¯¹è±¡æ¥æ¥æ”¶æ ¡éªŒå‡ºé”™ä¿¡æ¯å³å¯ï¼Œç„¶åæ ¹æ®é”™è¯¯ä¿¡æ¯è¿›è¡Œåˆ¤æ–­å’Œè¿”å›é”™è¯¯ä¿¡æ¯ç»™å‰ç«¯ã€‚</p><p><strong>æ³¨æ„</strong>ï¼š<br><code>@Validated</code> å’Œ <code>Errors errors</code> æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå¹¶ä¸”å½¢å‚é¡ºåºæ˜¯å›ºå®šçš„ï¼ˆä¸€å‰ä¸€åï¼‰ã€‚ä¹Ÿå°±æ˜¯æ‰€æ¯ä¸€ä¸ª<code>@Validated</code>åé¢å¿…é¡»è·Ÿä¸€ä¸ª<code>Errors</code>ï¼Œéœ€è¦éªŒè¯å¤šä¸ªbeanï¼Œåé¢å°±è·Ÿå¤šä¸ª<code>Errors</code>ã€‚</p><h1 id="AOPå¤„ç†Errors"><a href="#AOPå¤„ç†Errors" class="headerlink" title="AOPå¤„ç†Errors"></a>AOPå¤„ç†Errors</h1><p>å¦‚æœæˆ‘ä»¬é€šè¿‡JSRæ¥éªŒè¯beanå¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨æ¯ä¸ªéœ€è¦éªŒè¯çš„æ–¹æ³•ä¸­éƒ½éœ€è¦å¤„ç†Errorå¯¹è±¡ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°å¯ä»¥é€šè¿‡AOPçš„æ–¹å¼æ¥ç»Ÿä¸€å¤„ç†é”™è¯¯å¯¹è±¡ï¼Œå¹¶ä¸”ç»„ç»‡é”™è¯¯ä¿¡æ¯ï¼Œè¿”å›ç»™å‰ç«¯ã€‚</p><p>é€šè¿‡ä¸€ä¸ªç¯ç»•é€šçŸ¥å¯¹æ‰€æœ‰çš„actionæ–¹æ³•å°½å¿ƒæ‹¦æˆªï¼Œå¦‚æœå‘ç°æœ‰Errorså¯¹è±¡å­˜åœ¨ï¼Œå°±è·å–æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯ï¼Œå°è£…ä¸ºä¸€ä¸ªlistè¿”å›å‰ç«¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindingResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.Errors;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.ObjectError;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 2017/10/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidationAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ‡ç‚¹å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pjp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">aroundMethod</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Errors errors = <span class="keyword">null</span>;</span><br><span class="line">        Object[] args = pjp.getArgs();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != args &amp;&amp; args.length != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object object : args) &#123;</span><br><span class="line">                <span class="keyword">if</span> (object <span class="keyword">instanceof</span> BindingResult) &#123;</span><br><span class="line">                    errors = (BindingResult) object;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (errors != <span class="keyword">null</span> &amp;&amp; errors.hasErrors()) &#123;</span><br><span class="line">            List&lt;ObjectError&gt; allErrors = errors.getAllErrors();</span><br><span class="line">            List&lt;String&gt; messages = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">for</span> (ObjectError error : allErrors) &#123;</span><br><span class="line">                messages.add(error.getDefaultMessage());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.messageResult(messages);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pjp.proceed();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Springé…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validationAdvice"</span> <span class="attr">class</span>=<span class="string">"studio.jikewang.util.ValidationAdvice"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">"validation1"</span> <span class="attr">expression</span>=<span class="string">"execution(public * studio.jikewang.action.*.*(..))"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspect</span> <span class="attr">id</span>=<span class="string">"validationAspect"</span> <span class="attr">ref</span>=<span class="string">"validationAdvice"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:around</span> <span class="attr">method</span>=<span class="string">"aroundMethod"</span> <span class="attr">pointcut-ref</span>=<span class="string">"validation1"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:aspect</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="Validated-å’Œ-Valid"><a href="#Validated-å’Œ-Valid" class="headerlink" title="@Validated å’Œ @Valid"></a><code>@Validated</code> å’Œ <code>@Valid</code></h1><ul><li><code>@Valid</code>æ˜¯ä½¿ç”¨Hibernate Validationçš„æ—¶å€™ä½¿ç”¨ã€‚<br>Javaçš„JSR303å£°æ˜äº†è¿™ç±»æ¥å£ï¼Œç„¶åhibernateï¼validatorå¯¹å…¶è¿›è¡Œäº†å®ç°ã€‚</li><li><code>@Validated</code>æ˜¯åªç”¨Spring Validatoræ ¡éªŒæœºåˆ¶ä½¿ç”¨ã€‚</li></ul><h1 id="æ–¹æ³•å‚æ•°éªŒè¯"><a href="#æ–¹æ³•å‚æ•°éªŒè¯" class="headerlink" title="æ–¹æ³•å‚æ•°éªŒè¯"></a>æ–¹æ³•å‚æ•°éªŒè¯</h1><p>Springæä¾›äº†<code>MethodValidationPostProcessor</code>ç±»ï¼Œç”¨äºå¯¹æ–¹æ³•çš„æ ¡éªŒã€‚</p><p><code>Controller</code>ä¸­é…ç½®:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(@NotEmpty(message = <span class="string">"ç”¨æˆ·åä¸ä¸ºç©º"</span>)</span> String username,</span></span><br><span class="line"><span class="function">                        @<span class="title">NotEmpty</span><span class="params">(message = <span class="string">"å¯†ç ä¸ä¸ºç©º"</span>)</span>  String password) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.SUCCESS_RESULT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>xmlé…ç½®(<strong>æœ€å¥½æ˜¯é…ç½®åœ¨<code>&lt;mvc:annotation-driven validator=&quot;validator&quot; /&gt;</code>ä¸Šé¢ï¼Œä¸ç„¶ä¼šæœ‰æœªçŸ¥é”™è¯¯</strong>)å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span>  <span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.MethodValidationPostProcessor"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æ ¡éªŒé‡åˆ°éæ³•çš„å‚æ•°æ—¶ä¼šæŠ›å‡º<code>ConstraintViolationException</code>ï¼Œå¯ä»¥é€šè¿‡<code>getConstraintViolations</code>è·å¾—æ‰€æœ‰æ²¡æœ‰é€šè¿‡çš„æ ¡éªŒ<code>ConstraintViolation</code>é›†åˆï¼Œå¯ä»¥é€šè¿‡å®ƒä»¬æ¥è·å¾—å¯¹åº”çš„æ¶ˆæ¯ã€‚</p><p>æˆ‘ä»¬åŒæ ·ä½¿ç”¨ <code>@ExceptionHandler</code> æ•æ‰<code>ConstraintViolationException</code>å¼‚å¸¸å¤„ç†å…¨å±€å¼‚å¸¸ä¿¡æ¯ã€‚</p><p>ç„¶åå°†æ‰€æœ‰çš„é”™è¯¯ä¿¡æ¯å°è£…å¥½è¿”å›ç»™å‰ç«¯ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyExceptionHandler</span> </span>&#123;</span><br><span class="line">       <span class="meta">@ExceptionHandler</span>(ConstraintViolationException.class)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">handleConstraintViolationException</span><span class="params">(ConstraintViolationException e)</span> </span>&#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">for</span> (ConstraintViolation&lt;?&gt; s : e.getConstraintViolations()) &#123;</span><br><span class="line">            System.out.println(s.getInvalidValue() + <span class="string">": "</span> + s.getMessage());</span><br><span class="line">            list.add(s.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result();</span><br><span class="line">        result.setStatus(<span class="string">"0"</span>);</span><br><span class="line">        result.setMessage(list);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä½¿ç”¨-ValidatedéªŒè¯list"><a href="#ä½¿ç”¨-ValidatedéªŒè¯list" class="headerlink" title="ä½¿ç”¨@ValidatedéªŒè¯list"></a>ä½¿ç”¨<code>@Validated</code>éªŒè¯list</h1><p>ç°åœ¨æˆ‘é‡åˆ°ä¸€ä¸ªæ–°çš„éœ€æ±‚ï¼Œæˆ‘éœ€è¦å‰ç«¯ç»™æˆ‘ä¼ é€’ä¸€ä¸ªå¯¹è±¡æ•°ç»„ï¼Œäºæ˜¯æˆ‘ä½¿ç”¨ä¸€ä¸ªlistå»æ¥æ”¶ï¼Œä½†æ˜¯æ— æ³•è·å¾—éªŒè¯ä¿¡æ¯ã€‚</p><p>äºæ˜¯å°†listé‡æ–°åŒ…è£…ä¸€ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidList</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Valid</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;E&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;E&gt; <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;E&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.list = list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Controller</code>ä¸­é…ç½®:</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserAction</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/login"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">login</span><span class="params">(@Validated ValidList&lt;User&gt; users, Errors errors)</span> </span>&#123;</span><br><span class="line">        System.out.println(users.getList());</span><br><span class="line">        <span class="keyword">if</span> (errors.hasErrors()) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.messageResult(errors);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.SUCCESS_RESULT;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä¸ºäº†åªè¿”å›ç¬¬ä¸€ä¸ªéªŒè¯å¤±è´¥çš„ä¿¡æ¯(å¦‚æœä¸æ›´æ”¹ï¼Œå°±ä¼šå°†æ‰€æœ‰çš„å‡ºé”™ä¿¡æ¯è¿”å›ç»™å‰ç«¯)ï¼Œæ›´æ”¹<code>ValidationAdvice</code>å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ValidationAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ‡ç‚¹å¤„ç†</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pjp</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">aroundMethod</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">        Object[] args = pjp.getArgs();</span><br><span class="line">        <span class="keyword">boolean</span> isValidList = <span class="keyword">false</span>;</span><br><span class="line">        Errors errors = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> != args &amp;&amp; args.length != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object object : args) &#123;</span><br><span class="line">                <span class="keyword">if</span> (object <span class="keyword">instanceof</span> ValidList) &#123;</span><br><span class="line">                    isValidList = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (object <span class="keyword">instanceof</span> BindingResult) &#123;</span><br><span class="line">                    errors = (BindingResult) object;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (errors != <span class="keyword">null</span> &amp;&amp; errors.hasErrors()) &#123;</span><br><span class="line">            List&lt;ObjectError&gt; allErrors = errors.getAllErrors();</span><br><span class="line">            List&lt;String&gt; messages = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">for</span> (ObjectError error : allErrors) &#123;</span><br><span class="line">                <span class="keyword">if</span> (isValidList) &#123;</span><br><span class="line">                    messages.add(error.getDefaultMessage());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    messages.add(error.getDefaultMessage());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.messageResult(messages);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pjp.proceed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·å³å¯éªŒè¯<code>list</code>ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>AOPçš„æ€æƒ³æ˜¯è´¯ç©¿æˆ‘ä»¬çš„å¼€å‘çš„ï¼Œä½¿ç”¨AOPçš„æ€æƒ³å¯ä»¥å¤§å¤§æé«˜æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.jianshu.com/p/fc6c20af759a" target="_blank" rel="noopener">springmvcå‚æ•°æ ¡éªŒ-JSR303(Bean Validationï¼‰</a></li><li><a href="http://www.cnblogs.com/beiyan/p/5946345.html" target="_blank" rel="noopener">Java Bean Validation æœ€ä½³å®è·µ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>æŸ¥è¯¢åœ¨ä¸€å¼ è¡¨ä¸åœ¨å¦å¤–ä¸€å¼ è¡¨çš„è®°å½•åŠæ•ˆç‡æ¢ç©¶</title>
      <link href="/records-in-a-table-but-not-in-another-table/"/>
      <url>/records-in-a-table-but-not-in-another-table/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘åšé¡¹ç›®çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œè¦å°†å­˜åœ¨äºè¡¨taè€Œä¸å­˜åœ¨äºè¡¨tbä¸­çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥ã€‚</p><p>è®°å½•ä½¿ç”¨çš„æ–¹æ³•å’Œæ¢è®¨æ•ˆç‡ã€‚</p><a id="more"></a><h1 id="æ•°æ®å‡†å¤‡"><a href="#æ•°æ®å‡†å¤‡" class="headerlink" title="æ•°æ®å‡†å¤‡"></a>æ•°æ®å‡†å¤‡</h1><p>åˆ›å»ºè¡¨taï¼Œå¹¶ä¸”ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹æ’å…¥13000æ¡æ•°æ®ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šè¿è¡Œæ—¶é—´: 346.719sã€‚å¦‚æœè§‰å¾—æ’å…¥çš„é€Ÿåº¦æ¯”è¾ƒæ…¢,å¯ä»¥ç›´æ¥å¯¼å…¥æˆ‘å»ºå¥½çš„è¡¨ï¼Œç™¾åº¦äº‘åœ°å€ <a href="http://pan.baidu.com/s/1dFtovg1" target="_blank" rel="noopener">http://pan.baidu.com/s/1dFtovg1</a> ï¼Œé‡Œé¢å·²ç»æœ‰æ•°æ®äº†ï¼Œç›´æ¥å¯¼å…¥sqlæ‰§è¡Œå³å¯ï¼Œè¿™æ ·æ¯”ç”¨å­˜å‚¨è¿‡ç¨‹è¦å¿«å¾ˆå¤šã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> ta;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`ta`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">13000</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> ta_insert;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> ta_insert()</span><br><span class="line"> MODIFIES <span class="keyword">SQL</span> <span class="keyword">DATA</span></span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line"> <span class="keyword">SET</span> @i=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">SET</span> @<span class="keyword">max</span>=<span class="number">13000</span>;</span><br><span class="line"> WHILE @i&lt;@max DO</span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`ta`</span> <span class="keyword">VALUES</span> ();</span><br><span class="line"> <span class="keyword">SET</span> @i = @i + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> ta_insert();</span><br></pre></td></tr></table></figure><p>åˆ›å»ºè¡¨tbï¼Œå¹¶ä¸”ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹æ’å…¥10000æ¡æ•°æ®ï¼Œåœ¨æˆ‘çš„æœºå™¨ä¸Šè¿è¡Œæ—¶é—´:  224.102sã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> tb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tb`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">8000</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> tb_insert;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> tb_insert()</span><br><span class="line"> MODIFIES <span class="keyword">SQL</span> <span class="keyword">DATA</span></span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line"> <span class="keyword">SET</span> @i=<span class="number">1</span>;</span><br><span class="line"> <span class="keyword">SET</span> @<span class="keyword">max</span>=<span class="number">8000</span>;</span><br><span class="line"> WHILE @i&lt;@max DO</span><br><span class="line"> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="string">`tb`</span> <span class="keyword">VALUES</span> ();</span><br><span class="line"> <span class="keyword">SET</span> @i = @i + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">WHILE</span>;</span><br><span class="line"><span class="keyword">end</span> $$</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> tb_insert();</span><br></pre></td></tr></table></figure><h1 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h1><p>ä½¿ç”¨<code>NOT IN</code>ï¼Œtaè¡¨ä¸­çš„æ¯ä¸€ä¸ªidå€¼éƒ½è¦å»ä¸tbè¡¨ä¸­çš„idåŒ¹é…ï¼ŒåŒ¹é…åˆ°å°±åœæ­¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜åœ¨äºtaè¡¨è€Œä¸å­˜åœ¨äºtbè¡¨çš„idå€¼éœ€è¦ä¸æ‰€æœ‰tbè¡¨ä¸­çš„idå€¼è¿›è¡ŒåŒ¹é…ã€‚</p><p>æ‰§è¡Œå­æŸ¥è¯¢æ—¶ï¼ŒMYSQLéœ€è¦åˆ›å»ºä¸´æ—¶è¡¨ï¼ŒæŸ¥è¯¢å®Œæ¯•åå†åˆ é™¤è¿™äº›ä¸´æ—¶è¡¨ï¼Œæ‰€ä»¥ï¼Œå­æŸ¥è¯¢çš„é€Ÿåº¦ä¼šå—åˆ°ä¸€å®šçš„å½±å“ï¼Œè¿™é‡Œå¤šäº†ä¸€ä¸ªåˆ›å»ºå’Œé”€æ¯ä¸´æ—¶è¡¨çš„è¿‡ç¨‹ã€‚</p><p>å¹³å‡æ—¶é—´ä¸º 0.04sã€‚<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ta.id <span class="keyword">FROM</span> ta <span class="keyword">WHERE</span> ta.id <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> tb)</span><br></pre></td></tr></table></figure></p><h1 id="å·¦è¿æ¥"><a href="#å·¦è¿æ¥" class="headerlink" title="å·¦è¿æ¥"></a>å·¦è¿æ¥</h1><p>ä½¿ç”¨ <code>LEFT JOIN</code>ï¼Œtaè¡¨å·¦è¿æ¥tbè¡¨ï¼Œè€Œå­˜åœ¨äºtaè¡¨ä¸å­˜åœ¨äºtbè¡¨ä¸­çš„å­—æ®µä¸º<code>NULL</code>ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­<code>WHERE tb.id IS NULL</code>æ¥æ‰¾åˆ°å­˜åœ¨äºtaè¡¨è€Œä¸å­˜åœ¨äºtbè¡¨çš„idå€¼ã€‚</p><p>å¹³å‡æ—¶é—´æ˜¯ 0.06sã€‚<br><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ta.id <span class="keyword">FROM</span> ta <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tb <span class="keyword">ON</span> ta.id = tb.id <span class="keyword">WHERE</span> tb.id <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure></p><h1 id="æ•ˆç‡ä¹‹è°œ"><a href="#æ•ˆç‡ä¹‹è°œ" class="headerlink" title="æ•ˆç‡ä¹‹è°œ"></a>æ•ˆç‡ä¹‹è°œ</h1><h2 id="ç‰ˆæœ¬é—®é¢˜ï¼Ÿ"><a href="#ç‰ˆæœ¬é—®é¢˜ï¼Ÿ" class="headerlink" title="ç‰ˆæœ¬é—®é¢˜ï¼Ÿ"></a>ç‰ˆæœ¬é—®é¢˜ï¼Ÿ</h2><p>æŒ‰ç†æ¥è¯´ï¼Œè¿æ¥åº”è¯¥æ¯”å­æŸ¥è¯¢è¦å¿«ï¼Œä½†æ˜¯åœ¨æˆ‘è¿›è¡Œè¯•éªŒçš„æ—¶å€™å‘ç°å´ä¸æ˜¯è¿™æ ·çš„ï¼Œå­æŸ¥è¯¢å±…ç„¶è¿˜æ¯”è¿æ¥è¦å¿«ã€‚</p><p><img src="https://images.morethink.cn/20ef641be3a9a9aa899e5e373e05eef9.png" alt="" title="ç–‘æƒ‘"></p><p>æœç´¢äº†è§£åˆ°</p><blockquote><p>å¯¹äºç±»ä¼¼NOT INè¿™æ ·çš„å­æŸ¥è¯¢ï¼Œä¹Ÿèƒ½å—ç›Šäºsubquery materializeï¼Œå°†å­æŸ¥è¯¢çš„ç»“æœé›†cacheåˆ°ä¸´æ—¶è¡¨é‡Œï¼Œä½¿ç”¨hashindexæ¥è¿›è¡Œæ£€ç´¢ï¼›ç‰©åŒ–çš„å­æŸ¥è¯¢å¯ä»¥çœ‹åˆ°select_typeå­—æ®µä¸ºSUBQUERYï¼Œè€Œåœ¨MySQL5.5é‡Œä¸ºDEPENDENT SUBQUERY</p></blockquote><p>å¯èƒ½æ˜¯ç‰ˆæœ¬åŸå› ï¼Œæˆ‘ç”¨çš„æ˜¯mysql5.7ï¼Œå¯èƒ½åšäº†ä¼˜åŒ–ã€‚</p><p>äºæ˜¯ä½¿ç”¨mysql5.5å†æ¬¡æµ‹è¯•ã€‚</p><p>å‘ç°å­æŸ¥è¯¢å’Œå·¦è¿æ¥çš„æŸ¥è¯¢æ—¶é—´éƒ½åœ¨0.12sé™„è¿‘ï¼Œè¿˜æ˜¯ä¸èƒ½è¯´æ˜è¿æ¥æ¯”å­æŸ¥è¯¢é«˜æ•ˆã€‚è¿›ä¸€æ­¥çŒœæµ‹ï¼Œæˆ‘çš„æ•°æ®ç»„ç»‡æ ¼å¼æ˜¯å¦å‡ºç°äº†é—®é¢˜ï¼Œäºæ˜¯ä½¿ç”¨ä¸Šé¢ç™¾åº¦äº‘ç›˜è¿æ¥ä¸­çš„mm_memberè¡¨å’Œmm_logè¡¨(è¿™æ˜¯ <a href="https://www.cnblogs.com/cdf-opensource-007/p/6540521.html" target="_blank" rel="noopener">mysqlï¼ˆ4ï¼‰â€”â€” è¡¨è¿æ¥æŸ¥è¯¢ä¸whereåä½¿ç”¨å­æŸ¥è¯¢çš„æ€§èƒ½åˆ†æã€‚</a> æä¾›çš„æ•°æ®) ã€‚</p><h2 id="çŒœæµ‹éªŒè¯"><a href="#çŒœæµ‹éªŒè¯" class="headerlink" title="çŒœæµ‹éªŒè¯"></a>çŒœæµ‹éªŒè¯</h2><p><strong>å­æŸ¥è¯¢</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> mm_member.id <span class="keyword">FROM</span> mm_member <span class="keyword">WHERE</span> mm_member.id <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> mm_log.member_id <span class="keyword">FROM</span> mm_log)</span><br></pre></td></tr></table></figure><p><strong>å·¦è¿æ¥</strong></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> mm_member.id <span class="keyword">FROM</span> mm_member <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> mm_log.member_id <span class="keyword">FROM</span> mm_log ) <span class="keyword">AS</span> mm</span><br><span class="line"><span class="keyword">ON</span> mm.member_id = mm_member.id <span class="keyword">WHERE</span> mm.member_id <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p><strong>mysql5.7</strong></p><p>å­æŸ¥è¯¢ä¸º1.1så·¦å³ï¼Œå·¦è¿æ¥ä¸º1.55sï¼Œå­æŸ¥è¯¢ä¾ç„¶é€Ÿåº¦è¾ƒå¿«ã€‚</p><p><strong>mysql5.5</strong></p><p>å­æŸ¥è¯¢ä¸º48så·¦å³ï¼Œå·¦è¿æ¥ä¸º1.4sï¼Œå°†è¿‘34å€çš„å·®è·ï¼Œç”±æ­¤å°è¯ä¸Šé¢å¼•ç”¨çš„é‚£éƒ¨åˆ†ï¼Œ<strong>mysql5.7ç¡®å®å·²ç»å¤šå­æŸ¥è¯¢åšäº†ä¼˜åŒ–ï¼Œä½¿å…¶è¾¾åˆ°äº†é€¼è¿‘å·¦è¿æ¥çš„æ•ˆç‡</strong>ã€‚</p><p><strong>é‚£ä¸ºä»€ä¹ˆæˆ‘è‡ªå·±æ‰€å»ºç«‹çš„è¡¨æ— æ³•ä½“ç°ç‰ˆæœ¬çš„è¿™ç§æ€§èƒ½å·®åˆ«ï¼Ÿ</strong></p><p>çŒœæµ‹åº”è¯¥æ˜¯æ•°æ®ç±»å‹çš„åŸå› ï¼Œå¯èƒ½intç±»å‹çš„æŸ¥è¯¢æ•ˆç‡å·²ç»éƒ½ä¼˜åŒ–å¥½äº†ã€‚</p><h1 id="ç½‘ä¼ æœ€é«˜æ•ˆ"><a href="#ç½‘ä¼ æœ€é«˜æ•ˆ" class="headerlink" title="ç½‘ä¼ æœ€é«˜æ•ˆ"></a>ç½‘ä¼ æœ€é«˜æ•ˆ</h1><p>ä¸å¤ªæ¸…æ¥šå…¶ä¸­çš„åŸç†ï¼Œå¹¶ä¸”åœ¨æˆ‘çš„æµ‹è¯•ä¸­æ€§èƒ½è·Ÿè¿æ¥å·®ä¸å¤šã€‚</p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span> <span class="keyword">FROM</span> ta <span class="keyword">WHERE</span> (<span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(<span class="number">1</span>) <span class="keyword">AS</span> <span class="keyword">num</span> <span class="keyword">FROM</span> tb <span class="keyword">WHERE</span> ta.id = tb.id) = <span class="number">0</span></span><br></pre></td></tr></table></figure><blockquote><p>è€Œä¸”ç½‘ä¸Šæµä¼ çš„ç‰ˆæœ¬(<a href="http://blog.csdn.net/windren06/article/details/8188136" target="_blank" rel="noopener">(æ•°æ®åº“ç¯‡) SQLæŸ¥è¯¢~ å­˜åœ¨ä¸€ä¸ªè¡¨è€Œä¸åœ¨å¦ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®</a>)ä¸º</p><p>select <em> from B where (select count(1) as num from A where A.ID = B.ID) = 0<br>åº”è¯¥æ˜¯<br>select </em> from A where (select count(1) as num from  B where A.ID = B.ID) = 0<br>å¤§è¡¨åœ¨å‰ï¼Œå°è¡¨åœ¨åã€‚</p></blockquote><p><strong>æ³¨æ„</strong>ï¼š</p><ol><li>å­˜å‚¨è¿‡ç¨‹å¾ªç¯æ’å…¥æ¯”æ™®é€šæ–¹å¼æ’å…¥æ•°æ®æ…¢å¾ˆå¤šå€ã€‚</li><li>ç´¢å¼•å¯ä»¥æœ‰æ•ˆæé«˜æœç´¢æ•ˆç‡ã€‚</li><li>ä¸æ˜¯æ‰€æœ‰çš„å­æŸ¥è¯¢éƒ½æ¯”è¿æ¥æ…¢çš„ã€‚</li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://mysqllover.com/?p=919" target="_blank" rel="noopener">MySQL 5.6çš„ä¼˜åŒ–å™¨æ”¹è¿›</a></li><li><a href="https://www.cnblogs.com/cdf-opensource-007/p/6540521.html" target="_blank" rel="noopener">mysqlï¼ˆ4ï¼‰â€”â€” è¡¨è¿æ¥æŸ¥è¯¢ä¸whereåä½¿ç”¨å­æŸ¥è¯¢çš„æ€§èƒ½åˆ†æã€‚</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>getè¯·æ±‚ä¸­æ–‡ä¹±ç åŠget,postç¼–ç æ¢ç©¶</title>
      <link href="/get-request-Chinese-garbled/"/>
      <url>/get-request-Chinese-garbled/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘ä½¿ç”¨getè¯·æ±‚è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼š<br>å½“æˆ‘çš„è¯·æ±‚å‚æ•°ä¸­æœ‰ä¸­æ–‡æ—¶ï¼Œå‡ºç°ä¹±ç ã€‚<br>å¯æ˜¯å³ä½¿æˆ‘è®¾ç½®äº†Springçš„characterEncodingFilterï¼Œä¹Ÿè¿˜æ˜¯å‡ºç°ä¹±ç ã€‚<br>åŸå› ï¼štomcaté»˜è®¤ä½¿ç”¨ISO8859-1ç¼–ç æ¥è§£ægetä¸­çš„urlå‚æ•°ï¼Œå¯¼è‡´ä¹±ç ã€‚è€Œ<code>characterEncodingFilter</code>æˆ–è€…<code>request.setCharacterEncoding(&quot;UTF-8&quot;);</code>éƒ½åªé’ˆå¯¹postè¯·æ±‚ä½“æœ‰æ•ˆã€‚<br>ä¸‹é¢å¯¹Httpä¸­getæ–¹æ³•ç¼–ç åˆ°tomcatçš„è§£ç è¿‡ç¨‹è¿›è¡Œæ¢ç©¶ã€‚</p><a id="more"></a><h1 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h1><ol><li>æ›´æ”¹tomcatä¸­getæ–¹æ³•é»˜è®¤ISO8859-1ç¼–ç ä¸ºutf-8ç¼–ç ã€‚<br>æ‰¾åˆ°<code>conf/server.xml</code>,åœ¨ <code>&lt;Connector port=&quot;8082&quot; protocol=&quot;HTTP/1.1&quot;</code> ä¸­åŠ å…¥  <code>URIEncoding=&quot;utf-8&quot;</code>ã€‚</li><li>å°†å‚æ•°ä»¥iso8859-1ç¼–ç è½¬åŒ–ä¸ºå­—èŠ‚æ•°ç»„ï¼Œç„¶åå†ä»¥UTF-8å°†å­—èŠ‚æ•°ç»„è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚<code>userName = new String(userName.getBytes(&quot;ISO8859-1&quot;), &quot;UTF-8&quot;);</code></li></ol><h1 id="URLæ˜¯æ€ä¹ˆç¼–ç çš„ï¼Ÿ"><a href="#URLæ˜¯æ€ä¹ˆç¼–ç çš„ï¼Ÿ" class="headerlink" title="URLæ˜¯æ€ä¹ˆç¼–ç çš„ï¼Ÿ"></a>URLæ˜¯æ€ä¹ˆç¼–ç çš„ï¼Ÿ</h1><p>å‚è€ƒ <a href="http://www.ruanyifeng.com/blog/2010/02/url_encoding.html" target="_blank" rel="noopener">å…³äºURLç¼–ç </a></p><p>ä¸€èˆ¬æ¥è¯´ï¼ŒURLåªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ã€é˜¿æ‹‰ä¼¯æ•°å­—å’ŒæŸäº›æ ‡ç‚¹ç¬¦å·ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä»–æ–‡å­—å’Œç¬¦å·ã€‚æ¯”å¦‚ï¼Œä¸–ç•Œä¸Šæœ‰è‹±æ–‡å­—æ¯çš„ç½‘å€â€<a href="http://www.abc.com&quot;ï¼Œä½†æ˜¯æ²¡æœ‰å¸Œè…Šå­—æ¯çš„ç½‘å€&quot;http://www.aÎ²Î³.com&quot;ï¼ˆè¯»ä½œé˜¿å°”æ³•-è´å¡”-ä¼½ç›.comï¼‰ã€‚è¿™æ˜¯å› ä¸ºç½‘ç»œæ ‡å‡†RFC" target="_blank" rel="noopener">http://www.abc.com&quot;ï¼Œä½†æ˜¯æ²¡æœ‰å¸Œè…Šå­—æ¯çš„ç½‘å€&quot;http://www.aÎ²Î³.com&quot;ï¼ˆè¯»ä½œé˜¿å°”æ³•-è´å¡”-ä¼½ç›.comï¼‰ã€‚è¿™æ˜¯å› ä¸ºç½‘ç»œæ ‡å‡†RFC</a> 1738åšäº†ç¡¬æ€§è§„å®šã€‚</p><p>è¿™æ„å‘³ç€ï¼Œå¦‚æœURLä¸­æœ‰æ±‰å­—ï¼Œå°±å¿…é¡»ç¼–ç åä½¿ç”¨ã€‚ä½†æ˜¯éº»çƒ¦çš„æ˜¯ï¼ŒRFC 1738æ²¡æœ‰è§„å®šå…·ä½“çš„ç¼–ç æ–¹æ³•ï¼Œè€Œæ˜¯äº¤ç»™åº”ç”¨ç¨‹åºï¼ˆæµè§ˆå™¨ï¼‰è‡ªå·±å†³å®šã€‚è¿™å¯¼è‡´â€URLç¼–ç â€æˆä¸ºäº†ä¸€ä¸ªæ··ä¹±çš„é¢†åŸŸã€‚</p><p>ä¸åŒçš„æ“ä½œç³»ç»Ÿã€ä¸åŒçš„æµè§ˆå™¨ã€ä¸åŒçš„ç½‘é¡µå­—ç¬¦é›†ï¼Œå°†å¯¼è‡´å®Œå…¨ä¸åŒçš„ç¼–ç ç»“æœã€‚<strong>ç»è¿‡æµ‹è¯•ï¼Œç°åœ¨çš„æµè§ˆå™¨å¤§éƒ¨åˆ†éƒ½æ˜¯utf-8ç¼–ç </strong>ã€‚ä½†æ˜¯ä¸ºäº†å…¼å®¹æ‰€æœ‰çš„æµè§ˆå™¨ï¼Œå¯ä»¥ä½¿ç”¨Javascriptå‡½æ•°ï¼š<code>encodeURI()</code>ã€‚</p><p>encodeURI()æ˜¯Javascriptä¸­çœŸæ­£ç”¨æ¥å¯¹URLç¼–ç çš„å‡½æ•°ã€‚<br>å®ƒç€çœ¼äºå¯¹æ•´ä¸ªURLè¿›è¡Œç¼–ç ï¼Œå› æ­¤é™¤äº†å¸¸è§çš„ç¬¦å·ä»¥å¤–ï¼Œå¯¹å…¶ä»–ä¸€äº›åœ¨ç½‘å€ä¸­æœ‰ç‰¹æ®Šå«ä¹‰çš„ç¬¦å·â€; / ? : @ &amp; = + <code>$</code> , <code>#</code>â€œï¼Œä¹Ÿä¸è¿›è¡Œç¼–ç ã€‚ç¼–ç åï¼Œå®ƒè¾“å‡ºç¬¦å·çš„utf-8å½¢å¼ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªå­—èŠ‚å‰åŠ ä¸Š%ã€‚<br><img src="https://images.morethink.cn/801695c34db12f3a694ee415a6f5222b.png" alt=""></p><p>å®ƒå¯¹åº”çš„è§£ç å‡½æ•°æ˜¯decodeURI()ã€‚<br><img src="https://images.morethink.cn/52dab00c0410f5f372f9a204522622a5.png" alt=""></p><h1 id="tomcatæ˜¯æ€ä¹ˆè§£ç çš„ï¼Ÿ"><a href="#tomcatæ˜¯æ€ä¹ˆè§£ç çš„ï¼Ÿ" class="headerlink" title="tomcatæ˜¯æ€ä¹ˆè§£ç çš„ï¼Ÿ"></a>tomcatæ˜¯æ€ä¹ˆè§£ç çš„ï¼Ÿ</h1><p>getè¯·æ±‚æ˜¯ä½¿ç”¨urlç¼–ç æ–¹å¼ï¼Œè€Œpostè¯·æ±‚åŸºäºè¯·æ±‚ä½“è‡ªèº«çš„ç¼–ç ã€‚</p><p><strong>æ¨è</strong></p><ul><li>getè¯·æ±‚å«æœ‰urlå‚æ•°æ—¶ï¼Œä½¿ç”¨jsè‡ªå¸¦çš„ç¼–ç å‡½æ•°è¿›è¡Œç¼–ç ã€‚</li><li>postè¯·æ±‚åœ¨content-typeä¸­è®¾ç½®charset=utf-8ï¼Œå¦åˆ™ä½¿ç”¨é¡µé¢é»˜è®¤ç¼–ç ã€‚</li></ul><h2 id="getæ–¹æ³•çš„ç¼–ç "><a href="#getæ–¹æ³•çš„ç¼–ç " class="headerlink" title="getæ–¹æ³•çš„ç¼–ç "></a>getæ–¹æ³•çš„ç¼–ç </h2><p>æŸ¥çœ‹tomcatæºç ä¸­ï¼Œ<code>org.apache.catalina.connector.CoyoteAdapter</code>çš„æ–¹æ³•ï¼š<br>ä½¿ç”¨åœ¨conf/server.xmlä¸­ <code>&lt;Connector port=&quot;8082&quot; protocol=&quot;HTTP/1.1&quot;&gt;</code>é…ç½®çš„URIEncodingä½œä¸ºå°†å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°è½¬åŒ–ä¸ºå­—ç¬¦æ•°ç»„çš„ç¼–ç ï¼Œç¼ºçœä¸ºISO8859-1ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">convertURI</span><span class="params">(MessageBytes uri, Request request)</span></span></span><br><span class="line"><span class="function">    <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    ByteChunk bc = uri.getByteChunk();</span><br><span class="line">    <span class="keyword">int</span> length = bc.getLength();</span><br><span class="line">    CharChunk cc = uri.getCharChunk();</span><br><span class="line">    cc.allocate(length, -<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨é»˜è®¤ç¼–ç  ISO8859-1 å°†å­—èŠ‚æ•°ç»„ç¼–ç¨‹å­—ç¬¦</span></span><br><span class="line">    String enc = connector.getURIEncoding();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (enc != <span class="keyword">null</span>) &#123;</span><br><span class="line">        B2CConverter conv = request.getURIConverter();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (conv == <span class="keyword">null</span>) &#123;</span><br><span class="line">                conv = <span class="keyword">new</span> B2CConverter(enc, <span class="keyword">true</span>);</span><br><span class="line">                request.setURIConverter(conv);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                conv.recycle();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            log.error(<span class="string">"Invalid URI encoding; using HTTP default"</span>);</span><br><span class="line">            connector.setURIEncoding(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (conv != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                conv.convert(bc, cc, <span class="keyword">true</span>);</span><br><span class="line">                uri.setChars(cc.getBuffer(), cc.getStart(), cc.getLength());</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ioe) &#123;</span><br><span class="line">                <span class="comment">// Should never happen as B2CConverter should replace</span></span><br><span class="line">                <span class="comment">// problematic characters</span></span><br><span class="line">                request.getResponse().sendError(</span><br><span class="line">                        HttpServletResponse.SC_BAD_REQUEST);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Default encoding: fast conversion for ISO-8859-1</span></span><br><span class="line">    <span class="keyword">byte</span>[] bbuf = bc.getBuffer();</span><br><span class="line">    <span class="keyword">char</span>[] cbuf = cc.getBuffer();</span><br><span class="line">    <span class="keyword">int</span> start = bc.getStart();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        cbuf[i] = (<span class="keyword">char</span>) (bbuf[i + start] &amp; <span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    uri.setChars(cbuf, <span class="number">0</span>, length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="postæ–¹æ³•çš„å­—ç¬¦ç¼–ç "><a href="#postæ–¹æ³•çš„å­—ç¬¦ç¼–ç " class="headerlink" title="postæ–¹æ³•çš„å­—ç¬¦ç¼–ç "></a>postæ–¹æ³•çš„å­—ç¬¦ç¼–ç </h2><ol><li><p>å¦‚æœåœ¨servletçš„doPostæ–¹æ³•ä¸­æˆ–è€…filterä¸­è®¾ç½®äº†requestçš„å­—ç¬¦ç¼–ç ï¼Œé‚£ä¹ˆå°±ä»¥è®¾ç½®çš„ä¸ºå‡†ã€‚</p><ul><li><p><strong>requestè®¾ç½®ç¼–ç </strong></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequestrequest,HttpServletResponse response)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> IOException,ServletException</span>&#123;</span><br><span class="line"><span class="comment">//å¿…é¡»åœ¨getParameter,getParameterNames,</span></span><br><span class="line"><span class="comment">//getParameterValuesæ–¹æ³•è°ƒç”¨ä¹‹å‰è¿›è¡Œè®¾ç½®</span></span><br><span class="line">request.setContentType(<span class="string">"UTF-8"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>web.xmlä¸­é…ç½®filter</strong></p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>SetCharacterEncoding<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.catalina.filters.SetCharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>å¦‚æœæ²¡æœ‰è¿›è¡Œä¸Šé¢çš„é…ç½®ï¼Œé‚£ä¹ˆä»http headerä¸­å–å‡ºcontent-type,ç„¶åä»content-typeçš„å€¼ä¸­å–å‡ºcharsetçš„å€¼ï¼Œcharsetçš„å€¼ä½œä¸ºpostçš„å­—ç¬¦ç¼–ç ã€‚<br>å¦‚ <code>content-type=application/x-www-form-urlencoded;charset=utf-8</code><br>é‚£ä¹ˆï¼Œpostçš„å­—ç¬¦ç¼–ç å°±æ˜¯utf-8ã€‚<br>å¦‚æœä»http headerä¸­æ²¡æœ‰å–åˆ°content-typeä¸­çš„charsetï¼Œé‚£ä¹ˆï¼Œå°±ä½¿ç”¨ç¼ºçœçš„ISO-8859-1ã€‚</p></li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://www.ruanyifeng.com/blog/2010/02/url_encoding.html" target="_blank" rel="noopener">å…³äºURLç¼–ç </a></li><li><a href="http://blog.csdn.net/u010648555/article/details/50011987" target="_blank" rel="noopener"> getè¯·æ±‚ä¸­urlä¼ å‚ä¸­æ–‡ä¹±ç é—®é¢˜â€“é›†é”¦</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Http </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>springä½¿ç”¨redisåšç¼“å­˜</title>
      <link href="/spring-redis-cache/"/>
      <url>/spring-redis-cache/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¼“å­˜"><a href="#ç¼“å­˜" class="headerlink" title="ç¼“å­˜"></a>ç¼“å­˜</h1><h2 id="ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ</h2><p>åœ¨é«˜å¹¶å‘ä¸‹ï¼Œä¸ºäº†æé«˜è®¿é—®çš„æ€§èƒ½ï¼Œéœ€è¦å°†æ•°æ®åº“ä¸­ <strong>ä¸€äº›ç»å¸¸å±•ç°å’Œä¸ä¼šé¢‘ç¹å˜æ›´çš„æ•°æ®</strong>ï¼Œå­˜æ”¾åœ¨å­˜å–é€Ÿç‡æ›´å¿«çš„å†…å­˜ä¸­ã€‚è¿™æ ·å¯ä»¥</p><ol><li>é™ä½æ•°æ®çš„è·å–æ—¶é—´ï¼Œå¸¦æ¥æ›´å¥½çš„ä½“éªŒ</li><li>å‡è½»æ•°æ®åº“çš„å‹åŠ›</li></ol><p>ç¼“å­˜é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºåˆï¼ŒæŸ¥è¯¢æ—¶ç¼“å­˜å‘½ä¸­ç‡å¾ˆä½ã€å†™æ“ä½œå¾ˆé¢‘ç¹ç­‰åœºæ™¯ä¸é€‚å®œç”¨ç¼“å­˜ã€‚</p><p><strong>MySQLæœ‰è‡ªå·±çš„æŸ¥è¯¢ç¼“å­˜ï¼Œä¸ºä»€ä¹ˆè¿˜è¦ä½¿ç”¨ Redis ç­‰ç¼“å­˜åº”ç”¨</strong>ï¼Ÿ</p><ul><li>å½“åªæœ‰ä¸€å° MySQLæœåŠ¡å™¨æ—¶ï¼Œå¯ä»¥å°†ç¼“å­˜æ”¾ç½®åœ¨æœ¬åœ°ã€‚è¿™æ ·å½“æœ‰ç›¸åŒçš„ SQL æŸ¥è¯¢åˆ°è¾¾æ—¶ï¼Œå¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­å–åˆ°æŸ¥è¯¢ç»“æœï¼Œä¸éœ€è¦è¿›è¡Œ SQL çš„è§£æå’Œæ‰§è¡Œã€‚MySQL æä¾›äº†æœåŠ¡å™¨å±‚é¢çš„ç¼“å­˜æ”¯æŒã€‚</li><li>å¦‚æœæœ‰å¤šå° MySQL æœåŠ¡å™¨ï¼Œè¯·æ±‚ä¼šéšæœºåˆ†å‘ç»™å¤šå°ä¸­çš„ä¸€å°ï¼Œæˆ‘ä»¬æ— æ³•ä¿è¯ç›¸åŒçš„è¯·æ±‚ä¼šåˆ°è¾¾åŒä¸€å°æœåŠ¡å™¨ï¼Œæœ¬åœ°ç¼“å­˜å‘½ä¸­ç‡è¾ƒä½ã€‚æ‰€ä»¥åŸºäºæœ¬æœºçš„ç¼“å­˜å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œæ­¤æ—¶é‡‡ç”¨çš„ç­–ç•¥åº”è¯¥æ˜¯å°†æŸ¥è¯¢ç»“æœç¼“å­˜åœ¨ Redis æˆ–è€… Memcache ä¸­ã€‚</li></ul><p>è€ŒRedisæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ key-value å†…å­˜æ•°æ®åº“ï¼Œæ°æ°å¯ä»¥ä½œä¸ºç¼“å­˜ä½¿ç”¨ã€‚<br><a id="more"></a><br>GitHub åœ°å€ï¼š<a href="https://github.com/antirez/redis" target="_blank" rel="noopener">https://github.com/antirez/redis</a> ã€‚Github æ˜¯è¿™ä¹ˆæè¿°çš„ï¼š<br>Redis is an in-memory database that persists on disk. The data model is key-value, but many different kind of values are supported: Strings, Lists, Sets, Sorted Sets, Hashes, HyperLogLogs, Bitmaps.</p><p>ä½†æ˜¯mysqlè‡ªå·±æœ¬èº«æœ‰æŸ¥è¯¢ç¼“å­˜ï¼Œmemcachedä¹Ÿæ˜¯ä¸€ä¸ªä¼˜ç§€çš„å†…å­˜æ•°æ®åº“ï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦é€‰æ‹©redis</p><h2 id="ç¼“å­˜æ›´æ–°"><a href="#ç¼“å­˜æ›´æ–°" class="headerlink" title="ç¼“å­˜æ›´æ–°"></a>ç¼“å­˜æ›´æ–°</h2><p>æŸ¥çœ‹<a href="http://coolshell.cn/articles/17416.html" target="_blank" rel="noopener">ç¼“å­˜æ›´æ–°çš„å¥—è·¯</a>ï¼Œç¼“å­˜æ›´æ–°çš„æ¨¡å¼æœ‰å››ç§ï¼š</p><ul><li>Cache aside</li><li>Read through</li><li>Write through</li><li>Write behind cachinã€‚</li></ul><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Cache Aside ç­–ç•¥ï¼Œä»ä¸‰ä¸ªç»´åº¦ï¼š</p><ol><li>å‘½ä¸­ï¼šåº”ç”¨ç¨‹åºä»cacheä¸­å–æ•°æ®ï¼Œå–åˆ°åè¿”å›ã€‚æ‰§è¡Œå›¾ä¸­1,2æ­¥</li><li>å¤±æ•ˆï¼šåº”ç”¨ç¨‹åºå…ˆä»cacheå–æ•°æ®ï¼Œæ²¡æœ‰å¾—åˆ°ï¼Œåˆ™ä»æ•°æ®åº“ä¸­å–æ•°æ®ï¼ŒæˆåŠŸåï¼Œæ”¾åˆ°ç¼“å­˜ä¸­ã€‚æ‰§è¡Œå›¾ä¸­1,2,3ï¼Œ4,1ï¼Œ2æ­¥</li><li>æ›´æ–°ï¼šå…ˆæŠŠæ•°æ®å­˜åˆ°æ•°æ®åº“ä¸­ï¼ŒæˆåŠŸåï¼Œå†è®©ç¼“å­˜å¤±æ•ˆã€‚æ‰§è¡Œå›¾ä¸­1ï¼Œ2æ­¥</li></ol><p><img src="https://images.morethink.cn/6ae279a4bbe330303c483347a583f965.png" alt="" title="redisè°ƒç”¨è¿‡ç¨‹"></p><h1 id="springé…ç½®redisç¼“å­˜"><a href="#springé…ç½®redisç¼“å­˜" class="headerlink" title="springé…ç½®redisç¼“å­˜"></a>springé…ç½®redisç¼“å­˜</h1><p>æ¥ä¸‹æ¥è®²è§£ä¸€ä¸‹springçš„é…ç½®ã€‚</p><h1 id="ä¾èµ–é…ç½®"><a href="#ä¾èµ–é…ç½®" class="headerlink" title="ä¾èµ–é…ç½®"></a>ä¾èµ–é…ç½®</h1><p>pom.xmlä¸­æ·»åŠ </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- redis cache--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.data<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.2.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="RedisConfig"><a href="#RedisConfig" class="headerlink" title="RedisConfig"></a>RedisConfig</h1><p>ç°åœ¨æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯java config é…ç½®ï¼Œå› æ­¤éœ€è¦å°†æœ¬RedisConfigæ”¾åœ¨å¯ä»¥è¢«<br><code>&lt;context:component-scan base-package=&quot;&quot;/&gt;</code><br>æ‰«æçš„åŒ…ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.CacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.annotation.EnableCaching;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cache.interceptor.KeyGenerator;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.jedis.JedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 2017/11/5.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableCaching</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> <span class="keyword">extends</span> <span class="title">CachingConfigurerSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JedisConnectionFactory <span class="title">redisConnectionFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        JedisConnectionFactory redisConnectionFactory = <span class="keyword">new</span> JedisConnectionFactory();</span><br><span class="line">        <span class="comment">// Defaults</span></span><br><span class="line">        redisConnectionFactory.setHostName(<span class="string">"127.0.0.1"</span>);</span><br><span class="line">        redisConnectionFactory.setPort(<span class="number">6379</span>);</span><br><span class="line">        <span class="keyword">return</span> redisConnectionFactory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, String&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, String&gt; redisTemplate = <span class="keyword">new</span> RedisTemplate&lt;String, String&gt;();</span><br><span class="line">        redisTemplate.setConnectionFactory(factory);</span><br><span class="line">        redisTemplate.afterPropertiesSet();</span><br><span class="line">        setSerializer(redisTemplate);</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CacheManager <span class="title">cacheManager</span><span class="params">(RedisTemplate redisTemplate)</span> </span>&#123;</span><br><span class="line">        RedisCacheManager rcm = <span class="keyword">new</span> RedisCacheManager(redisTemplate);</span><br><span class="line">        <span class="comment">// è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œç§’</span></span><br><span class="line">        rcm.setDefaultExpiration(<span class="number">600</span>);</span><br><span class="line">        <span class="keyword">return</span> rcm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setSerializer</span><span class="params">(RedisTemplate&lt;String, String&gt; template)</span> </span>&#123;</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        template.setKeySerializer(<span class="keyword">new</span> StringRedisSerializer());</span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> KeyGenerator <span class="title">keyGenerator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> KeyGenerator() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Object <span class="title">generate</span><span class="params">(Object target, Method method, Object... params)</span> </span>&#123;</span><br><span class="line">                StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                sb.append(target.getClass().getName());</span><br><span class="line">                sb.append(<span class="string">":"</span> + method.getName());</span><br><span class="line">                <span class="keyword">for</span> (Object obj : params) &#123;</span><br><span class="line">                    sb.append(<span class="string">":"</span> + <span class="keyword">null</span> == obj ? <span class="string">"null"</span> : obj.toString());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> sb.toString();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬ä¸é…ç½®é‡å†™<code>keyGenerator()</code>æ–¹æ³•çš„è¯ï¼Œé»˜è®¤çš„keyç”Ÿæˆç­–ç•¥æ˜¯</p><p>Cacheable.java<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Spring Expression Language (SpEL) expression for computing the key dynamically.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;Default is &#123;<span class="doctag">@code</span> ""&#125;, meaning all method parameters are considered as a key,</span></span><br><span class="line"><span class="comment"> * unless a custom &#123;<span class="doctag">@link</span> #keyGenerator&#125; has been configured.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;The SpEL expression evaluates against a dedicated context that provides the</span></span><br><span class="line"><span class="comment"> * following meta-data:</span></span><br><span class="line"><span class="comment"> * &lt;ul&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;&#123;<span class="doctag">@code</span> #root.method&#125;, &#123;<span class="doctag">@code</span> #root.target&#125;, and &#123;<span class="doctag">@code</span> #root.caches&#125; for</span></span><br><span class="line"><span class="comment"> * references to the &#123;<span class="doctag">@link</span> java.lang.reflect.Method method&#125;, target object, and</span></span><br><span class="line"><span class="comment"> * affected cache(s) respectively.&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Shortcuts for the method name (&#123;<span class="doctag">@code</span> #root.methodName&#125;) and target class</span></span><br><span class="line"><span class="comment"> * (&#123;<span class="doctag">@code</span> #root.targetClass&#125;) are also available.</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;Method arguments can be accessed by index. For instance the second argument</span></span><br><span class="line"><span class="comment"> * can be accessed via &#123;<span class="doctag">@code</span> #root.args[1]&#125;, &#123;<span class="doctag">@code</span> #p1&#125; or &#123;<span class="doctag">@code</span> #a1&#125;. Arguments</span></span><br><span class="line"><span class="comment"> * can also be accessed by name if that information is available.&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">String <span class="title">key</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br></pre></td></tr></table></figure></p><p>ä¹Ÿå°±æ˜¯æŠŠæ‰€æœ‰çš„æ–¹æ³•å‚æ•°ä½œä¸ºä¸€ä¸ªkeyï¼Œä½†æ˜¯è¿™å¯èƒ½ä¼šé‡å¤ã€‚</p><h1 id="ç¼“å­˜æ³¨è§£"><a href="#ç¼“å­˜æ³¨è§£" class="headerlink" title="ç¼“å­˜æ³¨è§£"></a>ç¼“å­˜æ³¨è§£</h1><ul><li><code>@CacheConfig</code>ï¼šä¸»è¦ç”¨äºé…ç½®è¯¥ç±»ä¸­ä¼šç”¨åˆ°çš„ä¸€äº›å…±ç”¨çš„ç¼“å­˜é…ç½®ã€‚åœ¨è¿™é‡Œ<code>@CacheConfig(cacheNames = &quot;companies&quot;)</code>ï¼Œé…ç½®äº†è¯¥æ•°æ®è®¿é—®å¯¹è±¡ä¸­è¿”å›çš„å†…å®¹å°†å­˜å‚¨äºåä¸ºcompaniesçš„ç¼“å­˜å¯¹è±¡ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨è¯¥æ³¨è§£ï¼Œç›´æ¥é€šè¿‡<code>@Cacheable</code>è‡ªå·±é…ç½®ç¼“å­˜é›†çš„åå­—æ¥å®šä¹‰ã€‚</li><li><code>@Cacheable</code>ï¼š <strong>å£°æ˜Springåœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰ï¼Œé¦–å…ˆåº”è¯¥åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚æœè¿™ä¸ªå€¼èƒ½å¤Ÿæ‰¾åˆ°ï¼Œå°±ä¼šè¿”å›å­˜å‚¨çš„å€¼ï¼Œå¦åˆ™çš„è¯ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œè¿”å›å€¼ä¼šæ”¾åœ¨ç¼“å­˜ä¹‹ä¸­</strong>ã€‚è¯¥æ³¨è§£ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªå‚æ•°ï¼š<ul><li><code>value</code>ã€<code>cacheNames</code>ï¼šä¸¤ä¸ªç­‰åŒçš„å‚æ•°ï¼ˆcacheNamesä¸ºSpring4æ–°å¢ï¼Œä½œä¸ºvalueçš„åˆ«åï¼‰ï¼Œ<strong>ç”¨äºæŒ‡å®šç¼“å­˜å­˜å‚¨çš„é›†åˆå</strong>ã€‚ç”±äºSpring4ä¸­æ–°å¢äº†<code>@CacheConfig</code>ï¼Œå› æ­¤åœ¨Spring3ä¸­åŸæœ¬å¿…é¡»æœ‰çš„valueå±æ€§ï¼Œä¹Ÿæˆä¸ºéå¿…éœ€é¡¹äº†</li><li><code>key</code>ï¼šç¼“å­˜å¯¹è±¡å­˜å‚¨åœ¨Mapé›†åˆä¸­çš„keyå€¼ï¼Œéå¿…éœ€ï¼Œç¼ºçœæŒ‰ç…§å‡½æ•°çš„æ‰€æœ‰å‚æ•°ç»„åˆä½œä¸ºkeyå€¼ï¼Œè‹¥è‡ªå·±é…ç½®éœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼š@Cacheable(key = â€œ#p0â€)ï¼šä½¿ç”¨å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºç¼“å­˜çš„keyå€¼ï¼Œæ›´å¤šå…³äºSpELè¡¨è¾¾å¼çš„è¯¦ç»†å†…å®¹å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£</li><li><code>condition</code>ï¼šç¼“å­˜å¯¹è±¡çš„æ¡ä»¶ï¼Œéå¿…éœ€ï¼Œä¹Ÿéœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ï¼Œåªæœ‰æ»¡è¶³è¡¨è¾¾å¼æ¡ä»¶çš„å†…å®¹æ‰ä¼šè¢«ç¼“å­˜ï¼Œæ¯”å¦‚ï¼š@Cacheable(key = â€œ#p0â€, condition = â€œ#p0.length() &lt; 3â€)ï¼Œè¡¨ç¤ºåªæœ‰å½“ç¬¬ä¸€ä¸ªå‚æ•°çš„é•¿åº¦å°äº3çš„æ—¶å€™æ‰ä¼šè¢«ç¼“å­˜ï¼Œè‹¥åšæ­¤é…ç½®ä¸Šé¢çš„AAAç”¨æˆ·å°±ä¸ä¼šè¢«ç¼“å­˜ï¼Œè¯»è€…å¯è‡ªè¡Œå®éªŒå°è¯•ã€‚</li><li><code>unless</code>ï¼šå¦å¤–ä¸€ä¸ªç¼“å­˜æ¡ä»¶å‚æ•°ï¼Œéå¿…éœ€ï¼Œéœ€ä½¿ç”¨SpELè¡¨è¾¾å¼ã€‚å®ƒä¸åŒäºconditionå‚æ•°çš„åœ°æ–¹åœ¨äºå®ƒçš„åˆ¤æ–­æ—¶æœºï¼Œè¯¥æ¡ä»¶æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨ä¹‹åæ‰åšåˆ¤æ–­çš„ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é€šè¿‡å¯¹resultè¿›è¡Œåˆ¤æ–­ã€‚</li><li><code>keyGenerator</code>ï¼šç”¨äºæŒ‡å®škeyç”Ÿæˆå™¨ï¼Œéå¿…éœ€ã€‚è‹¥éœ€è¦æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰çš„keyç”Ÿæˆå™¨ï¼Œæˆ‘ä»¬éœ€è¦å»å®ç°org.springframework.cache.interceptor.KeyGeneratoræ¥å£ï¼Œå¹¶ä½¿ç”¨è¯¥å‚æ•°æ¥æŒ‡å®šã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè¯¥å‚æ•°ä¸keyæ˜¯äº’æ–¥çš„</li><li><code>cacheManager</code>ï¼šç”¨äºæŒ‡å®šä½¿ç”¨å“ªä¸ªç¼“å­˜ç®¡ç†å™¨ï¼Œéå¿…éœ€ã€‚åªæœ‰å½“æœ‰å¤šä¸ªæ—¶æ‰éœ€è¦ä½¿ç”¨</li><li><code>cacheResolver</code>ï¼šç”¨äºæŒ‡å®šä½¿ç”¨é‚£ä¸ªç¼“å­˜è§£æå™¨ï¼Œéå¿…éœ€ã€‚éœ€é€šè¿‡org.springframework.cache.interceptor.CacheResolveræ¥å£æ¥å®ç°è‡ªå·±çš„ç¼“å­˜è§£æå™¨ï¼Œå¹¶ç”¨è¯¥å‚æ•°æŒ‡å®šã€‚</li></ul></li></ul><p>é™¤äº†è¿™é‡Œç”¨åˆ°çš„ä¸¤ä¸ªæ³¨è§£ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸‹é¢å‡ ä¸ªæ ¸å¿ƒæ³¨è§£ï¼š</p><ul><li><code>@CachePut</code>ï¼š <strong>è¡¨æ˜Springåº”è¯¥å°†æ–¹æ³•çš„è¿”å›å€¼æ”¾åˆ°ç¼“å­˜ä¸­ï¼Œåœ¨æ–¹æ³•çš„è°ƒç”¨å‰å¹¶ä¸ä¼šæ£€æŸ¥ç¼“å­˜ï¼Œæ–¹æ³•å§‹ç»ˆéƒ½ä¼šè¢«è°ƒç”¨</strong>ã€‚å®ƒçš„å‚æ•°ä¸@<code>Cacheable</code>ç±»ä¼¼ï¼Œå…·ä½“åŠŸèƒ½å¯å‚è€ƒä¸Šé¢å¯¹<code>@Cacheable</code>å‚æ•°çš„è§£æã€‚</li><li><code>@CacheEvict</code>ï¼š<strong>é…ç½®äºå‡½æ•°ä¸Šï¼Œé€šå¸¸ç”¨åœ¨åˆ é™¤æ–¹æ³•ä¸Šï¼Œç”¨æ¥ä»ç¼“å­˜ä¸­ç§»é™¤ç›¸åº”æ•°æ®</strong>ã€‚é™¤äº†åŒ<code>@Cacheable</code>ä¸€æ ·çš„å‚æ•°ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸‹é¢ä¸¤ä¸ªå‚æ•°ï¼š<ul><li><code>allEntries</code>ï¼šéå¿…éœ€ï¼Œé»˜è®¤ä¸ºfalseã€‚å½“ä¸ºtrueæ—¶ï¼Œä¼šç§»é™¤æ‰€æœ‰æ•°æ®</li><li><code>beforeInvocation</code>ï¼šéå¿…éœ€ï¼Œé»˜è®¤ä¸ºfalseï¼Œä¼šåœ¨è°ƒç”¨æ–¹æ³•ä¹‹åç§»é™¤æ•°æ®ã€‚å½“ä¸ºtrueæ—¶ï¼Œä¼šåœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰ç§»é™¤æ•°æ®ã€‚</li></ul></li></ul><h1 id="ç¼“å­˜ä¸æ•°æ®åº“ä¸€è‡´æ€§"><a href="#ç¼“å­˜ä¸æ•°æ®åº“ä¸€è‡´æ€§" class="headerlink" title="ç¼“å­˜ä¸æ•°æ®åº“ä¸€è‡´æ€§"></a>ç¼“å­˜ä¸æ•°æ®åº“ä¸€è‡´æ€§</h1><ul><li>æ•°æ®åº“å¤„ç†è¦æ±‚å¼ºä¸€è‡´å®æ—¶æ€§çš„æ•°æ®ï¼Œä¾‹å¦‚é‡‘èæ•°æ®ã€äº¤æ˜“æ•°æ®ã€‚</li><li>Rediså¤„ç†ä¸è¦æ±‚å¼ºä¸€è‡´å®æ—¶æ€§çš„æ•°æ®ï¼Œä¾‹å¦‚ç½‘ç«™æœ€çƒ­è´´æ’è¡Œæ¦œã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´æ ¹æ®ä½ çš„ä¸šåŠ¡éœ€æ±‚ï¼Œè®¾ç½®ä½ çš„è¿‡æœŸæ—¶é—´ï¼Œå®¹è®¸redisæœ‰ä¸€äº›ä¸ä¸€è‡´ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ol><li>ç¼“å­˜javaå¯¹è±¡æ—¶å¿…é¡»å®ç°Serilaizableæ¥å£ï¼Œå› ä¸ºSpringä¼šå°†å¯¹è±¡å…ˆåºåˆ—åŒ–ä¹‹åå†å­˜å…¥åˆ°Redisä¸­ã€‚</li><li>ç¼“å­˜æ–¹æ³•çš„ <code>@Cacheable</code> æœ€å¥½ä½¿ç”¨æ–¹æ³•åï¼Œé¿å…ä¸åŒçš„æ–¹æ³•çš„ @Cacheable å€¼ä¸€è‡´ï¼Œç„¶åå†é…ä»¥ä»¥ä¸Šç¼“å­˜ç­–ç•¥ã€‚</li><li>åœ¨æˆ‘å°†è¿™ä¸ª<code>@Cacheable</code>æ”¾ç½®åœ¨SSMçš„daoå±‚å’Œserviceå±‚æ—¶ï¼Œredisç¼“å­˜å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯å½“æˆ‘å°†<code>@Cacheable</code>æ”¾åœ¨actionå±‚ä¸Šæ—¶å°±ä¼šæœ‰NPEã€‚</li><li><code>@Cacheable</code>æ²¡æœ‰é…ç½®åå­—ï¼Œæ”¹ä¸º<code>@Cacheable(&quot;å€¼&quot;)</code>ï¼Œå¦åˆ™ä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ã€‚ <figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.lang.IllegalStateException: No cache could be resolved <span class="keyword">for</span> <span class="string">'Builder[public abstract studio.jikewang.entity.TeacherClass studio.jikewang.dao.TeacherClassDao.getTeacherClass(int)] caches=[] | key='</span><span class="string">' | keyGenerator='</span><span class="string">' | cacheManager='</span><span class="string">' | cacheResolver='</span><span class="string">' | condition='</span><span class="string">' | unless='</span><span class="string">' | sync='</span><span class="keyword">false</span><span class="string">''</span> using resolver <span class="string">'org.springframework.cache.interceptor.SimpleCacheResolver@4f8d471b'</span>. At least one cache should be provided per cache operation.</span><br></pre></td></tr></table></figure></li></ol><p><strong>å‚è€ƒæ–‡æ¡£ï¼š</strong></p><ol><li><a href="http://blog.csdn.net/defonds/article/details/48716161" target="_blank" rel="noopener">Redis ç¼“å­˜ + Spring çš„é›†æˆç¤ºä¾‹</a></li><li><a href="http://www.cnblogs.com/x113773/p/7227114.html" target="_blank" rel="noopener">Spring Boot ä½¿ç”¨Redisç¼“å­˜</a></li><li><a href="http://twei.site/2017/08/20/MySQL%E7%BC%93%E5%AD%98-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BC%93%E5%AD%98query-cache/" target="_blank" rel="noopener">MySQLç¼“å­˜â€“æœåŠ¡å™¨ç¼“å­˜query cache</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å•ç‚¹ç™»å½•ä¹‹tomcatä¸­sessionåœ¨ä¸¤ä¸ªwebappä¸­å®ç°å…±äº«</title>
      <link href="/tomcat-webapps-session-sharing/"/>
      <url>/tomcat-webapps-session-sharing/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨é‡åˆ°ä¸€ä¸ªéœ€æ±‚å°±æ˜¯è¦æ±‚å®Œæˆç®€å•çš„å•ç‚¹ç™»å½•ï¼Œé€šè¿‡åœ¨ä¸€ä¸ªtomcatå®ä¾‹ä¸­æ”¾ç½®ä¸¤ä¸ªwebappsåº”ç”¨ROOTåº”ç”¨å’ŒCEOåº”ç”¨æ¥å®Œæˆåœ¨ROOTåº”ç”¨ç™»å½•åï¼Œåœ¨CEOå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œè€Œæœªåœ¨ROOTåº”ç”¨ç™»å½•æ—¶ï¼Œä¸å¯ä»¥è¿›å»CEOåº”ç”¨ã€‚<br>å®é™…ä¸Šé—®é¢˜å°±æ˜¯sessionå¦‚ä½•åœ¨ä¸¤ä¸ªwebappä¸­å®ç°å…±äº«ï¼Œé€šè¿‡ä¸Šç½‘æœç´¢å‘ç°ä¸€ä¸ªæ–¹æ³•<br><a id="more"></a></p><h1 id="æ–¹æ³•1ServletContext"><a href="#æ–¹æ³•1ServletContext" class="headerlink" title="æ–¹æ³•1ServletContext"></a>æ–¹æ³•1ServletContext</h1><p>server.xmlæ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ï¼š<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Host</span> <span class="attr">name</span>=<span class="string">"localhost"</span>  <span class="attr">appBase</span>=<span class="string">"webapps"</span><span class="attr">unpackWARs</span>=<span class="string">"true"</span> <span class="attr">autoDeploy</span>=<span class="string">"true"</span>&gt;</span>  </span><br><span class="line">    //WebappAä¸ºé¡¹ç›®åï¼ŒcrossContext="true"</span><br><span class="line">    <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/WebappA"</span>  <span class="attr">debug</span>=<span class="string">"9"</span> <span class="attr">reloadable</span>=<span class="string">"true"</span> <span class="attr">crossContext</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Context</span> <span class="attr">path</span>=<span class="string">"/WebappB"</span>  <span class="attr">debug</span>=<span class="string">"9"</span> <span class="attr">reloadable</span>=<span class="string">"true"</span> <span class="attr">crossContext</span>=<span class="string">"true"</span>/&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">Host</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>crossContextå±æ€§çš„æ„æ€æ˜¯ï¼šå¦‚æœè®¾ç½®ä¸ºtrueï¼Œä½ å¯ä»¥é€šè¿‡ServletContext.getContext() è°ƒç”¨å¦å¤–ä¸€ä¸ªWEBåº”ç”¨ç¨‹åºï¼Œè·å¾—ServletContext ç„¶åå†è°ƒç”¨å…¶getAttribute() å¾—åˆ°ä½ è¦çš„å¯¹è±¡ã€‚<br>Javaä»£ç å¦‚ä¸‹ï¼š<br>WebappA:<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpSession session = request.getSession();  </span><br><span class="line">session.setAttribute(<span class="string">"userId"</span>, <span class="string">"test"</span>);  </span><br><span class="line">ServletContext ContextA =session .getServletContext();  </span><br><span class="line">ContextA.setAttribute(<span class="string">"session"</span>, session );</span><br></pre></td></tr></table></figure></p><p>WebappB:<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">HttpSession sessionB = request.getSession();    </span><br><span class="line">ServletContext ContextB = sessionB.getServletContext();    </span><br><span class="line">ServletContext ContextA= ContextB.getContext(<span class="string">"/WebappA"</span>);<span class="comment">// è¿™é‡Œé¢ä¼ é€’çš„æ˜¯ WebappAçš„è™šæ‹Ÿè·¯å¾„  </span></span><br><span class="line">HttpSession sessionA =(HttpSession)ContextA.getAttribute(<span class="string">"session"</span>);  </span><br><span class="line">System.out.println(<span class="string">"userId: "</span>+sessionA.getAttribute(<span class="string">"userId"</span>));</span><br></pre></td></tr></table></figure></p><p>åˆçœ‹è¿™ä¸ªæ–¹æ³•ï¼Œå¥½åƒæ˜¯å®Œæˆæˆ‘ä»¬çš„ç›®æ ‡ï¼Œå¯æ˜¯åœ¨æˆ‘å®é™…åº”ç”¨æ—¶å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“user1åœ¨ç™»å½•å‰ä¸å¯ä»¥è¿›å…¥CEOåº”ç”¨ï¼Œåœ¨user1ç™»å½•åæ‰å¯ä»¥è¿›å…¥CEOåº”ç”¨ï¼Œä½†æ˜¯å½“user1é€€å‡ºä¹‹åï¼Œæœªç™»å½•çš„ç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›å…¥CEOåº”ç”¨ã€‚<br>åæ¥ä»”ç»†çœ‹äº†ä¸€ä¸‹ç½‘ä¸Šæä¾›çš„æ–¹æ³•ï¼Œå®ƒåªæ˜¯åœ¨webappAçš„ServletContextå­˜å‚¨äº†ä¸€ä¸ªsessionå€¼ï¼Œç„¶åä¼ é€’ç»™webAPPBï¼Œä½†æ˜¯ä¹Ÿä»…ä»…åªèƒ½ä¼ é€’ä¸€ä¸ªsessionå€¼ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªç”¨æˆ·çš„æ—¶å€™å°±ä¼šå‡ºç°sessionè¦†ç›–ã€‚</p><p>äºæ˜¯æ¢ç©¶å…¶ä»–è§£å†³æ–¹æ³•ã€‚</p><h1 id="æ–¹æ³•2sessionCookiePath"><a href="#æ–¹æ³•2sessionCookiePath" class="headerlink" title="æ–¹æ³•2sessionCookiePath"></a>æ–¹æ³•2sessionCookiePath</h1><p>åœ¨tomcat conf/context.htmlä¸­æœ‰å¦‚ä¸‹é…ç½®</p><ul><li><strong>sessionCookieName</strong><br>The name to be used for all session cookies created for this context. If set, this overrides any name set by the web application. If not set, the value specified by the web application, if any, will be used, or the name JSESSIONID if the web application does not explicitly set one.</li><li><strong>sessionCookiePath</strong><br>The path to be used for all session cookies created for this context. If set, this overrides any path set by the web application. If not set, the value specified by the web application will be used, or the context path used if the web application does not explicitly set one. To configure all web application to use an empty path (this can be useful for portlet specification implementations) set this attribute to / in the global CATALINA_BASE/conf/context.xml file.<br>Note: Once one web application using sessionCookiePath=â€/â€œ obtains a session, all subsequent sessions for any other web application in the same host also configured with sessionCookiePath=â€/â€œ will always use the same session ID. This holds even if the session is invalidated and a new one created. This makes session fixation protection more difficult and requires custom, Tomcat specific code to change the session ID shared by the multiple applications.</li></ul><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡<code>sessionCookiePath</code>å±æ€§ä½¿å¾—ä¸€ä¸ªtomcatå®ä¾‹ä¸‹æ‰€æœ‰çš„webappséƒ½å…±äº«ä¸€ä¸ªsessionï¼Œé€šè¿‡sessionCookieNameæ¥æŒ‡å®šsessionCookieNameåå­—ã€‚</p><p>äºæ˜¯æˆ‘å°±åœ¨tomcat conf/context.htmlä¸­é…ç½®å¦‚ä¸‹ï¼š<br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">sessionCookiePath</span>=<span class="string">"/"</span> <span class="attr">sessionCookieName</span>=<span class="string">"SESSIONID"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°åœ¨ROOTåº”ç”¨å’ŒCEOåº”ç”¨ä¸­ç¡®å®sessionCookieæ˜¯ä¸€æ ·çš„ã€‚å¯æ˜¯å½“æˆ‘åœ¨ROOTä¸­è¿›è¡Œ<code>session.setAttribute();</code>æ—¶ï¼ŒCEOåº”ç”¨ä¸èƒ½ä»sessionä¸­å–å¾—å€¼ï¼Œä¸ºnullï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹CEOåº”ç”¨è€Œè¨€ï¼ŒROOTåº”ç”¨åœ¨sessionæ‰€å‚¨å­˜çš„å€¼æ˜¯ä¸å¯è§çš„ã€‚ç„¶ååœ¨CEO sessionä¸­è¿›è¡Œ<code>session.setAttribute();</code>ï¼ŒROOTåº”ç”¨æ€»åŒæ ·æ— æ³•å–å¾—CEOå­˜å‚¨åœ¨sessionä¸­çš„æ•°æ®ï¼ŒçŒœæƒ³å¯èƒ½æ˜¯ä¸åŒçš„webappså¹¶ä¸ä¼šå…±äº«ç›¸åŒçš„sessionå†…å­˜ï¼Œæ¯ä¸€ä¸ªwebappsç»´æŠ¤è‡ªå·±session HashTableï¼Œåæ¥äº†è§£åˆ° <strong>sessionç®¡ç†å™¨æ˜¯å’Œcontextå®¹å™¨å…³è”çš„ï¼Œä¹Ÿå°±è¯´æ¯ä¸ªwebåº”ç”¨éƒ½ä¼šæœ‰ä¸€ä¸ªsessionç®¡ç†å™¨</strong>ï¼Œæ‰€ä»¥CEOåº”ç”¨å½“ç„¶æ— æ³•ä»ROOTåº”ç”¨å­˜å‚¨çš„sessionä¸­å–å€¼ã€‚</p><h1 id="æ–¹æ³•3redis-session-å…±äº«"><a href="#æ–¹æ³•3redis-session-å…±äº«" class="headerlink" title="æ–¹æ³•3redis session å…±äº«"></a>æ–¹æ³•3redis session å…±äº«</h1><p>ä»¥å‰æ›¾ç»äº†è§£è¿‡Nginx+tomcat+redisåšè´Ÿè½½å‡è¡¡çš„å†…å®¹ï¼ŒçŸ¥é“å¯ä»¥æŠŠsessionæ•°æ®å­˜å‚¨åˆ°redisä¸­ï¼Œç„¶åtomcatå†å»rediså–å€¼ã€‚<br>è€Œè¿™æ¬¡çš„tomcatä¸­sessionåœ¨ä¸¤ä¸ªwebappä¸­å®ç°å…±äº«å…¶å®ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p><p>åœ¨tomcat conf/context.htmlä¸­é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">sessionCookiePath</span>=<span class="string">"/"</span> <span class="attr">sessionCookieName</span>=<span class="string">"SESSIONID"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionHandlerValve"</span> /&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"com.orangefunction.tomcat.redissessions.RedisSessionManager"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">host</span>=<span class="string">"172.22.4.16"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">port</span>=<span class="string">"6379"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">database</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">              <span class="attr">maxInactiveInterval</span>=<span class="string">"60"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Context</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åå³å¯å®ç°tomcatä¸­sessionåœ¨ä¸¤ä¸ªwebappä¸­å®ç°å…±äº«ã€‚</p><p><strong>jaråŒ…å’Œwindows rediså®‰è£…åŒ…</strong><br><a href="http://pan.baidu.com/s/1eSITNnc" target="_blank" rel="noopener">http://pan.baidu.com/s/1eSITNnc</a></p><h1 id="sessionè¿‡æœŸç­–ç•¥"><a href="#sessionè¿‡æœŸç­–ç•¥" class="headerlink" title="sessionè¿‡æœŸç­–ç•¥"></a>sessionè¿‡æœŸç­–ç•¥</h1><p><strong>tomcat-sessionæ€ä¹ˆå®ç°çš„è¿‡æœŸç­–ç•¥ï¼Ÿ</strong><br>é¦–å…ˆå¦‚æœæ²¡æœ‰ä½¿ç”¨redisåšsessionç¼“å­˜ï¼ŒtomcatæœåŠ¡å™¨åœ¨å¯åŠ¨çš„æ—¶å€™åˆå§‹åŒ–äº†ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹,å®šæœŸ6*10ç§’å»æ£€æŸ¥æœ‰æ²¡æœ‰Sessionè¿‡æœŸ.è¿‡æœŸåˆ™æ¸…é™¤ã€‚è€Œä½¿ç”¨çš„tomcat-session-redisåšç¼“å­˜ï¼Œé‚£ä¹ˆsessionè¿‡æœŸä¹‹åå°±ç”±redisè¿›è¡Œåˆ é™¤ï¼Œredisé€šè¿‡æƒ°æ€§åˆ é™¤å’Œå®šæœŸåˆ é™¤æ¥åˆ é™¤è¿‡æœŸçš„sessionIDå€¼ã€‚</p><p>å½“ç„¶sessionIDè¿˜å­˜åœ¨äºå®¢æˆ·ç«¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯çš„sessionIDæ¸…ç†è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ<br>ç»è¿‡æµ‹è¯•æ˜¯å½“tomcatåˆ é™¤sessionIDå€¼ä¹‹åï¼Œtomcatä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªsessionIDå€¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br><img src="https://images.morethink.cn/4b5f8d1d886507e22022f753d970a0e1.png" alt=""></p><p><strong>æ€»ç»“ï¼š</strong><br>å…¶å®æˆ‘è¿™ä¸ªåŠŸèƒ½å°±æ˜¯å•ç‚¹ç™»å½•ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨Aåº”ç”¨ç™»å½•çš„æƒ…å†µä¸‹å¯ä»¥è®¿é—®Båº”ç”¨ï¼Œä½†æ˜¯å³ä½¿è®¾ç½®äº†<code>sessionCookiePath</code>ï¼Œsessionçš„Attributeå¹¶æ²¡æœ‰å…±äº«ï¼Œäºæ˜¯æƒ³åˆ°äº†å…ˆæŠŠsessionåºåˆ—åŒ–åˆ°redisä¸­ï¼Œç„¶åå–å‡ºæ¥åˆ¤æ–­ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å•ç‚¹ç™»å½•ã€‚æ ¸å¿ƒæ˜¯sessionåœ¨è¿™ä¸¤ä¸ªåº”ç”¨ä¸­å¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œé€šè¿‡è®¾ç½®<code>sessionCookiePath</code>ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ol><li>å½“ä½ ä½¿ç”¨è‡ªå·±çš„å¯¹è±¡æ‰§è¡Œ<code>session.setAttribute();</code>æ—¶ï¼Œå¿…é¡»å®ç°<code>Serializable</code>æ¥å£ï¼Œä¸ç„¶æ— æ³•è¿›è¡Œåºåˆ—åŒ–ã€‚</li><li><p><code>maxInactiveInterval</code> ä¸èµ·ä½œç”¨<br>tomcatæ—¥å¿—æè¿°ï¼š<br>è­¦å‘Š: Manager.setMaxInactiveInterval() is deprecated and calls to this method are ignored. Session timeouts should be configured in web.xml or via Context.setSessionTimeout(int timeoutInMinutes).<br>ä¿¡æ¯: Will expire sessions after 120 seconds(é»˜è®¤æ˜¯30åˆ†é’Ÿ)<br>åªèƒ½é€šè¿‡åœ¨ROOTä¸‹çš„web.xmlæˆ–è€…å…¨å±€çš„web.xml(CEOä¸­çš„session-configæ— æ³•ç”Ÿæ•ˆ)ä¸­é…ç½®æ‰å¯ç”Ÿæ•ˆã€‚</p> <figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--è®¾ç½®sessionè¿‡æœŸæ—¶é—´--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">session-config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">session-timeout</span>&gt;</span>20<span class="tag">&lt;/<span class="name">session-timeout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">session-config</span>&gt;</span></span><br></pre></td></tr></table></figure><p> é…ç½®æˆåŠŸåtomcatæ—¥å¿—ï¼š<br> ä¿¡æ¯: Will expire sessions after 120 seconds</p></li><li><p>åœ¨contextä¸­é…ç½®hostä¸ºé™æ€ip 172.22.4.16æŠ¥é”™å¦‚ä¸‹:<br><img src="https://images.morethink.cn/efe8ce59cb21d0131028c15e278c80f7.png" alt="">ï¼ŒGoogleå‘ç°åŸæ¥rediså’Œmysqlä¸€æ ·éƒ½æ˜¯å·²ç»é»˜è®¤ç»‘å®šäº†localhostï¼Œåªå…è®¸æœ¬æœºè®¿é—®ï¼Œäºæ˜¯æ›´æ”¹<code>redis.windows-service.conf</code>å¦‚ä¸‹</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">bind 127.0.0.1 172.22.4.16</span><br></pre></td></tr></table></figure><p> ä¹‹åå°±å¯ä»¥ä½¿ç”¨é™æ€ip 172.22.4.16è¿›è¡Œè®¿é—®ã€‚</p></li><li>msiåº”ç”¨çš„å®‰è£…ï¼Œä¿®å¤å’Œå¸è½½éƒ½æ˜¯é€šè¿‡ç‚¹å‡»msiæ–‡ä»¶ã€‚</li><li><strong>è¿˜æœ‰ä¸€ä¸ªå…±äº«sessionçš„æ–¹æ¡ˆæ˜¯spring-sessionã€‚</strong> spring-sessionä¸­é€šè¿‡è‡ªå·±ç”Ÿæˆsessionå¹¶ä¸”å­˜å‚¨åˆ°redisä¸­ï¼Œè¿˜æ˜¯éœ€è¦è®¾ç½®<code>sessionCookiePath=&quot;/&quot;</code>(åœ¨ä¸€ä¸ªtomcatä¸¤ä¸ªåº”ç”¨éœ€è¦å•ç‚¹ç™»å½•çš„æƒ…å†µ)ï¼Œå…¶ä»–sessionå…±äº«æ–¹æ¡ˆ(åœ¨å¤šä¸ªtomcatä¸­å®ç°å•ç‚¹ç™»å½•å¯ä»¥å‚è€ƒ <a href="http://www.jianshu.com/p/a4f49e73bce6" target="_blank" rel="noopener">spring sessionæ— æ³•å®ç°å…±äº«ï¼ˆå¤šwebåº”ç”¨ï¼‰</a>)ï¼Œä½†æ˜¯spring-sessionä¸æ˜¯æœåŠ¡å™¨çº§åˆ«çš„ï¼Œè€Œæ˜¯web åº”ç”¨çº§åˆ«çš„ï¼Œä¸å—æœåŠ¡å™¨å¦‚tomcatï¼Œjettyï¼Œjbossçš„é™åˆ¶ã€‚</li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://tomcat.apache.org/tomcat-7.0-doc/config/context.html" target="_blank" rel="noopener">http://tomcat.apache.org/tomcat-7.0-doc/config/context.html</a></li><li><a href="https://segmentfault.com/a/1190000009591087" target="_blank" rel="noopener">æ­å»ºTomcaté›†ç¾¤&amp;é€šè¿‡Redisç¼“å­˜å…±äº«sessionçš„ä¸€ç§æµè¡Œæ–¹æ¡ˆ</a></li><li><a href="http://blog.csdn.net/jiangguilong2000/article/details/51969250" target="_blank" rel="noopener">Tomcatçš„Sessionè¿‡æœŸå¤„ç†ç­–ç•¥</a></li><li><a href="http://www.cnblogs.com/interdrp/p/4935614.html" target="_blank" rel="noopener">Tomcatä¸­sessionçš„ç®¡ç†æœºåˆ¶</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tomcat </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JDK8 HashMap æºç è§£æ</title>
      <link href="/HashMap/"/>
      <url>/HashMap/</url>
      
        <content type="html"><![CDATA[<h1 id="HashMapä¸­æ•°æ®ç»“æ„"><a href="#HashMapä¸­æ•°æ®ç»“æ„" class="headerlink" title="HashMapä¸­æ•°æ®ç»“æ„"></a>HashMapä¸­æ•°æ®ç»“æ„</h1><p>åœ¨jdk1.7ä¸­ï¼ŒHashMapé‡‡ç”¨æ•°ç»„+é“¾è¡¨(æ‹‰é“¾æ³•)ã€‚å› ä¸ºæ•°ç»„æ˜¯ä¸€ç»„è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ˜“æŸ¥è¯¢ï¼Œä¸æ˜“å¢åˆ ï¼Œè€Œé“¾è¡¨æ˜¯ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé€šè¿‡èŠ‚ç‚¹ç›¸äº’è¿æ¥ï¼Œæ˜“åˆ é™¤ï¼Œä¸æ˜“æŸ¥è¯¢ã€‚HashMapç»“åˆè¿™ä¸¤è€…çš„ä¼˜ç§€ä¹‹å¤„æ¥æé«˜æ•ˆç‡ã€‚</p><p>è€Œåœ¨jdk1.8æ—¶ï¼Œä¸ºäº†è§£å†³å½“hashç¢°æ’è¿‡äºé¢‘ç¹ï¼Œè€Œé“¾è¡¨çš„æŸ¥è¯¢æ•ˆç‡(æ—¶é—´å¤æ‚åº¦ä¸ºO(n))è¿‡ä½æ—¶ï¼Œå½“é“¾è¡¨çš„é•¿åº¦è¾¾åˆ°ä¸€å®šå€¼(é»˜è®¤æ˜¯8)æ—¶ï¼Œå°†é“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘(æ—¶é—´å¤æ‚åº¦ä¸ºO(lg n))ï¼Œæå¤§çš„æé«˜äº†æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://images.morethink.cn/b3e3671b2edf38a675b5a28587f37ae4.png" alt="" title="JDK8 HashMap"></p><a id="more"></a><h1 id="HashMapåˆå§‹åŒ–"><a href="#HashMapåˆå§‹åŒ–" class="headerlink" title="HashMapåˆå§‹åŒ–"></a>HashMapåˆå§‹åŒ–</h1><p><strong>ä»¥ä¸‹ä»£ç æœªç»ç‰¹åˆ«å£°æ˜ï¼Œéƒ½æ˜¯jdk1.8</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * The default initial capacity - MUST be a power of two.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEFAULT_INITIAL_CAPACITY = <span class="number">1</span> &lt;&lt; <span class="number">4</span>; <span class="comment">// aka 16</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the default initial capacity</span></span><br><span class="line"><span class="comment"> * (16) and the default load factor (0.75).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">HashMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="comment">// all other fields defaulted</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>HashMapçš„é»˜è®¤å¤§å°æ˜¯16ã€‚æŸ¥çœ‹<code>HashMap</code>çš„æ„é€ æ–¹æ³•ï¼Œå‘ç°æ²¡æœ‰æ‰§è¡Œnewæ“ä½œï¼ŒçŒœæµ‹å¯èƒ½è·Ÿ<code>ArrayList</code>ä¸€æ ·æ˜¯åœ¨ç¬¬ä¸€æ¬¡<code>add</code>çš„æ—¶å€™å¼€è¾Ÿçš„å†…å­˜ï¼Œäºæ˜¯æŸ¥çœ‹<code>put</code>æ–¹æ³•ã€‚</p><h1 id="putæ–¹æ³•"><a href="#putæ–¹æ³•" class="headerlink" title="putæ–¹æ³•"></a>putæ–¹æ³•</h1><h2 id="å…³äºNodeèŠ‚ç‚¹"><a href="#å…³äºNodeèŠ‚ç‚¹" class="headerlink" title="å…³äºNodeèŠ‚ç‚¹"></a>å…³äºNodeèŠ‚ç‚¹</h2><p>HashMapå°†hashï¼Œkeyï¼Œvalueï¼Œnextå·²ç»å°è£…åˆ°ä¸€ä¸ªé™æ€å†…éƒ¨ç±»Nodeä¸Šã€‚å®ƒå®ç°äº†<code>Map.Entry&lt;K,V&gt;</code>æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; <span class="keyword">implements</span> <span class="title">Map</span>.<span class="title">Entry</span>&lt;<span class="title">K</span>,<span class="title">V</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> hash;</span><br><span class="line">    <span class="keyword">final</span> K key;</span><br><span class="line">    V value;</span><br><span class="line">    Node&lt;K,V&gt; next;</span><br><span class="line"></span><br><span class="line">    Node(<span class="keyword">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;</span><br><span class="line">        <span class="keyword">this</span>.hash = hash;</span><br><span class="line">        <span class="keyword">this</span>.key = key;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">        <span class="keyword">this</span>.next = next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> K <span class="title">getKey</span><span class="params">()</span>        </span>&#123; <span class="keyword">return</span> key; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">getValue</span><span class="params">()</span>      </span>&#123; <span class="keyword">return</span> value; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> key + <span class="string">"="</span> + value; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> V <span class="title">setValue</span><span class="params">(V newValue)</span> </span>&#123;</span><br><span class="line">        V oldValue = value;</span><br><span class="line">        value = newValue;</span><br><span class="line">        <span class="keyword">return</span> oldValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (o <span class="keyword">instanceof</span> Map.Entry) &#123;</span><br><span class="line">            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;</span><br><span class="line">                Objects.equals(value, e.getValue()))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å®šä¹‰ä¸€ä¸ªNodeæ•°ç»„table</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br></pre></td></tr></table></figure><h2 id="hashå®ç°"><a href="#hashå®ç°" class="headerlink" title="hashå®ç°"></a>hashå®ç°</h2><p>å½“æˆ‘ä»¬putçš„æ—¶å€™ï¼Œé¦–å…ˆè®¡ç®— <code>key</code>çš„<code>hash</code>å€¼ï¼Œè¿™é‡Œè°ƒç”¨äº† <code>hash</code>æ–¹æ³•ï¼Œ<code>hash</code>æ–¹æ³•å®é™…æ˜¯è®©<code>key.hashCode()</code>ä¸<code>key.hashCode()&gt;&gt;&gt;16</code>è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œé«˜16bitè¡¥0ï¼Œä¸€ä¸ªæ•°å’Œ0å¼‚æˆ–ä¸å˜ï¼Œæ‰€ä»¥ hash å‡½æ•°å¤§æ¦‚çš„ä½œç”¨å°±æ˜¯ï¼š<strong>é«˜16bitä¸å˜ï¼Œä½16bitå’Œé«˜16bitåšäº†ä¸€ä¸ªå¼‚æˆ–ï¼Œç›®çš„æ˜¯å‡å°‘ç¢°æ’</strong>ã€‚æŒ‰ç…§å‡½æ•°æ³¨é‡Šï¼Œå› ä¸ºbucketæ•°ç»„å¤§å°æ˜¯2çš„å¹‚ï¼Œè®¡ç®—ä¸‹æ ‡<code>index = (table.length - 1) &amp; hash</code>ï¼Œå¦‚æœä¸åš hash å¤„ç†ï¼Œç›¸å½“äºæ•£åˆ—ç”Ÿæ•ˆçš„åªæœ‰å‡ ä¸ªä½ bit ä½ï¼Œä¸ºäº†å‡å°‘æ•£åˆ—çš„ç¢°æ’ï¼Œè®¾è®¡è€…ç»¼åˆè€ƒè™‘äº†é€Ÿåº¦ã€ä½œç”¨ã€è´¨é‡ä¹‹åï¼Œä½¿ç”¨é«˜16bitå’Œä½16bitå¼‚æˆ–æ¥ç®€å•å¤„ç†å‡å°‘ç¢°æ’ï¼Œè€Œä¸”JDK8ä¸­ç”¨äº†å¤æ‚åº¦ Oï¼ˆlognï¼‰çš„æ ‘ç»“æ„æ¥æå‡ç¢°æ’ä¸‹çš„æ€§èƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">put</span><span class="params">(K key, V value)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> putVal(hash(key), key, value, <span class="keyword">false</span>, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    <span class="keyword">return</span> (key == <span class="keyword">null</span>) ? <span class="number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="number">16</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ç°æ–¹æ³•"><a href="#å®ç°æ–¹æ³•" class="headerlink" title="å®ç°æ–¹æ³•"></a>å®ç°æ–¹æ³•</h2><ul><li>å¦‚æœå½“å‰æ•°ç»„tableä¸ºnullï¼Œè¿›è¡Œresize()åˆå§‹åŒ–</li><li>å¦åˆ™è®¡ç®—æ•°ç»„ç´¢å¼•<code>i = (n - 1) &amp; hash</code></li><li>å¦‚æœè¿™ä¸ªtable[i]å€¼ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å°†è¿™ä¸ªNodeé”®å€¼å¯¹æ”¾åœ¨è¿™é‡Œ</li><li>åˆ¤æ–­keyæ˜¯å¦ä¸table[i]é‡å¤ï¼Œé‡å¤åˆ™æ›¿æ¢</li><li>ä¸é‡å¤åœ¨åˆ¤æ–­table[i]æ˜¯å¦è¿æ¥äº†ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸ºç©ºåˆ™new ä¸€ä¸ªNodeé”®å€¼å¯¹ï¼Œé“¾è¡¨ä¸ä¸ºç©ºå°±å¾ªç¯ç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„nextä¸ºnullæˆ–è€…å‡ºç°å‡ºç°é‡å¤keyå€¼</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">final</span> V <span class="title">putVal</span><span class="params">(<span class="keyword">int</span> hash, K key, V value, <span class="keyword">boolean</span> onlyIfAbsent,</span></span></span><br><span class="line"><span class="function"><span class="params">               <span class="keyword">boolean</span> evict)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="keyword">int</span> n, i;</span><br><span class="line">    <span class="comment">// é»˜è®¤å®¹é‡åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">if</span> ((tab = table) == <span class="keyword">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">        n = (tab = resize()).length;</span><br><span class="line">    <span class="comment">//å¦‚æœtable[i]ä¸ºç©ºï¼Œé‚£å°±æŠŠè¿™ä¸ªé”®å€¼å¯¹æ”¾åœ¨table[i], i = (n - 1) &amp; hash ç›¸ç­‰äº hash % n,</span></span><br><span class="line">    <span class="comment">//ä½†æ˜¯hashåæŒ‰ä½ä¸ n-1ï¼Œæ¯”%æ¨¡è¿ç®—å–ä½™è¦å¿«</span></span><br><span class="line">    <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="keyword">null</span>)</span><br><span class="line">        tab[i] = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">//å½“å¦ä¸€ä¸ªkeyçš„hashå€¼å·²ç»å­˜åœ¨æ—¶</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e; K k;</span><br><span class="line">        <span class="comment">// table[i].key == key</span></span><br><span class="line">        <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">            ((k = p.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            e = p;</span><br><span class="line">            <span class="comment">//JDK8åœ¨å“ˆå¸Œç¢°æ’çš„é“¾è¡¨é•¿åº¦è¾¾åˆ°TREEIFY_THRESHOLDï¼ˆé»˜è®¤8)åï¼Œ</span></span><br><span class="line">            <span class="comment">//ä¼šæŠŠè¯¥é“¾è¡¨è½¬å˜æˆæ ‘ç»“æ„ï¼Œæé«˜äº†æ€§èƒ½ã€‚</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="keyword">this</span>, tab, hash, key, value);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//éå†table[i]æ‰€å¯¹åº”çš„é“¾è¡¨ï¼Œç›´åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„nextä¸ºnullæˆ–è€…æœ‰é‡å¤çš„keyå€¼</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> binCount = <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((e = p.next) == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    p.next = newNode(hash, key, value, <span class="keyword">null</span>);</span><br><span class="line">                    <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                        treeifyBin(tab, hash);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                p = e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//keyé‡å¤ï¼Œæ›¿æ¢value</span></span><br><span class="line">        <span class="keyword">if</span> (e != <span class="keyword">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">            V oldValue = e.value;</span><br><span class="line">            <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="keyword">null</span>)</span><br><span class="line">                e.value = value;</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">            <span class="keyword">return</span> oldValue;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++modCount;</span><br><span class="line">    <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">        resize();</span><br><span class="line">    afterNodeInsertion(evict);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Callbacks to allow LinkedHashMap post-actions</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterNodeAccess</span><span class="params">(Node&lt;K,V&gt; p)</span> </span>&#123; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterNodeInsertion</span><span class="params">(<span class="keyword">boolean</span> evict)</span> </span>&#123; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">afterNodeRemoval</span><span class="params">(Node&lt;K,V&gt; p)</span> </span>&#123; &#125;</span><br></pre></td></tr></table></figure><h1 id="getæ–¹æ³•"><a href="#getæ–¹æ³•" class="headerlink" title="getæ–¹æ³•"></a>getæ–¹æ³•</h1><p>é¦–å…ˆé€šè¿‡<code>hash</code>å‡½æ•°æ‰¾åˆ°ç´¢å¼•ï¼Œç„¶ååˆ¤æ–­mapä¸ºnullï¼Œå†åˆ¤æ–­table[i]æ˜¯å¦ç­‰äºkeyï¼Œç„¶ååœ¨æ‰¾ä¸tableç›¸è¿çš„é“¾è¡¨çš„keyæ˜¯å¦ç›¸ç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> V <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt; e;</span><br><span class="line">    <span class="keyword">return</span> (e = getNode(hash(key), key)) == <span class="keyword">null</span> ? <span class="keyword">null</span> : e.value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">final</span> Node&lt;K,V&gt; <span class="title">getNode</span><span class="params">(<span class="keyword">int</span> hash, Object key)</span> </span>&#123;</span><br><span class="line">    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="keyword">int</span> n; K k;</span><br><span class="line">    <span class="keyword">if</span> ((tab = table) != <span class="keyword">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">        (first = tab[(n - <span class="number">1</span>) &amp; hash]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (first.hash == hash &amp;&amp; <span class="comment">// always check first node</span></span><br><span class="line">            ((k = first.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">            <span class="keyword">return</span> first;</span><br><span class="line">        <span class="keyword">if</span> ((e = first.next) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (first <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                <span class="keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                    ((k = e.key) == key || (key != <span class="keyword">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                    <span class="keyword">return</span> e;</span><br><span class="line">            &#125; <span class="keyword">while</span> ((e = e.next) != <span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="jdk1-7ä¸­çš„çº¿ç¨‹å®‰å…¨é—®é¢˜-resizeæ­»å¾ªç¯"><a href="#jdk1-7ä¸­çš„çº¿ç¨‹å®‰å…¨é—®é¢˜-resizeæ­»å¾ªç¯" class="headerlink" title="jdk1.7ä¸­çš„çº¿ç¨‹å®‰å…¨é—®é¢˜(resizeæ­»å¾ªç¯)"></a>jdk1.7ä¸­çš„çº¿ç¨‹å®‰å…¨é—®é¢˜(resizeæ­»å¾ªç¯)</h1><p>å½“HashMapçš„sizeè¶…è¿‡Capacity*loadFactoræ—¶ï¼Œéœ€è¦å¯¹HashMapè¿›è¡Œæ‰©å®¹ã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œé•¿åº¦ä¸ºåŸæ¥Capacityä¸¤å€çš„æ•°ç»„ï¼Œä¿è¯æ–°çš„Capacityä»ä¸º2çš„Næ¬¡æ–¹ï¼Œä»è€Œä¿è¯ä¸Šè¿°å¯»å€æ–¹å¼ä»é€‚ç”¨ã€‚åŒæ—¶éœ€è¦é€šè¿‡å¦‚ä¸‹transferæ–¹æ³•å°†åŸæ¥çš„æ‰€æœ‰æ•°æ®å…¨éƒ¨é‡æ–°æ’å…¥ï¼ˆrehashï¼‰åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚</p><p>ä¸‹åˆ—ä»£ç åŸºäº jdk1.7.0_79</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transfer</span><span class="params">(Entry[] newTable, <span class="keyword">boolean</span> rehash)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> newCapacity = newTable.length;</span><br><span class="line">  <span class="keyword">for</span> (Entry&lt;K,V&gt; e : table) &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="keyword">null</span> != e) &#123;</span><br><span class="line">      Entry&lt;K,V&gt; next = e.next;</span><br><span class="line">      <span class="keyword">if</span> (rehash) &#123;</span><br><span class="line">        e.hash = <span class="keyword">null</span> == e.key ? <span class="number">0</span> : hash(e.key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">int</span> i = indexFor(e.hash, newCapacity);</span><br><span class="line">      e.next = newTable[i];</span><br><span class="line">      newTable[i] = e;</span><br><span class="line">      e = next;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¥æ–¹æ³•å¹¶ä¸ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œè€Œä¸”åœ¨å¤šçº¿ç¨‹å¹¶å‘è°ƒç”¨æ—¶ï¼Œå¯èƒ½å‡ºç°æ­»å¾ªç¯ã€‚å…¶æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ã€‚ä»æ­¥éª¤2å¯è§ï¼Œè½¬ç§»æ—¶é“¾è¡¨é¡ºåºåè½¬ã€‚</p><ol><li>éå†åŸæ•°ç»„ä¸­çš„å…ƒç´ </li><li>å¯¹é“¾è¡¨ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹éå†ï¼šç”¨nextå–å¾—è¦è½¬ç§»é‚£ä¸ªå…ƒç´ çš„ä¸‹ä¸€ä¸ªï¼Œå°†eè½¬ç§»åˆ°æ–°æ•°ç»„çš„å¤´éƒ¨ï¼Œä½¿ç”¨å¤´æ’æ³•æ’å…¥èŠ‚ç‚¹</li><li>å¾ªç¯2ï¼Œç›´åˆ°é“¾è¡¨èŠ‚ç‚¹å…¨éƒ¨è½¬ç§»</li><li>å¾ªç¯1ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å…¨éƒ¨è½¬ç§»</li></ol><h2 id="å•çº¿ç¨‹rehash"><a href="#å•çº¿ç¨‹rehash" class="headerlink" title="å•çº¿ç¨‹rehash"></a>å•çº¿ç¨‹rehash</h2><p>å•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œrehashæ— é—®é¢˜ã€‚ä¸‹å›¾æ¼”ç¤ºäº†å•çº¿ç¨‹æ¡ä»¶ä¸‹çš„rehashè¿‡ç¨‹<br><img src="https://images.morethink.cn/c05a4a71c5ef3eb97458a16751a1815f.png" alt="" title="å•çº¿ç¨‹rehash"></p><h2 id="å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„rehash"><a href="#å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„rehash" class="headerlink" title="å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„rehash"></a>å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„rehash</h2><p>è¿™é‡Œå‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œäº†putæ“ä½œå¹¶å¼•å‘äº†rehashï¼Œæ‰§è¡Œäº†transferæ–¹æ³•ï¼Œå¹¶å‡è®¾çº¿ç¨‹ä¸€è¿›å…¥transferæ–¹æ³•å¹¶æ‰§è¡Œå®Œnext = e.nextåï¼Œå› ä¸ºçº¿ç¨‹è°ƒåº¦æ‰€åˆ†é…æ—¶é—´ç‰‡ç”¨å®Œè€Œâ€œæš‚åœâ€ï¼Œæ­¤æ—¶çº¿ç¨‹äºŒå®Œæˆäº†transferæ–¹æ³•çš„æ‰§è¡Œã€‚æ­¤æ—¶çŠ¶æ€å¦‚ä¸‹ã€‚</p><p><img src="https://images.morethink.cn/dc8ccf56884d2e89deba7e7903d6162b.png" alt=""></p><p>æ¥ç€çº¿ç¨‹1è¢«å”¤é†’ï¼Œç»§ç»­æ‰§è¡Œç¬¬ä¸€è½®å¾ªç¯çš„å‰©ä½™éƒ¨åˆ†</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">e.next = newTable[<span class="number">1</span>] = <span class="keyword">null</span></span><br><span class="line">newTable[<span class="number">1</span>] = e = key(<span class="number">5</span>)</span><br><span class="line">e = next = key(<span class="number">9</span>)</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://images.morethink.cn/5cdb106bc7eb9e827acf573312db6ae5.png" alt=""></p><p>æ¥ç€æ‰§è¡Œä¸‹ä¸€è½®å¾ªç¯ï¼Œç»“æœçŠ¶æ€å›¾å¦‚ä¸‹æ‰€ç¤º</p><p><img src="https://images.morethink.cn/75b2eb45292a2176ef3e8048179b9d6d.png" alt=""><br>æ­¤æ—¶å¾ªç¯é“¾è¡¨å½¢æˆï¼Œå¹¶ä¸”key(11)æ— æ³•åŠ å…¥åˆ°çº¿ç¨‹1çš„æ–°æ•°ç»„ã€‚åœ¨ä¸‹ä¸€æ¬¡è®¿é—®è¯¥é“¾è¡¨æ—¶ä¼šå‡ºç°æ­»å¾ªç¯ã€‚</p><h1 id="jdk1-8ä¸­çš„æ‰©å®¹"><a href="#jdk1-8ä¸­çš„æ‰©å®¹" class="headerlink" title="jdk1.8ä¸­çš„æ‰©å®¹"></a>jdk1.8ä¸­çš„æ‰©å®¹</h1><p>åœ¨jdk1.8ä¸­é‡‡ç”¨resizeæ–¹æ³•æ¥å¯¹HashMapè¿›è¡Œæ‰©å®¹ã€‚</p><h2 id="resizeæ–¹æ³•"><a href="#resizeæ–¹æ³•" class="headerlink" title="resizeæ–¹æ³•"></a>resizeæ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;</span><br><span class="line">    Node&lt;K,V&gt;[] oldTab = table;</span><br><span class="line">    <span class="keyword">int</span> oldCap = (oldTab == <span class="keyword">null</span>) ? <span class="number">0</span> : oldTab.length;</span><br><span class="line">    <span class="keyword">int</span> oldThr = threshold;</span><br><span class="line">    <span class="keyword">int</span> newCap, newThr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (oldCap &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">// è¶…è¿‡æœ€å¤§å€¼å°±ä¸å†æ‰©å……äº†ï¼Œå°±åªå¥½éšä½ ç¢°æ’å»å§</span></span><br><span class="line">        <span class="keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;</span><br><span class="line">            threshold = Integer.MAX_VALUE;</span><br><span class="line">            <span class="keyword">return</span> oldTab;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ²¡è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å……ä¸ºåŸæ¥çš„2å€</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;</span><br><span class="line">                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)</span><br><span class="line">            newThr = oldThr &lt;&lt; <span class="number">1</span>; <span class="comment">// double threshold</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (oldThr &gt; <span class="number">0</span>) <span class="comment">// initial capacity was placed in threshold</span></span><br><span class="line">        newCap = oldThr;</span><br><span class="line">    <span class="keyword">else</span> &#123;               <span class="comment">// zero initial threshold signifies using defaults</span></span><br><span class="line">        newCap = DEFAULT_INITIAL_CAPACITY;</span><br><span class="line">        newThr = (<span class="keyword">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">// è®¡ç®—æ–°çš„resizeä¸Šé™</span></span><br><span class="line">    <span class="keyword">if</span> (newThr == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">float</span> ft = (<span class="keyword">float</span>)newCap * loadFactor;</span><br><span class="line">        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="keyword">float</span>)MAXIMUM_CAPACITY ?</span><br><span class="line">                  (<span class="keyword">int</span>)ft : Integer.MAX_VALUE);</span><br><span class="line">    &#125;</span><br><span class="line">    threshold = newThr;</span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(&#123;<span class="string">"rawtypes"</span>,<span class="string">"unchecked"</span>&#125;)</span><br><span class="line">        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="keyword">new</span> Node[newCap];</span><br><span class="line">    table = newTab;</span><br><span class="line">    <span class="keyword">if</span> (oldTab != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="comment">// æŠŠæ¯ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketsä¸­</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; oldCap; ++j) &#123;</span><br><span class="line">            Node&lt;K,V&gt; e;</span><br><span class="line">            <span class="keyword">if</span> ((e = oldTab[j]) != <span class="keyword">null</span>) &#123;</span><br><span class="line">              <span class="comment">// æ¸…é™¤åŸæ¥table[i]ä¸­çš„å€¼</span></span><br><span class="line">                oldTab[j] = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (e.next == <span class="keyword">null</span>)</span><br><span class="line">                    newTab[e.hash &amp; (newCap - <span class="number">1</span>)] = e;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (e <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)e).split(<span class="keyword">this</span>, newTab, j, oldCap);</span><br><span class="line">                <span class="keyword">else</span> &#123; <span class="comment">// å¸¦æœ‰é“¾è¡¨æ—¶ä¼˜åŒ–é‡hash</span></span><br><span class="line">                    Node&lt;K,V&gt; loHead = <span class="keyword">null</span>, loTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; hiHead = <span class="keyword">null</span>, hiTail = <span class="keyword">null</span>;</span><br><span class="line">                    Node&lt;K,V&gt; next;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        next = e.next;</span><br><span class="line">                        <span class="comment">// åŸç´¢å¼•ï¼Œ(e.hash &amp; oldCap) == 0 è¯´æ˜ åœ¨putæ“ä½œé€šè¿‡ hash &amp; newThr</span></span><br><span class="line">                        <span class="comment">//è®¡ç®—å‡ºçš„ç´¢å¼•å€¼ç­‰äºç°åœ¨çš„ç´¢å¼•å€¼ã€‚</span></span><br><span class="line">                        <span class="keyword">if</span> ((e.hash &amp; oldCap) == <span class="number">0</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (loTail == <span class="keyword">null</span>)</span><br><span class="line">                                loHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                loTail.next = e;</span><br><span class="line">                            loTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// åŸç´¢å¼•+oldCapï¼Œä¸æ˜¯åŸç´¢å¼•ï¼Œå°±ç§»åŠ¨åŸæ¥çš„é•¿åº¦</span></span><br><span class="line">                        <span class="keyword">else</span> &#123;</span><br><span class="line">                            <span class="keyword">if</span> (hiTail == <span class="keyword">null</span>)</span><br><span class="line">                                hiHead = e;</span><br><span class="line">                            <span class="keyword">else</span></span><br><span class="line">                                hiTail.next = e;</span><br><span class="line">                            hiTail = e;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = next) != <span class="keyword">null</span>);</span><br><span class="line">                    <span class="comment">// åŸç´¢å¼•æ”¾åˆ°bucketé‡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> (loTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        loTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j] = loHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// åŸç´¢å¼•+oldCapæ”¾åˆ°bucketé‡Œ</span></span><br><span class="line">                    <span class="keyword">if</span> (hiTail != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        hiTail.next = <span class="keyword">null</span>;</span><br><span class="line">                        newTab[j + oldCap] = hiHead;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> newTab;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å£°æ˜ä¸¤å¯¹æŒ‡é’ˆï¼Œç»´æŠ¤ä¸¤ä¸ªé“¾è¡¨ï¼Œä¾æ¬¡åœ¨æœ«ç«¯æ·»åŠ æ–°çš„å…ƒç´ ï¼Œåœ¨å¤šçº¿ç¨‹æ“ä½œçš„æƒ…å†µä¸‹ï¼Œæ— éæ˜¯ç¬¬äºŒä¸ªçº¿ç¨‹é‡å¤ç¬¬ä¸€ä¸ªçº¿ç¨‹ä¸€æ¨¡ä¸€æ ·çš„æ“ä½œã€‚</p><p><strong>å› æ­¤ä¸ä¼šäº§ç”Ÿjdk1.7æ‰©å®¹æ—¶çš„resizeæ­»å¾ªç¯é—®é¢˜</strong>ã€‚</p><p>jdk1.8ä¸­hashmapçš„ç¡®ä¸ä¼šå› ä¸ºå¤šçº¿ç¨‹putå¯¼è‡´æ­»å¾ªç¯ï¼Œä½†æ˜¯ä¾ç„¶æœ‰å…¶ä»–çš„å¼Šç«¯ã€‚å› æ­¤å¤šçº¿ç¨‹æƒ…å†µä¸‹è¿˜æ˜¯å»ºè®®ä½¿ç”¨concurrenthashmapã€‚</p><h1 id="é¢è¯•é—®é¢˜"><a href="#é¢è¯•é—®é¢˜" class="headerlink" title="é¢è¯•é—®é¢˜"></a>é¢è¯•é—®é¢˜</h1><ol><li><p>å¦‚æœnew HashMap(19)ï¼Œbucketæ•°ç»„å¤šå¤§ï¼Ÿ<br>HashMapçš„bucket æ•°ç»„å¤§å°ä¸€å®šæ˜¯2çš„å¹‚ï¼Œå¦‚æœnewçš„æ—¶å€™æŒ‡å®šäº†å®¹é‡ä¸”ä¸æ˜¯2çš„å¹‚ï¼Œå®é™…å®¹é‡ä¼šæ˜¯æœ€æ¥è¿‘(å¤§äº)æŒ‡å®šå®¹é‡çš„2çš„å¹‚ï¼Œæ¯”å¦‚ new HashMap&lt;&gt;(19)ï¼Œæ¯”19å¤§ä¸”æœ€æ¥è¿‘çš„2çš„å¹‚æ˜¯32ï¼Œå®é™…å®¹é‡å°±æ˜¯32ã€‚<br> <strong>åŸºç¡€çŸ¥è¯†</strong><br> <img src="https://images.morethink.cn/cb763e4543ffb313ba5906deea59bdb8.png" alt="|ç¬¦å·   | æè¿° | è¿ç®—è§„åˆ™| | ---|---|---| |&amp;      | ä¸   | ä¸¤ä¸ªä½éƒ½ä¸º1æ—¶ï¼Œç»“æœæ‰ä¸º1| |&#124; | æˆ–   | ä¸¤ä¸ªä½éƒ½ä¸º0æ—¶ï¼Œç»“æœæ‰ä¸º0| |&and;  | å¼‚æˆ– | ä¸¤ä¸ªä½ç›¸åŒä¸º0ï¼Œç›¸å¼‚ä¸º1| |~      | å–å | 0å˜1ï¼Œ1å˜0|" title="ä½è¿ç®—"><br> <strong>ç®€ä¾¿æ–¹æ³•</strong>ï¼š<br> å¦‚å¯¹ <code>a</code> æŒ‰ä½å–åï¼Œåˆ™å¾—åˆ°çš„ç»“æœä¸º <code>-(a+1)</code> ã€‚<br> æ­¤æ¡è¿ç®—æ–¹å¼å¯¹æ­£æ•°è´Ÿæ•°å’Œé›¶éƒ½é€‚ç”¨ã€‚<br> <strong>æºç </strong></p> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a power of two size for the given target capacity.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">tableSizeFor</span><span class="params">(<span class="keyword">int</span> cap)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = cap - <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">2</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">8</span>;</span><br><span class="line">    n |= n &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ? <span class="number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>è§£æ</strong><br> å…ˆæ¥åˆ†ææœ‰å…³nä½æ“ä½œéƒ¨åˆ†ï¼šå…ˆæ¥å‡è®¾nçš„äºŒè¿›åˆ¶ä¸º01xxxâ€¦xxxã€‚æ¥ç€<br> å¯¹nå³ç§»1ä½ï¼š001xxâ€¦xxxï¼Œå†ä½æˆ–ï¼š011xxâ€¦xxx<br> å¯¹nå³ç§»2ä¸ºï¼š00011â€¦xxxï¼Œå†ä½æˆ–ï¼š01111â€¦xxx<br> æ­¤æ—¶å‰é¢å·²ç»æœ‰å››ä¸ª1äº†ï¼Œå†å³ç§»4ä½ä¸”ä½æˆ–å¯å¾—8ä¸ª1<br> åŒç†ï¼Œæœ‰8ä¸ª1ï¼Œå³ç§»8ä½è‚¯å®šä¼šè®©åå…«ä½ä¹Ÿä¸º1ã€‚<br> ç»¼ä¸Šå¯å¾—ï¼Œè¯¥ç®—æ³•è®©æœ€é«˜ä½çš„1åé¢çš„ä½å…¨å˜ä¸º1ã€‚<br> æœ€åå†è®©ç»“æœn+1ï¼Œå³å¾—åˆ°äº†2çš„æ•´æ•°æ¬¡å¹‚çš„å€¼äº†ã€‚<br> ç°åœ¨å›æ¥çœ‹çœ‹ç¬¬ä¸€æ¡è¯­å¥ï¼š<br> <code>int n = cap - 1;</code><br> ã€€ã€€è®©cap-1å†èµ‹å€¼ç»™nçš„ç›®çš„æ˜¯å¦æ‰¾åˆ°çš„ç›®æ ‡å€¼å¤§äºæˆ–ç­‰äºåŸå€¼ã€‚ä¾‹å¦‚äºŒè¿›åˆ¶1000ï¼Œåè¿›åˆ¶æ•°å€¼ä¸º8ã€‚å¦‚æœä¸å¯¹å®ƒå‡1è€Œç›´æ¥æ“ä½œï¼Œå°†å¾—åˆ°ç­”æ¡ˆ10000ï¼Œå³16ã€‚æ˜¾ç„¶ä¸æ˜¯ç»“æœã€‚å‡1åäºŒè¿›åˆ¶ä¸º111ï¼Œå†è¿›è¡Œæ“ä½œåˆ™ä¼šå¾—åˆ°åŸæ¥çš„æ•°å€¼1000ï¼Œå³8ã€‚<br> ã€€ã€€è¿™ç§æ–¹æ³•çš„æ•ˆç‡éå¸¸é«˜ï¼Œå¯è§Java8å¯¹å®¹å™¨ä¼˜åŒ–äº†å¾ˆå¤šï¼Œå¾ˆå¼ºå“ˆã€‚å…¶ä»–ä¹‹åå†è¿›è¡Œåˆ†æå§ã€‚</p></li><li>HashMapä»€ä¹ˆæ—¶å€™å¼€è¾Ÿbucketæ•°ç»„å ç”¨å†…å­˜ï¼Ÿ<br>HashMapåœ¨new åå¹¶ä¸ä¼šç«‹å³åˆ†é…bucketæ•°ç»„ï¼Œè€Œæ˜¯ç¬¬ä¸€æ¬¡putæ—¶åˆå§‹åŒ–ï¼Œç±»ä¼¼ArrayListåœ¨ç¬¬ä¸€æ¬¡addæ—¶åˆ†é…ç©ºé—´ã€‚</li><li>HashMapä½•æ—¶æ‰©å®¹ï¼Ÿ<br>HashMap åœ¨ put çš„å…ƒç´ æ•°é‡å¤§äº Capacity <em> LoadFactorï¼ˆé»˜è®¤16 </em> 0.75ï¼‰ ä¹‹åä¼šè¿›è¡Œæ‰©å®¹ã€‚</li><li>å½“ä¸¤ä¸ªå¯¹è±¡çš„hashcodeç›¸åŒä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<br>ç¢°æ’</li><li>å¦‚æœä¸¤ä¸ªé”®çš„hashcodeç›¸åŒï¼Œä½ å¦‚ä½•è·å–å€¼å¯¹è±¡ï¼Ÿ<br>éå†ä¸hashCodeå€¼ç›¸ç­‰æ—¶ç›¸è¿çš„é“¾è¡¨ï¼Œç›´åˆ°ç›¸ç­‰æˆ–è€…null</li><li>ä½ äº†è§£é‡æ–°è°ƒæ•´HashMapå¤§å°å­˜åœ¨ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://blog.csdn.net/vking_wang/article/details/14166593" target="_blank" rel="noopener">HashMapå®ç°åŸç†åˆ†æ</a></li><li><a href="https://zhuanlan.zhihu.com/p/30360734?utm_source=qq&amp;utm_medium=social" target="_blank" rel="noopener">ç”±é˜¿é‡Œå·´å·´Javaå¼€å‘è§„çº¦HashMapæ¡ç›®å¼•å‘çš„æ•…äº‹</a></li><li><a href="http://www.cnblogs.com/loading4/p/6239441.html" target="_blank" rel="noopener">Java8 HashMapä¹‹tableSizeFor</a></li><li><a href="https://tech.meituan.com/java-hashmap.html" target="_blank" rel="noopener">Java 8ç³»åˆ—ä¹‹é‡æ–°è®¤è¯†HashMap</a></li><li><a href="http://www.jasongj.com/java/concurrenthashmap/index.html" target="_blank" rel="noopener">Javaè¿›é˜¶ï¼ˆå…­ï¼‰ä»ConcurrentHashMapçš„æ¼”è¿›çœ‹Javaå¤šçº¿ç¨‹æ ¸å¿ƒæŠ€æœ¯</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HashMap </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows ApacheæœåŠ¡å™¨é…ç½®</title>
      <link href="/Windows-apache-Server/"/>
      <url>/Windows-apache-Server/</url>
      
        <content type="html"><![CDATA[<h1 id="Apache"><a href="#Apache" class="headerlink" title="Apache"></a>Apache</h1><p>64ä½å¯ä»¥è€Œ32ä½ä¸å¯ä»¥</p><h2 id="å®‰è£…ApacheæœåŠ¡"><a href="#å®‰è£…ApacheæœåŠ¡" class="headerlink" title="å®‰è£…ApacheæœåŠ¡"></a>å®‰è£…ApacheæœåŠ¡</h2><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>å¦‚æœæ²¡æœ‰è‡ªå·±è®¾ç½®ApacheæœåŠ¡åï¼Œåé¢éƒ½å¯ä¸è·Ÿ-n â€œæœåŠ¡åâ€ï¼Œå³é‡‡ç”¨é»˜è®¤çš„æœåŠ¡åç§°ã€‚</li><li>å¿…é¡»ç”¨ç®¡ç†å‘˜æç¤ºç¬¦æ‰“å¼€ï¼Œç›´æ¥ç”¨shift+F10æ‰“å¼€å‘½ä»¤è¡Œæ˜¯ä¸è¡Œçš„ã€‚</li></ul><a id="more"></a><p><strong>å‘½ä»¤ï¼š</strong></p><ol><li>å°†apacheæ³¨å†Œä¸ºæœåŠ¡<ul><li>httpd -k install<br>å°†Apacheæ³¨å†Œä¸ºwindowsæœåŠ¡ï¼Œå¯ä»¥æŒ‡å®šçš„æœåŠ¡åä¸ºâ€apacheâ€ã€‚</li><li>httpd -k install -n â€œæœåŠ¡åâ€ã€€<br>å°†Apacheæ³¨å†Œä¸ºwindowsæœåŠ¡ï¼Œè‡ªå·±æŒ‡å®šä¸€ä¸ªæœåŠ¡åå­—ã€‚</li><li>httpd -k install -n â€œæœåŠ¡åâ€ -f â€œconf\my.confâ€<br>å°†Apacheæ³¨å†Œä¸ºwindowsæœåŠ¡ï¼Œè‡ªå·±æŒ‡å®šä¸€ä¸ªæœåŠ¡åå­—ï¼Œå¹¶ä¸”ä½¿ç”¨ç‰¹å®šé…ç½®æ–‡ä»¶ã€‚</li></ul></li><li>å¸è½½ApacheæœåŠ¡<ul><li>httpd.exe -k uninstall -n â€œæœåŠ¡åâ€ã€€<br>ç§»é™¤ApacheæœåŠ¡ï¼Œ-n åé¢è·Ÿè‡ªå·±å–å¾—ApacheæœåŠ¡å™¨åå­—</li></ul></li><li>å¯åŠ¨ApacheæœåŠ¡<ul><li>httpd.exe -k start -n â€œæœåŠ¡åâ€ã€€</li></ul></li><li>åœæ­¢ApacheæœåŠ¡<ul><li>httpd.exe -k stop -n â€œæœåŠ¡åâ€ã€€</li><li>httpd.exe -k shutdown -n â€œæœåŠ¡åâ€ ã€€</li></ul></li><li>é‡å¯ApacheæœåŠ¡<ul><li>httpd.exe -k restart -n â€œæœåŠ¡åâ€ã€€</li></ul></li></ol><p>æƒ³è¦æ­£ç¡®å¯åŠ¨Apache æœåŠ¡ï¼Œè¿˜éœ€è¦åœ¨httpd.confä¸­é…ç½®<code>Define SRVROOT &quot;E:\Apache24&quot;</code>ä¸ºæœ¬åœ°Apacheä½ç½®ã€‚</p><h2 id="Apacheåå‘ä»£ç†é…ç½®"><a href="#Apacheåå‘ä»£ç†é…ç½®" class="headerlink" title="Apacheåå‘ä»£ç†é…ç½®"></a>Apacheåå‘ä»£ç†é…ç½®</h2><ol><li><p>éœ€è¦å¼€å¯apacheä»£ç†çš„æ‹“å±•ï¼Œå°†httpd.confä¸­ä¸‹åˆ—æ³¨é‡Šå–æ¶ˆ</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">LoadModule access_compat_module modules/mod_access_compat.so</span><br><span class="line">LoadModule proxy modules/proxy.so</span><br><span class="line">LoadModule proxy_connect modules/proxy_connect.so</span><br><span class="line">LoadModule proxy_http modules/proxy_http.so</span><br><span class="line">LoadModule proxy_html modules/proxy_html.so</span><br></pre></td></tr></table></figure></li><li><p>æ·»åŠ é…ç½®</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    ServerName localhost</span><br><span class="line">    &lt;Proxy *&gt;</span><br><span class="line">        Order deny,allow</span><br><span class="line">        Allow from all</span><br><span class="line">    &lt;/Proxy&gt;</span><br><span class="line">ProxyPass / http://127.0.0.1:8080/</span><br><span class="line">ProxyPassReverse / http://127.0.0.1:8080/</span><br><span class="line">&lt;/VirtualHost&gt;</span><br></pre></td></tr></table></figure></li></ol><p>å³å¯åå‘ä»£ç†æˆåŠŸåˆ°localhost:8080</p><p><strong>å‚è€ƒæ–‡æ¡£ï¼š</strong></p><ol><li><a href="http://meiling.blog.51cto.com/6220221/1786922" target="_blank" rel="noopener">windowsä¸‹apacheæœ€æ–°ä¸‹è½½ã€å®‰è£…é…ç½®</a></li><li><a href="http://www.cnblogs.com/yerenyuan/p/5460336.html" target="_blank" rel="noopener">ApacheæœåŠ¡å™¨çš„ä¸‹è½½ä¸å®‰è£…</a></li><li><a href="http://www.jianshu.com/p/203185c61838" target="_blank" rel="noopener">Apache24ï¼ˆwindowï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åå‘ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é¢è¯•ä¸­çš„Javaé“¾è¡¨</title>
      <link href="/linkedList/"/>
      <url>/linkedList/</url>
      
        <content type="html"><![CDATA[<p>é“¾è¡¨ä½œä¸ºå¸¸è€ƒçš„é¢è¯•é¢˜ï¼Œå¹¶ä¸”æœ¬èº«æ¯”è¾ƒçµæ´»ï¼Œå¯¹æŒ‡é’ˆçš„åº”ç”¨è¾ƒå¤šã€‚æœ¬æ–‡å¯¹å¸¸è§çš„é“¾è¡¨é¢è¯•é¢˜Javaå®ç°åšäº†æ•´ç†ã€‚</p><p>é“¾è¡¨èŠ‚ç‚¹å®šä¹‰å¦‚ä¸‹:<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    Node next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><a id="more"></a><h1 id="1-æ±‚å•é“¾è¡¨ä¸­ç»“ç‚¹çš„ä¸ªæ•°"><a href="#1-æ±‚å•é“¾è¡¨ä¸­ç»“ç‚¹çš„ä¸ªæ•°" class="headerlink" title="1. æ±‚å•é“¾è¡¨ä¸­ç»“ç‚¹çš„ä¸ªæ•°"></a>1. æ±‚å•é“¾è¡¨ä¸­ç»“ç‚¹çš„ä¸ªæ•°</h1><p>ä¾æ¬¡éå†é“¾è¡¨</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">size</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> size = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="keyword">null</span>) &#123;</span><br><span class="line">        size++;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="2-å°†å•é“¾è¡¨åè½¬"><a href="#2-å°†å•é“¾è¡¨åè½¬" class="headerlink" title="2. å°†å•é“¾è¡¨åè½¬"></a>2. å°†å•é“¾è¡¨åè½¬</h1><p>æ„å»ºä¸€ä¸ªæ–°çš„é“¾è¡¨ï¼Œä¾æ¬¡å°†æœ¬é“¾è¡¨çš„èŠ‚ç‚¹æ’å…¥åˆ°æ–°é“¾è¡¨çš„æœ€å‰ç«¯ï¼Œå³å¯å®Œæˆé“¾è¡¨çš„åè½¬ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">reverse</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    Node p1 = head, p2;</span><br><span class="line">    head = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p2 = p1;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤´æ’æ³•</span></span><br><span class="line">        p2.next = head;</span><br><span class="line">        head = p2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="3-æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ï¼ˆk-gt-0ï¼‰"><a href="#3-æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ï¼ˆk-gt-0ï¼‰" class="headerlink" title="3. æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ï¼ˆk &gt; 0ï¼‰"></a>3. æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ï¼ˆk &gt; 0ï¼‰</h1><p>ç¬¬ä¸€ç§è§£æ³•æ˜¯å¾—åˆ°é¡ºæ•°çš„ç¬¬ size+k-1 ä¸ªèŠ‚ç‚¹ï¼Œå³ä¸ºå€’æ•°çš„ç¬¬Kæ­ŒèŠ‚ç‚¹<br>ç¬¬äºŒç§è§£æ³•æ˜¯å¿«æ…¢æŒ‡é’ˆ,ä¸»è¦æ€è·¯å°±æ˜¯ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼Œå…ˆè®©å‰é¢çš„æŒ‡é’ˆèµ°åˆ°æ­£å‘ç¬¬kä¸ªç»“ç‚¹ï¼Œåé¢çš„æŒ‡é’ˆæ‰èµ°ï¼Œè¿™æ ·å‰åä¸¤ä¸ªæŒ‡é’ˆçš„è·ç¦»å·®æ˜¯k-1ï¼Œä¹‹åå‰åä¸¤ä¸ªæŒ‡é’ˆä¸€èµ·å‘å‰èµ°ï¼Œå‰é¢çš„æŒ‡é’ˆèµ°åˆ°æœ€åä¸€ä¸ªç»“ç‚¹æ—¶ï¼Œåé¢æŒ‡é’ˆæ‰€æŒ‡ç»“ç‚¹å°±æ˜¯å€’æ•°ç¬¬kä¸ªç»“ç‚¹ï¼Œä¸‹é¢é‡‡ç”¨è¿™ç§è§£æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">getKNode</span><span class="params">(Node head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &lt; <span class="number">0</span> || head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node p2 = head, p1 = head;</span><br><span class="line">    <span class="keyword">while</span> (k-- &gt; <span class="number">1</span> &amp;&amp; p1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¯´æ˜k&gt;sizeï¼Œå› æ­¤è¿”å›null</span></span><br><span class="line">    <span class="keyword">if</span> (k &gt; <span class="number">1</span> || p1 == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (p1.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-æŸ¥æ‰¾å•é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹"><a href="#4-æŸ¥æ‰¾å•é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹" class="headerlink" title="4. æŸ¥æ‰¾å•é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹"></a>4. æŸ¥æ‰¾å•é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹</h1><p>é‡‡ç”¨å¿«æ…¢æŒ‡é’ˆï¼Œp1æ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œp2æ¯æ¬¡èµ°ä¸€æ­¥ï¼Œå¥‡æ•°è¿”å›size/2+1ï¼Œå¶æ•°è¿”å›size/2,<br>æ³¨æ„é“¾è¡¨ä¸ºç©ºï¼Œé“¾è¡¨ç»“ç‚¹ä¸ªæ•°ä¸º1å’Œ2çš„æƒ…å†µã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">getMidNode</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node p1 = head, p2 = head;</span><br><span class="line">    <span class="keyword">while</span> (p1.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p1 == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p1 = p1.next.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="5-ä»å°¾åˆ°å¤´æ‰“å°å•é“¾è¡¨"><a href="#5-ä»å°¾åˆ°å¤´æ‰“å°å•é“¾è¡¨" class="headerlink" title="5. ä»å°¾åˆ°å¤´æ‰“å°å•é“¾è¡¨"></a>5. ä»å°¾åˆ°å¤´æ‰“å°å•é“¾è¡¨</h1><p>ç”¨æ ˆ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reversePrint</span><span class="params">(Node node)</span> </span>&#123;</span><br><span class="line">    Stack&lt;Node&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (node != <span class="keyword">null</span>) &#123;</span><br><span class="line">        stack.push(node);</span><br><span class="line">        node = node.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">        System.out.print(stack.pop().num + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€’å½’</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">reversePrint2</span><span class="params">(Node node)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (node != <span class="keyword">null</span>) &#123;</span><br><span class="line">        reversePrint2(node.next);</span><br><span class="line">        System.out.print(node.num + <span class="string">" "</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="6-å·²çŸ¥ä¸¤ä¸ªå•é“¾è¡¨pHead1å’ŒpHead2å„è‡ªæœ‰åºï¼ŒæŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªé“¾è¡¨ä¾ç„¶æœ‰åº"><a href="#6-å·²çŸ¥ä¸¤ä¸ªå•é“¾è¡¨pHead1å’ŒpHead2å„è‡ªæœ‰åºï¼ŒæŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªé“¾è¡¨ä¾ç„¶æœ‰åº" class="headerlink" title="6. å·²çŸ¥ä¸¤ä¸ªå•é“¾è¡¨pHead1å’ŒpHead2å„è‡ªæœ‰åºï¼ŒæŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªé“¾è¡¨ä¾ç„¶æœ‰åº"></a>6. å·²çŸ¥ä¸¤ä¸ªå•é“¾è¡¨pHead1å’ŒpHead2å„è‡ªæœ‰åºï¼ŒæŠŠå®ƒä»¬åˆå¹¶æˆä¸€ä¸ªé“¾è¡¨ä¾ç„¶æœ‰åº</h1><p>ç±»ä¼¼äºå½’å¹¶æ’åº</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">merge</span><span class="params">(Node head1, Node head2)</span> </span>&#123;</span><br><span class="line">    Node p1 = head1, p2 = head2, head;</span><br><span class="line">    <span class="keyword">if</span> (head1.num &lt; head2.num) &#123;</span><br><span class="line">        head = head1;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        head = head2;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Node p = head;</span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span> &amp;&amp; p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p1.num &lt;= p2.num) &#123;</span><br><span class="line">            p.next = p1;</span><br><span class="line">            p1 = p1.next;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            p.next = p2;</span><br><span class="line">            p2 = p2.next;</span><br><span class="line">            p = p.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p1 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p.next = p1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p2 != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p.next = p2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="7-åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯"><a href="#7-åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯" class="headerlink" title="7. åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯"></a>7. åˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯</h1><p>è¿™é‡Œä¹Ÿæ˜¯ç”¨åˆ°ä¸¤ä¸ªæŒ‡é’ˆã€‚å¦‚æœä¸€ä¸ªé“¾è¡¨ä¸­æœ‰ç¯ï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨ä¸€ä¸ªæŒ‡é’ˆå»éå†ï¼Œæ˜¯æ°¸è¿œèµ°ä¸åˆ°å¤´çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ä¸ªæŒ‡é’ˆå»éå†ï¼Œä¸€ä¸ªæŒ‡é’ˆä¸€æ¬¡èµ°ä¸¤æ­¥ï¼Œä¸€ä¸ªæŒ‡é’ˆä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œå¦‚æœæœ‰ç¯ï¼Œä¸¤ä¸ªæŒ‡é’ˆè‚¯å®šä¼šåœ¨ç¯ä¸­ç›¸é‡ã€‚æ—¶é—´å¤æ‚åº¦ä¸ºOï¼ˆnï¼‰ã€‚<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasRing</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    Node p1 = head, p2 = head;</span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span> &amp;&amp; p1.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p1 = p1.next.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">        <span class="keyword">if</span> (p1 == p2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="8-å·²çŸ¥ä¸€ä¸ªå•é“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œæ±‚è¿›å…¥ç¯ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"><a href="#8-å·²çŸ¥ä¸€ä¸ªå•é“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œæ±‚è¿›å…¥ç¯ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹" class="headerlink" title="8. å·²çŸ¥ä¸€ä¸ªå•é“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œæ±‚è¿›å…¥ç¯ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"></a>8. å·²çŸ¥ä¸€ä¸ªå•é“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œæ±‚è¿›å…¥ç¯ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</h1><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><p>ç”±ä¸Šé¢˜å¯çŸ¥ï¼ŒæŒ‰ç…§ p1 æ¯æ¬¡ä¸¤æ­¥ï¼Œp2 æ¯æ¬¡ä¸€æ­¥çš„æ–¹å¼èµ°ï¼Œå‘ç° p2 å’Œ p1 é‡åˆï¼Œç¡®å®šäº†å•å‘é“¾è¡¨æœ‰ç¯è·¯äº†ã€‚æ¥ä¸‹æ¥ï¼Œè®© p1 å›åˆ°é“¾è¡¨çš„å¤´éƒ¨ï¼Œé‡æ–°èµ°ï¼Œæ¯æ¬¡æ­¥é•¿ä¸æ˜¯èµ°2äº†ï¼Œè€Œæ˜¯èµ°1ï¼Œé‚£ä¹ˆå½“ p1 å’Œ p2 å†æ¬¡ç›¸é‡çš„æ—¶å€™ï¼Œå°±æ˜¯ç¯è·¯çš„å…¥å£äº†ã€‚</p><p><strong>ä¸ºä»€ä¹ˆï¼Ÿ</strong></p><p>å‡å®šèµ·ç‚¹åˆ°ç¯å…¥å£ç‚¹çš„è·ç¦»ä¸º aï¼Œp1 å’Œ p2 çš„ç›¸äº¤ç‚¹Mä¸ç¯å…¥å£ç‚¹çš„è·ç¦»ä¸ºbï¼Œç¯è·¯çš„å‘¨é•¿ä¸ºLï¼Œå½“ p1 å’Œ p2 ç¬¬ä¸€æ¬¡ç›¸é‡çš„æ—¶å€™ï¼Œå‡å®š p2 èµ°äº† n æ­¥ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p>p2èµ°çš„è·¯å¾„ï¼š a+b ï¼ nï¼›<br>p1èµ°çš„è·¯å¾„ï¼š a+b+k<em>L = 2</em>nï¼› p1 æ¯” p2 å¤šèµ°äº†kåœˆç¯è·¯ï¼Œæ€»è·¯ç¨‹æ˜¯p2çš„2å€</p><p>æ ¹æ®ä¸Šè¿°å…¬å¼å¯ä»¥å¾—åˆ° k*L=a+b=n ï¼Œæ˜¾ç„¶ï¼Œå¦‚æœä»ç›¸é‡ç‚¹Må¼€å§‹ï¼Œp2 å†èµ° n æ­¥çš„è¯ï¼Œè¿˜å¯ä»¥å†å›åˆ°ç›¸é‡ç‚¹ï¼ŒåŒæ—¶p2ä»å¤´å¼€å§‹èµ°çš„è¯ï¼Œç»è¿‡næ­¥ï¼Œä¹Ÿä¼šè¾¾åˆ°ç›¸é‡ç‚¹Mã€‚</p><p>æ˜¾ç„¶åœ¨è¿™ä¸ªæ­¥éª¤å½“ä¸­ p1 å’Œ p2 åªæœ‰å‰ a æ­¥èµ°çš„è·¯å¾„ä¸åŒï¼Œæ‰€ä»¥å½“ p1 å’Œ p2 å†æ¬¡é‡åˆçš„æ—¶å€™ï¼Œå¿…ç„¶æ˜¯åœ¨é“¾è¡¨çš„ç¯è·¯å…¥å£ç‚¹ä¸Šã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">getFirstRingNode</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    Node p1 = head, p2 = head;</span><br><span class="line">    <span class="keyword">while</span> (p1 != <span class="keyword">null</span> &amp;&amp; p1.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p1 = p1.next.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">        <span class="keyword">if</span> (p1 == p2) &#123;</span><br><span class="line">            p1 = head;</span><br><span class="line">            <span class="keyword">while</span> (p1 != p2) &#123;</span><br><span class="line">                p1 = p1.next;</span><br><span class="line">                p2 = p2.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="9-åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤"><a href="#9-åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤" class="headerlink" title="9. åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤"></a>9. åˆ¤æ–­ä¸¤ä¸ªå•é“¾è¡¨æ˜¯å¦ç›¸äº¤</h1><p>å¦‚æœä¸¤ä¸ªé“¾è¡¨ç›¸äº¤ï¼Œé‚£ä¹ˆç›¸äº¤ä¹‹åçš„èŠ‚ç‚¹åº”è¯¥ç›¸åŒï¼Œé‚£ä¹ˆæœ€åé‚£ä¸ªèŠ‚ç‚¹åº”è¯¥ä¹Ÿç›¸åŒ</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isIntersect</span><span class="params">(Node head1, Node head2)</span> </span>&#123;</span><br><span class="line">    Node p1 = head1, p2 = head2;</span><br><span class="line">    <span class="keyword">while</span> (p1.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (p2.next != <span class="keyword">null</span>) &#123;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p1 == p2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="10-æ±‚ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"><a href="#10-æ±‚ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹" class="headerlink" title="10. æ±‚ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"></a>10. æ±‚ä¸¤ä¸ªå•é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</h1><p>é‡‡ç”¨å¯¹é½çš„æ€æƒ³ã€‚è®¡ç®—ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ L1 , L2ï¼Œåˆ†åˆ«ç”¨ä¸¤ä¸ªæŒ‡é’ˆ p1 , p2 æŒ‡å‘ä¸¤ä¸ªé“¾è¡¨çš„å¤´ï¼Œ<br>ç„¶åå°†è¾ƒé•¿é“¾è¡¨çš„ p1ï¼ˆå‡è®¾ä¸º p1ï¼‰å‘åç§»åŠ¨L2 - L1ä¸ªèŠ‚ç‚¹ï¼Œç„¶åå†åŒæ—¶å‘åç§»åŠ¨p1 , p2ï¼Œ<br>ç›´åˆ° p1 = p2ã€‚ç›¸é‡çš„ç‚¹å°±æ˜¯ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">firstIntersectNode</span><span class="params">(Node head1, Node head2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len1 = size(head1);</span><br><span class="line">    <span class="keyword">int</span> len2 = size(head2);</span><br><span class="line">    Node p1 = head1, p2 = head2;</span><br><span class="line">    <span class="keyword">if</span> (len1 &gt; len2) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len1 - len2; i++) &#123;</span><br><span class="line">            p1 = p1.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len2 - len1; i++) &#123;</span><br><span class="line">            p2 = p2.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (p1 != p2) &#123;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="11-ç»™å‡ºä¸€å•é“¾è¡¨å¤´æŒ‡é’ˆ-head-å’Œä¸€èŠ‚ç‚¹æŒ‡é’ˆ-deletedNodeï¼ŒO-1-æ—¶é—´å¤æ‚åº¦åˆ é™¤èŠ‚ç‚¹deletedNode"><a href="#11-ç»™å‡ºä¸€å•é“¾è¡¨å¤´æŒ‡é’ˆ-head-å’Œä¸€èŠ‚ç‚¹æŒ‡é’ˆ-deletedNodeï¼ŒO-1-æ—¶é—´å¤æ‚åº¦åˆ é™¤èŠ‚ç‚¹deletedNode" class="headerlink" title="11. ç»™å‡ºä¸€å•é“¾è¡¨å¤´æŒ‡é’ˆ head å’Œä¸€èŠ‚ç‚¹æŒ‡é’ˆ deletedNodeï¼ŒO(1)æ—¶é—´å¤æ‚åº¦åˆ é™¤èŠ‚ç‚¹deletedNode"></a>11. ç»™å‡ºä¸€å•é“¾è¡¨å¤´æŒ‡é’ˆ head å’Œä¸€èŠ‚ç‚¹æŒ‡é’ˆ deletedNodeï¼ŒO(1)æ—¶é—´å¤æ‚åº¦åˆ é™¤èŠ‚ç‚¹deletedNode</h1><p>å°†deletedNodeä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼å¤åˆ¶ç»™deletedNodeèŠ‚ç‚¹ï¼Œç„¶ååˆ é™¤deletedNodeèŠ‚ç‚¹ï¼Œä½†æ˜¯å¯¹äºè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™è¦åšå¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">firstIntersectNode</span><span class="params">(Node head1, Node head2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len1 = size(head1);</span><br><span class="line">    <span class="keyword">int</span> len2 = size(head2);</span><br><span class="line">    Node p1 = head1, p2 = head2;</span><br><span class="line">    <span class="keyword">if</span> (len1 &gt; len2) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len1 - len2; i++) &#123;</span><br><span class="line">            p1 = p1.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len2 - len1; i++) &#123;</span><br><span class="line">            p2 = p2.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (p1 != p2) &#123;</span><br><span class="line">        p1 = p1.next;</span><br><span class="line">        p2 = p2.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="12-é“¾è¡¨çš„å†’æ³¡æ’åº"><a href="#12-é“¾è¡¨çš„å†’æ³¡æ’åº" class="headerlink" title="12. é“¾è¡¨çš„å†’æ³¡æ’åº"></a>12. é“¾è¡¨çš„å†’æ³¡æ’åº</h1><p>å¯¹äºæ•°ç»„çš„å†’æ³¡æ’åºæ˜¯ä¸Šå±‚forå¾ªç¯æ§åˆ¶æ¬¡æ•°ï¼Œä¸‹æ¬¡forå¾ªç¯æ§åˆ¶è·ç¦»ï¼Œå¯¹äºé“¾è¡¨çš„å†’æ³¡æ’åºè€Œè¨€ï¼Œé¦–å…ˆè®©tailæŒ‡é’ˆä¸ºnullï¼Œä¸€æ¬¡å¾ªç¯æ¯”è¾ƒå®Œä¹‹åï¼Œåœ¨ç­‰äºæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå€’æ•°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚ã€‚ã€‚å°±æ˜¯é€šè¿‡tailæŒ‡é’ˆæ§åˆ¶å¾ªç¯æ¯”è¾ƒçš„æ¬¡æ•°å’Œè·ç¦»ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bubbleSort</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    Node tail = <span class="keyword">null</span>;</span><br><span class="line">    Node p1;</span><br><span class="line">    <span class="keyword">while</span> (head != tail) &#123;</span><br><span class="line">        <span class="keyword">for</span> (p1 = head; p1.next != tail; p1 = p1.next) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p1.num &gt; p1.next.num) &#123;</span><br><span class="line">                <span class="keyword">int</span> temp = p1.num;</span><br><span class="line">                p1.num = p1.next.num;</span><br><span class="line">                p1.next.num = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        tail = p1;</span><br><span class="line">    &#125;</span><br><span class="line">    show(head);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="13-å•é“¾è¡¨çš„åŒå†’æ³¡æ’åº"><a href="#13-å•é“¾è¡¨çš„åŒå†’æ³¡æ’åº" class="headerlink" title="13. å•é“¾è¡¨çš„åŒå†’æ³¡æ’åº"></a>13. å•é“¾è¡¨çš„åŒå†’æ³¡æ’åº</h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">doubleBubblesort</span><span class="params">(Node start, Node end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (start != end) &#123;</span><br><span class="line">        Node p1 = start;</span><br><span class="line">        Node p2 = p1.next;</span><br><span class="line">        <span class="keyword">while</span> (p2 != end) &#123;</span><br><span class="line">            <span class="keyword">if</span> (p2.num &lt; start.num) &#123;</span><br><span class="line">                p1 = p1.next;</span><br><span class="line">                <span class="keyword">int</span> temp = p1.num;</span><br><span class="line">                p1.num = p2.num;</span><br><span class="line">                p2.num = temp;</span><br><span class="line">            &#125;</span><br><span class="line">            p2 = p2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> temp = p1.num;</span><br><span class="line">        p1.num = start.num;</span><br><span class="line">        start.num = temp;</span><br><span class="line">        doubleBubblesort(start, p1);</span><br><span class="line">        doubleBubblesort(p1.next, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¨éƒ¨ä»£ç æ”¾åœ¨ <a href="https://github.com/morethink/algorithm/blob/master/src/main/java/algorithm/list/LinkedList.java" target="_blank" rel="noopener">https://github.com/morethink/algorithm/blob/master/src/main/java/algorithm/list/LinkedList.java</a></p><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://blog.csdn.net/luckyxiaoqiang/article/details/7393134" target="_blank" rel="noopener">è½»æ¾æå®šé¢è¯•ä¸­çš„é“¾è¡¨é¢˜ç›®</a></li><li><a href="http://wuchong.me/blog/2014/03/25/interview-link-questions/" target="_blank" rel="noopener">é¢è¯•ç²¾é€‰ï¼šé“¾è¡¨é—®é¢˜é›†é”¦</a></li><li><a href="http://blog.csdn.net/qq_26768741/article/details/51635987" target="_blank" rel="noopener">é“¾è¡¨é¢è¯•é¢˜æ€»ç»“ï¼ˆä¸€ï¼‰</a></li><li><a href="http://www.lai18.com/content/1318246.html" target="_blank" rel="noopener">åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨é€’å½’å’Œè¿­ä»£ä¸¤ç§å†™æ³•ä»¥åŠæ‰©å±•é—®é¢˜ï¼šåˆå¹¶kä¸ªæœ‰åºé“¾è¡¨ javaå®ç°ï¼ˆleetcode21å’Œ23é¢˜ï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é“¾è¡¨ </tag>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é€’å½’ä¸å˜æ€è·³å°é˜¶</title>
      <link href="/abnormal-jump-step/"/>
      <url>/abnormal-jump-step/</url>
      
        <content type="html"><![CDATA[<p><strong>æ•°å­¦æ˜¯ç®—æ³•çš„çš‡åï¼Œä¸æ‡‚æ•°å­¦ï¼Œéš¾å­¦ç®—æ³•å•Šã€‚</strong></p><h3 id="å‰‘æŒ‡offerç¬¬11é¢˜Javaå®ç°"><a href="#å‰‘æŒ‡offerç¬¬11é¢˜Javaå®ç°" class="headerlink" title="å‰‘æŒ‡offerç¬¬11é¢˜Javaå®ç°"></a>å‰‘æŒ‡offerç¬¬11é¢˜Javaå®ç°</h3><p>é¢˜ç›®ï¼š<br>ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§â€¦â€¦å®ƒä¹Ÿå¯ä»¥è·³ä¸Šnçº§ã€‚æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ªnçº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 2017/8/13.</span></span><br><span class="line"><span class="comment"> *          &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *          &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *          ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§â€¦â€¦å®ƒä¹Ÿå¯ä»¥è·³ä¸Šnçº§ã€‚</span></span><br><span class="line"><span class="comment">            æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ªnçº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚</span></span><br><span class="line"><span class="comment"> *          &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *          æ€è·¯:</span></span><br><span class="line"><span class="comment"> *          å› ä¸ºnçº§å°é˜¶ï¼Œç¬¬ä¸€æ­¥æœ‰nç§è·³æ³•ï¼šè·³1çº§ã€è·³2çº§ã€åˆ°è·³nçº§</span></span><br><span class="line"><span class="comment"> *          è·³1çº§ï¼Œå‰©ä¸‹n-1çº§ï¼Œåˆ™å‰©ä¸‹è·³æ³•æ˜¯f(n-1)</span></span><br><span class="line"><span class="comment"> *          è·³2çº§ï¼Œå‰©ä¸‹n-2çº§ï¼Œåˆ™å‰©ä¸‹è·³æ³•æ˜¯f(n-2)</span></span><br><span class="line"><span class="comment"> *          æ‰€ä»¥f(n)=f(n-1)+f(n-2)+...+f(1)</span></span><br><span class="line"><span class="comment"> *          å› ä¸ºf(n-1)=f(n-2)+f(n-3)+...+f(1)</span></span><br><span class="line"><span class="comment"> *          æ‰€ä»¥f(n)=f(n-1)+f(n-1)=2*f(n-1)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test11</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Test11 test11 = <span class="keyword">new</span> Test11();</span><br><span class="line">        System.out.println(test11.JumpFloorII(<span class="number">10</span>));</span><br><span class="line">        System.out.println(test11.JumpFloorII2(<span class="number">10</span>));</span><br><span class="line">        System.out.println(test11.JumpFloorII3(<span class="number">10</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å½’</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">JumpFloorII2</span><span class="params">(<span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (target &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (target == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span> * JumpFloorII2(target - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿­ä»£</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">JumpFloorII3</span><span class="params">(<span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> f = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; target; i++) &#123;</span><br><span class="line">            f *= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­¤ç§æ€è·¯å……åˆ†è¯´æ˜äº†æ•°å­¦æ˜¯ç®—æ³•çš„çš‡å</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * æ¯ä¸ªå°é˜¶éƒ½æœ‰è·³ä¸ä¸è·³ä¸¤ç§æƒ…å†µ(ç¬¬né˜¶å°é˜¶å¿…é¡»è·³),æ‰€ä»¥æ€»å…±æœ‰ 2 ^ (n - 1)ç§è·³æ³•ï¼Œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> target</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">JumpFloorII</span><span class="params">(<span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ä½¿ç”¨Mathç±»çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">//        return (int) Math.pow(2, target - 1);</span></span><br><span class="line">        <span class="comment">//2^(n-1)å¯ä»¥ç”¨ä½ç§»æ“ä½œè¿›è¡Œï¼Œæ›´å¿«</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; --target;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§»ä½è¿ç®—ç¬¦"><a href="#ç§»ä½è¿ç®—ç¬¦" class="headerlink" title="ç§»ä½è¿ç®—ç¬¦"></a>ç§»ä½è¿ç®—ç¬¦</h3><p>å·¦ç§»è¿ç®—æ˜¯å°†ä¸€ä¸ªäºŒè¿›åˆ¶ä½çš„æ“ä½œæ•°æŒ‰æŒ‡å®šç§»åŠ¨çš„ä½æ•°å‘å·¦ç§»ä½ï¼Œç§»å‡ºä½è¢«ä¸¢å¼ƒï¼Œå³è¾¹çš„ç©ºä½ä¸€å¾‹è¡¥0ã€‚å³ç§»è¿ç®—æ˜¯å°†ä¸€ä¸ªäºŒè¿›åˆ¶ä½çš„æ“ä½œæ•°æŒ‰æŒ‡å®šç§»åŠ¨çš„ä½æ•°å‘å³ç§»åŠ¨ï¼Œç§»å‡ºä½è¢«ä¸¢å¼ƒï¼Œå·¦è¾¹ç§»å‡ºçš„ç©ºä½æˆ–è€…ä¸€å¾‹è¡¥0ï¼Œæˆ–è€…è¡¥ç¬¦å·ä½ï¼Œè¿™ç”±ä¸åŒçš„æœºå™¨è€Œå®šã€‚åœ¨ä½¿ç”¨è¡¥ç ä½œä¸ºæœºå™¨æ•°çš„æœºå™¨ä¸­ï¼Œæ­£æ•°çš„ç¬¦å·ä½ä¸º0ï¼Œè´Ÿæ•°çš„ç¬¦å·ä½ä¸º1ã€‚</p><p><strong><code>&lt;&lt; å·¦ç§»</code></strong></p><p>éœ€è¦ç§»ä½çš„æ•°å­— &lt;&lt; ç§»ä½çš„æ¬¡æ•°<br>ä¾‹å¦‚ï¼š<br>3 &lt;&lt; 2ï¼Œåˆ™æ˜¯å°†æ•°å­—3å·¦ç§»2ä½</p><ol><li>è®¡ç®—è¿‡ç¨‹ï¼š<br>ã€€ã€€é¦–å…ˆæŠŠ3è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°å­—0000 0000 0000 0000 0000 0000 0000 0011ï¼Œç„¶åæŠŠè¯¥æ•°å­—é«˜ä½(å·¦ä¾§)çš„ä¸¤ä¸ªé›¶ç§»å‡ºï¼Œå…¶ä»–çš„æ•°å­—éƒ½æœå·¦å¹³ç§»2ä½ï¼Œæœ€ååœ¨ä½ä½(å³ä¾§)çš„ä¸¤ä¸ªç©ºä½è¡¥é›¶ã€‚åˆ™å¾—åˆ°çš„æœ€ç»ˆç»“æœæ˜¯0000 0000 0000 0000 0000 0000 0000 1100ï¼Œåˆ™è½¬æ¢ä¸ºåè¿›åˆ¶æ˜¯12ã€‚</li><li>æ•°å­¦æ„ä¹‰ï¼š<br>ã€€ã€€<strong>åœ¨æ•°å­—æ²¡æœ‰æº¢å‡ºçš„å‰æä¸‹ï¼Œå¯¹äºæ­£æ•°å’Œè´Ÿæ•°ï¼Œå·¦ç§»ä¸€ä½éƒ½ç›¸å½“äºä¹˜ä»¥2çš„1æ¬¡æ–¹ï¼Œå·¦ç§»nä½å°±ç›¸å½“äºä¹˜ä»¥2çš„næ¬¡æ–¹ã€‚</strong></li></ol><p><strong><code>&gt;&gt; å³ç§»</code></strong><br>è¿ç®—è§„åˆ™ï¼š<br>æŒ‰äºŒè¿›åˆ¶å½¢å¼æŠŠæ‰€æœ‰çš„æ•°å­—å‘å³ç§»åŠ¨å¯¹åº”ä½ç§»ä½æ•°ï¼Œä½ä½ç§»å‡º(èˆå¼ƒ)ï¼Œé«˜ä½çš„ç©ºä½è¡¥ç¬¦å·ä½ï¼Œå³æ­£æ•°è¡¥é›¶ï¼Œè´Ÿæ•°è¡¥1ã€‚<br>è¯­æ³•æ ¼å¼ï¼š<br>éœ€è¦ç§»ä½çš„æ•°å­— &gt;&gt; ç§»ä½çš„æ¬¡æ•°</p><p>ä¾‹å¦‚11 &gt;&gt; 2ï¼Œåˆ™æ˜¯å°†æ•°å­—11å³ç§»2ä½</p><ol><li>è®¡ç®—è¿‡ç¨‹ï¼š<br>11çš„äºŒè¿›åˆ¶å½¢å¼ä¸ºï¼š0000 0000 0000 0000 0000 0000 0000 1011ï¼Œç„¶åæŠŠä½ä½çš„æœ€åä¸¤ä¸ªæ•°å­—ç§»å‡ºï¼Œå› ä¸ºè¯¥æ•°å­—æ˜¯æ­£æ•°ï¼Œæ‰€ä»¥åœ¨é«˜ä½è¡¥é›¶ã€‚åˆ™å¾—åˆ°çš„æœ€ç»ˆç»“æœæ˜¯0000 0000 0000 0000 0000 0000 0000 0010ã€‚è½¬æ¢ä¸ºåè¿›åˆ¶æ˜¯2ã€‚</li><li>æ•°å­¦æ„ä¹‰ï¼š<br><strong>å³ç§»ä¸€ä½ç›¸å½“äºé™¤2ï¼Œå³ç§»nä½ç›¸å½“äºé™¤ä»¥2çš„næ¬¡æ–¹ã€‚</strong></li></ol><p><strong><code>&gt;&gt;&gt; æ— ç¬¦å·å³ç§»</code></strong></p><ol><li><p>è¿ç®—è§„åˆ™ï¼š<br>æŒ‰äºŒè¿›åˆ¶å½¢å¼æŠŠæ‰€æœ‰çš„æ•°å­—å‘å³ç§»åŠ¨å¯¹åº”ä½æ•°ï¼Œä½ä½ç§»å‡º(èˆå¼ƒ)ï¼Œé«˜ä½çš„ç©ºä½è¡¥é›¶ã€‚å¯¹äºæ­£æ•°æ¥è¯´å’Œå¸¦ç¬¦å·å³ç§»ç›¸åŒï¼Œå¯¹äºè´Ÿæ•°æ¥è¯´ä¸åŒã€‚</p></li><li><p>å…¶ä»–ç»“æ„å’Œ&gt;&gt;ç›¸ä¼¼ã€‚<br>æœ‰çš„æ—¶å€™ï¼Œä½ å¸Œæœ›å°†ä¸€ä¸ªæ•°çš„äºŒè¿›åˆ¶å€¼å‘å³æˆ–å‘å·¦ç§»ä½ã€‚æ‰§è¡Œå·¦ç§»æ—¶ï¼Œåœ¨ä¸€ä¸ªæ•°çš„äºŒè¿›åˆ¶å½¢å¼ä¸­ï¼Œæ‰€æœ‰ä½éƒ½å‘å·¦ç§»åŠ¨ç”±ç§»ä½è¿ç®—ç¬¦å³ä¾§çš„æ“ä½œæ•°æŒ‡å®šçš„ä½æ•°ã€‚ ç§»ä½ååœ¨å³è¾¹ç•™ä¸‹çš„ç©ºä½å°†ç”±é›¶æ¥å¡«å……ã€‚å³ç§»ä½è¿ç®—ç¬¦çš„åŸç†ç›¸ä¼¼ï¼Œåªæ˜¯æœç›¸åçš„æ–¹å‘ç§»ä½ã€‚ç„¶è€Œï¼Œå¦‚æœæ•°æ˜¯è´Ÿæ•°ï¼Œé‚£ä¹ˆåœ¨å·¦ä¾§å¡«å……çš„å€¼å°±æ˜¯1è€Œä¸æ˜¯0ã€‚ä¸¤ä¸ªç§»ä½ è¿ç®—ç¬¦æ˜¯&gt;&gt;å’Œ&lt;&lt;ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯å³ç§»ä½å’Œå·¦ç§»ä½è¿ç®—ç¬¦ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰å¤åˆç§»ä½å’Œèµ‹å€¼è¿ç®—ç¬¦&lt;&lt;=å’Œ&gt;&gt;=ã€‚</p></li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="https://baike.baidu.com/item/%E7%A7%BB%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6" target="_blank" rel="noopener">ç§»ä½è¿ç®—ç¬¦-ç™¾åº¦ç™¾ç§‘</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¢è¯• </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaè¿­ä»£å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—</title>
      <link href="/Java%E8%BF%AD%E4%BB%A3%E5%AE%9E%E7%8E%B0%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/"/>
      <url>/Java%E8%BF%AD%E4%BB%A3%E5%AE%9E%E7%8E%B0%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/</url>
      
        <content type="html"><![CDATA[<p><strong>å‰‘æŒ‡offerç¬¬ä¹é¢˜Javaå®ç°</strong><br>é¢˜ç›®ï¼š<br>å¤§å®¶éƒ½çŸ¥é“æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œç°åœ¨è¦æ±‚è¾“å…¥ä¸€ä¸ªæ•´æ•°nï¼Œè¯·ä½ è¾“å‡ºæ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬né¡¹ã€‚</p><a id="more"></a><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test9</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Test9 test9 = <span class="keyword">new</span> Test9();</span><br><span class="line">        System.out.println(test9.Fibonacci(<span class="number">390000</span>));</span><br><span class="line">        System.out.println(test9.Fibonacci3(<span class="number">39</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸ºä»€ä¹ˆä¸é‡‡ç”¨é€’å½’ï¼Ÿå› ä¸ºé€’å½’å®é™…æ˜¯å¤§é‡è°ƒç”¨è‡ªèº«ï¼Œå½“æ•°é‡è¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨è®°å½•ï¼Œå®¹æ˜“å‘ç”Ÿå†…å­˜æº¢å‡ºã€‚</span></span><br><span class="line"><span class="comment">     * æ€ä¹ˆä¼˜åŒ–ï¼Ÿ</span></span><br><span class="line"><span class="comment">     * 1. é‡‡ç”¨å°¾é€’å½’ï¼Œä½†æ˜¯Javaå¹¶æ²¡æœ‰åŸºäºå°¾é€’å½’è¿›è¡Œä¼˜åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´Javaä¸­é‡‡ç”¨é€’å½’è¿˜æ˜¯æ— æ³•é¿å…å¾ˆå®¹æ˜“å‘ç”Ÿ"æ ˆæº¢å‡º"é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * å› ä¸ºå°¾é€’å½’éƒ½æ˜¯ä½äºè°ƒç”¨å‡½æ•°çš„æœ€åä¸€è¡Œï¼Œæ­¤æ—¶å¯ä»¥åˆ é™¤ä»¥å‰æ‰€ä¿å­˜çš„å‡½æ•°å†…å˜é‡ï¼Œæƒ³å½“äºæ¯æ¬¡åªè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ã€‚</span></span><br><span class="line"><span class="comment">     * 2. é‡‡ç”¨è¿­ä»£</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> f1 = <span class="number">0</span>, f2 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            f1 = f1 + f2;</span><br><span class="line">            f2 = f1 - f2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¸‹é¢è¿™ç§å†™æ³•æ›´ä¸ºå·§å¦™</span></span><br><span class="line"><span class="comment">//        while (n-- &gt; 0) &#123;</span></span><br><span class="line"><span class="comment">//            f1 = f1 + f2;</span></span><br><span class="line"><span class="comment">//            f2 = f1 - f2;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="keyword">return</span> f1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é‡‡ç”¨é€’å½’çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">Fibonacci3</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span> || n == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Fibonacci3(n - <span class="number">1</span>) + Fibonacci3(n - <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://www.ruanyifeng.com/blog/2015/04/tail-call.html" target="_blank" rel="noopener">å°¾è°ƒç”¨ä¼˜åŒ–</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é€’å½’ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Javaå®ç°äºŒå‰æ ‘çš„å…ˆåºã€ä¸­åºã€ååºã€å±‚åºéå†ï¼ˆé€’å½’å’Œéé€’å½’ï¼‰</title>
      <link href="/binary-tree/"/>
      <url>/binary-tree/</url>
      
        <content type="html"><![CDATA[<p>äºŒå‰æ ‘æ˜¯ä¸€ç§éå¸¸é‡è¦çš„æ•°æ®ç»“æ„ï¼Œå¾ˆå¤šå…¶å®ƒæ•°æ®ç»“æ„éƒ½æ˜¯åŸºäºäºŒå‰æ ‘çš„åŸºç¡€æ¼”å˜è€Œæ¥çš„ã€‚å¯¹äºäºŒå‰æ ‘ï¼Œæœ‰å‰åºã€ä¸­åºä»¥åŠååºä¸‰ç§éå†æ–¹æ³•ã€‚å› ä¸ºæ ‘çš„å®šä¹‰æœ¬èº«å°±æ˜¯é€’å½’å®šä¹‰ï¼Œå› æ­¤é‡‡ç”¨é€’å½’çš„æ–¹æ³•å»å®ç°æ ‘çš„ä¸‰ç§éå†ä¸ä»…å®¹æ˜“ç†è§£è€Œä¸”ä»£ç å¾ˆç®€æ´ã€‚è€Œå¯¹äºæ ‘çš„éå†è‹¥é‡‡ç”¨éé€’å½’çš„æ–¹æ³•ï¼Œå°±è¦é‡‡ç”¨æ ˆå»æ¨¡æ‹Ÿå®ç°ã€‚åœ¨ä¸‰ç§éå†ä¸­ï¼Œå‰åºå’Œä¸­åºéå†çš„éé€’å½’ç®—æ³•éƒ½å¾ˆå®¹æ˜“å®ç°ï¼Œéé€’å½’ååºéå†å®ç°èµ·æ¥ç›¸å¯¹æ¥è¯´è¦éš¾ä¸€ç‚¹ã€‚</p><a id="more"></a><p>èŠ‚ç‚¹åˆ†å¸ƒå¦‚ä¸‹:<br><img src="https://images.morethink.cn/19a9e3541a3de168c5d1a2ac6c509270.png" alt=""></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.Queue;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ææ–‡æµ©</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 2017/7/30.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BinaryTree</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŠ‚ç‚¹å®šä¹‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TreeNode</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        TreeNode left;</span><br><span class="line">        TreeNode right;</span><br><span class="line"></span><br><span class="line">        TreeNode(<span class="keyword">int</span> x) &#123;</span><br><span class="line">            val = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é«˜åº¦ï¼Œå·¦å³å­æ ‘ä¸­çš„è¾ƒå¤§å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">height</span><span class="params">(TreeNode node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> leftHeight = height(node.left);</span><br><span class="line">        <span class="keyword">int</span> rightHeight = height(node.right);</span><br><span class="line">        <span class="keyword">return</span> leftHeight &gt; rightHeight ? leftHeight + <span class="number">1</span> : rightHeight + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å±‚åºéå†ä¸€é¢—äºŒå‰æ ‘ï¼Œç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ€æƒ³ï¼Œä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—æ¥æŒ‰ç…§å±‚çš„é¡ºåºå­˜æ”¾èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     * å…ˆå°†æ ¹èŠ‚ç‚¹å…¥é˜Ÿåˆ—ï¼Œåªè¦é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œç„¶åå‡ºé˜Ÿåˆ—ï¼Œå¹¶è®¿é—®ï¼Œæ¥ç€è®²è®¿é—®èŠ‚ç‚¹çš„å·¦å³å­æ ‘ä¾æ¬¡å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">levelTraversal</span><span class="params">(TreeNode node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> LinkedList&lt;TreeNode&gt;();</span><br><span class="line">        queue.offer(node);</span><br><span class="line">        TreeNode treeNode;</span><br><span class="line">        <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">            treeNode = queue.poll();</span><br><span class="line">            System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">            <span class="keyword">if</span> (treeNode.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">                queue.offer(treeNode.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (treeNode.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">                queue.offer(treeNode.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…ˆåºé€’å½’</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">preOrder</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">            preOrder(treeNode.left);</span><br><span class="line">            preOrder(treeNode.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸­åºé€’å½’</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">inOrder</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            inOrder(treeNode.left);</span><br><span class="line">            System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">            inOrder(treeNode.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºé€’å½’</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">postOrder</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">            postOrder(treeNode.left);</span><br><span class="line">            postOrder(treeNode.right);</span><br><span class="line">            System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…ˆåºéé€’å½’ï¼š</span></span><br><span class="line"><span class="comment">     * è¿™ç§å®ç°ç±»ä¼¼äºå›¾çš„æ·±åº¦ä¼˜å…ˆéå†ï¼ˆDFSï¼‰ã€‚</span></span><br><span class="line"><span class="comment">     * ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œå°†æ ¹èŠ‚ç‚¹å…¥æ ˆï¼Œç„¶ååªè¦æ ˆä¸ä¸ºç©ºï¼Œå‡ºæ ˆå¹¶è®¿é—®ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ¥ç€ä¾æ¬¡å°†è®¿é—®èŠ‚ç‚¹çš„å³èŠ‚ç‚¹ã€å·¦èŠ‚ç‚¹å…¥æ ˆã€‚</span></span><br><span class="line"><span class="comment">     * è¿™ç§æ–¹å¼åº”è¯¥æ˜¯å¯¹å…ˆåºéå†çš„ä¸€ç§ç‰¹æ®Šå®ç°ï¼ˆçœ‹ä¸Šå»ç®€å•æ˜äº†ï¼‰ï¼Œ</span></span><br><span class="line"><span class="comment">     * ä½†æ˜¯ä¸å…·å¤‡å¾ˆå¥½çš„æ‰©å±•æ€§ï¼Œåœ¨ä¸­åºå’Œååºæ–¹å¼ä¸­ä¸é€‚ç”¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> root</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">preOrderStack</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        stack.push(root);</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            TreeNode treeNode = stack.pop();</span><br><span class="line">            System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">            <span class="keyword">if</span> (treeNode.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">                stack.push(treeNode.right);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (treeNode.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">                stack.push(treeNode.left);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…ˆåºéé€’å½’2ï¼š</span></span><br><span class="line"><span class="comment">     * åˆ©ç”¨æ ˆæ¨¡æ‹Ÿé€’å½’è¿‡ç¨‹å®ç°å¾ªç¯å…ˆåºéå†äºŒå‰æ ‘ã€‚</span></span><br><span class="line"><span class="comment">     * è¿™ç§æ–¹å¼å…·å¤‡æ‰©å±•æ€§ï¼Œå®ƒæ¨¡æ‹Ÿé€’å½’çš„è¿‡ç¨‹ï¼Œå°†å·¦å­æ ‘ç‚¹ä¸æ–­çš„å‹å…¥æ ˆï¼Œç›´åˆ°nullï¼Œ</span></span><br><span class="line"><span class="comment">     * ç„¶åå¤„ç†æ ˆé¡¶èŠ‚ç‚¹çš„å³å­æ ‘ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> root</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">preOrderStack2</span><span class="params">(TreeNode root)</span> </span>&#123;</span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        TreeNode treeNode = root;</span><br><span class="line">        <span class="keyword">while</span> (treeNode != <span class="keyword">null</span> || !stack.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//å°†å·¦å­æ ‘ç‚¹ä¸æ–­çš„å‹å…¥æ ˆ</span></span><br><span class="line">            <span class="keyword">while</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">//å…ˆè®¿é—®å†å…¥æ ˆ</span></span><br><span class="line">                System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">                stack.push(treeNode);</span><br><span class="line">                treeNode = treeNode.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å‡ºæ ˆå¹¶å¤„ç†å³å­æ ‘</span></span><br><span class="line">            <span class="keyword">if</span> (!stack.isEmpty()) &#123;</span><br><span class="line">                treeNode = stack.pop();</span><br><span class="line">                treeNode = treeNode.right;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸­åºéé€’å½’ï¼š</span></span><br><span class="line"><span class="comment">     * åˆ©ç”¨æ ˆæ¨¡æ‹Ÿé€’å½’è¿‡ç¨‹å®ç°å¾ªç¯ä¸­åºéå†äºŒå‰æ ‘ã€‚</span></span><br><span class="line"><span class="comment">     * æ€æƒ³å’Œä¸Šé¢çš„å…ˆåºéé€’å½’2ç›¸åŒï¼Œ</span></span><br><span class="line"><span class="comment">     * åªæ˜¯è®¿é—®çš„æ—¶é—´æ˜¯åœ¨å·¦å­æ ‘éƒ½å¤„ç†å®Œç›´åˆ°nullçš„æ—¶å€™å‡ºæ ˆå¹¶è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">inOrderStack</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (treeNode != <span class="keyword">null</span> || !stack.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">while</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">                stack.push(treeNode);</span><br><span class="line">                treeNode = treeNode.left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å·¦å­æ ‘è¿›æ ˆå®Œæ¯•</span></span><br><span class="line">            <span class="keyword">if</span> (!stack.isEmpty()) &#123;</span><br><span class="line">                treeNode = stack.pop();</span><br><span class="line">                System.out.print(treeNode.val + <span class="string">" "</span>);</span><br><span class="line">                treeNode = treeNode.right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TagNode</span> </span>&#123;</span><br><span class="line">        TreeNode treeNode;</span><br><span class="line">        <span class="keyword">boolean</span> isFirst;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºéé€’å½’ï¼š</span></span><br><span class="line"><span class="comment">     * ååºéå†ä¸åŒäºå…ˆåºå’Œä¸­åºï¼Œå®ƒæ˜¯è¦å…ˆå¤„ç†å®Œå·¦å³å­æ ‘ï¼Œ</span></span><br><span class="line"><span class="comment">     * ç„¶åå†å¤„ç†æ ¹(å›æº¯)ã€‚</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * å¯¹äºä»»ä¸€ç»“ç‚¹Pï¼Œå°†å…¶å…¥æ ˆï¼Œç„¶åæ²¿å…¶å·¦å­æ ‘ä¸€ç›´å¾€ä¸‹æœç´¢ï¼Œç›´åˆ°æœç´¢åˆ°æ²¡æœ‰å·¦å­©å­çš„ç»“ç‚¹ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ­¤æ—¶è¯¥ç»“ç‚¹å‡ºç°åœ¨æ ˆé¡¶ï¼Œä½†æ˜¯æ­¤æ—¶ä¸èƒ½å°†å…¶å‡ºæ ˆå¹¶è®¿é—®ï¼Œå› æ­¤å…¶å³å­©å­è¿˜ä¸ºè¢«è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment">     * æ‰€ä»¥æ¥ä¸‹æ¥æŒ‰ç…§ç›¸åŒçš„è§„åˆ™å¯¹å…¶å³å­æ ‘è¿›è¡Œç›¸åŒçš„å¤„ç†ï¼Œå½“è®¿é—®å®Œå…¶å³å­©å­æ—¶ï¼Œè¯¥ç»“ç‚¹åˆå‡ºç°åœ¨æ ˆé¡¶ï¼Œ</span></span><br><span class="line"><span class="comment">     * æ­¤æ—¶å¯ä»¥å°†å…¶å‡ºæ ˆå¹¶è®¿é—®ã€‚è¿™æ ·å°±ä¿è¯äº†æ­£ç¡®çš„è®¿é—®é¡ºåºã€‚</span></span><br><span class="line"><span class="comment">     * å¯ä»¥çœ‹å‡ºï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹éƒ½ä¸¤æ¬¡å‡ºç°åœ¨æ ˆé¡¶ï¼Œåªæœ‰åœ¨ç¬¬äºŒæ¬¡å‡ºç°åœ¨æ ˆé¡¶æ—¶ï¼Œæ‰èƒ½è®¿é—®å®ƒã€‚</span></span><br><span class="line"><span class="comment">     * å› æ­¤éœ€è¦å¤šè®¾ç½®ä¸€ä¸ªå˜é‡æ ‡è¯†è¯¥ç»“ç‚¹æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°åœ¨æ ˆé¡¶ï¼Œè¿™é‡Œæ˜¯åœ¨æ ‘ç»“æ„é‡Œé¢åŠ ä¸€ä¸ªæ ‡è®°ï¼Œç„¶ååˆæˆä¸€ä¸ªæ–°çš„TagNodeã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">postOrderStack</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        Stack&lt;TagNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        TagNode tagNode;</span><br><span class="line">        <span class="keyword">while</span> (treeNode != <span class="keyword">null</span> || !stack.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">//æ²¿å·¦å­æ ‘ä¸€ç›´å¾€ä¸‹æœç´¢ï¼Œç›´è‡³å‡ºç°æ²¡æœ‰å·¦å­æ ‘çš„ç»“ç‚¹</span></span><br><span class="line">            <span class="keyword">while</span> (treeNode != <span class="keyword">null</span>) &#123;</span><br><span class="line">                tagNode = <span class="keyword">new</span> TagNode();</span><br><span class="line">                tagNode.treeNode = treeNode;</span><br><span class="line">                tagNode.isFirst = <span class="keyword">true</span>;</span><br><span class="line">                stack.push(tagNode);</span><br><span class="line">                treeNode = treeNode.left;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!stack.isEmpty()) &#123;</span><br><span class="line">                tagNode = stack.pop();</span><br><span class="line">                <span class="comment">//è¡¨ç¤ºæ˜¯ç¬¬ä¸€æ¬¡å‡ºç°åœ¨æ ˆé¡¶</span></span><br><span class="line">                <span class="keyword">if</span> (tagNode.isFirst == <span class="keyword">true</span>) &#123;</span><br><span class="line">                    tagNode.isFirst = <span class="keyword">false</span>;</span><br><span class="line">                    stack.push(tagNode);</span><br><span class="line">                    treeNode = tagNode.treeNode.right;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//ç¬¬äºŒæ¬¡å‡ºç°åœ¨æ ˆé¡¶</span></span><br><span class="line">                    System.out.print(tagNode.treeNode.val + <span class="string">" "</span>);</span><br><span class="line">                    treeNode = <span class="keyword">null</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºéé€’å½’2ï¼š</span></span><br><span class="line"><span class="comment">     * è¦ä¿è¯æ ¹ç»“ç‚¹åœ¨å·¦å­©å­å’Œå³å­©å­è®¿é—®ä¹‹åæ‰èƒ½è®¿é—®ï¼Œå› æ­¤å¯¹äºä»»ä¸€ç»“ç‚¹Pï¼Œå…ˆå°†å…¶å…¥æ ˆã€‚å¦‚æœPä¸å­˜åœ¨å·¦å­©å­å’Œå³å­©å­ï¼Œåˆ™å¯ä»¥ç›´æ¥è®¿é—®å®ƒï¼›</span></span><br><span class="line"><span class="comment">     * æˆ–è€…På­˜åœ¨å·¦å­©å­æˆ–è€…å³å­©å­ï¼Œä½†æ˜¯å…¶å·¦å­©å­å’Œå³å­©å­éƒ½å·²è¢«è®¿é—®è¿‡äº†ï¼Œåˆ™åŒæ ·å¯ä»¥ç›´æ¥è®¿é—®è¯¥ç»“ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     * è‹¥éä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œåˆ™å°†Pçš„å³å­©å­å’Œå·¦å­©å­ä¾æ¬¡å…¥æ ˆï¼Œè¿™æ ·å°±ä¿è¯äº†æ¯æ¬¡å–æ ˆé¡¶å…ƒç´ çš„æ—¶å€™ï¼Œå·¦å­©å­åœ¨å³å­©å­å‰é¢è¢«è®¿é—®ï¼Œ</span></span><br><span class="line"><span class="comment">     * å·¦å­©å­å’Œå³å­©å­éƒ½åœ¨æ ¹ç»“ç‚¹å‰é¢è¢«è®¿é—®ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> treeNode</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">postOrderStack2</span><span class="params">(TreeNode treeNode)</span> </span>&#123;</span><br><span class="line">        Stack&lt;TreeNode&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        TreeNode currentTreeNode;</span><br><span class="line">        TreeNode preTreeNode = <span class="keyword">null</span>;</span><br><span class="line">        stack.push(treeNode);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">            currentTreeNode = stack.peek();</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰ç»“ç‚¹æ²¡æœ‰å­©å­ç»“ç‚¹æˆ–è€…å­©å­èŠ‚ç‚¹éƒ½å·²è¢«è®¿é—®è¿‡</span></span><br><span class="line">            <span class="keyword">if</span> ((currentTreeNode.left == <span class="keyword">null</span> &amp;&amp; currentTreeNode.right == <span class="keyword">null</span>) ||</span><br><span class="line">                    (preTreeNode != <span class="keyword">null</span> &amp;&amp; (preTreeNode == currentTreeNode.left || preTreeNode == currentTreeNode.right))) &#123;</span><br><span class="line">                System.out.print(currentTreeNode.val + <span class="string">" "</span>);</span><br><span class="line">                stack.pop();</span><br><span class="line">                preTreeNode = currentTreeNode;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (currentTreeNode.right != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    stack.push(currentTreeNode.right);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (currentTreeNode.left != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    stack.push(currentTreeNode.left);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://www.cnblogs.com/dolphin0520/archive/2011/08/25/2153720.html" target="_blank" rel="noopener">äºŒå‰æ ‘çš„éé€’å½’éå†</a></li><li><a href="http://blog.csdn.net/kerryfish/article/details/24309617" target="_blank" rel="noopener"> JAVAä¸‹å®ç°äºŒå‰æ ‘çš„å…ˆåºã€ä¸­åºã€ååºã€å±‚åºéå†ï¼ˆé€’å½’å’Œå¾ªç¯ï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç½”</title>
      <link href="/%E8%AF%BB%E4%B9%A6/wang/"/>
      <url>/%E8%AF%BB%E4%B9%A6/wang/</url>
      
        <content type="html"><![CDATA[<p>å°¼é‡‡è¯´ï¼Œæˆ‘çˆ±ä»¥è¡€ä¹¦è€…ã€‚æ‰€æ€æ‰€æ„Ÿï¼Œçš†å¯æˆè¯—ï¼Œè¯—è€…ï¼Œä¹¦çœŸæƒ…ä¹Ÿã€‚</p><p>è¯—ä¸­æœ‰å¤§é“ï¼Œæˆ‘æ‰‹å†™æˆ‘å¿ƒã€‚</p><a id="more"></a><p><strong>ç½”</strong></p><p>æƒ˜æ—¶ä¼¤æ‚²æœ›æœˆæ˜ï¼Œç¾¤æ˜Ÿé—ªé—ªä¼¼ç¬‘æˆ‘ã€‚<br>å§£å§£æœˆå…‰äººå·²å˜ï¼Œæ‰€æ€æ‰€æ„Ÿæ— ä¸åŒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è¯— </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linuxå¸¸ç”¨å‘½ä»¤</title>
      <link href="/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/Linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p><img src="https://images.morethink.cn/4115ca16f89d5c1d13146cd19e6ad6d5.png" alt=""><br>æœ¬æ–‡è®°å½•ä¸€äº›åœ¨Linuxç³»ç»Ÿä¸‹æ¯”è¾ƒå¸¸ç”¨çš„å‘½ä»¤ã€‚</p><p>é¦–å…ˆä»‹ç»ä¸‹Linuxä¸‹å‘½ä»¤ç”Ÿæ•ˆçš„é¡ºåºï¼š</p><ol><li>ç¬¬ä¸€é¡ºä½ï¼šæ‰§è¡Œç»å¯¹è·¯å¾„æˆ–è€…ç›¸å¯¹è·¯å¾„çš„å‘½ä»¤</li><li>ç¬¬äºŒé¡ºä½ï¼šæ‰§è¡Œåˆ«å</li><li>ç¬¬ä¸‰é¡ºä½ï¼šæ‰§è¡ŒBashçš„å†…éƒ¨å‘½ä»¤</li><li>ç¬¬å››é¡ºä½ï¼šæ‰§è¡ŒæŒ‰ç…§<code>$PATH</code>ç¯å¢ƒå˜é‡è®¾ç½®å®šä¹‰çš„ç›®å½•é¡ºåºçš„ç¬¬ä¸€ä¸ªå‘½ä»¤<a id="more"></a></li></ol><h1 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h1><p>è¯¥å‘½ä»¤ç”¨äºå¤åˆ¶æ–‡ä»¶ï¼Œcopyä¹‹æ„ï¼Œå®ƒè¿˜å¯ä»¥æŠŠå¤šä¸ªæ–‡ä»¶ä¸€æ¬¡æ€§åœ°å¤åˆ¶åˆ°ä¸€ä¸ªç›®å½•ä¸‹ï¼Œå®ƒçš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>-aï¼šå°†æ–‡ä»¶çš„ç‰¹æ€§ä¸€èµ·å¤åˆ¶  </li><li>-pï¼šè¿åŒæ–‡ä»¶çš„å±æ€§ä¸€èµ·å¤åˆ¶ï¼Œè€Œéä½¿ç”¨é»˜è®¤æ–¹å¼ï¼Œä¸-aç›¸ä¼¼ï¼Œå¸¸ç”¨äºå¤‡ä»½  </li><li>-iï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨æ—¶ï¼Œåœ¨è¦†ç›–æ—¶ä¼šå…ˆè¯¢é—®æ“ä½œçš„è¿›è¡Œ  </li><li>-rï¼šé€’å½’æŒç»­å¤åˆ¶ï¼Œç”¨äºç›®å½•çš„å¤åˆ¶è¡Œä¸º  </li><li>-uï¼šç›®æ ‡æ–‡ä»¶ä¸æºæ–‡ä»¶æœ‰å·®å¼‚æ—¶æ‰ä¼šå¤åˆ¶  </li></ul><p>ä¾‹ï¼š</p><ul><li><code>cp source dest</code> å¤åˆ¶æ–‡ä»¶</li><li><code>cp -r sourceFolder targetFolder</code> é€’å½’å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹</li></ul><h1 id="mv"><a href="#mv" class="headerlink" title="mv"></a>mv</h1><p>è¯¥å‘½ä»¤ç”¨äºç§»åŠ¨æ–‡ä»¶ã€ç›®å½•æˆ–æ›´åï¼Œmoveä¹‹æ„ï¼Œå®ƒçš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>-fï¼šforceå¼ºåˆ¶çš„æ„æ€ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸ä¼šè¯¢é—®è€Œç›´æ¥è¦†ç›–  </li><li>-iï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œå°±ä¼šè¯¢é—®æ˜¯å¦è¦†ç›–  </li><li>-uï¼šè‹¥ç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨ï¼Œä¸”æ¯”ç›®æ ‡æ–‡ä»¶æ–°ï¼Œæ‰ä¼šæ›´æ–°  </li></ul><p>æ³¨ï¼šè¯¥å‘½ä»¤å¯ä»¥æŠŠä¸€ä¸ªæ–‡ä»¶æˆ–å¤šä¸ªæ–‡ä»¶ä¸€æ¬¡ç§»åŠ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªç›®æ ‡æ–‡ä»¶ä¸€å®šè¦æ˜¯â€œç›®å½•â€ã€‚</p><p>ä¾‹ï¼š</p><ul><li><code>mv file1 file2 file3 dir</code>  æŠŠæ–‡ä»¶file1ã€file2ã€file3ç§»åŠ¨åˆ°ç›®å½•dirä¸­  </li><li><code>mv file1 file2</code> æŠŠæ–‡ä»¶file1é‡å‘½åä¸ºfile2  </li></ul><h1 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h1><p>è¯¥å‘½ä»¤ç”¨äºåˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œremoveä¹‹é—´ï¼Œå®ƒçš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>-f ï¼šå°±æ˜¯forceçš„æ„æ€ï¼Œå¿½ç•¥ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œä¸ä¼šå‡ºç°è­¦å‘Šæ¶ˆæ¯  </li><li>-i ï¼šäº’åŠ¨æ¨¡å¼ï¼Œåœ¨åˆ é™¤å‰ä¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦æ“ä½œ  </li><li>-r ï¼š<strong>é€’å½’åˆ é™¤ï¼Œæœ€å¸¸ç”¨äºç›®å½•åˆ é™¤ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å±é™©çš„å‚æ•°</strong>  </li></ul><p>ä¾‹å¦‚ï¼š</p><ul><li><code>rm -i file</code> åˆ é™¤æ–‡ä»¶fileï¼Œåœ¨åˆ é™¤ä¹‹å‰ä¼šè¯¢é—®æ˜¯å¦è¿›è¡Œè¯¥æ“ä½œ  </li><li><code>rm -fr dir</code>  å¼ºåˆ¶åˆ é™¤ç›®å½•dirä¸­çš„æ‰€æœ‰æ–‡ä»¶</li></ul><h1 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h1><p>taræ˜¯linuxä¸Šå¸¸ç”¨çš„æ‰“åŒ…ã€å‹ç¼©ã€è§£å‹ç¼©å·¥å…·ï¼Œå®ƒçš„å‚æ•°å¾ˆå¤šï¼Œè¿™é‡Œåˆ—ä¸¾å¸¸ç”¨çš„å‹ç¼©ä¸è§£å‹ç¼©å‚æ•°ã€‚</p><p>å‚æ•°ï¼š</p><ul><li><code>-c</code>ï¼š <strong>å»ºç«‹å‹ç¼©æ¡£æ¡ˆçš„å‚æ•°</strong></li><li><code>-x</code>ï¼š <strong>è§£å‹ç¼©å‹ç¼©æ¡£æ¡ˆçš„å‚æ•°</strong></li><li><code>-z</code>ï¼š ç”¨<code>gzip</code>å‹ç¼©</li><li><code>-j</code>ï¼š ç”¨<code>bzip2</code>è§£å‹æ–‡ä»¶</li><li><code>-Z</code>ï¼š ç”¨<code>compress</code>è§£å‹æ–‡ä»¶</li><li><code>-v</code>ï¼š å‹ç¼©çš„è¿‡ç¨‹ä¸­æ˜¾ç¤ºæ¡£æ¡ˆ</li><li><code>-f</code>ï¼š ç½®é¡¶æ–‡æ¡£åï¼Œåœ¨<code>-f</code>åé¢ç«‹å³æ¥æ–‡ä»¶åï¼Œä¸èƒ½å†åŠ å‚æ•°</li></ul><h2 id="æ‰“åŒ…ä¸è§£åŒ…"><a href="#æ‰“åŒ…ä¸è§£åŒ…" class="headerlink" title="æ‰“åŒ…ä¸è§£åŒ…"></a>æ‰“åŒ…ä¸è§£åŒ…</h2><ul><li><p>å°†æ•´ä¸ª/home/www/images ç›®å½•ä¸‹çš„æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -cvf images.tar images â† ä»…æ‰“åŒ…ï¼Œä¸å‹ç¼©</span><br></pre></td></tr></table></figure></li><li><p>è§£åŒ…åˆ°æŒ‡å®šçš„ç›®å½•</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -xvf filename.tar -C æŒ‡å®šç›®å½•</span><br></pre></td></tr></table></figure></li></ul><h2 id="å‹ç¼©ä¸è§£å‹ç¼©"><a href="#å‹ç¼©ä¸è§£å‹ç¼©" class="headerlink" title="å‹ç¼©ä¸è§£å‹ç¼©"></a>å‹ç¼©ä¸è§£å‹ç¼©</h2><h3 id="gzipå‹ç¼©"><a href="#gzipå‹ç¼©" class="headerlink" title="gzipå‹ç¼©"></a>gzipå‹ç¼©</h3><ul><li><p>æ‰“åŒ…åï¼Œä»¥gzipå‹ç¼©ï¼Œåœ¨å‚æ•°fåé¢çš„å‹ç¼©æ–‡ä»¶åæ˜¯è‡ªå·±å–çš„ï¼Œä¹ æƒ¯ä¸Šç”¨taræ¥åšï¼Œå¦‚æœåŠ zå‚æ•°ï¼Œåˆ™ä»¥tar.gz æˆ–tgzæ¥ä»£è¡¨gzipå‹ç¼©è¿‡çš„taræ–‡ä»¶</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zcvf images.tar.gz images</span><br></pre></td></tr></table></figure></li><li><p>å°† images.tar.gz è§£å‹</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf images.tar.gz</span><br></pre></td></tr></table></figure></li><li><p>è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½•</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf images.tar.gz -C æŒ‡å®šçš„ç›®å½•</span><br></pre></td></tr></table></figure></li></ul><h3 id="bzip2å‹ç¼©"><a href="#bzip2å‹ç¼©" class="headerlink" title="bzip2å‹ç¼©"></a>bzip2å‹ç¼©</h3><ul><li><p>æ‰“åŒ…åï¼Œä»¥bzip2å‹ç¼©</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -jcvf images.tar.bz2 images</span><br></pre></td></tr></table></figure></li><li><p>å°† images.tar.bz2 è§£å‹</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -jxvf images.tar.bz2</span><br></pre></td></tr></table></figure></li><li><p>è§£å‹ç¼©åˆ°æŒ‡å®šçš„ç›®å½•</p>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -jxvf images.tar.bz2 -C æŒ‡å®šçš„ç›®å½•</span><br></pre></td></tr></table></figure></li></ul><h2 id="ä¸åŒå‹ç¼©æ–¹å¼çš„å‹ç¼©ç‡æ¯”è¾ƒ"><a href="#ä¸åŒå‹ç¼©æ–¹å¼çš„å‹ç¼©ç‡æ¯”è¾ƒ" class="headerlink" title="ä¸åŒå‹ç¼©æ–¹å¼çš„å‹ç¼©ç‡æ¯”è¾ƒ"></a>ä¸åŒå‹ç¼©æ–¹å¼çš„å‹ç¼©ç‡æ¯”è¾ƒ</h2><ul><li><code>tar -zcvf test.tar.gz test</code></li><li><code>tar -jcvf test.tar.bz2 test</code></li><li><code>zip -ry test.zip test</code><br>  zipå‘½ä»¤è¦åŠ ä¸Šä¸¤ä¸ªé€‰é¡¹<ul><li><code>-r</code>ï¼šè¡¨ç¤ºé€’å½’ç›®å½•ï¼Œä¸ç„¶åªå‹å‡ºæ¥ä¸€ä¸ªç©ºç›®å½•ã€‚</li><li><code>-y</code>ï¼šè¡¨ç¤ºä¿æŒç¬¦å·é“¾æ¥ï¼Œè€Œä¸ç”¨æŠŠç¬¦å·é“¾æ¥æŒ‡å‘çš„æ–‡ä»¶ä¹Ÿå‹è¿›æ¥ã€‚</li></ul></li></ul><p>ç»“æœæ¯”è¾ƒï¼š<code>ll -h test.*</code><br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">-rw-r--r-- 1 liwenhao staff 45M  8  6 20:12 test.tar.bz2</span><br><span class="line">-rw-r--r-- 1 liwenhao staff 47M  8  6 20:12 test.tar.gz</span><br><span class="line">-rw-r--r-- 1 liwenhao staff 50M  8  6 20:13 test.zip</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼š<br>å‹ç¼©ç‡ï¼šbzip2 &gt; gzip &gt; zip</p><h2 id="taræ‰“åŒ…ç»å¯¹è·¯å¾„"><a href="#taræ‰“åŒ…ç»å¯¹è·¯å¾„" class="headerlink" title="taræ‰“åŒ…ç»å¯¹è·¯å¾„"></a>taræ‰“åŒ…ç»å¯¹è·¯å¾„</h2><p>å¤‡ä»½mysqlæ—¶ï¼Œæƒ³æŠŠä¹‹å‰çš„æ–‡ä»¶å‹ç¼©ï¼Œä½†æ˜¯ç”¨<code>tar czvf /data/backup/test.tar.gz /data/a/b/directory</code></p><p>æ‰“å¼€ä¸€çœ‹ï¼Œé‡Œé¢çš„å†…å®¹æ˜¯æŠŠæ•´ä¸ªç»å¯¹è·¯å¾„éƒ½æ”¾è¿›å»äº†ã€‚</p><p>å¦‚æœæƒ³å®ç°ç›¸å¯¹è·¯å¾„ï¼Œè¿™æ ·å†™å°±å¯ä»¥è§£å†³äº†</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar czvf /data/backup/test.tar.gz /data/a/b/directory</span><br><span class="line">æ”¹æˆ</span><br><span class="line">tar czvf /data/backup/test.tar.gz -C /data/a/b directory</span><br></pre></td></tr></table></figure><p>Cæ˜¯ä¸´æ—¶åˆ‡æ¢å·¥ä½œç›®å½•ï¼Œ-Pæ˜¯ç»å¯¹è·¯å¾„ï¼Œåœ¨è¿™é‡Œåªç”¨åˆ°-Cå‚æ•°å°±è¡Œäº†ã€‚</p><h1 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h1><p>è¯¥å‘½ä»¤ç”¨äºå°†æŸä¸ªæ—¶é—´ç‚¹çš„è¿›ç¨‹è¿è¡Œæƒ…å†µé€‰å–ä¸‹æ¥å¹¶è¾“å‡ºï¼Œprocessä¹‹æ„ï¼Œå®ƒçš„å¸¸ç”¨å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>-A ï¼šæ‰€æœ‰çš„è¿›ç¨‹å‡æ˜¾ç¤ºå‡ºæ¥  </li><li>-a ï¼šæ˜¾ç¤º <strong>åŒä¸€ç»ˆç«¯ä¸‹</strong> çš„æ‰€æœ‰ç¨‹åº</li><li>-u ï¼šæœ‰æ•ˆç”¨æˆ·çš„ç›¸å…³è¿›ç¨‹  </li><li>-x ï¼šä¸€èˆ¬ä¸aå‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå¯åˆ—å‡ºè¾ƒå®Œæ•´çš„ä¿¡æ¯  </li><li>-l ï¼šè¾ƒé•¿ï¼Œè¾ƒè¯¦ç»†åœ°å°†PIDçš„ä¿¡æ¯åˆ—å‡º  </li><li>-e ï¼šç­‰äº<code>&quot;-A&quot;</code></li><li>-f ï¼šæ˜¾ç¤ºç¨‹åºé—´çš„å…³ç³»</li></ul><p>å…¶å®æˆ‘ä»¬åªè¦è®°ä½psä¸€èˆ¬ä½¿ç”¨çš„å‘½ä»¤å‚æ•°æ­é…å³å¯ï¼Œå®ƒä»¬å¹¶ä¸å¤šï¼Œå¦‚ä¸‹ï¼š</p><ul><li><code>ps aux</code> æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰çš„è¿›ç¨‹æ•°æ®  </li><li><code>ps ax</code>  æŸ¥çœ‹ä¸ä¸terminalæœ‰å…³çš„æ‰€æœ‰è¿›ç¨‹  </li><li><code>ps -lA</code>  æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰çš„è¿›ç¨‹æ•°æ®  </li><li><code>ps axjf</code> æŸ¥çœ‹è¿åŒä¸€éƒ¨åˆ†è¿›ç¨‹æ ‘çŠ¶æ€</li></ul><p>æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ï¼š</p><ul><li><code>ps â€“ef|grep tomcat</code> æŸ¥çœ‹æ‰€æœ‰æœ‰å…³tomcatçš„è¿›ç¨‹</li><li><code>ps -ef|grep --color java</code> é«˜äº®è¦æŸ¥è¯¢çš„å…³é”®å­—</li></ul><h1 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h1><p>è¯¥å‘½ä»¤ç”¨äºå‘æŸä¸ªå·¥ä½œï¼ˆjobnumberï¼‰æˆ–è€…æ˜¯æŸä¸ªPIDï¼ˆæ•°å­—ï¼‰ä¼ é€ä¸€ä¸ªä¿¡å·ï¼Œå®ƒé€šå¸¸ä¸pså’Œjobså‘½ä»¤ä¸€èµ·ä½¿ç”¨ï¼Œå®ƒçš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š<br><code>kill -signal PID</code><br>signalçš„å¸¸ç”¨å‚æ•°(æœ€å‰é¢çš„æ•°å­—ä¸ºä¿¡å·çš„ä»£å·ï¼Œä½¿ç”¨æ—¶å¯ä»¥ç”¨ä»£å·ä»£æ›¿ç›¸åº”çš„ä¿¡å·)å¦‚ä¸‹ï¼š</p><ul><li>1ï¼šSIGHUPï¼Œå¯åŠ¨è¢«ç»ˆæ­¢çš„è¿›ç¨‹  </li><li>2ï¼šSIGINTï¼Œç›¸å½“äºè¾“å…¥ctrl+cï¼Œä¸­æ–­ä¸€ä¸ªç¨‹åºçš„è¿›è¡Œ  </li><li>9ï¼šSIGKILLï¼Œå¼ºåˆ¶ä¸­æ–­ä¸€ä¸ªè¿›ç¨‹çš„è¿›è¡Œ  </li><li>15ï¼šSIGTERMï¼Œä»¥æ­£å¸¸çš„ç»“æŸè¿›ç¨‹æ–¹å¼æ¥ç»ˆæ­¢è¿›ç¨‹  </li><li>17ï¼šSIGSTOPï¼Œç›¸å½“äºè¾“å…¥ctrl+zï¼Œæš‚åœä¸€ä¸ªè¿›ç¨‹çš„è¿›è¡Œ  </li></ul><p>ä¾‹å¦‚ï¼š</p><ul><li>ä»¥æ­£å¸¸çš„ç»“æŸè¿›ç¨‹æ–¹å¼æ¥ç»ˆäºç¬¬ä¸€ä¸ªåå°å·¥ä½œï¼Œå¯ç”¨jobså‘½ä»¤æŸ¥çœ‹åå°ä¸­çš„ç¬¬ä¸€ä¸ªå·¥ä½œè¿›ç¨‹<br><code>kill -SIGTERM %1</code> æˆ–è€… <code>kill -15 %1</code></li><li>é‡æ–°æ”¹åŠ¨è¿›ç¨‹IDä¸ºPIDçš„è¿›ç¨‹ï¼ŒPIDå¯ç”¨pså‘½ä»¤é€šè¿‡ç®¡é“å‘½ä»¤åŠ ä¸Šgrepå‘½ä»¤è¿›è¡Œç­›é€‰è·å¾—<br><code>kill -SIGHUP PID</code> æˆ–è€… <code>kill -1 PID</code></li><li>ç»ˆæ­¢çº¿ç¨‹å·ä½19979çš„è¿›ç¨‹<br><code>kill -9 19979</code></li></ul><h1 id="killall"><a href="#killall" class="headerlink" title="killall"></a>killall</h1><p>è¯¥å‘½ä»¤ç”¨äºå‘ä¸€ä¸ªå‘½ä»¤å¯åŠ¨çš„è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œå®ƒçš„ä¸€èˆ¬è¯­æ³•å¦‚ä¸‹ï¼š</p><p><code>killall [-iIe] [command name]</code><br>å®ƒçš„å‚æ•°å¦‚ä¸‹ï¼š</p><ul><li>-i ï¼šäº¤äº’å¼çš„æ„æ€ï¼Œè‹¥éœ€è¦åˆ é™¤æ—¶ï¼Œä¼šè¯¢é—®ç”¨æˆ·  </li><li>-e ï¼šè¡¨ç¤ºåé¢æ¥çš„command nameè¦ä¸€è‡´ï¼Œä½†command nameä¸èƒ½è¶…è¿‡15ä¸ªå­—ç¬¦  </li><li>-I ï¼šå‘½ä»¤åç§°å¿½ç•¥å¤§å°å†™  </li></ul><p>ä¾‹å¦‚ï¼š<br><code>killall -SIGHUP syslogd</code> é‡æ–°å¯åŠ¨syslogd  </p><h1 id="file"><a href="#file" class="headerlink" title="file"></a>file</h1><p>è¯¥å‘½ä»¤ç”¨äºåˆ¤æ–­æ¥åœ¨fileå‘½ä»¤åçš„æ–‡ä»¶çš„åŸºæœ¬æ•°æ®ï¼Œå› ä¸ºåœ¨Linuxä¸‹æ–‡ä»¶çš„ç±»å‹å¹¶ä¸æ˜¯ä»¥åç¼€ä¸ºåˆ†çš„ï¼Œæ‰€ä»¥è¿™ä¸ªå‘½ä»¤å¯¹æˆ‘ä»¬æ¥è¯´å°±å¾ˆæœ‰ç”¨äº†ï¼Œå®ƒçš„ç”¨æ³•éå¸¸ç®€å•ï¼ŒåŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š<br><code>file filename</code><br>ä¾‹å¦‚ï¼š<br><code>file ./test</code></p><h1 id="ln"><a href="#ln" class="headerlink" title="ln"></a>ln</h1><p>lnæ˜¯linuxä¸­åˆä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥.å½“æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç›®å½•ï¼Œç”¨åˆ°ç›¸åŒçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦çš„ç›®å½•ä¸‹éƒ½æ”¾ä¸€ä¸ªå¿…é¡»ç›¸åŒçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬åªè¦åœ¨æŸä¸ªå›ºå®šçš„ç›®å½•ï¼Œæ”¾ä¸Šè¯¥æ–‡ä»¶ï¼Œç„¶ååœ¨ å…¶å®ƒçš„ç›®å½•ä¸‹ç”¨lnå‘½ä»¤é“¾æ¥ï¼ˆlinkï¼‰å®ƒå°±å¯ä»¥ï¼Œä¸å¿…é‡å¤çš„å ç”¨ç£ç›˜ç©ºé—´ã€‚</p><h2 id="å‘½ä»¤æ ¼å¼ï¼š"><a href="#å‘½ä»¤æ ¼å¼ï¼š" class="headerlink" title="å‘½ä»¤æ ¼å¼ï¼š"></a>å‘½ä»¤æ ¼å¼ï¼š</h2><p><code>ln [å‚æ•°][æºæ–‡ä»¶æˆ–ç›®å½•][ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•]</code></p><h2 id="å‘½ä»¤åŠŸèƒ½ï¼š"><a href="#å‘½ä»¤åŠŸèƒ½ï¼š" class="headerlink" title="å‘½ä»¤åŠŸèƒ½ï¼š"></a>å‘½ä»¤åŠŸèƒ½ï¼š</h2><p>Linuxæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæœ‰æ‰€è°“çš„é“¾æ¥(link)ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è§†ä¸ºæ¡£æ¡ˆçš„åˆ«åï¼Œè€Œé“¾æ¥åˆå¯åˆ†ä¸ºä¸¤ç§ : ç¡¬é“¾æ¥(hard link)ä¸è½¯é“¾æ¥(symbolic link)ï¼Œç¡¬é“¾æ¥çš„æ„æ€æ˜¯ä¸€ä¸ªæ¡£æ¡ˆå¯ä»¥æœ‰å¤šä¸ªåç§°ï¼Œè€Œè½¯é“¾æ¥çš„æ–¹å¼åˆ™æ˜¯äº§ç”Ÿä¸€ä¸ªç‰¹æ®Šçš„æ¡£æ¡ˆï¼Œè¯¥æ¡£æ¡ˆçš„å†…å®¹æ˜¯æŒ‡å‘å¦ä¸€ä¸ªæ¡£æ¡ˆçš„ä½ç½®ã€‚ç¡¬é“¾æ¥æ˜¯å­˜åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œè€Œè½¯é“¾æ¥å´å¯ä»¥è·¨è¶Šä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><ul><li><p><strong>è½¯é“¾æ¥</strong>ï¼š</p><ol><li>è½¯é“¾æ¥ï¼Œä»¥è·¯å¾„çš„å½¢å¼å­˜åœ¨ã€‚ç±»ä¼¼äºWindowsæ“ä½œç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼</li><li>è½¯é“¾æ¥å¯ä»¥ è·¨æ–‡ä»¶ç³»ç»Ÿ ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥</li><li>è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åè¿›è¡Œé“¾æ¥</li><li>è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé“¾æ¥</li></ol></li><li><p><strong>ç¡¬é“¾æ¥</strong>:</p><ol><li>ç¡¬é“¾æ¥ï¼Œä»¥æ–‡ä»¶å‰¯æœ¬çš„å½¢å¼å­˜åœ¨ã€‚ä½†ä¸å ç”¨å®é™…ç©ºé—´ã€‚</li><li>ä¸å…è®¸ç»™ç›®å½•åˆ›å»ºç¡¬é“¾æ¥</li><li>ç¡¬é“¾æ¥åªæœ‰åœ¨åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­æ‰èƒ½åˆ›å»º</li></ol></li></ul><p>è¿™é‡Œæœ‰ä¸¤ç‚¹è¦æ³¨æ„ï¼š</p><ol><li><p><strong>lnå‘½ä»¤ä¼šä¿æŒæ¯ä¸€å¤„é“¾æ¥æ–‡ä»¶çš„åŒæ­¥æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºä½ æ”¹åŠ¨äº†å“ªä¸€å¤„ï¼Œå…¶å®ƒçš„æ–‡ä»¶éƒ½ä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–</strong>ï¼›</p></li><li><p>lnçš„é“¾æ¥åˆåˆ†è½¯é“¾æ¥å’Œç¡¬é“¾æ¥ä¸¤ç§ï¼Œè½¯é“¾æ¥å°±æ˜¯ln â€“s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œå®ƒåªä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶çš„é•œåƒï¼Œä¸ä¼šå ç”¨ç£ç›˜ç©ºé—´ï¼Œç¡¬é“¾æ¥ ln æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶ï¼Œæ²¡æœ‰å‚æ•°-sï¼Œ å®ƒä¼šåœ¨ä½ é€‰å®šçš„ä½ç½®ä¸Šç”Ÿæˆä¸€ä¸ªå’Œæºæ–‡ä»¶å¤§å°ç›¸åŒçš„æ–‡ä»¶ï¼Œæ— è®ºæ˜¯è½¯é“¾æ¥è¿˜æ˜¯ç¡¬é“¾æ¥ï¼Œæ–‡ä»¶éƒ½ä¿æŒåŒæ­¥å˜åŒ–ã€‚<br>lnæŒ‡ä»¤ç”¨åœ¨é“¾æ¥æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚åŒæ—¶æŒ‡å®šä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°æ˜¯ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šæŠŠå‰é¢æŒ‡å®šçš„æ‰€æœ‰æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°è¯¥ç›®å½•ä¸­ã€‚è‹¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–‡ä»¶æˆ–ç›®å½•ï¼Œä¸”æœ€åçš„ç›®çš„åœ°å¹¶éæ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼Œåˆ™ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ã€‚</p></li><li><p>å‘½ä»¤å‚æ•°ï¼š</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¿…è¦å‚æ•°:</span><br><span class="line">-b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥</span><br><span class="line">-d å…è®¸è¶…çº§ç”¨æˆ·åˆ¶ä½œç›®å½•çš„ç¡¬é“¾æ¥</span><br><span class="line">-f å¼ºåˆ¶æ‰§è¡Œ</span><br><span class="line">-i äº¤äº’æ¨¡å¼ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™æç¤ºç”¨æˆ·æ˜¯å¦è¦†ç›–</span><br><span class="line">-n æŠŠç¬¦å·é“¾æ¥è§†ä¸ºä¸€èˆ¬ç›®å½•</span><br><span class="line">-s è½¯é“¾æ¥(ç¬¦å·é“¾æ¥)</span><br><span class="line">-v æ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†è¿‡ç¨‹</span><br><span class="line">é€‰æ‹©å‚æ•°:</span><br><span class="line">-S &quot;-S&lt;å­—å°¾å¤‡ä»½å­—ç¬¦ä¸²&gt; &quot;æˆ– &quot;--suffix=&lt;å­—å°¾å¤‡ä»½å­—ç¬¦ä¸²&gt;â€</span><br><span class="line">-V &quot;-V&lt;å¤‡ä»½æ–¹å¼&gt;&quot;æˆ–&quot;--version-control=&lt;å¤‡ä»½æ–¹å¼&gt;&quot;</span><br><span class="line">--help æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯</span><br><span class="line">--version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</span><br></pre></td></tr></table></figure></li></ol><h2 id="ä½¿ç”¨å®ä¾‹"><a href="#ä½¿ç”¨å®ä¾‹" class="headerlink" title="ä½¿ç”¨å®ä¾‹"></a>ä½¿ç”¨å®ä¾‹</h2><p>å®ä¾‹1ï¼šç»™æ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥</p><p>å‘½ä»¤ï¼š</p><p><code>ln -s log2013.log link2013</code></p><p>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost test]# ll</span><br><span class="line"></span><br><span class="line">-rw-r--r-- 1 root bin      61 11-13 06:03 log2013.log</span><br><span class="line"></span><br><span class="line">[root@localhost test]# ln -s log2013.log link2013</span><br><span class="line"></span><br><span class="line">[root@localhost test]# ll</span><br><span class="line"></span><br><span class="line">lrwxrwxrwx 1 root root     11 12-07 16:01 link2013 -&gt; log2013.log</span><br><span class="line"></span><br><span class="line">-rw-r--r-- 1 root bin      61 11-13 06:03 log2013.log</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><p>ä¸ºlog2013.logæ–‡ä»¶åˆ›å»ºè½¯é“¾æ¥link2013ï¼Œå¦‚æœlog2013.logä¸¢å¤±ï¼Œlink2013å°†å¤±æ•ˆ</p><p>å®ä¾‹2ï¼šç»™æ–‡ä»¶åˆ›å»ºç¡¬é“¾æ¥</p><p>å‘½ä»¤ï¼š<br><code>ln log2013.log ln2013</code><br>è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[root@localhost test]# ll</span><br><span class="line"></span><br><span class="line">lrwxrwxrwx 1 root root     11 12-07 16:01 link2013 -&gt; log2013.log</span><br><span class="line"></span><br><span class="line">-rw-r--r-- 1 root bin      61 11-13 06:03 log2013.log</span><br><span class="line"></span><br><span class="line">[root@localhost test]# ln log2013.log ln2013</span><br><span class="line"></span><br><span class="line">[root@localhost test]# ll</span><br><span class="line"></span><br><span class="line">lrwxrwxrwx 1 root root     11 12-07 16:01 link2013 -&gt; log2013.log</span><br><span class="line"></span><br><span class="line">-rw-r--r-- 2 root bin      61 11-13 06:03 ln2013</span><br><span class="line"></span><br><span class="line">-rw-r--r-- 2 root bin      61 11-13 06:03 log2013.log</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><p>ä¸ºlog2013.logåˆ›å»ºç¡¬é“¾æ¥ln2013ï¼Œlog2013.logä¸ln2013çš„å„é¡¹å±æ€§ç›¸åŒ</p><h2 id="åˆ é™¤è½¯è¿æ¥"><a href="#åˆ é™¤è½¯è¿æ¥" class="headerlink" title="åˆ é™¤è½¯è¿æ¥"></a>åˆ é™¤è½¯è¿æ¥</h2><blockquote><p>ç›®å½•çš„è½¯è¿æ¥è¦è°¨æ…åˆ é™¤ï¼Œæœ‰å¯èƒ½æŠŠåŸæ–‡ä»¶ç›®å½•ä¸‹çš„æ–‡ä»¶ç»™åˆ é™¤äº†ã€‚</p></blockquote><ol><li><p>å…ˆå»ºç«‹ä¸€ä¸ªè½¯è¿æ¥</p> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@rekfan.com test]# ls -il</span><br><span class="line">æ€»è®¡  0</span><br><span class="line">1491138 -rw-râ€“râ€“ 1 root root 48 07-14 14:17 file1</span><br><span class="line">1491139 -rw-râ€“râ€“ 2  root root 0 07-14 14:17 file2</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0 07-14 14:17  file2hand</span><br><span class="line"><span class="meta">#</span>å»ºç«‹file1å’Œfile1softè½¯è¿æ¥</span><br><span class="line">[root@rekfan.com test]# ln -s file1  file1soft</span><br><span class="line">[root@rekfan.com test]# ls -il</span><br><span class="line">æ€»è®¡ 0</span><br><span class="line">1491138 -rw-râ€“râ€“ 1 root  root 48 07-14 14:17 file1</span><br><span class="line">1491140 lrwxrwxrwx 1 root root 5 07-14 14:24  file1soft -&gt; file1</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0 07-14 14:17  file2</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0 07-14 14:17 file2hand</span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤ä¸Šé¢å»ºç«‹çš„è½¯è¿æ¥</p> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@rekfan.com test]# ls -il</span><br><span class="line">æ€»è®¡  0</span><br><span class="line">1491138 -rw-râ€“râ€“ 1 root root 0 07-14 14:17 file1</span><br><span class="line">1491140 lrwxrwxrwx 1  root root 5 07-14 14:24 file1soft -&gt; file1</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0  07-14 14:17 file2</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0 07-14 14:17  file2hand</span><br><span class="line"><span class="meta">#</span>åˆ é™¤è½¯è¿æ¥</span><br><span class="line">[root@rekfan.com test]# rm -rf file1soft</span><br><span class="line">[root@rekfan.com test]#  ls -il</span><br><span class="line">æ€»è®¡ 0</span><br><span class="line">1491138 -rw-râ€“râ€“ 1 root root 0 07-14 14:17 file1</span><br><span class="line">1491139  -rw-râ€“râ€“ 2 root root 0 07-14 14:17 file2</span><br><span class="line">1491139 -rw-râ€“râ€“ 2 root root 0 07-14  14:17 file2hand</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>åˆ é™¤è½¯é“¾æ¥ ç¡®å®æ˜¯ç”¨rm ä½†æ˜¯!!!<br>rm -fr xxxx/ åŠ äº†ä¸ª/ è¿™ä¸ªæ˜¯åˆ é™¤æ–‡ä»¶å¤¹<br>rm -fr xxxx æ²¡æœ‰/ è¿™ä¸ªæ˜¯åˆ é™¤è½¯é“¾æ¥</p></blockquote><h1 id="catå‘½ä»¤"><a href="#catå‘½ä»¤" class="headerlink" title="catå‘½ä»¤"></a>catå‘½ä»¤</h1><p>è¯¥å‘½ä»¤ç”¨äºæŸ¥çœ‹æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼Œåæ¥è¦æŸ¥çœ‹çš„æ–‡ä»¶åï¼Œé€šå¸¸å¯ç”¨ç®¡é“ä¸moreå’Œlessä¸€èµ·ä½¿ç”¨ï¼Œä»è€Œå¯ä»¥ä¸€é¡µé¡µåœ°æŸ¥çœ‹æ•°æ®ã€‚ä¾‹å¦‚ï¼š</p><p><code>cat text | less</code>  æŸ¥çœ‹textæ–‡ä»¶ä¸­çš„å†…å®¹<br>æ³¨ï¼šè¿™æ¡å‘½ä»¤ä¹Ÿå¯ä»¥ä½¿ç”¨less textæ¥ä»£æ›¿  </p><h1 id="chgrpå‘½ä»¤"><a href="#chgrpå‘½ä»¤" class="headerlink" title="chgrpå‘½ä»¤"></a>chgrpå‘½ä»¤</h1><p>è¯¥å‘½ä»¤ç”¨äºæ”¹å˜æ–‡ä»¶æ‰€å±ç”¨æˆ·ç»„ï¼Œå®ƒçš„ä½¿ç”¨éå¸¸ç®€å•ï¼Œå®ƒçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p><p><code>chgrp [é€‰é¡¹] [ç»„] [æ–‡ä»¶]</code></p><ul><li><code>-R</code>ï¼šå¤„ç†æŒ‡å®šç›®å½•ä»¥åŠå…¶å­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</li><li><code>-v</code>ï¼šè¿è¡Œæ—¶æ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†ä¿¡æ¯</li><li><code>--dereference</code>ï¼šä½œç”¨äºç¬¦å·é“¾æ¥çš„æŒ‡å‘ï¼Œè€Œä¸æ˜¯ç¬¦å·é“¾æ¥æœ¬èº«</li><li><code>--no-dereference</code>ï¼šä½œç”¨äºç¬¦å·é“¾æ¥æœ¬èº«</li></ul><p>ä¾‹å¦‚ï¼š<br><code>chgrp -vR users ./dir</code> é€’å½’åœ°æŠŠdirç›®å½•ä¸‹ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ç”¨æˆ·ç»„ä¿®æ”¹ä¸ºusers  </p><h1 id="chownå‘½ä»¤"><a href="#chownå‘½ä»¤" class="headerlink" title="chownå‘½ä»¤"></a>chownå‘½ä»¤</h1><p>è¯¥å‘½ä»¤ç”¨äºæ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œä¸chgrpå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ç›¸åŒï¼Œåªæ˜¯ä¿®æ”¹çš„æ–‡ä»¶å±æ€§ä¸åŒã€‚</p><h1 id="chmodå‘½ä»¤"><a href="#chmodå‘½ä»¤" class="headerlink" title="chmodå‘½ä»¤"></a>chmodå‘½ä»¤</h1><p>è¯¥å‘½ä»¤ç”¨äºæ”¹å˜æ–‡ä»¶çš„æƒé™ï¼Œä¸€èˆ¬çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><p><code>chmod [-R] xyz æ–‡ä»¶æˆ–ç›®å½•</code><br>-Rï¼šè¿›è¡Œé€’å½’çš„æŒç»­æ›´æ”¹ï¼Œå³è¿åŒå­ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šæ›´æ”¹<br>åŒæ—¶ï¼Œchmodè¿˜å¯ä»¥ä½¿ç”¨uï¼ˆuserï¼‰ã€gï¼ˆgroupï¼‰ã€oï¼ˆotherï¼‰ã€aï¼ˆallï¼‰å’Œ+ï¼ˆåŠ å…¥ï¼‰ã€-ï¼ˆåˆ é™¤ï¼‰ã€=ï¼ˆè®¾ç½®ï¼‰è·Ÿrwxæ­é…æ¥å¯¹æ–‡ä»¶çš„æƒé™è¿›è¡Œæ›´æ”¹ã€‚</p><p>ä¾‹å¦‚ï¼š<br><code>chmod 755 file</code>  æŠŠfileçš„æ–‡ä»¶æƒé™æ”¹å˜ä¸º-rxwr-xr-xï¼Œrè¡¨ç¤ºè¯»ã€wè¡¨ç¤ºå†™ã€xè¡¨ç¤ºå¯æ‰§è¡Œã€‚<br><code>chmod g+w file</code> å‘fileçš„æ–‡ä»¶æƒé™ä¸­åŠ å…¥ç”¨æˆ·ç»„å¯å†™æƒé™ã€‚<br><code>chmod +x file</code> è®©æ–‡ä»¶å¯æ‰§è¡Œã€‚</p><p>æƒé™ä»£å·ï¼š</p><ul><li>rï¼šè¯»æƒé™ï¼Œç”¨æ•°å­—4è¡¨ç¤º</li><li>wï¼šå†™æƒé™ï¼Œç”¨æ•°å­—2è¡¨ç¤º</li><li>xï¼šæ‰§è¡Œæƒé™ï¼Œç”¨æ•°å­—1è¡¨ç¤º</li></ul><h1 id="å…³äºæœç´¢çš„å‘½ä»¤"><a href="#å…³äºæœç´¢çš„å‘½ä»¤" class="headerlink" title="å…³äºæœç´¢çš„å‘½ä»¤"></a>å…³äºæœç´¢çš„å‘½ä»¤</h1><h2 id="1-find"><a href="#1-find" class="headerlink" title="1 find"></a>1 find</h2><ol><li>findæ˜¯æœ€å¸¸è§å’Œæœ€å¼ºå¤§çš„æŸ¥æ‰¾å‘½ä»¤ï¼Œä½ å¯ä»¥ç”¨å®ƒæ‰¾åˆ°ä»»ä½•ä½ æƒ³æ‰¾çš„æ–‡ä»¶ã€‚ï¼ˆé¿å…å¤§èŒƒå›´çš„æœç´¢ï¼Œä¼šéå¸¸æµªè´¹ç³»ç»Ÿèµ„æºï¼Œå»ºè®®ä¸åœ¨ç›´æ¥åœ¨â€/â€œç›®å½•ä¸‹æœç´¢ï¼‰</li><li>æ ¼å¼ï¼šfind [æœç´¢èŒƒå›´] [æœç´¢æ¡ä»¶]</li><li><p>ä¾‹ï¼š</p><ul><li>find /home -name æ–‡ä»¶å</li><li>find /home -iname æ–‡ä»¶å (ä¸åŒºåˆ†å¤§å°å†™)</li><li>find /home -user æ–‡ä»¶å (æ‰€æœ‰è€…æ–‡ä»¶)</li><li>find /home -nouser æ–‡ä»¶å(æ²¡æœ‰æ‰€å±è€…çš„æ–‡ä»¶ï¼Œliunxä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰æ‰€å±è€…ï¼Œå¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆä¸€èˆ¬éƒ½æ˜¯åƒåœ¾æ–‡ä»¶ï¼Œä½†è¿˜æ˜¯æœ‰ç‰¹ä¾‹çš„ï¼Œæ¯”å¦‚å†…æ ¸äº§ç”Ÿçš„æ–‡ä»¶ï¼Œå°±æ²¡æœ‰æ‰€å±è€…ï¼Œä¸€èˆ¬åœ¨procå’Œsysç›®å½•ä¸‹ï¼›è¿˜æœ‰å¤–æ¥æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯Uç›˜æ‹·å…¥çš„æ–‡ä»¶ä¹Ÿä¼šå¿½ç•¥æ‰€æœ‰è€…ã€‚)</li><li>find . -type f -mmin -10 æœç´¢å½“å‰ç›®å½•ä¸­ï¼Œæ‰€æœ‰è¿‡å»10åˆ†é’Ÿä¸­æ›´æ–°è¿‡çš„æ™®é€šæ–‡ä»¶ã€‚å¦‚æœä¸åŠ -type få‚æ•°ï¼Œåˆ™æœç´¢æ™®é€šæ–‡ä»¶+ç‰¹æ®Šæ–‡ä»¶+ç›®å½•ã€‚</li><li>find ç›®å½• -size æ–‡ä»¶å¤§å° (æ³¨æ„ï¼šæ–‡ä»¶å¤§å°ç”¨å°å†™kå’Œå¤§å†™Mã€‚)</li></ul></li></ol><p><strong>å¦‚æœä»€ä¹ˆå‚æ•°ä¹Ÿä¸åŠ ï¼Œfindé»˜è®¤æœç´¢å½“å‰ç›®å½•åŠå…¶å­ç›®å½•ï¼Œå¹¶ä¸”ä¸è¿‡æ»¤ä»»ä½•ç»“æœï¼ˆä¹Ÿå°±æ˜¯è¿”å›æ‰€æœ‰æ–‡ä»¶ï¼‰ï¼Œå°†å®ƒä»¬å…¨éƒ½æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</strong></p><h2 id="2-locate"><a href="#2-locate" class="headerlink" title="2 locate"></a>2 locate</h2><p>locateå‘½ä»¤å…¶å®æ˜¯â€find -nameâ€çš„å¦ä¸€ç§å†™æ³•ï¼Œä½†æ˜¯è¦æ¯”åè€…å¿«å¾—å¤šï¼ŒåŸå› åœ¨äºå®ƒä¸æœç´¢å…·ä½“ç›®å½•ï¼Œè€Œæ˜¯æœç´¢ä¸€ä¸ªæ•°æ®åº“ï¼ˆ/var/lib/locatedbï¼‰ï¼Œè¿™ä¸ªæ•°æ®åº“ä¸­å«æœ‰æœ¬åœ°æ‰€æœ‰æ–‡ä»¶ä¿¡æ¯ã€‚Linuxç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºè¿™ä¸ªæ•°æ®åº“ï¼Œå¹¶ä¸”æ¯å¤©è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ï¼Œæ‰€ä»¥ä½¿ç”¨locateå‘½ä»¤æŸ¥ä¸åˆ°æœ€æ–°å˜åŠ¨è¿‡çš„æ–‡ä»¶ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œå¯ä»¥åœ¨ä½¿ç”¨locateä¹‹å‰ï¼Œå…ˆä½¿ç”¨<strong>updatedb</strong>å‘½ä»¤ï¼Œæ‰‹åŠ¨æ›´æ–°æ•°æ®åº“ã€‚ locateå‘½ä»¤çš„ä½¿ç”¨å®ä¾‹ï¼š</p><ul><li><code>locate /etc/sh</code>,æœç´¢etcç›®å½•ä¸‹æ‰€æœ‰ä»¥shå¼€å¤´çš„æ–‡ä»¶ã€‚</li><li><code>locate ~/m</code>,æœç´¢ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œæ‰€æœ‰ä»¥må¼€å¤´çš„æ–‡ä»¶ã€‚</li><li><code>locate -i ~/m</code>,æœç´¢ç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œæ‰€æœ‰ä»¥må¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶ä¸”å¿½ç•¥å¤§å°å†™ã€‚</li></ul><h2 id="3-whereis"><a href="#3-whereis" class="headerlink" title="3 whereis"></a>3 whereis</h2><p>whereiså‘½ä»¤åªèƒ½ç”¨äº<strong>ç¨‹åºå</strong>çš„æœç´¢ï¼Œè€Œä¸”åªæœç´¢äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå‚æ•°-bï¼‰ã€manè¯´æ˜æ–‡ä»¶ï¼ˆå‚æ•°-mï¼‰å’Œæºä»£ç æ–‡ä»¶ï¼ˆå‚æ•°-sï¼‰ã€‚å¦‚æœçœç•¥å‚æ•°ï¼Œåˆ™è¿”å›æ‰€æœ‰ä¿¡æ¯ã€‚ whereiså‘½ä»¤çš„ä½¿ç”¨å®ä¾‹ï¼š <code>whereis grep</code></p><h2 id="4-which"><a href="#4-which" class="headerlink" title="4 which"></a>4 which</h2><p>whichå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼Œ<strong>åœ¨PATHå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­</strong>ï¼Œæœç´¢æŸä¸ªç³»ç»Ÿå‘½ä»¤çš„ä½ç½®ï¼Œå¹¶ä¸”è¿”å›ç¬¬ä¸€ä¸ªæœç´¢ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨whichå‘½ä»¤ï¼Œå°±å¯ä»¥çœ‹åˆ°æŸä¸ªç³»ç»Ÿå‘½ä»¤æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠæ‰§è¡Œçš„åˆ°åº•æ˜¯å“ªä¸€ä¸ªä½ç½®çš„å‘½ä»¤ã€‚ whichå‘½ä»¤çš„ä½¿ç”¨å®ä¾‹ï¼š <code>which grep</code></p><h1 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h1><p>æœç´¢æ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œä¸€èˆ¬ä¸ºå­—ç¬¦ä¸²ï¼Œä¸æ­£åˆ™è¡¨è¾¾å¼ç»“åˆä½¿ç”¨ grep [é€‰é¡¹] å­—ç¬¦ä¸² æ–‡ä»¶å ï¼ˆå­—ç¬¦ä¸²ä½¿ç”¨ â€œâ€ åŒ…å›´ï¼Œç»“æœä¸ºè¡Œè®°å½•ï¼‰ -i å¿½ç•¥å¤§å°å†™ -v æ’é™¤æŒ‡å®šå­—ç¬¦ä¸²</p><p><strong>findä¸grepçš„åŒºåˆ«</strong>ï¼š</p><ul><li>findï¼šåœ¨ ç³»ç»Ÿ ä¸­æœç´¢ç¬¦åˆæ¡ä»¶çš„ æ–‡ä»¶åï¼Œä½¿ç”¨ é€šé…ç¬¦ï¼ˆå®Œå…¨ï¼‰åŒ¹é…</li><li>grepï¼šåœ¨ æ–‡ä»¶ å½“ä¸­æœç´¢ç¬¦åˆæ¡ä»¶çš„ å­—ç¬¦ä¸²ï¼Œä½¿ç”¨ æ­£åˆ™è¡¨è¾¾å¼ ï¼ˆåŒ…å«ï¼‰åŒ¹é…</li></ul><h1 id="time"><a href="#time" class="headerlink" title="time"></a>time</h1><p>time å¯ä»¥ç»Ÿè®¡å‘½ä»¤æ‰§è¡Œçš„æ—¶é—´ï¼ŒåŒ…æ‹¬ç¨‹åºçš„å®é™…è¿è¡Œæ—¶é—´(real time)ï¼Œä»¥åŠç¨‹åºè¿è¡Œåœ¨ç”¨æˆ·æ€çš„æ—¶é—´(user time)å’Œå†…æ ¸æ€çš„æ—¶é—´(sys time)ã€‚<br>ä¾‹å¦‚ï¼š<code>time git pull</code> åˆ™æ˜¯ç»Ÿè®¡æ›´æ–°ä»£ç èŠ±è´¹å¤šé•¿æ—¶é—´</p><h1 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h1><p>aliaså‘½ä»¤ç”¨æ¥è®¾ç½®æŒ‡ä»¤çš„åˆ«åã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤å¯ä»¥å°†ä¸€äº›è¾ƒé•¿çš„å‘½ä»¤è¿›è¡Œç®€åŒ–ã€‚ä½¿ç”¨aliasæ—¶ï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨å•å¼•å·â€™â€™å°†åŸæ¥çš„å‘½ä»¤å¼•èµ·æ¥ï¼Œé˜²æ­¢ç‰¹æ®Šå­—ç¬¦å¯¼è‡´é”™è¯¯ã€‚</p><p>aliaså‘½ä»¤çš„ä½œç”¨åªå±€é™äºè¯¥æ¬¡ç™»å…¥çš„æ“ä½œã€‚è‹¥è¦æ¯æ¬¡ç™»å…¥éƒ½èƒ½å¤Ÿä½¿ç”¨è¿™äº›å‘½ä»¤åˆ«åï¼Œåˆ™å¯å°†ç›¸åº”çš„aliaså‘½ä»¤å­˜æ”¾åˆ°bashçš„åˆå§‹åŒ–æ–‡ä»¶<code>/etc/bashrc</code>ä¸­ã€‚</p><p>alias çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•ä¸ºï¼š<code>alias æ–°çš„å‘½ä»¤=&#39;åŸå‘½ä»¤ -é€‰é¡¹/å‚æ•°&#39;</code><br>ä¾‹å¦‚ï¼š<code>alias l=â€˜ls -lsh&#39;</code>å°†é‡æ–°å®šä¹‰lså‘½ä»¤ï¼Œç°åœ¨åªéœ€è¾“å…¥lå°±å¯ä»¥åˆ—ç›®å½•äº†ã€‚ç›´æ¥è¾“å…¥ alias å‘½ä»¤ä¼šåˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®šä¹‰çš„å‘½ä»¤åˆ«åã€‚</p><p>è¦åˆ é™¤ä¸€ä¸ªåˆ«åï¼Œå¯ä»¥ä½¿ç”¨ unalias å‘½ä»¤ï¼Œå¦‚ unalias lã€‚</p><p><strong>æŸ¥çœ‹ç³»ç»Ÿå·²ç»è®¾ç½®çš„åˆ«åï¼š</strong></p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">alias egrep='egrep --color'</span><br><span class="line">alias fgrep='fgrep --color'</span><br><span class="line">alias grep='grep --color'</span><br><span class="line">alias hpush='bash /Users/liwenhao/Desktop/github/hpush.sh'</span><br><span class="line">alias ll='ls -l'</span><br><span class="line">alias ls='ls -F --show-control-chars --color=auto'</span><br><span class="line">alias vi='vim'</span><br></pre></td></tr></table></figure><h1 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h1><p><code>tail</code> å‘½ä»¤ä»æŒ‡å®šç‚¹å¼€å§‹å°†æ–‡ä»¶å†™åˆ°æ ‡å‡†è¾“å‡ºã€‚ä½¿ç”¨tailå‘½ä»¤çš„-fé€‰é¡¹å¯ä»¥æ–¹ä¾¿çš„æŸ¥é˜…æ­£åœ¨æ”¹å˜çš„æ—¥å¿—æ–‡ä»¶ï¼Œ<code>tail -f filename</code>ä¼šæŠŠfilenameé‡Œæœ€å°¾éƒ¨çš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œå¹¶ä¸”ä¸ä½†åˆ·æ–°ï¼Œä½¿ä½ çœ‹åˆ°æœ€æ–°çš„æ–‡ä»¶å†…å®¹.</p><ol><li><p>å‘½ä»¤æ ¼å¼;</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">tail[å¿…è¦å‚æ•°][é€‰æ‹©å‚æ•°][æ–‡ä»¶]</span><br></pre></td></tr></table></figure></li><li><p>å‘½ä»¤åŠŸèƒ½ï¼šç”¨äºæ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶æœ«å°¾å†…å®¹ï¼Œä¸æŒ‡å®šæ–‡ä»¶æ—¶ï¼Œä½œä¸ºè¾“å…¥ä¿¡æ¯è¿›è¡Œå¤„ç†ã€‚å¸¸ç”¨æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ã€‚</p></li><li><p>å‘½ä»¤å‚æ•°ï¼š</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-f å¾ªç¯è¯»å–</span><br><span class="line">-q ä¸æ˜¾ç¤ºå¤„ç†ä¿¡æ¯</span><br><span class="line">-v æ˜¾ç¤ºè¯¦ç»†çš„å¤„ç†ä¿¡æ¯</span><br><span class="line">-c &lt;æ•°ç›®&gt; æ˜¾ç¤ºçš„å­—èŠ‚æ•°</span><br><span class="line">-n &lt;è¡Œæ•°&gt; æ˜¾ç¤ºè¡Œæ•°</span><br><span class="line">--pid=PID ä¸-fåˆç”¨,è¡¨ç¤ºåœ¨è¿›ç¨‹ID,PIDæ­»æ‰ä¹‹åç»“æŸ.</span><br><span class="line">-q, --quiet, --silent ä»ä¸è¾“å‡ºç»™å‡ºæ–‡ä»¶åçš„é¦–éƒ¨</span><br><span class="line">-s, --sleep-interval=S ä¸-fåˆç”¨,è¡¨ç¤ºåœ¨æ¯æ¬¡åå¤çš„é—´éš”ä¼‘çœ Sç§’</span><br></pre></td></tr></table></figure></li><li><p>ä¸¾ä¾‹</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># å†™åˆ°1.logï¼Œä¸”åå°è¿è¡Œ</span><br><span class="line">ping www.baidu.com &gt; 1.log 2&gt;&amp;1 &amp;</span><br><span class="line"># å¾ªç¯æŸ¥çœ‹å°¾éƒ¨æ—¥å¿—</span><br><span class="line">tail -f 1.log</span><br><span class="line"># æ€æ­» pingè¿›ç¨‹</span><br><span class="line">killall ping</span><br></pre></td></tr></table></figure></li></ol><h1 id="æ‰§è¡Œå¤šä¸ªå‘½ä»¤"><a href="#æ‰§è¡Œå¤šä¸ªå‘½ä»¤" class="headerlink" title="æ‰§è¡Œå¤šä¸ªå‘½ä»¤"></a>æ‰§è¡Œå¤šä¸ªå‘½ä»¤</h1><ul><li>åä¸€ä¸ªå‘½ä»¤ä¾èµ–äºå‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºï¼Œå¯ä»¥æ˜¯ç”¨ç®¡é“(|)<br><code>ls | wc -l</code> :å½“å‰ç›®å½•æ–‡ä»¶ä¸ªæ•°</li><li>åä¸€ä¸ªå‘½ä»¤å¿…é¡»ç­‰å‰ä¸€ä¸ªå‘½ä»¤è¿è¡ŒæˆåŠŸååœ¨è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨åŒä¸å·(&amp;&amp;)<br><code>aa &amp;&amp; ls</code> ï¼šåªè¿è¡Œaaï¼Œlsä¸è¿è¡Œ</li><li>åä¸€ä¸ªå‘½ä»¤å¿…é¡»ç­‰å‰ä¸€ä¸ªå‘½ä»¤è¿è¡Œå®Œï¼Œä¸å…³å¿ƒæ˜¯å¦æˆåŠŸï¼Œä½¿ç”¨å•ä¸å·(&amp;)<br><code>aa &amp; ls</code> ï¼šaaå’Œlséƒ½è¿è¡Œï¼Œä½†æ˜¯lså¿…é¡»ç­‰aaè¿è¡Œå®Œã€‚</li><li>å¹¶è¡Œæ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œä½¿ç”¨ä¸¤ä¸ªç«–å·(||)<br><code>aa || ls</code>ï¼šaaå’Œlså¹¶è¡Œæ‰§è¡Œï¼Œäº’ä¸å½±å“ã€‚</li></ul><h1 id="æ‰§è¡Œshellè„šæœ¬"><a href="#æ‰§è¡Œshellè„šæœ¬" class="headerlink" title="æ‰§è¡Œshellè„šæœ¬"></a>æ‰§è¡Œshellè„šæœ¬</h1><p>å½“æˆ‘ä»¬å†™å®Œä¸€ä¸ªè„šæœ¬çš„æ—¶å€™ï¼Œå®ƒæ˜¯ä¸å¯ä»¥è¢«ç›´æ¥è¿è¡Œçš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ï¼š</p><ol><li>é€šè¿‡Bashè°ƒç”¨æ‰§è¡Œè„šæœ¬ ï¼š<code>bash hello.sh</code></li><li>é¦–å…ˆèµ‹äºˆæ‰§è¡Œæƒé™ï¼š<code>chmod 755 hello.sh</code>ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„ <code>./hello.sh</code> æˆ–è€…é€šè¿‡ç»å¯¹è·¯å¾„ <code>/root/hello.sh</code>æ¥æ‰§è¡Œã€‚</li></ol><h2 id="Shellç‰¹æ®Šå˜é‡ï¼š-0-å’Œå‘½ä»¤è¡Œå‚æ•°"><a href="#Shellç‰¹æ®Šå˜é‡ï¼š-0-å’Œå‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="Shellç‰¹æ®Šå˜é‡ï¼š$0, $#, $*, $@, $?, $$å’Œå‘½ä»¤è¡Œå‚æ•°"></a>Shellç‰¹æ®Šå˜é‡ï¼š<code>$0</code>, <code>$#</code>, <code>$*</code>, <code>$@</code>, <code>$?</code>, <code>$$</code>å’Œå‘½ä»¤è¡Œå‚æ•°</h2><p>å˜é‡ååªèƒ½åŒ…å«æ•°å­—ã€å­—æ¯å’Œä¸‹åˆ’çº¿ï¼Œå› ä¸ºæŸäº›åŒ…å«å…¶ä»–å­—ç¬¦çš„å˜é‡æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œè¿™æ ·çš„å˜é‡è¢«ç§°ä¸ºç‰¹æ®Šå˜é‡ã€‚</p><p>ä¾‹å¦‚ï¼Œ<code>$$</code> è¡¨ç¤ºå½“å‰Shellè¿›ç¨‹çš„IDï¼Œå³pidï¼Œçœ‹ä¸‹é¢çš„ä»£ç ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">$</span>echo $$</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œç»“æœ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">29949</span><br></pre></td></tr></table></figure></p><p><strong>ç‰¹æ®Šå˜é‡åˆ—è¡¨</strong>ï¼š</p><table><thead><tr><th style="text-align:center">å˜é‡</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center"><code>$0</code></td><td>å½“å‰è„šæœ¬çš„æ–‡ä»¶å</td></tr><tr><td style="text-align:center"><code>$n</code></td><td>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ã€‚n æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå‚æ•°ã€‚</td></tr><tr><td style="text-align:center"><code>$#</code></td><td>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ä¸ªæ•°ã€‚</td></tr><tr><td style="text-align:center"><code>$*</code></td><td>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚</td></tr><tr><td style="text-align:center"><code>$@</code></td><td>ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚è¢«åŒå¼•å·(â€œ â€œ)åŒ…å«æ—¶ï¼Œä¸ $* ç¨æœ‰ä¸åŒï¼Œä¸‹é¢å°†ä¼šè®²åˆ°ã€‚</td></tr><tr><td style="text-align:center"><code>$?</code></td><td>ä¸Šä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ï¼Œæˆ–å‡½æ•°çš„è¿”å›å€¼ã€‚</td></tr><tr><td style="text-align:center"><code>$$</code></td><td>å½“å‰Shellè¿›ç¨‹IDã€‚å¯¹äº Shell è„šæœ¬ï¼Œå°±æ˜¯è¿™äº›è„šæœ¬æ‰€åœ¨çš„è¿›ç¨‹IDã€‚</td></tr></tbody></table><h2 id="å‘½ä»¤è¡Œå‚æ•°"><a href="#å‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°"></a>å‘½ä»¤è¡Œå‚æ•°</h2><p>è¿è¡Œè„šæœ¬æ—¶ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°ç§°ä¸ºå‘½ä»¤è¡Œå‚æ•°ã€‚å‘½ä»¤è¡Œå‚æ•°ç”¨ <code>$n</code> è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼Œ<code>$1</code> è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œ<code>$2</code> è¡¨ç¤ºç¬¬äºŒä¸ªå‚æ•°ï¼Œä¾æ¬¡ç±»æ¨ã€‚</p><p>è¯·çœ‹ä¸‹é¢çš„è„šæœ¬ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">echo "File Name: $0"</span><br><span class="line">echo "First Parameter : $1"</span><br><span class="line">echo "First Parameter : $2"</span><br><span class="line">echo "Quoted Values: $@"</span><br><span class="line">echo "Quoted Values: $*"</span><br><span class="line">echo "Total Number of Parameters : $#"</span><br></pre></td></tr></table></figure></p><p>è¿è¡Œç»“æœï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$./test.sh Zara Ali</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">File Name : ./test.sh</span><br><span class="line">First Parameter : Zara</span><br><span class="line">Second Parameter : Ali</span><br><span class="line">Quoted Values: Zara Ali</span><br><span class="line">Quoted Values: Zara Ali</span><br><span class="line">Total Number of Parameters : 2</span><br></pre></td></tr></table></figure><h2 id="å’Œ-çš„åŒºåˆ«"><a href="#å’Œ-çš„åŒºåˆ«" class="headerlink" title="$* å’Œ $@ çš„åŒºåˆ«"></a><code>$*</code> å’Œ <code>$@</code> çš„åŒºåˆ«</h2><p><code>$*</code>å’Œ <code>$@</code> éƒ½è¡¨ç¤ºä¼ é€’ç»™å‡½æ•°æˆ–è„šæœ¬çš„æ‰€æœ‰å‚æ•°ï¼Œä¸è¢«åŒå¼•å·(â€œ â€œ)åŒ…å«æ—¶ï¼Œéƒ½ä»¥<code>&quot;$1&quot;</code> <code>&quot;$2&quot;</code> â€¦ <code>&quot;$n&quot;</code> çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</p><p>ä½†æ˜¯å½“å®ƒä»¬è¢«åŒå¼•å·(â€œ â€œ)åŒ…å«æ—¶ï¼Œ<code>&quot;$*&quot;</code> ä¼šå°†æ‰€æœ‰çš„å‚æ•°ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œä»¥â€<code>$1</code> <code>$2</code> â€¦ <code>$n</code>â€œçš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ï¼›<code>&quot;$@&quot;</code> ä¼šå°†å„ä¸ªå‚æ•°åˆ†å¼€ï¼Œä»¥<code>&quot;$1&quot;</code> <code>&quot;$2&quot;</code> â€¦ <code>&quot;$n&quot;</code> çš„å½¢å¼è¾“å‡ºæ‰€æœ‰å‚æ•°ã€‚</p><p>ä¸‹é¢çš„ä¾‹å­å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ° <code>$*</code> å’Œ <code>$@</code>çš„åŒºåˆ«ï¼š<br><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span>!/bin/bash</span><br><span class="line">echo "\$*=" $*</span><br><span class="line">echo "\"\$*\"=" "$*"</span><br><span class="line">echo "\$@=" $@</span><br><span class="line">echo "\"\$@\"=" "$@"</span><br><span class="line">echo "print each param from \$*"</span><br><span class="line">for var in $*</span><br><span class="line">do</span><br><span class="line">    echo "$var"</span><br><span class="line">done</span><br><span class="line">echo "print each param from \$@"</span><br><span class="line">for var in $@</span><br><span class="line">do</span><br><span class="line">    echo "$var"</span><br><span class="line">done</span><br><span class="line">echo "print each param from \"\$*\""</span><br><span class="line">for var in "$*"</span><br><span class="line">do</span><br><span class="line">    echo "$var"</span><br><span class="line">done</span><br><span class="line">echo "print each param from \"\$@\""</span><br><span class="line">for var in "$@"</span><br><span class="line">do</span><br><span class="line">    echo "$var"</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p><p>æ‰§è¡Œ ./test.sh â€œaâ€ â€œbâ€ â€œcâ€ â€œdâ€ï¼Œçœ‹åˆ°ä¸‹é¢çš„ç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$*=  a b c d</span><br><span class="line">&quot;$*&quot;= a b c d</span><br><span class="line">$@=  a b c d</span><br><span class="line">&quot;$@&quot;= a b c d</span><br><span class="line">print each param from $*</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">print each param from $@</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">print each param from &quot;$*&quot;</span><br><span class="line">a b c d</span><br><span class="line">print each param from &quot;$@&quot;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br></pre></td></tr></table></figure></p><h2 id="é€€å‡ºçŠ¶æ€"><a href="#é€€å‡ºçŠ¶æ€" class="headerlink" title="é€€å‡ºçŠ¶æ€"></a>é€€å‡ºçŠ¶æ€</h2><p><code>$?</code> å¯ä»¥è·å–ä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚æ‰€è°“é€€å‡ºçŠ¶æ€ï¼Œå°±æ˜¯ä¸Šä¸€ä¸ªå‘½ä»¤æ‰§è¡Œåçš„è¿”å›ç»“æœã€‚</p><p>é€€å‡ºçŠ¶æ€æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤§éƒ¨åˆ†å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¼šè¿”å› 0ï¼Œå¤±è´¥è¿”å› 1ã€‚</p><p>ä¸è¿‡ï¼Œä¹Ÿæœ‰ä¸€äº›å‘½ä»¤è¿”å›å…¶ä»–å€¼ï¼Œè¡¨ç¤ºä¸åŒç±»å‹çš„é”™è¯¯ã€‚</p><p>ä¸‹é¢ä¾‹å­ä¸­ï¼Œå‘½ä»¤<code>$./test.sh Zara Ali</code>æˆåŠŸæ‰§è¡Œè¾“å‡ºï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">File Name : ./test.sh</span><br><span class="line">First Parameter : Zara</span><br><span class="line">Second Parameter : Ali</span><br><span class="line">Quoted Values: Zara Ali</span><br><span class="line">Quoted Values: Zara Ali</span><br><span class="line">Total Number of Parameters : 2</span><br><span class="line">$echo $?</span><br><span class="line">0</span><br><span class="line">$</span><br></pre></td></tr></table></figure></p><p><strong><code>$?</code> ä¹Ÿå¯ä»¥è¡¨ç¤ºå‡½æ•°çš„è¿”å›å€¼</strong>ã€‚</p><h1 id="PATHç¯å¢ƒå˜é‡"><a href="#PATHç¯å¢ƒå˜é‡" class="headerlink" title="PATHç¯å¢ƒå˜é‡"></a>PATHç¯å¢ƒå˜é‡</h1><p>ä¸‹é¢çš„ç¬¬ä¸€ç§æ–¹å¼å…³æœºåä¼šå¤±æ•ˆï¼Œç›¸å½“äºä¸´æ—¶ç¯å¢ƒå˜é‡ï¼Œåé¢ä¸¤ç§éƒ½æ˜¯å†™è¿›äº†ç³»ç»Ÿé…ç½®ï¼Œå› æ­¤ä¼šæ°¸ä¹…ç”Ÿæ•ˆã€‚</p><ol><li>ç›´æ¥ç”¨exportå‘½ä»¤ <code>export PATH=$PATH:/usr/local/src/node-v0.10.24/node_modules/node-sass/bin</code></li><li><p>ä¿®æ”¹profileæ–‡ä»¶ï¼š</p><ul><li><code>vi /etc/profile</code></li><li>ç„¶ååœ¨æ–‡ä»¶é‡Œé¢åŠ å…¥<code>export PATH=$PATH:/usr/local/src/node-v0.10.24/node_modules/node-sass/bin</code></li><li>æ‰§è¡Œå‘½ä»¤ <code>source /etc/profile</code> ç”Ÿæ•ˆ</li></ul></li><li><p>ä¿®æ”¹.bashrcæ–‡ä»¶</p><ul><li><code>vi /root/.bashrc</code></li><li>åœ¨é‡Œé¢åŠ å…¥ <code>export PATH=$PATH:/usr/local/src/node-v0.10.24/node_modules/node-sass/bin</code></li><li>æ‰§è¡Œå‘½ä»¤<code>source /root/.bashrc</code> ç”Ÿæ•ˆ</li></ul></li></ol><p>å¦‚æœä¿®æ”¹äº†<code>/etc/profile</code>ï¼Œé‚£ä¹ˆç¼–è¾‘ç»“æŸåæ‰§è¡Œ<code>source profile</code>(<code>source /etc/profile</code>) æˆ– æ‰§è¡Œç‚¹å‘½ä»¤ <code>. ./profile</code>ï¼ŒPATHçš„å€¼æ‰ä¼šç«‹å³ç”Ÿæ•ˆï¼Œä¸ç„¶å°±åªæœ‰ç­‰ä¸‹ä¸€æ¬¡å¼€æœºã€‚</p><p>è¿™ä¸ªæ–¹æ³•çš„åŸç†å°±æ˜¯å†æ‰§è¡Œä¸€æ¬¡/etc/profile shellè„šæœ¬ï¼Œæ³¨æ„å¦‚æœç”¨sh /etc/profileæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºshæ˜¯åœ¨å­shellè¿›ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œå³ä½¿PATHæ”¹å˜äº†ä¹Ÿä¸ä¼šååº”åˆ°å½“å‰ç¯å¢ƒä¸­ï¼Œä½†æ˜¯sourceæ˜¯åœ¨å½“å‰ shellè¿›ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½çœ‹åˆ°PATHçš„æ”¹å˜ã€‚</p><p>æœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¸å°å¿ƒå°†PATHç¯å¢ƒå˜é‡è®¾ç½®é”™è¯¯å¯¼è‡´å‘½ä»¤å¤±æ•ˆï¼Œå¯ä»¥å‚è€ƒä¸‹é¢ä¸¤ç§æ–¹å¼è§£å†³ã€‚</p><ol><li>å¦‚æœæ˜¯é€šè¿‡å‘½ä»¤è¡Œè®¾ç½®çš„ï¼Œå¯ä»¥é€šè¿‡é‡å¯æˆ–è€…ç¦»å¼€æœ¬æ¬¡ç™»å½•(é€€å‡ºæœ¬æ¬¡shell)</li><li>å¦‚æœæ˜¯å› ä¸ºä¿®æ”¹é…ç½®æ–‡ä»¶å¯¼è‡´æ— æ³•ä½¿ç”¨ï¼Œå¯ä»¥æ‰§è¡Œ<code>export PATH=/usr/bin:/usr/sbin:/bin:/sbin:/usr/X11R6/bin</code>å‘½ä»¤æš‚æ—¶ä½¿ç”¨è¿™äº›ç›®å½•ä¸‹çš„å‘½ä»¤ï¼Œå¦‚ <code>vi</code>,<code>ls</code>,<code>cd</code>ï¼Œä»æ–°ä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚</li></ol><h1 id="å‘½ä»¤è¡Œå¿«æ·é”®"><a href="#å‘½ä»¤è¡Œå¿«æ·é”®" class="headerlink" title="å‘½ä»¤è¡Œå¿«æ·é”®"></a>å‘½ä»¤è¡Œå¿«æ·é”®</h1><ol><li>å…‰æ ‡ç§»åŠ¨<ul><li><strong>Ctrl + f â€“ å‘å³ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ï¼Œå½“ç„¶å¤šæ•°äººç”¨â†’</strong></li><li><strong>Ctrl + b â€“ å‘å·¦ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ï¼Œ å¤šæ•°äººç”¨â†</strong></li><li>ESC + f â€“ å‘å³ç§»åŠ¨ä¸€ä¸ªå•è¯ï¼ŒMACä¸‹å»ºè®®ç”¨ALT + â†’</li><li>ESC + b â€“ å‘å·¦ç§»åŠ¨ä¸€ä¸ªå•è¯ï¼ŒMACä¸‹å»ºè®®ç”¨ALT + â†</li><li><strong>Ctrl + a â€“ è·³åˆ°è¡Œé¦–</strong></li><li><strong>Ctrl + e â€“ è·³åˆ°è¡Œå°¾</strong></li></ul></li><li>åˆ é™¤<ul><li>Ctrl + d â€“ å‘å³åˆ é™¤ä¸€ä¸ªå­—ç¬¦</li><li><strong>Ctrl + h â€“ å‘å·¦åˆ é™¤ä¸€ä¸ªå­—ç¬¦</strong></li><li><strong>Ctrl + u â€“ åˆ é™¤å½“å‰ä½ç½®å­—ç¬¦è‡³è¡Œé¦–ï¼ˆè¾“å…¥å¯†ç é”™è¯¯çš„æ—¶å€™å¤šç”¨ä¸‹è¿™ä¸ªï¼‰</strong></li><li>Ctrl + k â€“ åˆ é™¤å½“å‰ä½ç½®å­—ç¬¦è‡³è¡Œå°¾</li><li>Ctrl + w â€“ åˆ é™¤ä»å…‰æ ‡åˆ°å½“å‰å•è¯å¼€å¤´</li></ul></li><li>å‘½ä»¤åˆ‡æ¢<ul><li><strong>Ctrl + p â€“ ä¸Šä¸€ä¸ªå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ç”¨â†‘</strong></li><li><strong>Ctrl + n â€“ ä¸‹ä¸€ä¸ªå‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ç”¨â†“</strong></li></ul></li><li>å…¶ä»–å¿«æ·é”®<ul><li>Ctrl + y â€“ æ’å…¥æœ€è¿‘åˆ é™¤çš„å•è¯</li><li>Ctrl + c â€“ ç»ˆæ­¢æ“ä½œ</li><li>Ctrl + d â€“ å½“å‰æ“ä½œè½¬åˆ°åå°</li><li><strong>Ctrl + l â€“ æ¸…å± ï¼ˆæœ‰æ—¶å€™ä¸ºäº†å¥½çœ‹ï¼‰</strong></li><li>ctrl + z - æŠŠå‘½ä»¤æ”¾å…¥åå°ï¼Œè¿™ä¸ªå‘½ä»¤è°¨æ…ä½¿ç”¨</li><li><strong>ctrl + r - å†å²å‘½ä»¤æœç´¢</strong></li><li>Alt + f - å…‰æ ‡å‘å‰ï¼ˆForwardï¼‰ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯</li><li>Alt + b - å…‰æ ‡å¾€å›ï¼ˆBackwardï¼‰ç§»åŠ¨åˆ°å‰ä¸€ä¸ªå•è¯</li><li><strong>Ctrl + w - åˆ é™¤ä»å…‰æ ‡ä½ç½®å‰åˆ°å½“å‰æ‰€å¤„å•è¯ï¼ˆWordï¼‰çš„å¼€å¤´</strong></li><li>Alt + d - åˆ é™¤ä»å…‰æ ‡ä½ç½®åˆ°å½“å‰æ‰€å¤„å•è¯çš„æœ«å°¾</li><li>Ctrl + y - ç²˜è´´æœ€åä¸€æ¬¡è¢«åˆ é™¤çš„å•è¯</li></ul></li></ol><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.ruanyifeng.com/blog/2009/10/5_ways_to_search_for_files_using_the_terminal.html" target="_blank" rel="noopener">Linuxçš„äº”ä¸ªæŸ¥æ‰¾å‘½ä»¤</a></li><li><a href="https://blog.csdn.net/ljianhui/article/details/11100625" target="_blank" rel="noopener">åˆçª¥Linux ä¹‹ æˆ‘æœ€å¸¸ç”¨çš„20æ¡å‘½ä»¤</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Windowsã€LinuxåŠMacæŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹</title>
      <link href="/Windows-and-Linux-view-the-port-and-kill-the-process/"/>
      <url>/Windows-and-Linux-view-the-port-and-kill-the-process/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»å¦‚ä½•åœ¨Windowsã€LinuxåŠMacä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹ã€‚</p><a id="more"></a><h1 id="Windowsä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"><a href="#Windowsä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹" class="headerlink" title="Windowsä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"></a>Windowsä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹</h1><ol><li>æŸ¥çœ‹å ç”¨ç«¯å£å·çš„è¿›ç¨‹å·ï¼š<code>netstat â€“ano | findstr &quot;æŒ‡å®šç«¯å£å·&quot;</code></li><li>é€šè¿‡è¿›ç¨‹å·æ€æ­»è¿›ç¨‹ï¼š<code>taskkill /pid è¿›ç¨‹å·</code><ul><li>é€šè¿‡è¿›ç¨‹å·å¼ºåˆ¶æ€æ­»è¿›ç¨‹ï¼š<code>taskkill /f /pid è¿›ç¨‹å·</code></li></ul></li><li>é€šè¿‡è¿›ç¨‹å·æŸ¥çœ‹è¿›ç¨‹ <code>tasklist | findstr &quot;è¿›ç¨‹å·&quot;</code></li></ol><h1 id="Linuxä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"><a href="#Linuxä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹" class="headerlink" title="Linuxä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"></a>Linuxä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹</h1><ol><li>Linuxä¸‹æŸ¥çœ‹ç«¯å£å·æ‰€ä½¿ç”¨çš„è¿›ç¨‹å·ï¼š<code>netstat -anp|grep port</code></li><li><p>æ€æ­»è¿›ç¨‹</p><ul><li><code>kill -9 PID</code></li><li>Linuxä¸‹è¿˜æä¾›äº†ä¸€ä¸ªkillallå‘½ä»¤ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¿›ç¨‹çš„åå­—è€Œä¸æ˜¯è¿›ç¨‹æ ‡è¯†å·ï¼Œä¾‹å¦‚ï¼š <code>killall -9 name</code></li></ul></li><li><p>é€šè¿‡ç«¯å£å·æŸ¥çœ‹è¿›ç¨‹å·</p><ol><li>æŸ¥çœ‹ç¨‹åºå¯¹åº”è¿›ç¨‹å·ï¼š<code>ps -ef | grep è¿›ç¨‹å</code></li><li>æŸ¥çœ‹è¿›ç¨‹å·æ‰€å ç”¨çš„ç«¯å£å·<ul><li>REDHAT: <code>netstat -nltp|grep pid</code></li><li>ubuntu: <code>netstat -anp|grep pid</code></li></ul></li></ol></li></ol><h1 id="Macä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"><a href="#Macä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹" class="headerlink" title="Macä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹"></a>Macä¸‹æŸ¥çœ‹ç«¯å£å’Œæ€æ­»è¿›ç¨‹</h1><p>Macä¸‹ä½¿ç”¨lsofï¼ˆlist open filesï¼‰æ¥æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µï¼Œlsof æ˜¯ä¸€ä¸ªåˆ—å‡ºå½“å‰ç³»ç»Ÿæ‰“å¼€æ–‡ä»¶çš„å·¥å…·ã€‚</p><p>ä½¿ç”¨ <code>-i</code> æŸ¥çœ‹æŸä¸ªç«¯å£æ˜¯å¦è¢«å ç”¨ï¼Œå¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">lsof -i:3000</span><br></pre></td></tr></table></figure></p><p>å¦‚æœç«¯å£è¢«å ç”¨ï¼Œåˆ™ä¼šè¿”å›ç›¸å…³ä¿¡æ¯ï¼Œå¦‚æœæ²¡è¢«å ç”¨ï¼Œåˆ™ä¸è¿”å›ä»»ä½•ä¿¡æ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>æˆ‘è¯»ä¸œå¡</title>
      <link href="/%E8%AF%BB%E4%B9%A6/%E8%8B%8F%E4%B8%9C%E5%9D%A1%E4%BC%A0/"/>
      <url>/%E8%AF%BB%E4%B9%A6/%E8%8B%8F%E4%B8%9C%E5%9D%A1%E4%BC%A0/</url>
      
        <content type="html"><![CDATA[<p>æ¯å½“æˆ‘ä¸€æèµ·è‹ä¸œå¡æ¥ï¼Œå¤§å®¶æ€»ä¼šä¸è‡ªè§‰çš„å¾®ç¬‘ï¼Œè¿™å¥è¯æœ€èƒ½æ¦‚æ‹¬è‹ä¸œå¡çš„ä¸€åˆ‡ã€‚<br>æœ‰è¯—äº‘ï¼š<br>äººç”Ÿæ‰€å¤„åº”ä½•ä¼¼ï¼Œåº”æ˜¯é£é¸¿è¸é›ªæ³¥ã€‚<br>æ³¥ä¸Šå¶ç„¶ç•™æŒ‡çˆªï¼Œé¸¿é£å“ªå¤è®¡ä¸œè¥¿ã€‚</p><a id="more"></a><p>è‹ä¸œå¡çš„ä¸€ç”Ÿæ˜¯ä¸€ä¸ªä¹è§‚ä»æ”¿åˆ°ä¹è§‚ç”Ÿæ´»çš„è¿‡ç¨‹ï¼Œè‹ä¸œå¡ä»¥å…¶æ‹’ä¸å¦¥åçš„æ°”è´¨è€Œä¸ºå®˜åœºæ‰€ä¸å®¹ï¼Œæœ¬æ¥æœ‰æ²»ä¸–ä¹‹æ‰çš„è‹ä¸œå¡å…ˆå› ç‹å®‰çŸ³å˜æ³•è€Œæƒ¨é­æ’æŒ¤ï¼Œåå¾—åˆ°å¤ªçš‡å¤ªåçš„èµè¯†è€Œå¼€å§‹è‚ƒæ¸…å˜æ³•æµæ¯’ï¼Œä¸æ–™éšç€å¤ªçš‡å¤ªåçš„å»ä¸–ï¼Œè‡ªå·±ä¹Ÿè¢«æµæ”¾ï¼Œç©¶å…¶åŸå› ï¼Œä¹ƒæ˜¯å› ä¸ºçš‡ä½çš„æ›´è¿­ï¼Œä¸€ä½ä¸è´¤æ˜çš„çš‡å¸æ˜“å—å°äººè’™è”½è€Œä¸è¡Œç›Šæ°‘ä¹‹ç­–ã€‚æˆ‘ä»¬ä¸èƒ½ä¿è¯å¤©æ‰çš„åä»£ä»ç„¶æ˜¯å¤©æ‰ï¼Œè€ŒæŠŠç‹æœçš„å‘½è¿å¯„æ‰˜äºåŸºå› å®éå¥½äº‹ã€‚</p><p>æƒ³èµ·ã€Šæ˜æœé‚£äº›äº‹å„¿ã€‹çš„å¾é˜¶ï¼Œæ˜é‡Œé€€è®©ï¼Œæš—é‡Œç§¯è“„åŠ›é‡ï¼Œç§‰æŒå¿ ä¹‰ä¹‹å¿ƒï¼Œä¸¥åµ©ç»ˆå€’ã€‚<br>æ­£æ‰€è°“ï¼Œè´ªå®˜å¥¸ï¼Œä½ è¦æ¯”è´ªå®˜æ›´å¥¸ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>ç»™å¤§ä¸€çš„å­¦å¼Ÿ</title>
      <link href="/to-16-freshman/"/>
      <url>/to-16-freshman/</url>
      
        <content type="html"><![CDATA[<h1 id="æˆ‘åº”è¯¥ç¼–ç¨‹å—ï¼Ÿ"><a href="#æˆ‘åº”è¯¥ç¼–ç¨‹å—ï¼Ÿ" class="headerlink" title="æˆ‘åº”è¯¥ç¼–ç¨‹å—ï¼Ÿ"></a>æˆ‘åº”è¯¥ç¼–ç¨‹å—ï¼Ÿ</h1><ol><li><a href="https://www.zhihu.com/question/35256075" target="_blank" rel="noopener">å¦‚ä½•ç¡®å®šè‡ªå·±æ˜¯å¦é€‚åˆåšç¨‹åºå‘˜ï¼Ÿ</a></li><li><a href="https://www.zhihu.com/question/19578287" target="_blank" rel="noopener">å¦‚ä½•å­¦ä¹ ç¼–ç¨‹ï¼Ÿ</a></li></ol><p><strong>ä¸ºä»€ä¹ˆä¸å°è¯•ä¸€ä¸‹å‘¢ï¼Ÿ</strong></p><a id="more"></a><h1 id="å­¦ä¼šä½¿ç”¨å·¥å…·"><a href="#å­¦ä¼šä½¿ç”¨å·¥å…·" class="headerlink" title="å­¦ä¼šä½¿ç”¨å·¥å…·"></a>å­¦ä¼šä½¿ç”¨å·¥å…·</h1><p>å…¶å®æ•´ä¸ªäº’è”ç½‘å°±æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæ˜¯æˆ‘ä»¬è·å–ä¿¡æ¯ã€äº¤æµçš„å·¥å…·ï¼Œè€Œä½œä¸ºâ€Write the code, Change the worldâ€çš„ç¨‹åºå‘˜ï¼Œæ›´åº”è¯¥é€šè¿‡å·¥å…·æ¥æé«˜æ•ˆç‡ã€‚</p><p><strong>Windows</strong></p><p><a href="http://www.cnblogs.com/wayou/p/shortcuts.html" target="_blank" rel="noopener">æ²¡æœ‰é¼ æ ‡çš„æ—¥å­å¤šäºäº†æˆ‘ç²¾æ¹›çš„æ‰‹æ“ï¼Œå„ç§å¿«æ·é”®åˆ†äº«</a></p><p><strong>Chrome</strong></p><p><a href="http://www.jeffjade.com/2015/10/19/2015-10-18-chrome-vimium/" target="_blank" rel="noopener">Vimium~è®©æ‚¨çš„Chromeèµ·é£</a></p><p><strong>IDEA</strong></p><p>IDEA æ˜¯ä¸€ç§ç¼–ç¨‹å·¥å…·ï¼Œè€Œç¼–ç¨‹å·¥å…·æ˜¯ç”¨æ¥æé«˜ç¼–ç¨‹æ•ˆç‡çš„ï¼Œå› æ­¤ï¼Œæ€ä¹ˆæœ‰æ•ˆæé«˜ç¼–ç¨‹æ•ˆç‡ï¼Œæ‰æ˜¯æˆ‘ä»¬ä½¿ç”¨å·¥å…·æ‰€è¦è€ƒè™‘çš„ã€‚</p><ol><li><a href="http://whudoc.qiniudn.com/2016/IntelliJ-IDEA-Tutorial/index.html" target="_blank" rel="noopener">IDEA ä¸­æ–‡æ•™ç¨‹</a></li><li><a href="http://blog.csdn.net/kiwi_coder/article/details/17113759" target="_blank" rel="noopener">IntelliJä¸‹ä½¿ç”¨Code/Live TemplateåŠ å¿«ç¼–ç é€Ÿåº¦ï¼šç¨‹åºå‘˜çš„å·¥ä½œä¸æ˜¯å†™ç¨‹åºï¼Œè€Œæ˜¯å†™ç¨‹åºè§£å†³é—®é¢˜</a></li></ol><h1 id="ç¨‹åºå‘˜ç´ å…»"><a href="#ç¨‹åºå‘˜ç´ å…»" class="headerlink" title="ç¨‹åºå‘˜ç´ å…»"></a>ç¨‹åºå‘˜ç´ å…»</h1><p>è¯´åˆ°åº•ï¼Œç¨‹åºå‘˜ä¸è¿‡æ˜¯ä¸€ç§èŒä¸šï¼Œåšä¸€ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜ä¸ä»…éœ€è¦ç´ å…»ï¼Œè¿˜éœ€è¦è‰¯å¥½çš„ä¹ æƒ¯ï¼Œå½“ç„¶ï¼Œä¸€åˆ‡éƒ½å¯ä»¥åŸ¹å…»ã€‚</p><ol><li><a href="http://www.cnblogs.com/morethink/p/6790464.html" target="_blank" rel="noopener">æ€ä¹ˆè§£å†³é—®é¢˜</a></li><li><a href="http://coolshell.cn/articles/4506.html" target="_blank" rel="noopener">å†è°ˆâ€œæˆ‘æ˜¯æ€ä¹ˆæ‹›è˜ç¨‹åºå‘˜çš„â€ï¼ˆä¸Šï¼‰</a></li><li><a href="http://www.cnblogs.com/xueweihan/p/5220513.html" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯çœŸæ­£çš„ç¨‹åºå‘˜</a></li><li><a href="http://zwchen.iteye.com/blog/1154193" target="_blank" rel="noopener">Javaæºç é˜…è¯»çš„çœŸå®ä½“ä¼š</a></li><li><a href="http://www.csdn.net/article/2012-10-19/2810967-Why-are-China%27s-programmers-always-calle" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆä¸­å›½çš„ç¨‹åºå‘˜æ€»è¢«ç§°ä¸ºç å†œï¼Ÿ</a></li></ol><h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><p><strong>Java åç«¯æŠ€èƒ½æ ‘</strong><br><img src="https://images.morethink.cn/java-skill-tree.png" alt=""><br><strong>Java å­¦ä¹ è¿‡ç¨‹</strong></p><ol><li><a href="https://www.zhihu.com/question/29581524/answer/44872235" target="_blank" rel="noopener">å­¦ä¹  JAVAï¼Œæœ‰ä»€ä¹ˆä¹¦ç±æ¨èï¼Ÿå­¦ä¹ çš„æ–¹æ³•å’Œè¿‡ç¨‹æ˜¯æ€æ ·çš„ï¼Ÿ</a></li><li><a href="http://www.hollischuang.com/archives/489" target="_blank" rel="noopener">Javaå·¥ç¨‹å¸ˆæˆç¥ä¹‹è·¯~</a></li><li><a href="https://www.zhihu.com/question/19945685" target="_blank" rel="noopener">æˆ‘ä»¬å¦‚ä½•å­¦å¥½Javaï¼Ÿ</a></li><li><a href="http://www.imooc.com/course/programdetail/pid/31" target="_blank" rel="noopener">Javaå·¥ç¨‹å¸ˆ</a></li></ol><p><strong>å­¦ä¹ å¹³å°</strong></p><ol><li>æ…•è¯¾ç½‘æ˜¯ä¸€ä¸ªå¾ˆå¥½å­¦ä¹ å¹³å°ï¼Œé‡Œé¢æœ‰å¾ˆå¤šä¸é”™çš„å­¦ä¹ èµ„æ–™ï¼Œæ¯”è¾ƒç³»ç»Ÿå’Œå…¨é¢ã€‚<br><img src="https://images.morethink.cn/imooc.jpg" alt=""></li><li><a href="http://www.jikexueyuan.com/" target="_blank" rel="noopener">æå®¢å­¦é™¢</a></li><li><a href="https://www.shiyanlou.com/" target="_blank" rel="noopener">å®éªŒæ¥¼</a></li></ol><p><strong>Java åšå®¢</strong></p><ol><li><a href="http://www.cnblogs.com/skywang12345/archive/2013/06/14/index.html" target="_blank" rel="noopener">skywangçš„åšå®¢ç›®å½•(æŒç»­æ›´æ–°ä¸­â€¦)</a></li><li><a href="http://blog.csdn.net/ns_code/article/details/17539599" target="_blank" rel="noopener">ã€Javaå¹¶å‘ç¼–ç¨‹ã€‘å¹¶å‘ç¼–ç¨‹å¤§åˆé›†</a></li><li><a href="http://www.hollischuang.com/archives/1003" target="_blank" rel="noopener">ã€Šæˆç¥ä¹‹è·¯-åŸºç¡€ç¯‡ã€‹JVMâ€”â€”Javaå†…å­˜ç›¸å…³(å·²å®Œç»“)</a></li><li><a href="http://cmsblogs.com/" target="_blank" rel="noopener">http://cmsblogs.com/</a> ä¸€ä¸ªJavaç‰›äººçš„åšå®¢</li></ol><p><strong>æš‘å‡å…¥é—¨ä¹¦ç±</strong><br>ã€ŠJava æ ¸å¿ƒæŠ€æœ¯ï¼šå·1 åŸºç¡€çŸ¥è¯†ã€‹</p><h1 id="ä»·å€¼åšå®¢ä»¬"><a href="#ä»·å€¼åšå®¢ä»¬" class="headerlink" title="ä»·å€¼åšå®¢ä»¬"></a>ä»·å€¼åšå®¢ä»¬</h1><ol><li><a href="http://mindhacks.cn/" target="_blank" rel="noopener">åˆ˜æœªé¹ | Mind Hacks</a> - é‡Œé¢è®²äº†ä¸€äº›æ–¹æ³•è®ºï¼Œè¿˜å¯ä»¥ä¹°ä»–çš„æš—æ—¶é—´æ¥çœ‹çœ‹</li><li><a href="http://www.ruanyifeng.com/home.html" target="_blank" rel="noopener">é˜®ä¸€å³°çš„ä¸ªäººç½‘ç«™</a> - ç§‘æŠ€ä¸äººæ–‡å¹¶é‡ï¼Œä»–ç¿»è¯‘çš„é»‘å®¢ä¸ç”»å®¶å¯ä»¥çœ‹çœ‹</li><li><a href="http://coolshell.cn/" target="_blank" rel="noopener">Highä¸€ä¸‹! é…· å£³ â€“ COOLSHELL</a> - ä¸€ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜ï¼Œäº«å—ç¼–ç¨‹å’ŒæŠ€æœ¯æ‰€å¸¦æ¥çš„å¿«ä¹</li></ol><h1 id="æŠ€æœ¯"><a href="#æŠ€æœ¯" class="headerlink" title="æŠ€æœ¯"></a>æŠ€æœ¯</h1><ol><li><a href="http://www.infoq.com/cn/" target="_blank" rel="noopener">infoq</a></li><li>APPï¼šå¼€å‘è€…å¤´æ¡ï¼Œæ˜é‡‘ï¼Œsegmentfaultï¼ŒCSDN</li></ol><p>æœ€åï¼Œä»»ä½•äº‹æƒ…æœ€æ‹ä¸“æ³¨ä¸”åšæŒï¼Œæ…¢æ…¢æ¥ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹æ€è€ƒ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Springäº‹åŠ¡ä¸å›æ»šåŸå› åˆ†æ</title>
      <link href="/Spring-transaction-no-rollback/"/>
      <url>/Spring-transaction-no-rollback/</url>
      
        <content type="html"><![CDATA[<p>Synchronizedç”¨äºçº¿ç¨‹é—´çš„æ•°æ®å…±äº«ï¼Œè€ŒThreadLocalåˆ™ç”¨äºçº¿ç¨‹é—´çš„æ•°æ®éš”ç¦»ã€‚</p><p>åœ¨æˆ‘å®Œæˆä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªSpringäº‹åŠ¡ä¸å›æ»šçš„é—®é¢˜ï¼Œé€šè¿‡aspectJå’Œ@Transactionalæ³¨è§£éƒ½æ— æ³•å®Œæˆå¯¹äºäº‹åŠ¡çš„å›æ»šï¼Œç»è¿‡æŸ¥çœ‹åšå®¢å’Œæ–‡æ¡£</p><ol><li>é»˜è®¤å›æ»šRuntimeException</li><li>Serviceå†…éƒ¨æ–¹æ³•è°ƒç”¨</li><li>Springçˆ¶å­å®¹å™¨è¦†ç›–</li></ol><p>ä»£ç å·²ç»ä¸Šä¼ åˆ° <a href="https://github.com/morethink/transactional" target="_blank" rel="noopener">https://github.com/morethink/transactional</a></p><a id="more"></a><h1 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h1><p>ä¸‹é¢æ˜¯@Transactionalçš„æ³¨é‡Šæ–‡æ¡£ï¼Œä¸‹é¢æœ‰ä¸ªIf no rules are relevant to the exception,it will be treated like {@link  org.springframework.transaction.interceptor.DefaultTransactionAttribute} (rolling back on runtime exceptions).<br>é»˜è®¤ä¼šä½¿ç”¨<code>RuntimeException</code>,é‚£ä¸ºä»€ä¹ˆ<strong>Springé»˜è®¤å›æ»šRuntimeException</strong>ï¼Œå› ä¸ºJavaæŠŠExceptionåˆ†ä¸ºä¸¤ç§ã€‚</p><ol><li>checked Exceptionï¼šExceptionç±»æœ¬èº«ï¼Œä»¥åŠExceptionçš„å­ç±»ä¸­é™¤äº†â€è¿è¡Œæ—¶å¼‚å¸¸â€ä¹‹å¤–çš„å…¶å®ƒå­ç±»éƒ½å±äºè¢«æ£€æŸ¥å¼‚å¸¸ã€‚</li><li>unchecked Exceptionï¼š RuntimeExceptionå’ŒErroréƒ½å±äºæœªæ£€æŸ¥å¼‚å¸¸ã€‚</li></ol><p><img src="https://images.morethink.cn/java-exception.jpg" alt=""></p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Describes transaction attributes on a method or class.</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;This annotation type is generally directly comparable to Spring&apos;s</span><br><span class="line"> * &#123;@link org.springframework.transaction.interceptor.RuleBasedTransactionAttribute&#125;</span><br><span class="line"> * class, and in fact &#123;@link AnnotationTransactionAttributeSource&#125; will directly</span><br><span class="line"> * convert the data to the latter class, so that Spring&apos;s transaction support code</span><br><span class="line"> * does not have to know about annotations. If no rules are relevant to the exception,</span><br><span class="line"> * it will be treated like</span><br><span class="line"> * &#123;@link org.springframework.transaction.interceptor.DefaultTransactionAttribute&#125;</span><br><span class="line"> * (rolling back on runtime exceptions).</span><br><span class="line"> *</span><br><span class="line"> * &lt;p&gt;For specific information about the semantics of this annotation&apos;s attributes,</span><br><span class="line"> * consult the &#123;@link org.springframework.transaction.TransactionDefinition&#125; and</span><br><span class="line"> * &#123;@link org.springframework.transaction.interceptor.TransactionAttribute&#125; javadocs.</span><br><span class="line"> *</span><br><span class="line"> * @author Colin Sampaleanu</span><br><span class="line"> * @author Juergen Hoeller</span><br><span class="line"> * @author Sam Brannen</span><br><span class="line"> * @since 1.2</span><br><span class="line"> * @see org.springframework.transaction.interceptor.TransactionAttribute</span><br><span class="line"> * @see org.springframework.transaction.interceptor.DefaultTransactionAttribute</span><br><span class="line"> * @see org.springframework.transaction.interceptor.RuleBasedTransactionAttribute</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><p>å› æ­¤ï¼Œå¦‚æœå‘ç”Ÿçš„ä¸æ˜¯RuntimeExceptionï¼Œè€Œä½ æœ‰æ²¡æœ‰é…ç½®rollback for ï¼Œé‚£ä¹ˆï¼Œå¼‚å¸¸å°±ä¸ä¼šå›æ»šã€‚</p><h1 id="service-å†…éƒ¨æ–¹æ³•è°ƒç”¨"><a href="#service-å†…éƒ¨æ–¹æ³•è°ƒç”¨" class="headerlink" title="service å†…éƒ¨æ–¹æ³•è°ƒç”¨"></a>service å†…éƒ¨æ–¹æ³•è°ƒç”¨</h1><p><strong>å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰å¼€å¯äº‹åŠ¡æ§åˆ¶çš„æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå¼€å¯äº†äº‹åŠ¡æ§åˆ¶æ–¹æ³•ï¼Œä¸ä¼šäº‹åŠ¡å›æ»šã€‚</strong></p><p><strong>AccountServiceç±»</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@Service</span><br><span class="line">public class AccountService &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccountDao accountDao;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å®Œæˆè½¬é’±ä¸šåŠ¡,transferæ–¹æ³•å¼€å¯äº‹åŠ¡</span><br><span class="line">     *</span><br><span class="line">     * @param out</span><br><span class="line">     * @param in</span><br><span class="line">     * @param money</span><br><span class="line">     */</span><br><span class="line">    @Transactional(isolation = Isolation.DEFAULT, propagation = Propagation.REQUIRED)</span><br><span class="line">    public void transfer(String out, String in, double money) &#123;</span><br><span class="line">        Account account = new Account();</span><br><span class="line">        account.setName(out);</span><br><span class="line">        account.setMoney(money);</span><br><span class="line">        accountDao.out(account);</span><br><span class="line">        int i = 1 / 0;</span><br><span class="line">        account.setName(in);</span><br><span class="line">        accountDao.in(account);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å®Œæˆè½¬é’±ä¸šåŠ¡,transferProxyæ–¹æ³•æ²¡æœ‰å¼€å¯äº‹åŠ¡</span><br><span class="line">     *</span><br><span class="line">     * @param out</span><br><span class="line">     * @param in</span><br><span class="line">     * @param money</span><br><span class="line">     */</span><br><span class="line">    public void transferProxy(String out, String in, double money) &#123;</span><br><span class="line">        System.out.println(&quot;è°ƒç”¨transferæ–¹æ³• å¼€å§‹&quot;);</span><br><span class="line">        transfer(out, in, money);</span><br><span class="line">        System.out.println(&quot;è°ƒç”¨transferæ–¹æ³• ç»“æŸ&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>AccountActionç±»</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class AccountAction &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AccountService accountService;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/transfer&quot;)</span><br><span class="line">    public String transfer(String out, String in, double money) &#123;</span><br><span class="line">        accountService.transfer(out, in, money);</span><br><span class="line">        return &quot;transfer&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @RequestMapping(&quot;/transferProxy&quot;)</span><br><span class="line">    public String transferProxy(String out, String in, double money) &#123;</span><br><span class="line">        accountService.transferProxy(out, in, money);</span><br><span class="line">        return &quot;transfer&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ol><li><p>é€šè¿‡transferProxyæ–¹æ³•è°ƒç”¨transferæ–¹æ³•æ—¶</p> <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Logging initialized using &apos;class org.apache.ibatis.logging.stdout.StdOutImpl&apos; adapter.</span><br><span class="line">è°ƒç”¨transferæ–¹æ³• å¼€å§‹</span><br><span class="line">Creating a new SqlSession</span><br><span class="line">SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a0dbf4] was not registered for synchronization because synchronization is not active</span><br><span class="line">JDBC Connection [com.mchange.v2.c3p0.impl.NewProxyConnection@6386ed [wrapping: com.mysql.jdbc.JDBC4Connection@9f2009]] will not be managed by Spring</span><br><span class="line">==&gt;  Preparing: update account set money = money - ? where name = ?</span><br><span class="line">==&gt; Parameters: 100.0(Double), aaa(String)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line">Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@a0dbf4]</span><br></pre></td></tr></table></figure><p> å‘ç°æ²¡æœ‰å¼€å¯äº‹åŠ¡</p></li><li>ç›´æ¥è°ƒç”¨transferæ–¹æ³•æ—¶ <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Logging initialized using &apos;class org.apache.ibatis.logging.stdout.StdOutImpl&apos; adapter.</span><br><span class="line">Creating a new SqlSession</span><br><span class="line">Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@238be2]</span><br><span class="line">JDBC Connection [com.mchange.v2.c3p0.impl.NewProxyConnection@a502e0 [wrapping: com.mysql.jdbc.JDBC4Connection@3dbe42]] will be managed by Spring</span><br><span class="line">==&gt;  Preparing: update account set money = money - ? where name = ?</span><br><span class="line">==&gt; Parameters: 100.0(Double), aaa(String)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line">Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@238be2]</span><br><span class="line">Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@238be2]</span><br><span class="line">Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@238be2]</span><br></pre></td></tr></table></figure></li></ol><p>æˆ‘ä»¬éƒ½çŸ¥é“Springäº‹åŠ¡ç®¡ç†æ˜¯é€šè¿‡AOPä»£ç†å®ç°çš„ï¼Œå¯æ˜¯é‚£ä¹ˆä»€ä¹ˆæ¡ä»¶ä¼šä½¿å¾—AOPä»£ç†å¼€å¯ï¼Ÿé€šè¿‡æŸ¥çœ‹<br><a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#transaction" target="_blank" rel="noopener">Sprinå®˜æ–¹æ–‡æ¡£</a>ï¼Œå‘ç°åªæœ‰æŠŠæ•´ä¸ªServiceè®¾ä¸ºäº‹åŠ¡æ§åˆ¶æ—¶ï¼Œæ‰ä¼šè¿›è¡ŒAOPä»£ç†ã€‚å¦‚æœæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ²¡æœ‰äº‹åŠ¡çš„transferProxyæ–¹æ³•å»è°ƒç”¨æœ‰äº‹åŠ¡çš„transferæ–¹æ³•ï¼Œæ˜¯é€šè¿‡thiså¼•ç”¨è¿›è¡Œè°ƒç”¨ï¼Œæ²¡æœ‰å¼€å¯äº‹åŠ¡ï¼Œå³ä½¿å‘ç”Ÿäº†RuntimeExceptionä¹Ÿä¸ä¼šå›æ»šã€‚</p><p><img src="https://images.morethink.cn/tx.png" alt=""></p><p>ç„¶å</p><h1 id="Springçˆ¶å­å®¹å™¨è¦†ç›–"><a href="#Springçˆ¶å­å®¹å™¨è¦†ç›–" class="headerlink" title="Springçˆ¶å­å®¹å™¨è¦†ç›–"></a>Springçˆ¶å­å®¹å™¨è¦†ç›–</h1><p>Springå®¹å™¨ä¼˜å…ˆåŠ è½½ç”±ServletContextListenerï¼ˆå¯¹åº”applicationContext.xmlï¼‰äº§ç”Ÿçš„çˆ¶å®¹å™¨ï¼Œè€ŒSpringMVCï¼ˆå¯¹åº”mvc_dispatcher_servlet.xmlï¼‰äº§ç”Ÿçš„æ˜¯å­å®¹å™¨ã€‚å­å®¹å™¨Controllerè¿›è¡Œæ‰«æè£…é…æ—¶è£…é…çš„@Serviceæ³¨è§£çš„å®ä¾‹æ˜¯æ²¡æœ‰ç»è¿‡äº‹åŠ¡åŠ å¼ºå¤„ç†ï¼Œå³æ²¡æœ‰äº‹åŠ¡å¤„ç†èƒ½åŠ›çš„Serviceï¼Œè€Œçˆ¶å®¹å™¨è¿›è¡Œåˆå§‹åŒ–çš„Serviceæ˜¯ä¿è¯äº‹åŠ¡çš„å¢å¼ºå¤„ç†èƒ½åŠ›çš„ã€‚å¦‚æœä¸åœ¨å­å®¹å™¨ä¸­å°†Service excludeæ‰ï¼Œæ­¤æ—¶å¾—åˆ°çš„å°†æ˜¯åŸæ ·çš„æ— äº‹åŠ¡å¤„ç†èƒ½åŠ›çš„Serviceï¼Œå› ä¸ºåœ¨å¤šä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹ï¼Œå¦‚æœåŒä¸€ä¸ªbeanè¢«å®šä¹‰ä¸¤æ¬¡ï¼Œåé¢ä¸€ä¸ªä¼˜å…ˆã€‚</p><p>å½“æˆ‘ä»¬åœ¨applicationContext.xml,spring-mvc.xmléƒ½é…ç½®å¦‚ä¸‹æ‰«æåŒ…æ—¶ï¼Œspring-mvc.xmlä¸­çš„serviceå°±ä¼šè¦†ç›–applicationContext.xmlä¸­çš„serviceã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">context:component-scan base-package=&quot;net.morethink&quot;/&gt;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå½“æˆ‘ä»¬ä½¿ç”¨JUnitæµ‹è¯•çš„æ—¶å€™ï¼Œä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚<br>JUnité…ç½®å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@RunWith(SpringJUnit4ClassRunner.class)</span><br><span class="line">@ContextConfiguration(locations = &#123;&quot;classpath:applicationContext.xml&quot;, &quot;classpath:dispatcher-servlet.xml&quot;&#125;)</span><br><span class="line">@WebAppConfiguration</span><br><span class="line">public class AccountActionTest &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    protected MockMvc mockMvc;</span><br><span class="line">    @Autowired</span><br><span class="line">    protected WebApplicationContext wac;</span><br><span class="line"></span><br><span class="line">    @Before()  //è¿™ä¸ªæ–¹æ³•åœ¨æ¯ä¸ªæ–¹æ³•æ‰§è¡Œä¹‹å‰éƒ½ä¼šæ‰§è¡Œä¸€é</span><br><span class="line">    public void setup() &#123;</span><br><span class="line">        mockMvc = MockMvcBuilders.webAppContextSetup(wac).build();  //åˆå§‹åŒ–MockMvcå¯¹è±¡</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testTransfer() throws Exception &#123;</span><br><span class="line">        String responseString = mockMvc.perform(</span><br><span class="line">                get(&quot;/transfer&quot;)    //è¯·æ±‚çš„url,è¯·æ±‚çš„æ–¹æ³•æ˜¯get</span><br><span class="line">                        .contentType(MediaType.APPLICATION_FORM_URLENCODED)  //æ•°æ®çš„æ ¼å¼</span><br><span class="line">                        .param(&quot;out&quot;, &quot;aaa&quot;)</span><br><span class="line">                        .param(&quot;in&quot;, &quot;bbb&quot;)</span><br><span class="line">                        .param(&quot;money&quot;, &quot;100&quot;)</span><br><span class="line">        ).andExpect(status().isOk())    //è¿”å›çš„çŠ¶æ€æ˜¯200</span><br><span class="line">//                .andDo(print())         //æ‰“å°å‡ºè¯·æ±‚å’Œç›¸åº”çš„å†…å®¹</span><br><span class="line">                .andReturn().getResponse().getContentAsString();   //å°†ç›¸åº”çš„æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">        System.out.println(responseString);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    public void testTransferProxy() throws Exception &#123;</span><br><span class="line">        String responseString = mockMvc.perform(</span><br><span class="line">                get(&quot;/transferProxy&quot;)    //è¯·æ±‚çš„url,è¯·æ±‚çš„æ–¹æ³•æ˜¯get</span><br><span class="line">                        .contentType(MediaType.APPLICATION_FORM_URLENCODED)  //æ•°æ®çš„æ ¼å¼</span><br><span class="line">                        .param(&quot;out&quot;, &quot;aaa&quot;)</span><br><span class="line">                        .param(&quot;in&quot;, &quot;bbb&quot;)</span><br><span class="line">                        .param(&quot;money&quot;, &quot;100&quot;)</span><br><span class="line">        ).andExpect(status().isOk())    //è¿”å›çš„çŠ¶æ€æ˜¯200</span><br><span class="line">//                .andDo(print())         //æ‰“å°å‡ºè¯·æ±‚å’Œç›¸åº”çš„å†…å®¹</span><br><span class="line">                .andReturn().getResponse().getContentAsString();   //å°†ç›¸åº”çš„æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span><br><span class="line">        System.out.println(responseString);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><strong>å¯èƒ½å› ä¸ºJUnitä¸ä¼šäº§ç”Ÿçˆ¶å­å®¹å™¨ã€‚</strong></p><p><strong>è¿˜æœ‰å¯èƒ½æ˜¯å…¶å®ƒé…ç½®æ–‡ä»¶å‡ºé”™ï¼Œä¾‹å¦‚ï¼Œè¿æ¥æ± é…ç½®ä¸ºå¤šä¾‹</strong></p><p>å‚è€ƒæ–‡æ¡£</p><ol><li><a href="http://www.jianshu.com/p/f5fc14bde8a0" target="_blank" rel="noopener">Springå£°æ˜å¼äº‹åŠ¡ä¸ºä½•ä¸å›æ»š</a></li><li><a href="http://www.importnew.com/19489.html" target="_blank" rel="noopener">Springä¸­@Transactionaläº‹åŠ¡å›æ»šï¼ˆå«å®ä¾‹è¯¦ç»†è®²è§£ï¼Œé™„æºç ï¼‰</a></li><li><a href="http://blog.csdn.net/c289054531/article/details/9187081" target="_blank" rel="noopener">æ·±å…¥ç ”ç©¶java.lang.ThreadLocalç±»</a></li><li><a href="http://blog.csdn.net/c289054531/article/details/9196053" target="_blank" rel="noopener">Springå•å®ä¾‹ã€å¤šçº¿ç¨‹å®‰å…¨ã€äº‹åŠ¡è§£æ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æœ‰ä¸€ç§æ–œè½ä¸‹æ¥çš„å¹½å…‰</title>
      <link href="/%E8%AF%BB%E4%B9%A6/There-is-a-light-that-falls-down/"/>
      <url>/%E8%AF%BB%E4%B9%A6/There-is-a-light-that-falls-down/</url>
      
        <content type="html"><![CDATA[<p>By:Emily Dickinson<br>è¯‘:ä½™å…‰ä¸­</p><p>å†¬æ—¥çš„ä¸‹åˆå¾€å¾€æœ‰ä¸€ç§<br>æ–œè½ä¸‹æ¥çš„å¹½å…‰ï¼Œ<br>å‹è¿«ç€æˆ‘ä»¬ï¼Œé‚£é‡é‡å¦‚åŒ<br>å¤§æ•™å ‚ä¸­çš„ç´å“ã€‚<br><a id="more"></a><br>å®ƒç»™æˆ‘ä»¬ä»¥ç¥åœ£çš„åˆ›ä¼¤ï¼›<br>æˆ‘ä»¬æ‰¾ä¸åˆ°æ–‘ç—•ã€‚<br>åªæœ‰å†…å¿ƒæ‰€å¼•èµ·çš„å˜åŒ–ï¼Œ<br>å°†å®ƒçš„æ„ä¹‰è•´å­˜ã€‚</p><p>æ²¡äººèƒ½å¤Ÿä½¿å®ƒæ„Ÿæ‚Ÿï¼›<br>å®ƒæ˜¯ç»æœ›çš„çƒ™å°ï¼Œ<br>ä¸€ç§æ— æ¯”ç¾å¦™çš„ç—›è‹¦ï¼Œ<br>å€Ÿå¤§æ°”ä¼ ç»™æˆ‘ä»¬ã€‚</p><p>å½“å®ƒæ¥æ—¶ï¼Œå››é‡éƒ½å€¾å¬ï¼Œ<br>é˜´å½±å…¨å±ä½å‘¼å¸ï¼›<br>å½“å»æ—¶ï¼Œè¿œå¾—åƒæˆ‘ä»¬<br>é¥æœ›æ­»äº¡çš„è·ç¦»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>æ€ä¹ˆä½¿ç”¨IDEA</title>
      <link href="/how-to-use-IDEA/"/>
      <url>/how-to-use-IDEA/</url>
      
        <content type="html"><![CDATA[<h1 id="war-å’Œ-war-exploded"><a href="#war-å’Œ-war-exploded" class="headerlink" title="war å’Œ war exploded"></a>war å’Œ war exploded</h1><ol><li>waréƒ¨ç½²é¦–å…ˆé€šè¿‡IDEAç”Ÿæˆ.warå·¥ç¨‹æ–‡ä»¶ï¼Œç„¶åå°†WEBå·¥ç¨‹ä»¥åŒ…çš„å½¢å¼ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œå› æ­¤ä¼šæ›¿ä»£æœåŠ¡å™¨æœ¬æ¥åŒåçš„web appé¡¹ç›®ã€‚</li><li>war explodedæ¨¡å¼ç›´æ¥å°†WEBå·¥ç¨‹ä»¥å½“å‰æ–‡ä»¶å¤¹çš„ä½ç½®å…³ç³»ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚</li></ol><a id="more"></a><p>ä½¿ç”¨ï¼š</p><ol><li>waræ¨¡å¼è¿™ç§å¯ä»¥ç§°ä¹‹ä¸ºæ˜¯å‘å¸ƒæ¨¡å¼ï¼Œçœ‹åå­—ä¹ŸçŸ¥é“ï¼Œè¿™æ˜¯å…ˆæ‰“æˆwaråŒ…ï¼Œå†å‘å¸ƒï¼›</li><li>war explodedæ¨¡å¼æ˜¯ç›´æ¥æŠŠæ–‡ä»¶å¤¹ã€jspé¡µé¢ ã€classesç­‰ç­‰ç§»åˆ°IDEAç”Ÿæˆçš„Tomcatéƒ¨ç½²æ–‡ä»¶å¤¹é‡Œé¢ï¼Œè¿›è¡ŒåŠ è½½éƒ¨ç½²ï¼Œä¸ä¼šæ›¿ä»£æœ¬æ¥tomcatä¸­çš„åŒåweb appé¡¹ç›®ã€‚å› æ­¤è¿™ç§æ–¹å¼æ”¯æŒçƒ­éƒ¨ç½²ï¼Œä¸€èˆ¬åœ¨å¼€å‘çš„æ—¶å€™ä¹Ÿæ˜¯ç”¨è¿™ç§æ–¹å¼ã€‚</li><li>åœ¨å¹³æ—¶å¼€å‘çš„æ—¶å€™ï¼Œä½¿ç”¨çƒ­éƒ¨ç½²çš„è¯ï¼Œåº”è¯¥å¯¹Tomcatä¸­è¿›è¡Œç›¸åº”çš„è®¾ç½®,æ›´æ”¹å›¾ä¸­ä¸¤å¤„æ ‡è®°ä¸º <code>update classes and resources</code>:<br><img src="https://images.morethink.cn/IDEA-update.jpg" alt=""><br>è¿™æ ·çš„è¯ä¿®æ”¹çš„htmlï¼Œjspæˆ–è€…ç¬¬ä¸‰æ–¹æ¨¡ç‰ˆæ¡†æ¶ä¾‹å¦‚ Freemarkerçƒ­éƒ¨ç½²æ‰å¯ä»¥ç”Ÿæ•ˆã€‚</li></ol><h1 id="çƒ­éƒ¨ç½²æ’ä»¶-JRebel"><a href="#çƒ­éƒ¨ç½²æ’ä»¶-JRebel" class="headerlink" title="çƒ­éƒ¨ç½²æ’ä»¶ JRebel"></a>çƒ­éƒ¨ç½²æ’ä»¶ JRebel</h1><blockquote><p>åœ¨ Java Web å¼€å‘ä¸­ï¼Œ ä¸€èˆ¬æ›´æ–°äº† Java æ–‡ä»¶åè¦æ‰‹åŠ¨é‡å¯ Tomcat æœåŠ¡å™¨ï¼Œ æ‰èƒ½ç”Ÿæ•ˆï¼Œ æµªè´¹ä¸å°‘ç”Ÿå‘½å•Šï¼Œ è‡ªä»æœ‰äº† JRebel è¿™ç¥å™¨çš„å‡ºç°ï¼Œ ä¸è®ºæ˜¯æ›´æ–° class ç±»è¿˜æ˜¯æ›´æ–° Spring é…ç½®æ–‡ä»¶éƒ½èƒ½åšåˆ°ç«‹é©¬ç”Ÿæ•ˆï¼Œå¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚</p></blockquote><p><a href="http://whudoc.qiniudn.com/2016/IntelliJ-IDEA-Tutorial/jrebel-setup.html" target="_blank" rel="noopener">IntelliJ IDEA çš„ Java çƒ­éƒ¨ç½²æ’ä»¶ JRebel å®‰è£…åŠä½¿ç”¨</a></p><h1 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶" class="headerlink" title="å¸¸ç”¨æ’ä»¶"></a>å¸¸ç”¨æ’ä»¶</h1><ol><li>é˜¿é‡Œå·´å·´è§„çº¦æ£€æµ‹</li><li>ç¿»è¯‘æ’ä»¶</li><li>wakatime</li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> IDEA </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ€ä¹ˆè§£å†³é—®é¢˜</title>
      <link href="/%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98/"/>
      <url>/%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ç¼–ç¨‹æ€»æ˜¯ä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜ï¼Œä½ è§£å†³é—®é¢˜çš„ã€æ–¹å¼åæ˜ ä½ çš„æ€ç»´æ–¹å¼ï¼Œä½ çš„æ€ç»´æ–¹å¼å†³å®šä½ çš„æœªæ¥ï¼Œå¾ˆå¤šäº‹æƒ…å¯ä»¥é ç»éªŒè§£å†³ï¼Œæ€ç»´å´éœ€è¦ä¸æ–­çš„é”»ç‚¼ã€‚</p><p>ç¨‹åºå‘˜ä¸ä»…ä»…æ˜¯ç¨‹åºå‘˜ï¼Œä»–æ›´åº”è¯¥æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„å­¦ä¹ è€…ã€‚</p><a id="more"></a><p><strong>ä»¥ä¸‹ä¸»è¦æ¥æºäºé©¬å£«å…µè€å¸ˆ(å¾ˆæœ‰å‚è€ƒæ„ä¹‰)ï¼š</strong></p><p>åœ¨ç¼–ç¨‹ä¸­ï¼Œæ¯ä¸ªäººéƒ½ä¼šéš¾å…é‡åˆ°é—®é¢˜ï¼Œé‚£ä¹ˆï¼Œé‡åˆ°é—®é¢˜ä¹‹åï¼Œç¯å¢ƒé…ä¸é€šï¼Œç¨‹åºè°ƒä¸è¿‡ï¼Œè¿è¡Œä¸æ­£å¸¸ï¼Œé‡è§è¿™äº›æ¼äººçš„é—®é¢˜çš„æ—¶å€™ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>é¦–å…ˆæˆ‘è¦æ­å–œä½ ï¼Œé‡è§é—®é¢˜ï¼Œæ„å‘³ç€ä½ åˆæœ‰æ¶¨ç»éªŒçš„æœºä¼šäº†ï¼Œæ¯è§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œä½ çš„JAVAç»éªŒå€¼å°±åº”è¯¥ä¸Šå‡å‡ ç™¾ç‚¹ï¼Œé—®é¢˜é‡åˆ°çš„è¶Šå¤šï¼ŒçŸ¥è¯†æå‡çš„è¶Šå¿«ã€‚ ä½†æ˜¯æ€»æ˜¯è§£å†³ä¸äº†ä¹Ÿæ˜¯å¾ˆæ¼äººçš„ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ æˆ‘ä¸€èˆ¬è¦æ±‚æˆ‘ä»¬çš„å­¦ç”Ÿéƒ½æ˜¯è¿™æ ·æ¥è¿›è¡Œçš„ã€‚</p><p>å½“ä½ é‡åˆ°ä¸€ä¸ªé—®é¢˜çš„æ—¶å€™ï¼š</p><h1 id="è¦ä»”ç»†çš„è§‚å¯Ÿé”™è¯¯çš„ç°è±¡ï¼Œæ˜¯çš„ï¼Œè¦ä»”ç»†"><a href="#è¦ä»”ç»†çš„è§‚å¯Ÿé”™è¯¯çš„ç°è±¡ï¼Œæ˜¯çš„ï¼Œè¦ä»”ç»†" class="headerlink" title="è¦ä»”ç»†çš„è§‚å¯Ÿé”™è¯¯çš„ç°è±¡ï¼Œæ˜¯çš„ï¼Œè¦ä»”ç»†"></a>è¦ä»”ç»†çš„è§‚å¯Ÿé”™è¯¯çš„ç°è±¡ï¼Œæ˜¯çš„ï¼Œè¦ä»”ç»†</h1><p><em>è‹±è¯­æ˜¯æˆä¸ºä¸€ä¸ªç‰›é€¼ç¨‹åºå‘˜çš„å¿…ç»ä¹‹è·¯</em></p><p>æœ‰ä¸å°‘åŒå­¦çš„æ‰‹éå¸¸å¿«ï¼Œåœ¨ç¼–è¯‘ä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼ŒæŠ¥äº†ä¸€å¤§å †çš„é”™è¯¯ï¼Œæ‰«äº†ä¸€çœ¼ä¹‹åå°±å¼€å§‹ç›¯ç€ä»£ç ä¸€è¡Œä¸€è¡Œçš„æ‰¾ï¼Œçœ‹æ¸…ä»€ä¹ˆé”™è¯¯äº†å—ï¼Ÿæ²¡æœ‰ï¼æœ‰çš„æ—¶å€™å®‰è£…è½¯ä»¶å‡ºé—®é¢˜äº†ï¼Œä¸€ä¸ªå¯¹è¯æ¡†å¼¹å‡ºæ¥è¯´å‡ºé”™äº†ï¼Œé©¬ä¸Šä¸¾æ‰‹é—®è€å¸ˆï¼šâ€œä¸å¾—äº†äº†ï¼Œå‡ºé”™äº†ï¼Œå‡ºé”™äº†â€ã€‚</p><p>â€œä»€ä¹ˆé”™è¯¯ï¼Ÿâ€</p><p>â€œè¿˜æ²¡çœ‹å‘¢ï¼Ÿâ€</p><p>è¿™éƒ½æ˜¯å…¸å‹çš„ä¸ä¸Šå¿ƒçš„æ–¹æ³•ï¼è¯·è®°ä½ï¼Œå­¦ä¹ ç¼–ç¨‹å¹¶ä¸æ˜¯ä¸€ä»¶å¾ˆå®¹æ˜“çš„äº‹æƒ…ï¼Œè‡ªå·±é¦–å…ˆè¦é‡è§†ï¼Œè¦ç”¨å¿ƒæ‰å¯ä»¥ã€‚åœ¨å¼€å‘ä¸­ï¼Œä»”ç»†è§‚å¯Ÿå‡ºé”™ä¿¡æ¯ï¼Œæˆ–è€…è¿è¡Œä¸æ­£å¸¸çš„ä¿¡æ¯ï¼Œæ˜¯ä½ è¦åšçš„ç¬¬ä¸€ä»¶äº‹ã€‚è¯»æ¸…æ¥šäº†ï¼Œæ‰èƒ½åœ¨ä»¥åçš„æ­¥éª¤ä¸­æœ‰çš„æ”¾çŸ¢ï¼Œå“­äº†åŠå¤©ï¼Œæ€»è¦çŸ¥é“å“­çš„æ˜¯è°æ‰æˆã€‚</p><p>è¿™é‡Œåˆåˆ†ä¸‰ç§æƒ…å†µï¼š</p><p>A:é”™è¯¯ä¿¡æ¯è¯»æ‡‚äº†ï¼Œé‚£ä¹ˆè¯·è¿›å…¥2æ­¥ï¼šè¦ä»”ç»†æ€è€ƒé—®é¢˜ä¼šå‡ºåœ¨å“ªäº›ç¯èŠ‚</p><p>B:æ²¡è¯»æ‡‚ï¼Œæ„£æ˜¯ä¸€ç‚¹æ²¡çœ‹æ‡‚ï¼Œè¿›å…¥ç¬¬4æ­¥å§ï¼šgoogle</p><p>C:è¯»äº†ä¸ªåŠæ‡‚ï¼Œæœ‰äº›çœ‰ç›®ä½†æ˜¯ä¸å¤ªèƒ½ç¡®å®šï¼Œç¬¬2æ­¥å’Œç¬¬4æ­¥ç»“åˆç€æ¥ã€‚</p><h1 id="è¦ä»”ç»†æ€è€ƒé—®é¢˜ä¼šå‡ºåœ¨å“ªäº›ç¯èŠ‚ï¼ˆé‡è¦ï¼‰"><a href="#è¦ä»”ç»†æ€è€ƒé—®é¢˜ä¼šå‡ºåœ¨å“ªäº›ç¯èŠ‚ï¼ˆé‡è¦ï¼‰" class="headerlink" title="è¦ä»”ç»†æ€è€ƒé—®é¢˜ä¼šå‡ºåœ¨å“ªäº›ç¯èŠ‚ï¼ˆé‡è¦ï¼‰"></a>è¦ä»”ç»†æ€è€ƒé—®é¢˜ä¼šå‡ºåœ¨å“ªäº›ç¯èŠ‚ï¼ˆé‡è¦ï¼‰</h1><p>å½“ä½ è¯»æ‡‚äº†ä¸€ä¸ªé—®é¢˜ä¹‹åï¼Œè¦å¥½å¥½çš„æ€è€ƒè¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šåœ¨å“ªäº›ç¯èŠ‚ä¸Šå‡ºé”™ã€‚</p><p>ä¸€è¾†æ±½è½¦ä»æ€»æˆå“çº¿ä¸Šä¸‹æ¥ï¼Œè½¦é—¨å­å…³ä¸ä¸Šï¼ å“ªé”™äº†ï¼Ÿä½ æ€ä¹ˆæŸ¥ï¼Ÿ å½“ç„¶æ˜¯é¡ºç€ç”Ÿäº§çº¿ä¸€ç«™ä¸€ç«™çš„æŸ¥ä¸‹æ¥ã€‚ ç¨‹åºä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿæ˜¯ä¸€ç³»åˆ—è¯­å¥å®Œæˆåäº§ç”Ÿçš„ç»“æœã€‚</p><p>å†™ä¸€ä¸ªç½‘ç»œç¨‹åºï¼Œæ€»æ˜¯å‘ç°æœåŠ¡å™¨ç«¯æ‰“å°ä¸å‡ºæ¥æ”¶çš„æ•°æ®ï¼Œæœ‰å‡ ä¸ªç¯èŠ‚ä¼šå‡ºé”™ï¼Ÿä»”ç»†åˆ†æè¿™ä¸ªç°è±¡çš„ç¯èŠ‚ï¼š</p><p>å®¢æˆ·ç«¯äº§ç”Ÿæ•°æ®-&gt;æŒ‰â€œå‘é€â€æŒ‰é’®-&gt;å‘é€åˆ°æœåŠ¡å™¨-&gt;æœåŠ¡å™¨æ¥æ”¶åˆ°åæ‰“å°</p><p>è¿™å‡ ä¸ªç¯èŠ‚éƒ½æœ‰å¯èƒ½ä¼šå‡ºé”™ï¼š</p><p>æœ‰å¯èƒ½å®¢æˆ·ç«¯æ ¹æœ¬å°±æ²¡äº§ç”Ÿæ•°æ®ï¼Œæœ‰å¯èƒ½å‘é€æŒ‰é’®æŒ‰ä¸‹å»åæ ¹æœ¬å°±æ²¡å‘å‡ºå»ï¼Œæˆ–è€…å‘å‡ºå»çš„ä¸æ˜¯ä½ äº§ç”Ÿçš„ä¸œè¥¿ï¼Œæˆ–è€…æ ¹æœ¬å°±æ²¡è¿æ¥ç½‘ç»œï¼Œæˆ–è€…å‘é€å‡ºå»æœåŠ¡å™¨æ²¡æœ‰æ¥æ”¶åˆ°ï¼Œæˆ–è€…æ¥æ”¶åˆ°ä¹‹å‰å°±æ‰“å°äº†ç­‰ç­‰ç­‰ç­‰ã€‚</p><p>å­¦ç€å»è¿™æ ·ä»”ç»†çš„åˆ†æç¨‹åºçš„ç¯èŠ‚å’Œè¿™äº›ç¯èŠ‚å¯èƒ½ä¼šäº§ç”Ÿçš„é—®é¢˜ï¼Œä½ çš„ç»éªŒå€¼å®šç„¶ä¼šå¤§å¹…åº¦å¿«é€Ÿçš„æå‡ï¼Œè¿™æ ·åšå¾ˆç´¯äººï¼Œä½†æ˜¯ä¸€ä»¶äº‹æƒ…å¦‚æœåšä¸‹æ¥ä¸€ç‚¹éƒ½ä¸ç´¯çš„è¯ï¼Œè¿™ä¸ªä¸œè¥¿è¿˜æœ‰ä»·å€¼å—ï¼Ÿ</p><p>åœ¨ç½‘é¡µAè¾“å…¥äº†ä¸€ä¸ªäººçš„åå­—ï¼Œæäº¤åˆ°Bï¼Œé¦–å…ˆå­˜å‚¨åˆ°æ•°æ®åº“ï¼Œç„¶åå†è¯»å‡ºæ¥ï¼Œå‘ç°ä¹±ç ï¼æ€ä¹ˆåŠï¼Ÿå½“ç„¶æ˜¯åˆ†æç¯èŠ‚ï¼š</p><p>å®¢æˆ·è¾“å…¥-&gt;HTTPå‘é€-&gt;Bæ¥æ”¶-&gt;å­˜å‚¨åˆ°æ•°æ®åº“-&gt;è¯»å‡º-&gt;å±•ç°åˆ°ç½‘é¡µ</p><p>æ¯ä¸ªç¯èŠ‚éƒ½å¯èƒ½å‡ºé—®é¢˜ï¼Œæ€ä¹ˆæ‰èƒ½çŸ¥é“å“ªé‡Œå‡ºçš„é—®é¢˜ï¼Ÿç»§ç»­å¾€ä¸‹è¯»ã€‚</p><h1 id="å¦‚ä½•å®šä½é”™è¯¯ï¼ˆé‡è¦ï¼‰"><a href="#å¦‚ä½•å®šä½é”™è¯¯ï¼ˆé‡è¦ï¼‰" class="headerlink" title="å¦‚ä½•å®šä½é”™è¯¯ï¼ˆé‡è¦ï¼‰"></a>å¦‚ä½•å®šä½é”™è¯¯ï¼ˆé‡è¦ï¼‰</h1><p><strong>åˆ†ææ¸…æ¥šæœ‰å“ªäº›ç¯èŠ‚ä¹‹åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å®šä½åˆ°åº•ä»€ä¹ˆç¯èŠ‚å‡ºé”™äº†</strong></p><p>å®šä½æœ‰ä»¥ä¸‹ä¸‰ç§åŠæ³•ï¼š</p><p>A æ‰“å°è¾“å‡ºï¼Œæ¯”å¦‚javaçš„System.out.println()ï¼Œæ¯”å¦‚jsçš„alert()ï¼Œè¿™ç§åŠæ³•å¸¸ç”¨ï¼Œå¿…é¡»æŒæ¡</p><p>B Debugï¼Œå¯ä»¥å‚è€ƒæˆ‘ä»¬çš„è§†é¢‘ã€Šå¦å…‹å¤§æˆ˜ã€‹ï¼Œè¯¦ç»†è®²äº†Eclipseçš„è°ƒè¯•ã€‚</p><p>C åˆ æ‰ä¸€éƒ¨åˆ†è°ƒè¯•ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯å»æ‰ä¸€éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œåšç®€åŒ–ï¼Œç„¶åè°ƒè¯•å‰©ä¸‹çš„åŠŸèƒ½ï¼ŒJSPå’ŒJavaScriptå¸¸ç”¨ã€‚</p><h1 id="å¦‚æœè¿˜ä¸è¡Œï¼Œgoogleå§"><a href="#å¦‚æœè¿˜ä¸è¡Œï¼Œgoogleå§" class="headerlink" title="å¦‚æœè¿˜ä¸è¡Œï¼Œgoogleå§"></a>å¦‚æœè¿˜ä¸è¡Œï¼Œgoogleå§</h1><p>è¿˜æŸ¥ä¸å‡ºæ¥ï¼Ÿæ­å–œä½ ï¼Œä½ é‡åˆ°çš„é”™è¯¯æ˜¯å€¼å¾—è®¤çœŸå¯¹å¾…çš„é”™è¯¯ï¼Œæ˜¯ä¼šå½±å“ä½ å­¦ä¹ ç”Ÿæ¶¯çš„é”™è¯¯ï¼Œé—®ä¸€ä¸‹googleæˆ–è€…ç™¾åº¦å§ã€‚ç…§ç€ä¸‹é¢çš„æ–¹æ³•æŸ¥æŸ¥çœ‹ã€‚</p><p>å…ˆç²¾åç²—ï¼Œé¦–å…ˆå…ˆè¿›è¡Œå°½é‡ç²¾ç¡®çš„æŸ¥æ‰¾ï¼Œæ¯”å¦‚ä¸€ä¸ªé”™è¯¯ï¼ŒSocketExceptionï¼Œä½ æ€€ç–‘å®ƒæ˜¯åœ¨connect()æ–¹æ³•å‡ºçš„é—®é¢˜ï¼Œé‚£ä¹ˆå½“ç„¶æ˜¯é€‰è¿™æ ·çš„å…³é”®è¯<code>java connect SocketException</code></p><ol><li><p>å…ˆä¸­åè‹±ï¼Œæœ¬ç€ä»¥è§£å†³é—®é¢˜ä¸ºä¸»çš„æƒ³æ³•ï¼Œç»ƒä¹ è‹±æ–‡è¿˜æ˜¯å…ˆæ”¾åœ¨ä¸€è¾¹å§ï¼Œé¦–å…ˆåº”è¯¥åœ¨ä¸­æ–‡ç½‘é¡µä¸­æŸ¥è¯¢ï¼Œè¿˜ä¸è¡Œçš„è¯ï¼Œæœç´¢è‹±æ–‡çš„å§ã€‚æœ‰å¾ˆå¤šä¸œè¥¿å°±åƒä¸€å±‚çª—æˆ·çº¸ï¼Œè¿œçœ‹ç°è’™è’™æ€ªå”¬äººçš„ï¼Œä½ å£®ç€èƒ†å­ä¸€æ…ï¼Œå®ƒå°±ç ´äº†ã€‚é˜…è¯»è‹±æ–‡çš„ä¹¦ç±å°±æ˜¯å¦‚æ­¤ï¼Œä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£ä¹ˆå›°éš¾(å®å¯åœ¨æ²™åœºä¸Šæˆ˜æ­»ï¼Œä¹Ÿä¸èƒ½è¢«å“æ­»ä¸æ˜¯å—)</p></li><li><p>ä¿¡æ¯ç­›é€‰ï¼Œæœç´¢å‡ºæ¥çš„ç»“æœä¸è§å¾—èƒ½å¤Ÿå®Œå…¨åŒ¹é…ï¼Œå»ºè®®å¤§å®¶å¤šé˜…è¯»å‰å‡ é¡µçš„æœç´¢ç»“æœï¼Œå¤šæ‰“å¼€å‡ ä¸ªç½‘é¡µçœ‹çœ‹ï¼Œä¸è¿‡ï¼Œæˆ‘çš„ç»éªŒæ˜¯è¶…è¿‡3é¡µä¸€èˆ¬å°±æ²¡æ„ä¹‰äº†ï¼Œæ‰€ä»¥è¶…è¿‡3é¡µè¿˜æ²¡æœ‰æ‰¾åˆ°åˆé€‚çš„ç­”æ¡ˆï¼Œæˆ–è®¸åº”è¯¥è°ƒæ•´ä¸€ä¸‹å…³é”®è¯ï¼Œæˆ–è€…æ”¾ç²—æ•´ä¸ªæœç´¢çš„ç»“æœäº†ã€‚</p></li><li><p>ç»å¸¸çš„è¿›è¡ŒçŸ¥è¯†éš¾ç‚¹çš„æŸ¥è¯¢ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜ç‰µæ‰¯çš„é¢æ¯”è¾ƒå¹¿ï¼Œå°±å¹²è„†åˆ°ç½‘ä¸Šæœç´¢ä¸€äº›ç›¸å…³çš„ä¸“é¢˜ï¼Œæ¯”å¦‚â€œjava ä¹±ç  mysqlâ€ â€œoracle åˆ›å»ºç”¨æˆ·â€ç­‰ç­‰ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œä¸è¦çŠ¯æ‡’ï¼Œå‹¤åŠ¨æ‰‹å†™ä¸€äº›å°å°çš„æµ‹è¯•ç¨‹åºï¼Œæ¥å¼„æ˜ç™½çŸ¥è¯†ç‚¹çš„ç»†èŠ‚ã€‚è¿™ä¹Ÿæ˜¯æ¶¨çŸ¥è¯†çš„é‡è¦çš„é€”å¾„ã€‚</p></li></ol><h1 id="ä»€ä¹ˆï¼Ÿè¿˜ä¸è¡Œï¼Ÿé‚£ä¹ˆå°±BBSå§"><a href="#ä»€ä¹ˆï¼Ÿè¿˜ä¸è¡Œï¼Ÿé‚£ä¹ˆå°±BBSå§" class="headerlink" title="ä»€ä¹ˆï¼Ÿè¿˜ä¸è¡Œï¼Ÿé‚£ä¹ˆå°±BBSå§"></a>ä»€ä¹ˆï¼Ÿè¿˜ä¸è¡Œï¼Ÿé‚£ä¹ˆå°±BBSå§</h1><p>å¦‚æœå®åœ¨è¿˜ä¸è¡Œï¼Œå°±åˆ°BBSä¸Šé¢é—®ä¸€é—®é«˜æ‰‹å§ã€‚ åˆ°å“ªä¸ªBBSä¸Šï¼Ÿ</p><p>googleæˆ–è€…ç™¾åº¦ä¸å°±è¡Œäº†ä¹ˆï¼Ÿå…³é”®è¯â€œjavaè®ºå›â€â€œjava bbsâ€</p><p>ç„¶ååœ¨æœç´¢ç»“æœé‡Œå¥½å¥½çš„çœ‹çœ‹é‚£äº›æ´»åŠ¨é¢‘ç¹çš„è®ºå›ï¼Œä»¥åå°±æ˜¯ä½ ç»å¸¸å…‰é¡¾çš„åœ°æ–¹äº†ã€‚CSDNè®ºå›é¦–é¡µå°±å¾ˆä¸é”™ã€‚</p><p>å‘åˆ«äººæé—®æ˜¯éå¸¸éœ€è¦æŠ€å·§çš„ï¼</p><p>æ›¾ç»æœ‰äººé—®æˆ‘è¿™æ ·çš„é—®é¢˜ï¼šâ€œè¯·é—®å¦‚ä½•æ‰èƒ½å­¦å¥½javaå‘¢ï¼Ÿâ€è¿™ä¸ªè¦æ±‚å¤ªæ³›æ³›äº†ã€‚è¿˜æœ‰äººç»™æˆ‘ä¸€æ®µä»£ç ç”šè‡³jaråŒ…ä¹Ÿå¯„è¿‡æ¥ï¼Œç„¶åè¯´è€å¸ˆçš„æˆ‘çš„ä»£ç ä¸­æœ‰ä¸ªé”™è¯¯æ‚¨å¸®æˆ‘æŸ¥æŸ¥ã€‚</p><p>æˆ‘æ²¡æœ‰åŠæ³•å»èŠ±å¤§é‡çš„æ—¶é—´å»ºç«‹ç¯å¢ƒå»è°ƒè¯•ä¸€ä¸ªè¿˜ä¸çŸ¥é“å­˜åœ¨ä¸å­˜åœ¨çš„é”™è¯¯ï¼</p><p>è¿˜æœ‰äººåœ¨BBSä¸Šé—®è¿™æ ·çš„é—®é¢˜ï¼šâ€œæ˜¯å¦æœ‰äººèƒ½å¸®æˆ‘å®Œæˆä¸€ä¸ªå®Œæ•´èŠå¤©çš„ç¨‹åºï¼Ÿè¯·å¸®æˆ‘å†™ä¸€ä¸ªç™»é™†æ¨¡å—å§ï¼â€</p><p>è¿™ä¸ªè¦æ±‚æœ‰äº›è¿‡åˆ†äº†ï¼Œæœ‰äººå¸®ä½ åšæ˜¯ä½ çš„è¿æ°”ï¼Œæ²¡æœ‰äººå¸®ä½ æ˜¯æ­£å¸¸ååº”ã€‚</p><p>å‘åˆ«äººæé—®ï¼Œåº”è¯¥é¦–å…ˆç¡®å®šä½ å·²ç»åšäº†è‡ªå·±åº”è¯¥åšçš„äº‹ï¼Œç®€å•è¯´æ˜¯æˆ‘å‰é¢åˆ—ä¸¾çš„1ï¼Œ2ï¼Œ3ï¼Œ4æ­¥ä½ éƒ½ä½œè¿‡äº†ï¼Œç„¶åå†æ±‚åŠ©äºäººã€‚ä¸è¦æ²¡æœ‰ç»è¿‡è®¤çœŸæ€è€ƒå°±è‰ç‡çš„å‘åˆ«äººæé—®ï¼Œè‡ªå·±ä¹Ÿä¸ä¼šæœ‰é•¿è¶³è¿›æ­¥çš„ã€‚</p><p>é‚£æˆ‘è¯¥æ€ä¹ˆæ ·å‘åˆ«äººæé—®å‘¢ï¼Ÿ</p><p>åœ¨googleæˆ–ç™¾åº¦æœç´¢ã€Šæé—®çš„æ™ºæ…§ã€‹ï¼Œä½ ä¼šæ‰¾åˆ°ç­”æ¡ˆã€‚</p><p>åœ¨è¿™é‡Œæˆ‘ç»™å‡ºä¸€ä¸ªé“¾æ¥<br>ï¼<a href="https://github.com/ryanhanwu/How-To-Ask-Questions-The-Smart-Way/blob/master/README-zh_CN.md" target="_blank" rel="noopener">æé—®çš„æ™ºæ…§</a>ï¼Œç£¨åˆ€ä¸è¯¯ç æŸ´åŠŸï¼Œå…ˆèŠ±ç‚¹æ—¶é—´å»é˜…è¯»ä¸€ä¸‹å§ã€‚</p><p>å¾—åˆ°åˆ«äººçš„å›ç­”ï¼Œè¦æ‡‚å¾—æ„Ÿæ©ã€‚ä¸éœ€è¦å»å†™ä¿¡æ„Ÿè°¢ï¼Œä¸éœ€è¦æ”¯ä»˜è´¹ç”¨ï¼Œä¸éœ€è¦é‚£äº›èŠ±è¨€å·§è¯­ï¼Œåšåˆ°ä¸‹é¢è¿™ä¸€ç‚¹å°±å¤Ÿäº†ï¼š</p><p>å½“ä½ é€æ­¥æˆä¸ºé«˜æ‰‹çš„æ—¶å€™ï¼Œè¦å›ç­”åˆ«äººåœ¨è®ºå›ä¸Šæå‡ºçš„é—®é¢˜ï¼Œæœ‰æ—¶é—´æœ‰ç²¾åŠ›çš„å‰æä¹‹ä¸‹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹æ€è€ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–¹æ³•è®º </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¦‚æœä½ çœŸçš„æƒ³åšä¸€ä»¶äº‹ï¼Œä½ ä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•</title>
      <link href="/there-is-away/"/>
      <url>/there-is-away/</url>
      
        <content type="html"><![CDATA[<blockquote><p>å†™åšå®¢è¿™ä»¶äº‹æƒ…ç»™æˆ‘æœ€å¤§çš„ä½“ä¼šå°±æ˜¯ï¼Œä¸€ä»¶äº‹æƒ…å¦‚æœä½ èƒ½å¤ŸåšæŒåš8å¹´ï¼Œé‚£ä¹ˆä¸ç®¡æ•ˆç‡å’Œé¢‘ç‡å¤šä½ï¼Œæœ€ç»ˆæ€»èƒ½å–å¾—ä¸€äº›å¾ˆå¯è§‚çš„æ”¶ç›Šã€‚è€Œå¦ä¸€ä¸ªä½“ä¼šå°±æ˜¯ï¼Œä¸€ä»¶äº‹æƒ…åªè¦ä½ åšæŒå¾—è¶³å¤Ÿä¹…ï¼Œâ€œåšæŒâ€å°±ä¼šæ…¢æ…¢å˜æˆâ€œä¹ æƒ¯â€ã€‚åŸæœ¬éœ€è¦è´¹åŠ›å»é©±åŠ¨çš„äº‹æƒ…ä¾¿æˆäº†å®¶å¸¸ä¾¿é¥­ï¼Œäº‘æ·¡é£è½»ã€‚â€“åˆ˜æœªé¹</p></blockquote><a id="more"></a><p>åˆ†äº«ä¸€ä¸ªæˆ‘éå¸¸å–œæ¬¢çš„æ•…äº‹ï¼Œè¿™ç¯‡æ–‡ç« å¯¹æˆ‘å½±å“å¾ˆæ·±ï¼Œæ¯å½“æˆ‘æƒ³æ”¾å¼ƒæˆ‘çš„è®¡åˆ’æ—¶ï¼Œå°±ä¼šå“èµ·è¿™å¥è¯ï¼š <strong>Where there is a willï¼Œthere is away</strong>ã€‚ç„¶åæˆ‘çš„è®¡åˆ’å°±åˆèƒ½ç»§ç»­ä¸‹å»äº†ã€‚è¿™å¥è¯å°±æ˜¯æ„å¿—åŠ›æœ€ç›´æ¥çš„ä½“ç°ï¼Œç»ä¸æ”¾å¼ƒè‡ªå·±æƒ³åšçš„äº‹ï¼Œä¸ç®¡å‘ç”Ÿä»€ä¹ˆäº‹æƒ…ï¼Œä½ ä¸€å®šä¼šæƒ³åˆ°ä¸€ä¸ªè§£å†³è¿™ä»¶äº‹çš„åŠæ³•ã€‚</p><p>å¸Œæœ›æ¯ä¸ªèƒ½çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„äººï¼Œè¦è¦è®°å¾—ä¸‹é¢çš„è¯ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">å¦‚æœä½ çœŸçš„æƒ³åšä¸€ä»¶äº‹ï¼Œä½ ä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•ï¼›</span><br><span class="line">å¦‚æœä½ ä¸æƒ³åšä¸€ä»¶äº‹ï¼Œä½ ä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªå€Ÿå£ã€‚</span><br></pre></td></tr></table></figure><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1953 å¹´11æœˆ13æ—¥ï¼Œä¸¹éº¦é¦–éƒ½å“¥æœ¬å“ˆæ ¹ã€‚æ¶ˆé˜²é˜Ÿçš„ç”µè¯æ€»æœºåœ¨æ¸…æ™¨ä¸‰ç‚¹æ”¶åˆ°ä¸€ä¸ªç”µè¯ã€‚äºŒåäºŒå²çš„å¹´é’æ¶ˆé˜²å‘˜åŸƒé‡Œå¸Œåœ¨å€¼ç­ã€‚<br>ã€€ã€€ã€Œå–‚å–‚ï¼è¿™é‡Œæ˜¯æ¶ˆé˜²é˜Ÿã€ã€‚ç”µè¯çš„é‚£ç«¯æ²¡äººå›ç­”ï¼Œå¯æ˜¯åŸƒé‡Œå¸Œå¬åˆ°ä¸€æ²‰é‡çš„å‘¼å¸å£°ã€‚<br>ã€€ã€€åæ¥ä¸€ä¸ªååˆ†æ¿€åŠ¨çš„å£°éŸ³ï¼Œè¯´ï¼šã€Œæ•‘å‘½ï¼Œæ•‘å‘½å•Šï¼æˆ‘ç«™ä¸èµ·æ¥ï¼æˆ‘çš„è¡€åœ¨æµï¼ã€<br>ã€€ã€€ã€Œåˆ«æ…Œï¼Œå¤ªå¤ªã€ï¼ŒåŸƒé‡Œå¸Œå›ç­”ï¼Œã€Œæˆ‘ä»¬é©¬ä¸Šå°±åˆ°ï¼Œæ‚¨åœ¨é‚£é‡Œï¼Ÿã€<br>ã€€ã€€ã€Œæˆ‘ä¸çŸ¥é“ã€‚ã€<br>ã€€ã€€ã€Œä¸åœ¨æ‚¨çš„å®¶é‡Œï¼Ÿã€<br>ã€€ã€€ã€Œæ˜¯çš„ï¼Œæˆ‘æƒ³æ˜¯åœ¨å®¶é‡Œã€‚ã€<br>ã€€ã€€ã€Œå®¶åœ¨å“ªé‡Œï¼Œå“ªæ¡è¡—ï¼Ÿã€<br>ã€€ã€€ã€Œæˆ‘ä¸çŸ¥é“ï¼Œæˆ‘çš„å¤´æ™•ï¼Œæˆ‘åœ¨æµè¡€ã€‚ã€<br>ã€€ã€€ã€Œæ‚¨è‡³å°‘è¦å‘Šè¯‰æˆ‘æ‚¨å«ä»€ä¹ˆåå­—ï¼ã€<br>ã€€ã€€ã€Œæˆ‘è®°ä¸å¾—äº†ï¼Œæˆ‘æƒ³æˆ‘æ’åˆ°äº†å¤´ã€‚ã€<br>ã€€ã€€ã€Œè¯·ä¸è¦æŠŠç”µè¯æŒ‚æ‰ã€‚ã€<br>ã€€ã€€åŸƒé‡Œå¸Œæ‹¿èµ·ç¬¬äºŒå…·ç”µè¯ï¼Œæ‹¨åˆ°ç”µè¯å…¬å¸ï¼Œå›ç­”ä»–çš„æ˜¯ä¸€ä¸ªå¹´è€çš„ç”·å£«ã€‚<br>ã€€ã€€ã€Œè¯·æ‚¨å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¸€ä¸ªç”µè¯å®¢æˆ·çš„å·ç ï¼Œè¿™å®¢æˆ·ç°åœ¨æ­£å’Œæ¶ˆé˜²æ€»é˜Ÿé€šç”µè¯ã€‚ã€<br>ã€€ã€€ã€Œä¸ï¼Œæˆ‘ä¸èƒ½ï¼Œæˆ‘æ˜¯å®ˆå¤œçš„è­¦å«ï¼Œæˆ‘ä¸æ‡‚è¿™äº›äº‹ã€‚è€Œä¸”ä»Šå¤©æ˜¯æ˜ŸæœŸå…­ï¼Œæ²¡æœ‰ä»»ä½•äººåœ¨ã€‚ã€<br>ã€€ã€€åŸƒé‡Œå¸ŒæŒ‚ä¸Šç”µè¯ã€‚ä»–æœ‰äº†å¦ä¸€ä¸ªä¸»æ„ï¼Œäºæ˜¯é—®é‚£å¥³äººï¼šã€Œä½ æ€æ ·æ‰¾åˆ°æ¶ˆé˜²é˜Ÿçš„ç”µè¯å·ç çš„ï¼Ÿã€<br>ã€€ã€€ã€Œå·ç å†™åœ¨ç”µè¯æœºä¸Šï¼Œæˆ‘è·Œå€’æ—¶æŠŠå®ƒç»™æ‹–ä¸‹æ¥äº†ã€‚ã€<br>ã€€ã€€ã€Œé‚£æ‚¨çœ‹çœ‹ç”µè¯æœºä¸Šæ˜¯å¦ä¹Ÿæœ‰æ‚¨å®¶çš„ç”µè¯å·ç ã€‚ã€<br>ã€€ã€€ã€Œæ²¡æœ‰ï¼Œæ²¡æœ‰åˆ«çš„ä»»ä½•å·ç ã€‚è¯·ä½ ä»¬å¿«ç‚¹æ¥å•Šï¼ã€é‚£å¥³äººçš„å£°éŸ³æ„ˆæ¥æ„ˆå¼±ã€‚<br>ã€€ã€€ã€Œè¯·æ‚¨å‘Šè¯‰æˆ‘ï¼Œæ‚¨èƒ½çœ‹åˆ°ä»€ä¹ˆä¸œè¥¿ï¼Ÿã€<br>ã€€ã€€ã€Œæˆ‘â€¦æˆ‘çœ‹åˆ°çª—å­ï¼Œçª—å¤–ï¼Œè¡—ä¸Šï¼Œæœ‰ä¸€ç›è·¯ç¯ã€‚ã€<br>ã€€ã€€å¥½å•Šâ”€â”€åŸƒé‡Œå¸Œæƒ³â”€â”€å¥¹å®¶é¢å‘å¤§è¡—ï¼Œè€Œä¸”å¿…å®šæ˜¯åœ¨ä¸€å±‚ä¸å¤ªé«˜çš„æ¥¼ä¸Šï¼Œå› ä¸ºå¥¹çœ‹å¾—è§è·¯ç¯ã€‚ã€Œçª—æˆ·æ˜¯æ€æ ·çš„ï¼Ÿã€ä»–ç»§ç»­æŸ¥é—®ï¼Œã€Œæ˜¯æ­£æ–¹å½¢çš„å—ï¼Ÿã€<br>ã€€ã€€ã€Œä¸ï¼Œæ˜¯é•¿æ–¹å½¢çš„ã€‚ã€<br>ã€€ã€€é‚£ä¹ˆï¼Œä¸€å®šæ˜¯åœ¨ä¸€ä¸ªæ—§åŒºå†…ã€‚<br>ã€€ã€€ã€Œæ‚¨ç‚¹äº†ç¯å—ï¼Ÿã€<br>ã€€ã€€ã€Œæ˜¯çš„ï¼Œç¯äº®ç€ã€‚ã€<br>ã€€ã€€åŸƒé‡Œå¸Œè¿˜æƒ³é—®ï¼Œä½†ä¸å†æœ‰å£°éŸ³å›ç­”äº†ã€‚<br>ã€€ã€€éœ€è¦èµ¶å¿«é‡‡å–è¡ŒåŠ¨ï¼ä½†æ˜¯åšä»€ä¹ˆï¼Ÿ<br>ã€€ã€€åŸƒé‡Œå¸Œæ‰“ç”µè¯ç»™ä¸Šå¸ï¼Œå‘ä»–é™ˆè¿°æ¡ˆæƒ…ã€‚<br>ã€€ã€€ä¸Šå¸è¯´ï¼šã€Œä¸€ç‚¹åŠæ³•ä¹Ÿæ²¡æœ‰ã€‚ä¸å¯èƒ½æ‰¾åˆ°é‚£ä¸ªå¥³äººã€‚è€Œä¸”ï¼Œã€ä»–å‡ ä¹ç”Ÿèµ·æ°”æ¥ï¼Œã€Œé‚£å¥³äººå äº†æˆ‘ä»¬çš„ä¸€æ¡ç”µè¯çº¿ï¼Œè¦æ˜¯å“ªé‡Œå‘ç”Ÿç«è­¦ï¼Ÿã€<br>ã€€ã€€ä½†æ˜¯åŸƒé‡Œå¸Œä¸æ„¿æ”¾å¼ƒã€‚æ•‘å‘½æ˜¯æ¶ˆé˜²é˜Ÿå‘˜çš„é¦–è¦èŒè´£ï¼ä»–æ˜¯è¿™æ ·è¢«æ•™å¯¼çš„ã€‚<br>ã€€ã€€çªç„¶ï¼Œä»–å…´èµ·ä¸€ä¸ªç–¯ç‹‚çš„å¿µå¤´ã€‚ä¸Šå¸å¬äº†ï¼Œå“åäº†ï¼šã€Œäººä»¬ä¼šä»¥ä¸ºåŸå­æˆ˜äº‰çˆ†å‘äº†ï¼ã€ä»–è¯´ã€‚ã€Œåœ¨æ·±å¤œï¼Œåœ¨å“¥æœ¬å“ˆæ ¹è¿™æ ·ä¸€ä¸ªå¤§éƒ½ä¼šé‡Œ â€¦â€¦ã€<br>ã€€ã€€ã€Œæˆ‘æ³æ±‚æ‚¨ï¼ã€åŸƒé‡Œå¸ŒåšæŒï¼Œã€Œæˆ‘ä»¬å¿…é¡»èµ¶å¿«è¡ŒåŠ¨ï¼Œå¦åˆ™å…¨éƒ½å¾’åŠ³æ— ç›Šï¼ã€<br>ã€€ã€€ç”µè¯çº¿çš„å¦ä¸€ç«¯é™é»˜äº†ç‰‡åˆ»ï¼Œè€ŒååŸƒé‡Œå¸Œå¬åˆ°ç­”å¤ï¼šã€Œå¥½çš„ï¼Œæˆ‘ä»¬å°±è¿™ä¹ˆåšã€‚æˆ‘é©¬ä¸Šæ¥ã€‚ã€<br>ã€€ã€€åäº”åˆ†é’Ÿåï¼ŒäºŒåè¾†æ•‘ç«è½¦åœ¨åŸä¸­å‘å‡ºå“äº®çš„è­¦ç¬›å£°ï¼Œæ¯è¾†è½¦åœ¨ä¸€ä¸ªåŒºåŸŸå†…å››é¢å…«æ–¹çš„è·‘ã€‚<br>ã€€ã€€é‚£å¥³äººå·²ç»ä¸èƒ½å†è¯´è¯äº†ï¼Œä½†åŸƒé‡Œå¸Œä»å¬åˆ°å¥¹é‚£æ€¥ä¿ƒçš„å‘¼å¸å£°ã€‚<br>ã€€ã€€ååˆ†é’ŸååŸƒé‡Œå¸Œå–Šè¯´ï¼šã€Œæˆ‘å¬åˆ°ç”µè¯é‡Œä¼ æ¥è­¦ç¬›å£°ï¼ã€<br>ã€€ã€€é˜Ÿé•¿é€è¿‡æ”¶å‘å¯¹è®²æœºï¼Œä¸‹ä»¤ï¼šã€Œä¸€å·è½¦ï¼Œç†„ç­è­¦ç¬›ï¼ã€è€Œåè½¬é—®åŸƒé‡Œå¸Œã€‚<br>ã€€ã€€ã€Œæˆ‘è¿˜å¬åˆ°è­¦ç¬›å£°ï¼ã€ä»–ç­”è¯´ã€‚<br>ã€€ã€€ã€ŒäºŒå·è½¦ï¼Œç†„ç­è­¦ç¬›ï¼ã€<br>ã€€ã€€ã€Œæˆ‘è¿˜å¬å¾—è§â€¦ ã€‚ã€<br>ã€€ã€€ç›´åˆ°ç¬¬åäºŒè¾†è½¦ï¼ŒåŸƒé‡Œå¸Œå–Šè¯´ï¼šã€Œæˆ‘ç°åœ¨å¬ä¸è§äº†ã€‚ã€<br>ã€€ã€€é˜Ÿé•¿ä¸‹ä»¤ï¼šã€ŒåäºŒå·è½¦ï¼Œå†æ”¾è­¦ç¬›ã€‚ã€<br>ã€€ã€€åŸƒé‡Œå¸Œå‘ŠçŸ¥ï¼šã€Œæˆ‘ç°åœ¨åˆå¬åˆ°äº†ï¼Œä½†è¶Šèµ°è¶Šè¿œï¼ã€<br>ã€€ã€€ã€ŒåäºŒå·è½¦æ‰å›å¤´ï¼ã€é˜Ÿé•¿ä¸‹ä»¤ã€‚<br>ã€€ã€€ä¸ä¹…ï¼ŒåŸƒé‡Œå¸Œå–Šé“ï¼šã€Œåˆé€æ¸åœ°è¿‘äº†ï¼Œç°åœ¨å£°éŸ³éå¸¸åˆºè€³ï¼Œåº”è¯¥åˆšå¥½åˆ°äº†æ­£ç¡®çš„è·¯ä¸Šã€‚ã€<br>ã€€ã€€ã€ŒåäºŒå·è½¦ï¼Œä½ ä»¬æ‰¾ä¸€ä¸ªæœ‰ç¯å…‰çš„çª—æˆ·ï¼ã€<br>ã€€ã€€ã€Œæœ‰ä¸Šç™¾ç›çš„ç¯åœ¨äº®ç€ï¼Œäººä»¬å‡ºç°åœ¨çª—å£ä¸ºçœ‹å‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼ã€<br>ã€€ã€€ã€Œåˆ©ç”¨æ‰©éŸ³æœºï¼ã€é˜Ÿé•¿ä¸‹ä»¤ã€‚<br>ã€€ã€€åŸƒé‡Œå¸Œç»ç”±ç”µè¯å¬åˆ°æ‰©éŸ³æœºçš„å£°éŸ³ï¼šã€Œå„ä½å¥³å£«å’Œå…ˆç”Ÿï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªç”Ÿå‘½æœ‰ä¸¥é‡å±é™©çš„å¦‡å¥³ã€‚æˆ‘ä»¬çŸ¥é“å¥¹åœ¨ä¸€é—´æœ‰ç¯å…‰çš„æˆ¿é—´é‡Œï¼Œè¯·ä½ ä»¬å…³æ‰ä½ ä»¬çš„ç¯ã€‚ã€<br>ã€€ã€€æ‰€æœ‰çš„çª—æˆ·éƒ½å˜é»‘äº†ï¼Œé™¤äº†ä¸€ä¸ªã€‚<br>ã€€ã€€è¿‡äº†ä¸€ä¼šå„¿ï¼ŒåŸƒé‡Œå¸Œå¬åˆ°æ¶ˆé˜²é˜Ÿå‘˜é—¯å…¥æˆ¿é—´ï¼Œè€Œåä¸€ä¸ªç”·éŸ³å‘å¯¹è®²æœºè¯´ï¼šã€Œè¿™å¥³äººå·²å¤±å»çŸ¥è§‰ï¼Œä½†è„‰æä»åœ¨è·³åŠ¨ã€‚æˆ‘ä»¬ç«‹åˆ»æŠŠå¥¹é€åˆ°åŒ»é™¢ã€‚æˆ‘ç›¸ä¿¡æœ‰æ•‘ã€‚ã€<br>ã€€ã€€æµ·ä¼¦ï¼ç´¢æ©è¾¾â”€â”€è¿™æ˜¯é‚£å¥³äººçš„åå­—â”€â”€çœŸçš„è·æ•‘äº†ã€‚å¥¹è‹é†’äº†ï¼Œå‡ ä¸ªæ˜ŸæœŸåï¼Œä¹Ÿæ¢å¤äº†è®°å¿†ã€‚<br>ã€€ã€€<strong>å¦‚æœä½ çœŸçš„æƒ³åšä¸€ä»¶äº‹ï¼Œä½ ä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªæ–¹æ³•ï¼›å¦‚æœä½ ä¸æƒ³åšä¸€ä»¶äº‹ï¼Œä½ ä¸€å®šä¼šæ‰¾åˆ°ä¸€ä¸ªå€Ÿå£ã€‚</strong>ã€Œ <em>Where there is a willï¼Œthere is a way</em>ã€‚ã€</p>]]></content>
      
      
      <categories>
          
          <category> è¯»ä¹¦ </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Spring äº‹åŠ¡</title>
      <link href="/Spring-Transaction/"/>
      <url>/Spring-Transaction/</url>
      
        <content type="html"><![CDATA[<h1 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h1><ol><li>äº‹åŠ¡ï¼šé€»è¾‘ä¸Šçš„ä¸€ç»„æ“ä½œ,è¿™ç»„æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸ,è¦ä¹ˆå…¨éƒ¨å¤±è´¥</li><li>äº‹åŠ¡å››å¤§ç‰¹æ€§<ul><li><strong>åŸå­æ€§</strong>: äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½,äº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿ,è¦ä¹ˆéƒ½ä¸å‘ç”Ÿ</li><li><strong>ä¸€è‡´æ€§</strong>: äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´(ä¾‹å¦‚:ä¸¤ä¸ªäººè½¬è´¦,è½¬è´¦å‰åæ€»é‡‘é¢çš„æ•°ç›®éƒ½æ˜¯å›ºå®šçš„)</li><li><strong>éš”ç¦»æ€§</strong>: å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶,ä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶ä»–ç”¨æˆ·çš„äº‹åŠ¡æ‰€å¹²æ‰°,å¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´æ•°æ®è¦ç›¸äº’éš”ç¦»(ä¾‹å¦‚:å‡è®¾æœ‰ä¸¤ä¸ªäº‹åŠ¡åŒæ—¶åœ¨æ“ä½œæ•°æ®åº“,ä¾‹å¦‚å¼ ä¸‰ä¿®æ”¹ä¸€ä¸ªè®°å½•,åŒæ—¶æå››ä¹Ÿåœ¨ä¿®æ”¹è¿™ä¸ªè®°å½•,ä¼šå¯¼è‡´è¯¥è®°å½•è¢«é‡å¤ä¿®æ”¹,æˆ–è€…ç¬¬ä¸€æ¬¡ä¿®æ”¹çš„è®°å½•è¢«ç¬¬äºŒæ¬¡è®°å½•ç»™è¦†ç›–æ‰)</li><li><strong>æŒä¹…æ€§</strong>: ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦è¢«æäº¤,å®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„,å³ä½¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“</li></ul></li></ol><a id="more"></a><h1 id="äº‹åŠ¡éš”ç¦»"><a href="#äº‹åŠ¡éš”ç¦»" class="headerlink" title="äº‹åŠ¡éš”ç¦»"></a>äº‹åŠ¡éš”ç¦»</h1><p>é€šå¸¸æ¥è¯´ï¼Œåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œä¼šåŒæ—¶æœ‰å¤šä¸ªç”¨æˆ·è®¿é—®æ•°æ®åº“ï¼Œåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæœ‰ï¼Œä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜</p><ol><li><strong>è„è¯»</strong><br> ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡æ”¹å†™ä½†è¿˜æœªæäº¤çš„æ•°æ®ï¼Œå¦‚æœè¿™äº›æ•°æ®è¢«å›æ»šï¼Œåˆ™è¯»åˆ°çš„æ•°æ®æ˜¯æ— æ•ˆçš„ã€‚</li><li><strong>ä¸å¯é‡å¤è¯»</strong><br> åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå¤šæ¬¡è¯»å–åŒä¸€æ•°æ®è¿”å›çš„ç»“æœæœ‰æ‰€ä¸åŒã€‚</li><li><strong>å¹»è¯»</strong>(â€œå¹»è¯»â€æ˜¯ä¸å¯é‡å¤è¯»çš„ä¸€ç§ç‰¹æ®Šåœºæ™¯)<br> ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å‡ è¡Œè®°å½•åï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ’å…¥ä¸€äº›è®°å½•ï¼Œå¹»è¯»å°±å‘ç”Ÿäº†ã€‚å†åæ¥çš„æŸ¥è¯¢ä¸­ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡å°±ä¼šå‘ç°æœ‰äº›åŸæ¥æ²¡æœ‰çš„è®°å½•ã€‚</li></ol><p><strong>DBMSé€šè¿‡åŠ é”æ¥è¿›è¡Œå¹¶å‘æ§åˆ¶ï¼Œä¸åŒçš„éš”ç¦»çº§åˆ«æ‹¥æœ‰ä¸åŒçš„æŒé”æ—¶é—´ã€‚</strong></p><p>â€œCâ€-è¡¨ç¤ºé”ä¼šæŒç»­åˆ°äº‹åŠ¡æäº¤ã€‚ â€œSâ€ â€“è¡¨ç¤ºé”æŒç»­åˆ°å½“å‰è¯­å¥æ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœé”åœ¨è¯­å¥æ‰§è¡Œå®Œæ¯•å°±é‡Šæ”¾åˆ™å¦å¤–ä¸€ä¸ªäº‹åŠ¡å°±å¯ä»¥åœ¨è¿™ä¸ªäº‹åŠ¡æäº¤å‰ä¿®æ”¹é”å®šçš„æ•°æ®ï¼Œä»è€Œé€ æˆæ··ä¹±ã€‚</p><table><thead><tr><th>éš”ç¦»çº§åˆ«l</th><th>å†™æ“ä½œ</th><th>è¯»æ“ä½œ</th><th>èŒƒå›´æ“ä½œ (â€¦whereâ€¦)</th></tr></thead><tbody><tr><td>æœªæäº¤è¯»</td><td>S</td><td>S</td><td>S</td></tr><tr><td>æäº¤è¯»</td><td>C</td><td>S</td><td>S</td></tr><tr><td>å¯é‡å¤è¯»</td><td>C</td><td>C</td><td>S</td></tr><tr><td>å¯åºåˆ—åŒ–</td><td>C</td><td>C</td><td>C</td></tr></tbody></table><p><strong>éš”ç¦»çº§åˆ«</strong></p><ol><li>æœªæäº¤è¯»(<code>READ_UNCOMMITED</code>);<br>å…è®¸ä½ è¯»å–è¿˜æœªæäº¤çš„æ”¹å˜äº†çš„æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´è„ï¼Œå¹»ï¼Œä¸å¯é‡å¤è¯»ã€‚</li><li>æäº¤è¯»(<code>READ_COMMINTED</code>):<br>å…è®¸åœ¨å¹¶å‘äº‹åŠ¡å·²ç»æäº¤åè¯»å–ï¼Œå¯é˜²æ­¢è„è¯»ï¼Œä½†å¹»è¯»å’Œä¸å¯é‡å¤è¯»è¿˜æ˜¯æœ‰å¯èƒ½å‘ç”Ÿã€‚</li><li>å¯é‡å¤è¯»(<code>REPEATABLE_READ</code>):<br>å¯¹ç›¸åŒå­—æ®µçš„å¤šæ¬¡è¯»å–æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®è¢«äº‹åŠ¡æœ¬èº«æ”¹å˜ï¼Œå¯é˜²æ­¢è„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»æœ‰å¯èƒ½å‡ºç°ã€‚</li><li>å¯åºåˆ—åŒ–(<code>SERILIZABLE</code>):<br>å®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ï¼Œç¡®ä¿ä¸å‘ç”Ÿè„è¯»ï¼Œå¹»è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œè¿™åœ¨æ‰€æœ‰çš„éš”ç¦»çº§åˆ«ä¸­æ˜¯æœ€æ…¢çš„ï¼Œå®ƒæ˜¯å…¸å‹çš„å®Œå…¨é€šè¿‡é”å®šåœ¨äº‹åŠ¡ä¸­æ¶‰åŠçš„æ•°æ®è¡¨æ¥å®Œæˆçš„ã€‚</li></ol><p>å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th>å¹»å½±è¯»</th></tr></thead><tbody><tr><td>æœªæäº¤è¯»</td><td>å¯èƒ½å‘ç”Ÿ</td><td>å¯èƒ½å‘ç”Ÿ</td><td>å¯èƒ½å‘ç”Ÿ</td></tr><tr><td>æäº¤è¯»</td><td>-</td><td>å¯èƒ½å‘ç”Ÿ</td><td>å¯èƒ½å‘ç”Ÿ</td></tr><tr><td>å¯é‡å¤è¯»</td><td>-</td><td>-</td><td>å¯èƒ½å‘ç”Ÿ</td></tr><tr><td>å¯åºåˆ—åŒ–</td><td>-</td><td>-</td><td>-</td></tr></tbody></table><p>TransactionDefinitionå®šä¹‰äº‹åŠ¡éš”ç¦»çº§åˆ«</p><p><strong>é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«</strong></p><p>é™¤äº†ä»¥ä¸Šçš„æ•°æ®åº“æä¾›çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œspringæä¾›äº†Defaultéš”ç¦»çº§åˆ«ï¼Œè¯¥çº§åˆ«è¡¨ç¤ºspringä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«ã€‚</p><ul><li>MySQLï¼šREPATABLE_READ(å¯èƒ½å‡ºç°å¹»è¯»)</li><li>Oracleï¼šREAD_COMMITTED(å¯èƒ½å‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»)</li></ul><p><strong>å¹¶å‘æ“ä½œæ€ä¹ˆè®¾ç½®æ•°æ®åº“éš”ç¦»çº§åˆ«</strong></p><p>è¿™ä¸ªè¦çœ‹ä½ å…·ä½“ä½¿ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ä½ æ˜¯å¹¶å‘çš„æ—¶å€™å»å†™ï¼Œè¿˜æ˜¯å»è¯»ï¼Œè¿˜æ˜¯å»è¯»å†™ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯è¯»å†™ï¼Œé‚£ä¹ˆä¸€èˆ¬æ˜¯ repeatable readï¼Œè™½ç„¶ä»–æœ‰å¹»è¯»å¾—å¯èƒ½æ€§ï¼Œä½†æ˜¯ä¸€èˆ¬å»å‘ç”Ÿå¹»è¯»å¾—ä¸šåŠ¡æ˜¯ä¸å¸¸è§çš„ã€‚</p><h1 id="äº‹åŠ¡ä¼ æ’­è¡Œä¸º"><a href="#äº‹åŠ¡ä¼ æ’­è¡Œä¸º" class="headerlink" title="äº‹åŠ¡ä¼ æ’­è¡Œä¸º"></a>äº‹åŠ¡ä¼ æ’­è¡Œä¸º</h1><p>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼šè§£å†³ä¸šåŠ¡å±‚çš„æ–¹æ³•ä¹‹é—´çš„ç›¸äº’è°ƒç”¨çš„é—®é¢˜(åœ¨è°ƒç”¨æ–¹æ³•çš„è¿‡ç¨‹ä¸­,äº‹åŠ¡æ˜¯å¦‚ä½•ä¼ é€’çš„)</p><p>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºæœ‰ä¸ƒç§ï¼Œåˆåˆ†ä¸ºä¸‰ç±»ï¼š</p><ol><li>å¦‚æœ A æ–¹æ³•ä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™è°ƒç”¨ B æ–¹æ³•æ—¶å°±ç”¨è¯¥äº‹åŠ¡ï¼Œå³ï¼šAå’ŒBæ–¹æ³•åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚<ul><li><strong>PROPAGATION_REQUIRED</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è°ƒç”¨ B æ–¹æ³•æ—¶å°±åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå³ï¼šAå’ŒBæ–¹æ³•åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ã€‚</li><li><strong>PROPAGATION_SUPPORTS</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è°ƒç”¨ B æ–¹æ³•æ—¶å°±ä¸ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚</li><li><strong>PROPAGATION_MANDATORY</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è°ƒç”¨ B æ–¹æ³•æ—¶å°±æŠ›å‡ºå¼‚å¸¸ã€‚</li></ul></li><li>A æ–¹æ³•å’Œ B æ–¹æ³•ä¸åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢ã€‚<ul><li><strong>PROPAGATION_REQUIRES_NEW</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·å¹¶æ–°å»ºä¸€ä¸ªäº‹åŠ¡ç»™ B æ–¹æ³•ã€‚</li><li><strong>PROPAGATION_NOT_SUPPORTED</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·ã€‚</li><li><strong>PROPAGATION_NEVER</strong>ï¼šå¦‚æœ A æ–¹æ³•ä¸­æœ‰äº‹åŠ¡ï¼Œåˆ™æŠ¥å¼‚å¸¸ã€‚</li></ul></li><li>å¦‚æœ A æ–¹æ³•æœ‰çš„äº‹åŠ¡æ‰§è¡Œå®Œï¼Œè®¾ç½®ä¸€ä¸ªä¿å­˜ç‚¹ï¼Œå¦‚æœ B æ–¹æ³•ä¸­äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œå¯ä»¥æ»šå›ä¿å­˜ç‚¹æˆ–åˆå§‹çŠ¶æ€ã€‚<ul><li><strong>PROPAGATION_NESTED</strong> ï¼šå¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™åµŒå¥—äº‹åŠ¡æ‰§è¡Œ</li></ul></li></ol><p>é‡ç‚¹çš„ä¸‰ç§ï¼š</p><ul><li>PROPAGATION_REQUIRED</li><li>PROPAGATION_REQUIRES_NEW</li><li>PROPAGATION_NESTED</li></ul><h1 id="Springäº‹åŠ¡ç®¡ç†"><a href="#Springäº‹åŠ¡ç®¡ç†" class="headerlink" title="Springäº‹åŠ¡ç®¡ç†"></a>Springäº‹åŠ¡ç®¡ç†</h1><p>Springå°†äº‹åŠ¡ç®¡ç†åˆ†æˆäº†ä¸¤ç±»:</p><ul><li>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†<ul><li>æ‰‹åŠ¨ç¼–å†™ä»£ç è¿›è¡Œäº‹åŠ¡ç®¡ç†(å¾ˆå°‘ä½¿ç”¨)</li></ul></li><li>å£°æ˜å¼äº‹åŠ¡ç®¡ç†<ul><li>åŸºäºTransactionProxyFactoryBeançš„æ–¹å¼(å¾ˆå°‘ä½¿ç”¨),éœ€è¦ä¸ºæ¯ä¸ªè¿›è¡Œäº‹åŠ¡ç®¡ç†çš„ç±»,é…ç½®ä¸€ä¸ªTransactionProxyFactoryBeanè¿›è¡Œå¢å¼º</li><li>åŸºäºAspectJçš„xmlæ–¹å¼(ç»å¸¸ä½¿ç”¨),ä¸€æ—¦é…ç½®å¥½,ç±»ä¸Šä¸éœ€è¦æ·»åŠ ä»»ä½•ä¸œè¥¿</li><li>åŸºäºæ³¨è§£(ç»å¸¸ä½¿ç”¨),é…ç½®ç®€å•,éœ€è¦åœ¨ä¸šåŠ¡å±‚ç±»ä¸Šæ·»åŠ ä¸€ä¸ª@Transactionlçš„æ³¨è§£</li></ul></li></ul><h1 id="ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†"><a href="#ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†" class="headerlink" title="ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†"></a>ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†</h1><h2 id="TransactionProxyFactoryBean"><a href="#TransactionProxyFactoryBean" class="headerlink" title="TransactionProxyFactoryBean"></a>TransactionProxyFactoryBean</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"accountServiceProxy"</span> <span class="attr">class</span>=<span class="string">"org.springframework.transaction.interceptor.TransactionProxyFactoryBean"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"target"</span> <span class="attr">ref</span>=<span class="string">"accountService"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionManager"</span> <span class="attr">ref</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"transactionAttributes"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                   propæ ¼å¼ï¼š</span></span><br><span class="line"><span class="comment">                       * PROPAGATIONï¼šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</span></span><br><span class="line"><span class="comment">                       * ISOLATIONï¼šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="comment">                       * readOnlyï¼šåªè¯»(ä¸å¯ä»¥è¿›è¡Œä¿®æ”¹,æ’å…¥,åˆ é™¤çš„æ“ä½œ)</span></span><br><span class="line"><span class="comment">                       * -Exceptionï¼šå‘ç”Ÿå“ªäº›å¼‚å¸¸å›æ»šäº‹åŠ¡</span></span><br><span class="line"><span class="comment">                       * +Exceptionï¼šå‘ç”Ÿå“ªäº›å¼‚å¸¸äº‹åŠ¡ä¸å›æ»š</span></span><br><span class="line"><span class="comment">                 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"transfer"</span>&gt;</span>PROPAGATION_REQUIRED,readOnly<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="AspectJ"><a href="#AspectJ" class="headerlink" title="AspectJ"></a>AspectJ</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡çš„é€šçŸ¥ï¼ˆäº‹åŠ¡çš„å¢å¼ºï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                propagationï¼šä¼ æ’­è¡Œä¸º</span></span><br><span class="line"><span class="comment">                isolationï¼šéš”ç¦»çº§åˆ«</span></span><br><span class="line"><span class="comment">                read-onlyï¼šåªè¯»</span></span><br><span class="line"><span class="comment">                rollback-forï¼šå‘ç”Ÿå“ªäº›å¼‚å¸¸æ—¶å›æ»š</span></span><br><span class="line"><span class="comment">                no-rollback-forï¼šå‘ç”Ÿå“ªäº›å¼‚å¸¸æ—¶ä¸å›æ»š</span></span><br><span class="line"><span class="comment">                timeoutï¼šè¿‡æœŸä¿¡æ¯</span></span><br><span class="line"><span class="comment">             --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"transfer"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®aopåˆ‡é¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®åˆ‡å…¥ç‚¹ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">expression</span>=<span class="string">"execution(* net.morethink.service.AccountService+.*(..))"</span> <span class="attr">id</span>=<span class="string">"pointcut1"</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®åˆ‡é¢ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut-ref</span>=<span class="string">"pointcut1"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Transactionl"><a href="#Transactionl" class="headerlink" title="@Transactionl"></a>@Transactionl</h2><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒæ–‡æ¡£</p><ol><li><a href="https://zh.wikipedia.org/wiki/%E4%BA%8B%E5%8B%99%E9%9A%94%E9%9B%A2" target="_blank" rel="noopener">äº‹åŠ¡éš”ç¦»-ç»´åŸºç™¾ç§‘</a></li><li><a href="https://www.ibm.com/developerworks/cn/education/opensource/os-cn-spring-trans/" target="_blank" rel="noopener">å…¨é¢åˆ†æ Spring çš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†åŠå£°æ˜å¼äº‹åŠ¡ç®¡ç†-IBM</a></li><li><a href="http://www.cnblogs.com/xrq730/p/5454381.html" target="_blank" rel="noopener">MyBatis6ï¼šMyBatisé›†æˆSpringäº‹ç‰©ç®¡ç†ï¼ˆä¸‹ç¯‡ï¼‰-åšå®¢å›­</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Spring </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CentOS7ä¸‹ Javaã€Tomcatã€MySQLã€Mavençƒ­éƒ¨ç½²</title>
      <link href="/Linux-Java/"/>
      <url>/Linux-Java/</url>
      
        <content type="html"><![CDATA[<p>æœ¬æ–‡ä»‹ç»äº†CentOS7 64ä½ä¸‹Javaã€Tomcatã€MySQLã€Mavençƒ­éƒ¨ç½²ç­‰æœåŠ¡å™¨ç¯å¢ƒçš„æ­å»ºå’Œè°ƒè¯•è¿‡ç¨‹ã€‚</p><p>å­¦ç”ŸæœåŠ¡å™¨èµ„æºè·å–æ–¹æ³•ï¼š</p><ol><li><a href="https://www.qcloud.com/act/campus" target="_blank" rel="noopener">äº‘+æ ¡å›­è®¡åˆ’ - è…¾è®¯äº‘</a></li><li>é˜¿é‡Œäº‘äº‘ç¿¼è®¡åˆ’</li><li>github å­¦ç”ŸåŒ…ï¼Œé‡Œé¢æœ‰Digital Ocean 50ç¾å…ƒçš„VPSå¯ç”¨</li></ol><p>å·²ç»å°†æ‰€éœ€è¦çš„å·¥å…·(Xshell,Xftpã€FileZillaç­‰sftpä¸Šä¼ å·¥å…·ï¼Œjdk-8u101-linux-x64.tar.gzå’Œapache-tomcat-9.0.0.M10.tar.gz)ä¸Šä¼ è‡³ç™¾åº¦äº‘ <a href="http://pan.baidu.com/s/1qYRms8G" target="_blank" rel="noopener">http://pan.baidu.com/s/1qYRms8G</a></p><a id="more"></a><h1 id="Javaç¯å¢ƒé…ç½®"><a href="#Javaç¯å¢ƒé…ç½®" class="headerlink" title="Javaç¯å¢ƒé…ç½®"></a>Javaç¯å¢ƒé…ç½®</h1><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>é€šè¿‡<code>uname -r</code>åˆ¤æ–­ç³»ç»Ÿæ˜¯å¤šå°‘ä½</p><ul><li>64ä½ ï¼š å‡ºç°x86_64</li><li>32ä½ ï¼š å‡ºç°i686æˆ–i386</li></ul><h2 id="å®‰è£…Java-JDK8-0"><a href="#å®‰è£…Java-JDK8-0" class="headerlink" title="å®‰è£…Java JDK8.0"></a>å®‰è£…Java JDK8.0</h2><ol><li>å»ºç«‹Javaç›®å½•ï¼Œå­˜æ”¾Javaå’ŒTomcat<ul><li>cd /usr/local/</li><li>mkdir Java</li><li>cd Java</li></ul></li><li>ä½¿ç”¨FileZillaå°†ä¸‹è½½å¥½çš„jdk-8u101-linux-x64.tar.gz å’Œ apache-tomcat-9.0.0.M10.tar.gzä¸Šä¼ è‡³Javaç›®å½•ä¸‹(ä¼ é€çš„å›½å¤–æœåŠ¡å™¨å¾ˆæ…¢,å›½å†…å‡ ä¹æ˜¯å›½å¤–çš„åå€ï¼Œä½†æ˜¯ä¹Ÿåªæœ‰ä¸¤ä¸‰ç™¾KBï¼Œä¹Ÿå¯èƒ½æ˜¯ç”µè„‘é—®é¢˜)</li><li>å°†ä¸Šä¼ çš„jdkè§£å‹ï¼Œç„¶åé‡å‘½åä¸ºjdk<ul><li>tar -zxv -f  jdk-8u101-linux-x64.tar.gz</li><li>mv jdk1.8.0_101  jdk</li><li>cd jdk</li></ul></li><li><p>é…ç½®ç¯å¢ƒå˜é‡Environment=JAVA_HOME=/usr/local/Java/jdk</p><ol><li>vim /etc/profile</li><li><p>æ‰“å¼€ä¹‹åæŒ‰é”®ç›˜ï¼ˆiï¼‰è¿›å…¥ç¼–è¾‘æ¨¡å¼,å°†ä¸‹é¢çš„å†…å®¹å¤åˆ¶åˆ°åº•éƒ¨</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">JAVA_HOME=/usr/local/Java/jdk</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">CLASSPATH=$JAVA_HOME/jre/lib/ext:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH JAVA_HOME CLASSPATH</span><br></pre></td></tr></table></figure></li><li><p>å†™å®Œä¹‹åæˆ‘ä»¬æŒ‰é”®ç›˜ï¼ˆESCï¼‰æŒ‰é’®é€€å‡ºï¼Œç„¶åæŒ‰ï¼ˆ:wqï¼‰ä¿å­˜å¹¶ä¸”å…³é—­Vimã€‚</p></li><li>ä½¿ç”¨ <code>source /etc/profile</code>å‘½ä»¤ä½¿å…¶ç«‹å³ç”Ÿæ•ˆ</li><li>é€šè¿‡<code>java -version</code>éªŒè¯Javaæ˜¯å¦é…ç½®æˆåŠŸã€‚</li></ol></li></ol><h1 id="å®‰è£…Tomcat9"><a href="#å®‰è£…Tomcat9" class="headerlink" title="å®‰è£…Tomcat9"></a>å®‰è£…Tomcat9</h1><ol><li>åœ¨Javaç›®å½•ä¸‹è§£å‹ä¸Šé¢ä¸€æ­¥å·²ç»ä¸Šä¼ ä¸Šå»çš„Tomcat9.0<ul><li>tar -zxv -f apache-tomcat-9.0.0.M10.tar.gz</li><li>mv apache-tomcat-9.0.0.M10 tomcat</li><li>cd tomcat</li></ul></li><li>å¯åŠ¨å‘½ä»¤ä¸º /usr/local/Java/tomcat/bin/startup.sh</li><li>å¯åŠ¨å®Œæˆåè¿˜éœ€å¼€æ”¾8080ç«¯å£(CentOS7è¿™ä¸ªç‰ˆæœ¬çš„é˜²ç«å¢™é»˜è®¤ä½¿ç”¨çš„æ˜¯firewallï¼Œä¸ä¹‹å‰çš„ç‰ˆæœ¬ä½¿ç”¨iptablesä¸ä¸€æ ·ã€‚ <strong>å…³äºé˜²ç«å¢™ç«¯å£å¯ä»¥æŸ¥çœ‹åé¢çš„å‚è€ƒæ–‡æ¡£</strong>)<ul><li>firewall-cmd â€“zone=public â€“add-port=8080/tcp â€“permanent<br>å‡ºç°successè¡¨æ˜æ·»åŠ æˆåŠŸ</li><li>æ›´æ–°é˜²ç«å¢™è§„åˆ™å³å¯ï¼š firewall-cmd â€“reload</li><li>é‡å¯é˜²ç«å¢™ systemctl restart firewalld.service</li></ul></li><li>ç„¶åå†æ¬¡åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://ip:8080ï¼Œå¦‚æœçœ‹åˆ°tomcatç³»ç»Ÿç•Œé¢ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚" target="_blank" rel="noopener">http://ip:8080ï¼Œå¦‚æœçœ‹åˆ°tomcatç³»ç»Ÿç•Œé¢ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚</a></li><li>Tomcat 8080 ç«¯å£æ— æ³•è®¿é—®<ul><li>æŸ¥çœ‹8080ç«¯å£è¢«é‚£ä¸ªç¨‹åºå ç”¨(åº”è¯¥æ˜¯Java) netstat -anp ç„¶åå†æ€æ­»å ç”¨è¿›ç¨‹ã€‚</li><li><strong>å¯èƒ½æ˜¯ä½ çš„æœåŠ¡å™¨æä¾›å•†æœ‰å®‰å…¨ç»„æ¥æ§åˆ¶ç«¯å£ï¼Œä½ éœ€è¦å»æä¾›å•†é‚£é‡Œå¼€å¯ç«¯å£(PSï¼šæˆ‘çš„é˜¿é‡Œäº‘æœåŠ¡å™¨å°±æ˜¯å¿…é¡»è¦è®¾ç½®ç«¯å£å®‰å…¨ç»„æ‰å¯ä»¥è®¿é—®ç«¯å£)</strong></li></ul></li><li>å…³é—­å‘½ä»¤ä¸º /usr/local/Java/tomcat/bin/shutdown.sh</li></ol><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="å®‰è£…MySQL"><a href="#å®‰è£…MySQL" class="headerlink" title="å®‰è£…MySQL"></a>å®‰è£…MySQL</h2><p>CentOS 7çš„yumæºä¸­è²Œä¼¼æ²¡æœ‰æ­£å¸¸å®‰è£…mysqlæ—¶çš„mysql-severæ–‡ä»¶ï¼Œéœ€è¦å»å®˜ç½‘ä¸Šä¸‹è½½</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># wget http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm</span><br><span class="line"># rpm -ivh mysql-community-release-el7-5.noarch.rpm</span><br><span class="line"># yum install mysql-community-server</span><br></pre></td></tr></table></figure><p>æˆåŠŸå®‰è£…ä¹‹åé‡å¯mysqlæœåŠ¡ã€‚<br>åˆæ¬¡å®‰è£…mysqlæ˜¯rootè´¦æˆ·æ˜¯æ²¡æœ‰å¯†ç çš„<br>è®¾ç½®å¯†ç çš„æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># systemctl start mysqld.service</span><br><span class="line"></span><br><span class="line"># mysql -uroot</span><br><span class="line"># mysql&gt;set password = password(&quot;ä½ çš„å¯†ç &quot;);</span><br><span class="line"># mysql&gt;flush privileges;</span><br><span class="line"># mysql&gt; exit</span><br></pre></td></tr></table></figure><h2 id="è¿œç¨‹è¿æ¥"><a href="#è¿œç¨‹è¿æ¥" class="headerlink" title="è¿œç¨‹è¿æ¥"></a>è¿œç¨‹è¿æ¥</h2><p>è¿›å…¥MySQLåé€šè¿‡<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO &apos;root&apos;@&apos;%&apos; IDENTIFIED BY &apos;ä½ çš„å¯†ç &apos; WITH GRANT OPTION;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥å…è®¸ä»»æ„ä¸»æœºè®¿é—®ä½ åœ¨æœåŠ¡å™¨æ­å»ºçš„MySQLï¼Œå¯ä»¥å§<code>%</code>æ›´æ¢ä¸ºä½ éœ€è¦å…è®¸çš„IPå’Œä¸»æœºã€‚</p><p>ä½†æ˜¯ï¼Œåœ¨æˆ‘è¿›è¡Œè¿œç¨‹è¿æ¥çš„æ—¶å€™å‘ç”Ÿå¦‚ä¸‹é”™è¯¯<br><img src="https://images.morethink.cn/mysql-2003-error.png" alt=""><br>å¯ä»¥æ ¹æ®ä¸‹é¢è¿›è¡Œæ’é”™</p><ol><li>æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è®¿é—®ï¼Œæ˜¯å¦èƒ½ping é€š</li><li>å®‰å…¨ç»„åŠç«¯å£å·æ˜¯å¦æ‰“å¼€æˆ–è€…è¢«å ç”¨</li><li>æœåŠ¡å™¨æ˜¯å¦è¿è¡Œæˆ–è€…å…³é—­åªå…è®¸æœ¬æœºè®¿é—®</li><li>é‡å¯è¯•è¯•</li></ol><p>å½“æˆ‘æ’é™¤ä¸Šé¢3ä¸­æƒ…å†µåï¼Œå‘ç°å±äºç¬¬å››ä¸­ï¼Œå¯èƒ½æ˜¯å› ä¸ºè¿˜æ²¡æœ‰ç«‹å³ç”Ÿæ•ˆã€‚</p><h2 id="ä¸­æ–‡ä¹±ç é—®é¢˜"><a href="#ä¸­æ–‡ä¹±ç é—®é¢˜" class="headerlink" title="ä¸­æ–‡ä¹±ç é—®é¢˜"></a>ä¸­æ–‡ä¹±ç é—®é¢˜</h2><p>åœ¨æˆ‘å»ºç«‹æ•°æ®æ—¶å‘ç°ä¸­æ–‡æ— æ³•æ’å…¥ï¼Œäºæ˜¯æŸ¥çœ‹ä½¿ç”¨<code>show variables like &#39;character%&#39;;</code><br>å¦‚å›¾æ‰€ç¤ºï¼Œå‘ç°é»˜è®¤ä¸æ˜¯utf-8ï¼Œäºæ˜¯é€šè¿‡åœ¨CentOS7ä¸­ä¿®æ”¹æ–‡ä»¶/usr/share/mysql/my-default.cnfï¼Œåœ¨[mysqld]ï¼Œ[mysql]ï¼Œ[client]ä¸‹åˆ†åˆ«æ·»åŠ å¦‚ä¸‹å†…å®¹<br><img src="https://images.morethink.cn/msql-chinese-fail.jpg" alt=""><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">collation-server = utf8_unicode_ci</span><br><span class="line">init-connect=&apos;SET NAMES utf8&apos;</span><br><span class="line">character_set_server = utf8</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line"></span><br><span class="line">default-character-set=utf8</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line"></span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹å®Œæˆåï¼Œé‡å¯mysqlæœåŠ¡ï¼Œsystemctl restart mysqlï¼Œç„¶åè¿›å…¥mysqlï¼Œå†æ¬¡ä½¿ç”¨<code>show variables like &#39;character%&#39;;</code>å‘½ä»¤æŸ¥çœ‹ï¼Œå¦‚å›¾ï¼Œ<br><img src="https://images.morethink.cn/msql-chinese-success.jpg" alt=""><br>å‘ç°ä¸€æ ·ï¼Œè¯´æ˜utf-8å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯æ— æ³•æ’å…¥ä¸­æ–‡ï¼Œäºæ˜¯çŒœæµ‹å¯èƒ½æ˜¯ç³»ç»ŸåŸç”Ÿä¸æ”¯æŒutf-8ï¼Œæ›´æ”¹ç³»ç»Ÿç¼–ç åå‘ç°æœç„¶å¦‚æ­¤ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># cat /etc/locale.conf</span><br><span class="line">LANG=&quot;en_US.UTF-8&quot;</span><br><span class="line"># vim /etc/locale.conf</span><br><span class="line"># cat /etc/locale.conf</span><br><span class="line">LANG=&quot;zh_CN.UTF-8&quot;</span><br></pre></td></tr></table></figure></p><p>äºæ˜¯æ›´æ”¹ä¸º</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">LANG=&quot;zh_CN.UTF-8&quot;</span><br><span class="line">LANGUAGE=&quot;zh_CN.UTF-8&quot;</span><br><span class="line">SUPPORTED=&quot;zh_CN.UTF-8:zh_CN:zh:en_US.UTF-8:en_US:en&quot;</span><br><span class="line">SYSFONT=&quot;lat0-sun16&quot;</span><br></pre></td></tr></table></figure><p>é‡å¯ç³»ç»Ÿä¹‹åï¼Œå†æ¬¡é‡å¯MySQLæœåŠ¡ã€‚</p><p>å¦‚å›¾ï¼Œå‘ç°å¯ä»¥æ’å…¥ä¸­æ–‡ã€‚</p><p><img src="https://images.morethink.cn/mysql-chinese-success-result.jpg" alt=""></p><h2 id="è§£å†³MySQL5-5å¿˜è®°å¯†ç "><a href="#è§£å†³MySQL5-5å¿˜è®°å¯†ç " class="headerlink" title="è§£å†³MySQL5.5å¿˜è®°å¯†ç "></a>è§£å†³MySQL5.5å¿˜è®°å¯†ç </h2><p>é€šè¿‡è·³è¿‡æƒé™å®‰å…¨æ£€æŸ¥è®¾ç½®æ–°å¯†ç ã€‚</p><ol><li>é¦–å…ˆæ£€æŸ¥mysqlæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œè‹¥å·²å¯åŠ¨åˆ™å…ˆå°†å…¶åœæ­¢æœåŠ¡ï¼Œå¯åœ¨å¼€å§‹èœå•çš„è¿è¡Œï¼Œä½¿ç”¨å‘½ä»¤ï¼š <code>net stop mysql</code><br>ï¼Œç„¶åæ‰“å¼€ç¬¬ä¸€ä¸ªcmd1çª—å£ï¼Œåˆ‡æ¢åˆ°mysqlçš„binç›®å½•ï¼Œè¿è¡Œå‘½ä»¤ï¼š<br><code>mysqld --defaults-file=&quot;C:\Program Files\MySQL\MySQL Server 5.5\my.ini&quot; --console --skip-grant-tables</code>ï¼Œå°†å‘½ä»¤ä¸­çš„MySqlç‰ˆæœ¬æ›´æ¢ä½ çš„ç‰ˆæœ¬ã€‚<br><strong>è¯¥å‘½ä»¤é€šè¿‡è·³è¿‡æƒé™å®‰å…¨æ£€æŸ¥ï¼Œå¼€å¯mysqlæœåŠ¡ï¼Œè¿™æ ·è¿æ¥mysqlæ—¶ï¼Œå¯ä»¥ä¸ç”¨è¾“å…¥ç”¨æˆ·å¯†ç </strong>ã€‚<br>æ­¤æ—¶å·²ç»å¼€å¯äº†mysqlæœåŠ¡äº†ï¼<br><strong>è¿™ä¸ªçª—å£ä¿ç•™ä¸å…³é—­</strong>ã€‚</li><li>æ‰“å¼€ç¬¬äºŒä¸ªcmd2çª—å£ï¼Œè¿æ¥mysql<ul><li>è¾“å…¥å‘½ä»¤ï¼š<code>mysql -u root -p</code><br>å‡ºç°ï¼š <code>Enter password:</code> ï¼Œåœ¨è¿™é‡Œç›´æ¥å›è½¦ï¼Œä¸ç”¨è¾“å…¥å¯†ç ã€‚ ç„¶åå°±å°±ä¼šå‡ºç°ç™»å½•æˆåŠŸçš„ä¿¡æ¯ã€‚</li><li>ä½¿ç”¨å‘½ä»¤åˆ‡æ¢åˆ°mysqlæ•°æ®åº“ï¼š<code>use mysql;</code></li><li>ä½¿ç”¨å‘½ä»¤æ›´æ”¹rootå¯†ç ï¼š<br><code>UPDATE user SET Password=PASSWORD(&#39;newpassword&#39;) where USER=&#39;root&#39;;</code></li><li>åˆ·æ–°æƒé™ï¼š<br><code>FLUSH PRIVILEGES;</code></li><li>ç„¶åé€€å‡ºï¼Œé‡æ–°ç™»å½•ï¼š<br><code>quit</code></li><li>é‡æ–°ç™»å½•ï¼š å¯ä»¥å…³æ‰ä¹‹å‰çš„cmd1 çª—å£äº†ã€‚</li></ul></li><li>ç„¶åç”¨<code>net start mysql</code> å¯åŠ¨æœåŠ¡<ul><li>ç™»å½•ï¼š<code>mysql -u root -p</code></li><li>å‡ºç°è¾“å…¥å¯†ç æç¤ºï¼Œè¾“å…¥æ–°çš„å¯†ç å³å¯ç™»å½•ï¼š<br><code>Enter password: ***********</code></li></ul></li></ol><p>æ˜¾ç¤ºç™»å½•ä¿¡æ¯ï¼š æˆåŠŸ  å°±ä¸€åˆ‡okäº†</p><h1 id="Maven-çƒ­éƒ¨ç½²"><a href="#Maven-çƒ­éƒ¨ç½²" class="headerlink" title="Maven çƒ­éƒ¨ç½²"></a>Maven çƒ­éƒ¨ç½²</h1><p>Maven çƒ­éƒ¨ç½²å¯ä»¥é€šè¿‡ä¸€è¡Œå‘½ä»¤éƒ¨ç½²åˆ°æœ¬åœ°æœåŠ¡å™¨ï¼Œæ²¡æœ‰é—®é¢˜çš„è¯å°±ä¸€è¡Œå‘½ä»¤éƒ¨ç½²åˆ°æ­£å¼æœåŠ¡å™¨ã€‚åŠå…¶æ–¹ä¾¿äº†å¼€å‘å’Œéƒ¨ç½²ã€‚å› ä¸ºæˆ‘çš„Tomcat9é‡åˆ°å¾ˆå¤šé—®é¢˜ã€‚<br>å¯ä»¥å‚è€ƒ <a href="http://www.cnblogs.com/xyb930826/p/5725340.html" target="_blank" rel="noopener">mavenè‡ªåŠ¨éƒ¨ç½²åˆ°è¿œç¨‹tomcatæ•™ç¨‹</a> è¿›è¡Œéƒ¨ç½²å’Œæµ‹è¯•ã€‚</p><p>ä¸‹é¢æ˜¯æˆ‘é‡åˆ°çš„ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºæ²¡æœ‰é…ç½®IDEAçš„make å¯¼è‡´å‡ºé”™ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ERROR] Failed to execute goal org.apache.tomcat.maven:tomcat7-maven-plugin:2.2:deploy (default-cli) on project liwenhao: Cannot invoke Tomcat manager: Connect</span><br><span class="line">ion reset by peer: socket write error -&gt; [Help 1]</span><br><span class="line">[ERROR]</span><br><span class="line">[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.</span><br><span class="line">[ERROR] Re-run Maven using the -X switch to enable full debug logging.</span><br><span class="line">[ERROR]</span><br><span class="line">[ERROR] For more information about the errors and possible solutions, please read the following articles:</span><br><span class="line">[ERROR] [Help 1]</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥é€šè¿‡å°†makeå¦‚ä¸‹é…ç½®<br><img src="https://images.morethink.cn/make-maven-goal.jpg" alt=""><br>å³å¯æˆåŠŸ</p><p><strong>waråŒ…éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¹±ç </strong></p><p><img src="https://images.morethink.cn/maven-war-messy-code.jpg" alt=""><br>å¯ä»¥é€šè¿‡é…ç½®å¦‚ä¸‹å±æ€§ï¼Œè§£å†³ä¸­æ–‡waråŒ…æœåŠ¡å™¨ä¹±ç ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure></p><p>é…ç½®å®Œå›¾ã€‚<br><img src="https://images.morethink.cn/maven-war-code-success.jpg" alt=""></p><p>åœ¨æˆ‘é€šè¿‡<code>mvn tomcat7:deploy</code>å‘½ä»¤çƒ­éƒ¨ç½²æ—¶ï¼Œä¼šå‡ºç°mysqlæ— æ³•è¿æ¥çš„æƒ…å†µï¼Œåæ¥åœ¨æˆ‘é‡æ–°è¿›è¡Œçƒ­éƒ¨ç½²çš„æ—¶å€™ï¼Œæ²¡æœ‰å‡ºç°è¿™ä¸ªé—®é¢˜ã€‚<br><strong>çŒœæµ‹</strong><br>åº”è¯¥æ˜¯æˆ‘çš„é…ç½®æ–‡ä»¶çš„é—®é¢˜</p><p><strong>å‚è€ƒæ–‡æ¡£</strong></p><ol><li><a href="http://www.centoscn.com/CentOS/config/2016/0511/7218.html" target="_blank" rel="noopener">centos 7 å¼€æ”¾ 80ç«¯å£</a></li><li><a href="http://www.cnblogs.com/weiok/p/5086971.html" target="_blank" rel="noopener">centos7 è®¾ç½®ä¸­æ–‡</a></li><li><a href="https://zhangzifan.com/centos-7-remove-mysql.html" target="_blank" rel="noopener">CentOS 7ä¸‹å½»åº•å¸è½½MySQLæ•°æ®åº“</a></li><li>CentOS7 <strong>è¿œç¨‹è®¿é—®MySQL</strong><ul><li><a href="http://blog.sina.com.cn/s/blog_5da16ee20102x47h.html" target="_blank" rel="noopener">Centos 7 mysql 5.7 ç»™rootå¼€å¯è¿œç¨‹è®¿é—®æƒé™ï¼Œä¿®æ”¹rootå¯†ç </a></li><li><strong><a href="http://www.aiezu.com/db/mysql_cant_connect_through_socket.html" target="_blank" rel="noopener">è¿æ¥Mysqlæç¤ºCanâ€™t connect to local MySQL server through socketçš„è§£å†³æ–¹æ³•</a></strong></li></ul></li><li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-apache-tomcat-8-on-centos-7" target="_blank" rel="noopener">How To Install Apache Tomcat 8 on CentOS 7</a></li><li><a href="http://www.cnblogs.com/linuxnotes/archive/2013/03/09/2951101.html" target="_blank" rel="noopener">windowsç¯å¢ƒä¸­mysqlå¿˜è®°rootå¯†ç çš„è§£å†³åŠæ³•</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS7 </tag>
            
            <tag> Tomcat </tag>
            
            <tag> MySQL </tag>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å‰ç«¯é€šè¿‡Nginxåå‘ä»£ç†è§£å†³è·¨åŸŸé—®é¢˜</title>
      <link href="/Nginx-Cross-Domain/"/>
      <url>/Nginx-Cross-Domain/</url>
      
        <content type="html"><![CDATA[<p>åœ¨å‰é¢å†™çš„ä¸€ç¯‡æ–‡ç« <a href="http://www.cnblogs.com/morethink/p/6525216.html" target="_blank" rel="noopener">SpringMVCè§£å†³è·¨åŸŸé—®é¢˜</a>ï¼Œæˆ‘ä»¬æ¢è®¨äº†ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜ä»¥åŠSpringMVCæ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜ï¼Œè§£å†³æ–¹å¼ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹å¼:</p><ol><li>JSONP</li><li>CORS</li><li>WebSocket</li></ol><p>å¯æ˜¯è¿™å‡ ç§æ–¹å¼éƒ½æ˜¯åŸºäºæœåŠ¡å™¨é…ç½®çš„ï¼Œå³å¯¹äºè‡ªå·±çš„ç½‘ç«™æ˜¯å¯ä»¥é€šè¿‡è¿™å‡ ç§æ–¹å¼è§£å†³çš„ï¼Œå¯æ˜¯ç°åœ¨é‡åˆ°å¦ä¸€ä¸ªéœ€æ±‚(å‰é¢æåˆ°è¿‡ï¼Œå†™æ‰‡è´æ’ä»¶ï¼Œæˆ‘ä»¬ä¸èƒ½æ›´æ”¹æ‰‡è´çš„æœåŠ¡å™¨é…ç½®ï¼Œä¹Ÿä¸èƒ½å‘çŸ­ä¿¡å«ä»–ä»¬ç»™æˆ‘é…ç½®ä¸€ä¸‹)ã€‚</p><p>æœ¬æ–‡æ¢è®¨äº†å‰ç«¯å¦‚ä½•é€šè¿‡Nginxåå‘ä»£ç†çš„æ–¹å¼è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p><a id="more"></a><h1 id="è·¨åŸŸ"><a href="#è·¨åŸŸ" class="headerlink" title="è·¨åŸŸ"></a>è·¨åŸŸ</h1><p>å†æ¬¡é‡ç”³ï¼š <strong>è·¨åŸŸæ˜¯æµè§ˆå™¨è¡Œä¸ºï¼Œä¸æ˜¯æœåŠ¡å™¨è¡Œä¸ºã€‚</strong></p><p>å®é™…ä¸Šï¼Œè¯·æ±‚å·²ç»åˆ°è¾¾æœåŠ¡å™¨äº†ï¼Œåªä¸è¿‡åœ¨å›æ¥çš„æ—¶å€™è¢«æµè§ˆå™¨é™åˆ¶äº†ã€‚å°±åƒPythonä»–å¯ä»¥è¿›è¡ŒæŠ“å–æ•°æ®ä¸€æ ·ï¼Œä¸ç»è¿‡æµè§ˆå™¨è€Œå‘èµ·è¯·æ±‚æ˜¯å¯ä»¥å¾—åˆ°æ•°æ®ï¼Œæƒ³åˆ°é€šè¿‡Nginxçš„åå‘ä»£ç†æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚</p><h1 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h1><p>æ‰€è°“ä»£ç†å°±æ˜¯åœ¨æˆ‘ä»¬å’ŒçœŸå®çš„æœåŠ¡å™¨ä¹‹é—´æœ‰ä¸€å°ä»£ç†æœåŠ¡å™¨ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯é€šè¿‡å®ƒæ¥è¿›è¡Œè½¬æ¥çš„ã€‚</p><h2 id="æ­£å‘ä»£ç†"><a href="#æ­£å‘ä»£ç†" class="headerlink" title="æ­£å‘ä»£ç†"></a>æ­£å‘ä»£ç†</h2><p>æ­£å‘ä»£ç†å°±æ˜¯æˆ‘ä»¬è®¿é—®ä¸äº†Googleï¼Œä½†æ˜¯æˆ‘åœ¨å›½å¤–æœ‰ä¸€å°vpsï¼Œå®ƒå¯ä»¥è®¿é—®Googleï¼Œæˆ‘è®¿é—®å®ƒï¼Œå«å®ƒè®¿é—®Googleåï¼ŒæŠŠæ•°æ®ä¼ ç»™æˆ‘ã€‚</p><p>å¦‚å›¾ï¼š</p><p><img src="https://images.morethink.cn/proxy.jpg" alt="" title="æ­£å‘ä»£ç†"></p><h2 id="åå‘ä»£ç†"><a href="#åå‘ä»£ç†" class="headerlink" title="åå‘ä»£ç†"></a>åå‘ä»£ç†</h2><blockquote><p>å¤§å®¶éƒ½æœ‰è¿‡è¿™æ ·çš„ç»å†ï¼Œæ‹¨æ‰“10086å®¢æœç”µè¯ï¼Œå¯èƒ½ä¸€ä¸ªåœ°åŒºçš„10086å®¢æœæœ‰å‡ ä¸ªæˆ–è€…å‡ åä¸ªï¼Œä½ æ°¸è¿œéƒ½ä¸éœ€è¦å…³å¿ƒåœ¨ç”µè¯é‚£å¤´çš„æ˜¯å“ªä¸€ä¸ªï¼Œå«ä»€ä¹ˆï¼Œç”·çš„ï¼Œè¿˜æ˜¯å¥³çš„ï¼Œæ¼‚äº®çš„è¿˜æ˜¯å¸…æ°”çš„ï¼Œä½ éƒ½ä¸å…³å¿ƒï¼Œä½ å…³å¿ƒçš„æ˜¯ä½ çš„é—®é¢˜èƒ½ä¸èƒ½å¾—åˆ°ä¸“ä¸šçš„è§£ç­”ï¼Œä½ åªéœ€è¦æ‹¨é€šäº†10086çš„æ€»æœºå·ç ï¼Œç”µè¯é‚£å¤´æ€»ä¼šæœ‰äººä¼šå›ç­”ä½ ï¼Œåªæ˜¯æœ‰æ—¶æ…¢æœ‰æ—¶å¿«è€Œå·²ã€‚é‚£ä¹ˆè¿™é‡Œçš„10086æ€»æœºå·ç å°±æ˜¯æˆ‘ä»¬è¯´çš„åå‘ä»£ç†ã€‚å®¢æˆ·ä¸çŸ¥é“çœŸæ­£æä¾›æœåŠ¡äººçš„æ˜¯è°ã€‚</p><p>åå‘ä»£ç†éšè—äº†çœŸå®çš„æœåŠ¡ç«¯ï¼Œå½“æˆ‘ä»¬è¯·æ±‚ <a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> çš„æ—¶å€™ï¼Œå°±åƒæ‹¨æ‰“10086ä¸€æ ·ï¼ŒèƒŒåå¯èƒ½æœ‰æˆåƒä¸Šä¸‡å°æœåŠ¡å™¨ä¸ºæˆ‘ä»¬æœåŠ¡ï¼Œä½†å…·ä½“æ˜¯å“ªä¸€å°ï¼Œä½ ä¸çŸ¥é“ï¼Œä¹Ÿä¸éœ€è¦çŸ¥é“ï¼Œä½ åªéœ€è¦çŸ¥é“åå‘ä»£ç†æœåŠ¡å™¨æ˜¯è°å°±å¥½äº†ï¼Œ<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> å°±æ˜¯æˆ‘ä»¬çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œåå‘ä»£ç†æœåŠ¡å™¨ä¼šå¸®æˆ‘ä»¬æŠŠè¯·æ±‚è½¬å‘åˆ°çœŸå®çš„æœåŠ¡å™¨é‚£é‡Œå»ã€‚Nginxå°±æ˜¯æ€§èƒ½éå¸¸å¥½çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œç”¨æ¥åšè´Ÿè½½å‡è¡¡ã€‚</p></blockquote><p>å¦‚å›¾ï¼š<br><img src="https://images.morethink.cn/reverse-proxy.jpg" alt="" title="åå‘ä»£ç†"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><strong>æ­£å‘ä»£ç†éšè—äº†çœŸå®çš„å®¢æˆ·ç«¯</strong>ã€‚</li><li><strong>åå‘ä»£ç†éšè—äº†çœŸå®çš„æœåŠ¡å™¨</strong>ã€‚</li></ul><p>Nginx å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åå‘ä»£ç†æœåŠ¡å™¨ï¼Œå½“ç„¶apacheä¹Ÿå¯ä»¥å®ç°æ­¤åŠŸèƒ½ã€‚</p><p>windowsä¸‹Apacheé…ç½®å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š  <a href="http://www.cnblogs.com/morethink/p/7551877.html" target="_blank" rel="noopener">Windows ApacheæœåŠ¡å™¨é…ç½®</a></p><h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><p>Nginxï¼ˆå‘éŸ³åŒengine xï¼‰æ˜¯ä¸€ä¸ª WebæœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨ä½œåå‘ä»£ç†ï¼Œè´Ÿè½½å¹³è¡¡å™¨å’Œ HTTPç¼“å­˜ã€‚è¯¥è½¯ä»¶ç”± Igor Sysoev åˆ›å»ºï¼Œå¹¶äº2004å¹´é¦–æ¬¡å…¬å¼€å‘å¸ƒã€‚åŒåå…¬å¸æˆç«‹äº2011å¹´ï¼Œä»¥æä¾›æ”¯æŒã€‚</p><p>æˆ‘åœ¨<a href="http://www.cnblogs.com/morethink/p/6390072.html" target="_blank" rel="noopener">Windowsä¸‹å®ç°Nginxè´Ÿè½½å‡è¡¡</a>æåˆ°è¿‡Windowsä¸‹Nginxå‘½ä»¤ä½¿ç”¨ã€‚</p><h2 id="Nginx-åå‘ä»£ç†æ¨¡å—-proxy-pass"><a href="#Nginx-åå‘ä»£ç†æ¨¡å—-proxy-pass" class="headerlink" title="Nginx åå‘ä»£ç†æ¨¡å— proxy_pass"></a>Nginx åå‘ä»£ç†æ¨¡å— proxy_pass</h2><p><code>proxy_pass</code> åé¢è·Ÿç€ä¸€ä¸ª URLï¼Œç”¨æ¥å°†è¯·æ±‚åå‘ä»£ç†åˆ° URL å‚æ•°æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­çš„ <code>proxy_pass https://api.shanbay.com</code>ï¼Œåˆ™å°†åŒ¹é…çš„è¯·æ±‚åå‘ä»£ç†åˆ° <a href="https://api.shanbay.comã€‚" target="_blank" rel="noopener">https://api.shanbay.comã€‚</a></p><p>é€šè¿‡åœ¨é…ç½®æ–‡ä»¶ä¸­å¢åŠ <code>proxy_pass ä½ çš„æœåŠ¡å™¨ip</code>,ä¾‹å¦‚è¿™é‡Œçš„æ‰‡è´æœåŠ¡å™¨åœ°å€ï¼Œå°±å¯ä»¥å®Œæˆåå‘ä»£ç†ã€‚</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        ## ç”¨æˆ·è®¿é—® localhostï¼Œåˆ™åå‘ä»£ç†åˆ°https://api.shanbay.com</span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">            proxy_pass https://api.shanbay.com;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é…ç½®htmlä»¥æ–‡ä»¶æ–¹å¼æ‰“å¼€"><a href="#é…ç½®htmlä»¥æ–‡ä»¶æ–¹å¼æ‰“å¼€" class="headerlink" title="é…ç½®htmlä»¥æ–‡ä»¶æ–¹å¼æ‰“å¼€"></a>é…ç½®htmlä»¥æ–‡ä»¶æ–¹å¼æ‰“å¼€</h1><p>ä¸€èˆ¬çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„HTMLæ–‡ä»¶æ—¶æ”¾ç½®åœ¨NginxæœåŠ¡å™¨ä¸Šé¢çš„ï¼Œå³é€šè¿‡è¾“å…¥ <a href="http://localhost/index.html" target="_blank" rel="noopener">http://localhost/index.html</a> ï¼Œä½†æ˜¯åœ¨å‰ç«¯è¿›è¡Œè°ƒè¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½æ˜¯é€šè¿‡ ä½¿ç”¨ file:///E:/nginx/html/index.html æ¥æ‰“å¼€HTMLã€‚æœåŠ¡å™¨æ‰“å¼€ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚</p><p>è€Œæˆ‘ä»¬ä¹‹æ‰€ä»¥è¦éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œæ˜¯æƒ³è¦ä½¿ç”¨æµè§ˆå™¨è‡ªå¸¦çš„CORSå¤´æ¥è§£å†³è·¨åŸŸé—®é¢˜ï¼Œå¦‚æœä¸æƒ³æŠŠHTMLæ”¾ç½®åœ¨Nginxä¸­ï¼Œè€Œæƒ³é€šè¿‡æœ¬åœ°æ‰“å¼€çš„æ–¹å¼æ¥è°ƒè¯•HTMLï¼Œå¯ä»¥é€šè¿‡è‡ªå·±æ·»åŠ <code>Access-Control-Allow-Origin</code>ç­‰httpå¤´ï¼Œä½†æ˜¯æˆ‘ä»¬çš„AJAXè¯·æ±‚ä¸€å®šè¦åŠ ä¸Š<code>http://127.0.0.1/request</code>ï¼Œè€Œä¸èƒ½ç›´æ¥æ˜¯ <code>/request</code>ï¼Œäºæ˜¯å°†nginx.confä½œå¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">    # é…ç½®htmlä»¥æ–‡ä»¶æ–¹å¼æ‰“å¼€</span><br><span class="line">    if ($request_method = &apos;POST&apos;) &#123;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Origin&apos; *;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Methods&apos; &apos;GET, POST, OPTIONS&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Headers&apos; &apos;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&apos;;</span><br><span class="line">      &#125;</span><br><span class="line">    if ($request_method = &apos;GET&apos;) &#123;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Origin&apos; *;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Methods&apos; &apos;GET, POST, OPTIONS&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Headers&apos; &apos;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    # ä»£ç†åˆ°8080ç«¯å£</span><br><span class="line">    proxy_pass        http://127.0.0.1:8080;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¤„ç†DELETEå’ŒPUTè·¨åŸŸè¯·æ±‚"><a href="#å¤„ç†DELETEå’ŒPUTè·¨åŸŸè¯·æ±‚" class="headerlink" title="å¤„ç†DELETEå’ŒPUTè·¨åŸŸè¯·æ±‚"></a>å¤„ç†DELETEå’ŒPUTè·¨åŸŸè¯·æ±‚</h1><p>è€Œç°åœ¨æˆ‘çš„åå°æ˜¯restfulé£æ ¼çš„æ¥å£ï¼Œé‡‡ç”¨äº†deleteå’Œputæ–¹æ³•ï¼Œè€Œä¸Šé¢çš„é…ç½®å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚</p><p>å¯ä»¥é€šè¿‡å¢åŠ å¯¹éç®€å•è¯·æ±‚çš„åˆ¤æ–­æ¥è§£å†³DELETEå’ŒPUTè·¨åŸŸè¯·æ±‚ã€‚</p><p>éç®€å•è¯·æ±‚æ˜¯é‚£ç§å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•æ˜¯PUTæˆ–DELETEï¼Œæˆ–è€…Content-Typeå­—æ®µçš„ç±»å‹æ˜¯application/jsonã€‚</p><p>éç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ï¼Œä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œå¢åŠ ä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œç§°ä¸ºâ€é¢„æ£€â€è¯·æ±‚ï¼ˆpreflightï¼‰ã€‚</p><p>æœåŠ¡å™¨æ”¶åˆ°â€é¢„æ£€â€è¯·æ±‚ä»¥åï¼Œæ£€æŸ¥äº†Originã€Access-Control-Request-Methodå’ŒAccess-Control-Request-Headerså­—æ®µä»¥åï¼Œç¡®è®¤å…è®¸è·¨æºè¯·æ±‚ï¼Œå°±å¯ä»¥åšå‡ºå›åº”ã€‚</p><p>å› æ­¤ï¼Œä¸ºäº†ä½¿Nginxå¯ä»¥å¤„ç†deleteç­‰éç®€å•è¯·æ±‚ï¼ŒNginxéœ€è¦ä½œå‡ºç›¸åº”çš„æ”¹å˜ï¼Œæ›´æ”¹é…ç½®å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    # å®Œæˆæµè§ˆå™¨çš„&quot;é¢„æ£€&quot;è¯·æ±‚</span><br><span class="line">if ($request_method = &apos;OPTIONS&apos;) &#123;</span><br><span class="line">add_header Access-Control-Allow-Origin *;</span><br><span class="line">add_header Access-Control-Allow-Credentials true;</span><br><span class="line">add_header Access-Control-Allow-Methods &apos;GET, POST, PUT, DELETE, OPTIONS&apos;;</span><br><span class="line">add_header &apos;Access-Control-Allow-Headers&apos; &apos;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&apos;;</span><br><span class="line">return 204;</span><br><span class="line">&#125;</span><br><span class="line">    # é…ç½®htmlåœ¨æœ¬åœ°æ‰“å¼€</span><br><span class="line">    if ($request_method = &apos;POST&apos;) &#123;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Origin&apos; *;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Methods&apos; &apos;GET, POST, OPTIONS&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Headers&apos; &apos;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&apos;;</span><br><span class="line">      &#125;</span><br><span class="line">    if ($request_method = &apos;GET&apos;) &#123;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Origin&apos; *;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Credentials&apos; &apos;true&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Methods&apos; &apos;GET, POST, OPTIONS&apos;;</span><br><span class="line">          add_header &apos;Access-Control-Allow-Headers&apos; &apos;DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">    # é…ç½®htmlåœ¨Nginxä¸­æ‰“å¼€</span><br><span class="line">    location ~* \.(html|htm)$ &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    # ä»£ç†åˆ°8080ç«¯å£</span><br><span class="line">    proxy_pass        http://127.0.0.1:8080;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¿…é¡»æŠŠæˆ‘ä»¬çš„htmlä»£ç æ”¾åœ¨Nginxä¸­htmlæ–‡ä»¶å¤¹å†…ï¼Œå³ä½¿ç”¨Nginxå½“åšæˆ‘ä»¬çš„å‰ç«¯æœåŠ¡å™¨ã€‚</p><h1 id="URLé‡å†™"><a href="#URLé‡å†™" class="headerlink" title="URLé‡å†™"></a>URLé‡å†™</h1><p>æœ‰æ—¶å€™æˆ‘ä»¬ä»…ä»…åªæƒ³å°†<code>/api</code>ä¸‹çš„urlåå‘ä»£ç†åˆ°åç«¯ï¼Œå¯ä»¥é€šè¿‡åœ¨nginx.confä¸­é…ç½®urlé‡å†™è§„åˆ™å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    root   html;</span><br><span class="line">    index  index.html index.htm;</span><br><span class="line">         location ^~ /api &#123;</span><br><span class="line">         rewrite ^/api/(.*)$ /$1 break;</span><br><span class="line">         proxy_pass https://api.shanbay.com/;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬åªç”¨å¤„ç†<code>/api</code>ä¸‹çš„urlã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬é€šè¿‡<code>rewrite</code>å°†URLé‡å†™ä¸ºçœŸæ­£è¦è¯·æ±‚çš„<code>URL</code>ï¼Œé€šè¿‡<code>proxy_pass</code>ä»£ç†åˆ°çœŸå®çš„æœåŠ¡å™¨IPæˆ–è€…åŸŸåã€‚</p><h1 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h1><p>å¦‚æœCookieçš„åŸŸåéƒ¨åˆ†ä¸å½“å‰é¡µé¢çš„åŸŸåä¸åŒ¹é…å°±æ— æ³•å†™å…¥ã€‚æ‰€ä»¥å¦‚æœè¯·æ±‚ <a href="http://www.a.com" target="_blank" rel="noopener">www.a.com</a> ï¼ŒæœåŠ¡å™¨ proxy_pass åˆ° <a href="http://www.b.com" target="_blank" rel="noopener">www.b.com</a> åŸŸåï¼Œç„¶å <a href="http://www.b.com" target="_blank" rel="noopener">www.b.com</a> è¾“å‡º <code>domian=b.com</code> çš„ Cookieï¼Œå‰ç«¯çš„é¡µé¢ä¾ç„¶åœç•™åœ¨ <a href="http://www.a.com" target="_blank" rel="noopener">www.a.com</a> ä¸Šï¼Œäºæ˜¯æµè§ˆå™¨å°±æ— æ³•å°† Cookie å†™å…¥ã€‚</p><p>å¯åœ¨nginxåå‘ä»£ç†ä¸­è®¾ç½®ï¼š</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    # é¡µé¢åœ°å€æ˜¯a.comï¼Œä½†æ˜¯è¦ç”¨b.comçš„cookie</span><br><span class="line">    proxy_cookie_domain b.com a.com;  #æ³¨æ„åˆ«å†™é”™ä½ç½®äº† proxy_cookie_path / /;</span><br><span class="line">    proxy_pass http://b.com;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Nginxè§£å†³è·¨åŸŸé—®é¢˜é€šè¿‡Nginxåå‘ä»£ç†å°†å¯¹çœŸå®æœåŠ¡å™¨çš„è¯·æ±‚è½¬ç§»åˆ°æœ¬æœºæœåŠ¡å™¨æ¥é¿å…æµè§ˆå™¨çš„â€åŒæºç­–ç•¥é™åˆ¶â€ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://www.jianshu.com/p/c872ffa500af" target="_blank" rel="noopener">Nginxåå‘ä»£ç†é…ç½®ï¼ˆè§£å†³è·¨åŸŸé—®é¢˜ï¼‰</a></li><li>è¿™ä¸¤ç¯‡æ–‡ç« è®²è§£äº†URLé‡å†™çš„è§„åˆ™å’Œç”¨æ³•<ul><li><a href="https://xuexb.com/html/nginx-url-rewrite.html" target="_blank" rel="noopener">nginxé…ç½®urlé‡å†™</a></li><li><a href="http://seanlook.com/2015/05/17/nginx-location-rewrite/" target="_blank" rel="noopener">nginxé…ç½®locationæ€»ç»“åŠrewriteè§„åˆ™å†™æ³•</a></li></ul></li><li><a href="http://www.cnblogs.com/wxd0108/p/5217801.html" target="_blank" rel="noopener">Nginxé…ç½®æ–‡ä»¶è¯¦è§£</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> è·¨åŸŸ </tag>
            
            <tag> åå‘ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SpringMVCè§£å†³è·¨åŸŸé—®é¢˜</title>
      <link href="/SpringMVC%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/"/>
      <url>/SpringMVC%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>æœ‰ä¸ªæœ‹å‹åœ¨å†™æ‰‡è´æ’ä»¶çš„æ—¶å€™é‡åˆ°äº†è·¨åŸŸé—®é¢˜ã€‚<br>äºæ˜¯æˆ‘å¯¹è§£å†³è·¨åŸŸé—®é¢˜çš„æ–¹å¼è¿›è¡Œäº†ä¸€ç•ªæ¢è®¨ã€‚</p><p>é—®é¢˜</p><blockquote><p>APIï¼šæŸ¥è¯¢å•è¯<br><strong>URL</strong>ï¼š <a href="https://api.shanbay.com/bdc/search/?word={word}" target="_blank" rel="noopener">https://api.shanbay.com/bdc/search/?word={word}</a><br><strong>è¯·æ±‚æ–¹å¼</strong>: GET<br><strong>å‚æ•°</strong>ï¼š {word}, å¿…é¡»ï¼Œè¦æŸ¥è¯¢çš„å•è¯</p></blockquote><a id="more"></a><p>æŠ¥é”™ä¸º<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">XMLHttpRequest cannot load http://localhost/home/saveCandidate. No &apos;Access-Control-Allow-Origin&apos; header is present on the requested resource. Origin &apos;null&apos; is therefore not allowed access. The response had HTTP status code 404.</span><br></pre></td></tr></table></figure></p><p>è¿™å°±æ˜¯å…¸å‹çš„è·¨åŸŸé—®é¢˜ã€‚</p><p>ä½†æ˜¯æˆ‘åœ¨æµè§ˆå™¨é‡Œè¾“å…¥URLæ˜¯å¯ä»¥è¿›è¡ŒæŸ¥è¯¢å•è¯çš„æ“ä½œçš„ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Œå³ä¸‹é¢ä¸¤ä¸ªé—®é¢˜</p><ol><li>ä¸ºä»€ä¹ˆåœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥URLä¸ä¼šå‡ºç°è·¨åŸŸé—®é¢˜ã€‚</li><li>ä¸åœ¨æœåŠ¡å™¨è¿è¡Œçš„htmlæ˜¯å¦å¯ä»¥å®Œæˆä¸€æ¬¡httpè¯·æ±‚</li></ol><p>ç»è¿‡Googleå’Œè‡ªå·±æµ‹è¯•</p><ol><li><strong>è·¨åŸŸé™åˆ¶æ˜¯æµè§ˆå™¨è¡Œä¸ºï¼Œä¸æ˜¯æœåŠ¡å™¨è¡Œä¸ºã€‚</strong> æµè§ˆå™¨è®¤ä¸ºåœ°å€æ è¾“å…¥æ—¶å®‰å…¨çš„,æ‰€ä»¥ä¸é™åˆ¶è®¤ä¸ºæ˜¯è·¨åŸŸã€‚</li><li>å¯ä»¥ï¼Œåªè¦æœåŠ¡å™¨é…ç½®ä¸ºæ‰€æœ‰åŸŸéƒ½å¯ä»¥è¿›è¡Œè¯·æ±‚,é‚£ä¹ˆä¸åœ¨æœåŠ¡å™¨è¿è¡Œçš„HTMLå°±å¯ä»¥å®Œæˆhttpè¯·æ±‚ã€‚</li></ol><h1 id="ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜"><a href="#ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜" class="headerlink" title="ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜"></a>ä»€ä¹ˆæ˜¯è·¨åŸŸé—®é¢˜</h1><p><strong>åŒæºç­–ç•¥</strong>ï¼š</p><blockquote><p>åŒæºæŒ‡çš„æ˜¯<strong>åŸŸåï¼ˆæˆ–IPï¼‰</strong>ï¼Œ<strong>åè®®</strong>ï¼Œ<strong>ç«¯å£</strong>éƒ½ç›¸åŒï¼Œä¸åŒæºçš„å®¢æˆ·ç«¯è„šæœ¬(javascriptã€ActionScript)åœ¨æ²¡æ˜ç¡®æˆæƒçš„æƒ…å†µä¸‹ï¼Œä¸èƒ½è¯»å†™å¯¹æ–¹çš„èµ„æºã€‚</p></blockquote><table><thead><tr><th>URL</th><th>è§£é‡Š</th><th>æ˜¯å¦è·¨åŸŸ</th></tr></thead><tbody><tr><td><a href="http://www.morethink.cn">http://www.morethink.cn</a></td><td>åŸæ¥çš„URL</td></tr><tr><td><a href="http://www.image.morethink.cn" target="_blank" rel="noopener">http://www.image.morethink.cn</a></td><td>å­åŸŸå</td><td>è·¨åŸŸ(cookieä¹Ÿæ— æ³•è®¿é—®)</td></tr><tr><td><a href="http://morethink.cn" target="_blank" rel="noopener">http://morethink.cn</a></td><td>ä¸åŠ www</td><td>è·¨åŸŸ</td></tr><tr><td><a href="https://www.morethink.cn">https://www.morethink.cn</a></td><td>æ›´æ”¹åè®®</td><td>è·¨åŸŸ</td></tr><tr><td><a href="http://www.morethink.cn:8080">http://www.morethink.cn:8080</a></td><td>æ›´æ”¹ç«¯å£å·</td><td>è·¨åŸŸ</td></tr></tbody></table><p><strong>åŸå› </strong>ï¼š</p><p>åŒæºæ”¿ç­–çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®ã€‚<br>è®¾æƒ³è¿™æ ·ä¸€ç§æƒ…å†µï¼šAç½‘ç«™æ˜¯ä¸€å®¶é“¶è¡Œï¼Œç”¨æˆ·ç™»å½•ä»¥åï¼Œåˆå»æµè§ˆå…¶ä»–ç½‘ç«™ã€‚å¦‚æœå…¶ä»–ç½‘ç«™å¯ä»¥è¯»å–Aç½‘ç«™çš„Cookieï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ<br>å¾ˆæ˜¾ç„¶ï¼Œå¦‚æœCookieåŒ…å«éšç§ï¼ˆæ¯”å¦‚å­˜æ¬¾æ€»é¢ï¼‰ï¼Œè¿™äº›ä¿¡æ¯å°±ä¼šæ³„æ¼ã€‚æ›´å¯æ€•çš„æ˜¯ï¼ŒCookieå¾€å¾€ç”¨æ¥ä¿å­˜ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰é€€å‡ºç™»å½•ï¼Œå…¶ä»–ç½‘ç«™å°±å¯ä»¥å†’å……ç”¨æˆ·ï¼Œä¸ºæ‰€æ¬²ä¸ºã€‚å› ä¸ºæµè§ˆå™¨åŒæ—¶è¿˜è§„å®šï¼Œæäº¤è¡¨å•ä¸å—åŒæºæ”¿ç­–çš„é™åˆ¶ã€‚<br>ç”±æ­¤å¯è§ï¼Œâ€åŒæºæ”¿ç­–â€æ˜¯å¿…éœ€çš„ï¼Œå¦åˆ™ Cookie å¯ä»¥å…±äº«ï¼Œäº’è”ç½‘å°±æ¯«æ— å®‰å…¨å¯è¨€äº†ã€‚</p><p>åŒæºç­–ç•¥é™åˆ¶ä»¥ä¸‹å‡ ç§è¡Œä¸ºï¼š</p><ol><li>Cookieã€LocalStorage å’Œ IndexDB æ— æ³•è¯»å–</li><li>DOM å’Œ Jså¯¹è±¡æ— æ³•è·å¾—</li><li>AJAX è¯·æ±‚ä¸èƒ½å‘é€</li></ol><h1 id="æ¨¡æ‹Ÿè·¨åŸŸé—®é¢˜"><a href="#æ¨¡æ‹Ÿè·¨åŸŸé—®é¢˜" class="headerlink" title="æ¨¡æ‹Ÿè·¨åŸŸé—®é¢˜"></a>æ¨¡æ‹Ÿè·¨åŸŸé—®é¢˜</h1><p>æµ‹è¯•URLä¸º   <a href="http://localhost:80/home/allProductions" target="_blank" rel="noopener">http://localhost:80/home/allProductions</a></p><p>å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨<code>console</code>ä¸­æ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">xhr.open(<span class="string">'GET'</span>, <span class="string">'http://localhost:80/home/allProductions'</span>,<span class="literal">true</span>);</span><br><span class="line">xhr.send();</span><br><span class="line">xhr.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(xhr.responseText));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä»»æ„ç½‘ç«™æ‰“å¼€æ§åˆ¶å°ï¼Œæ‰§è¡Œæ­¤æ®µä»£ç å¯ä»¥æ¨¡æ‹Ÿè·¨åŸŸè¯·æ±‚ã€‚</p><p>åœ¨çŸ¥ä¹æ§åˆ¶å°æ‰“å¼€æŠ¥é”™å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Mixed Content: The page at &apos;https://www.zhihu.com/question/26376773&apos; was loaded over HTTPS, but requested an insecure XMLHttpRequest endpoint &apos;http://localhost/home/allProductions&apos;. This request has been blocked; the content must be served over HTTPS.</span><br></pre></td></tr></table></figure><p><img src="https://images.morethink.cn/zhihu-https-cross-domain.jpg" alt="" title="æ¨¡æ‹Ÿè·¨åŸŸè¯·æ±‚"></p><p>å› ä¸ºçŸ¥ä¹æ˜¯httpsï¼ŒæŠ¥é”™ä¸æ™®é€šçš„httpåè®®ä¸åŒã€‚</p><p>å†æ¾„æ¸…ä¸€ä¸‹è·¨åŸŸé—®é¢˜ï¼š</p><ol><li>å¹¶éæµè§ˆå™¨é™åˆ¶äº†å‘èµ·è·¨ç«™è¯·æ±‚ï¼Œè€Œæ˜¯è·¨ç«™è¯·æ±‚å¯ä»¥æ­£å¸¸å‘èµ·ï¼Œä½†æ˜¯è¿”å›ç»“æœè¢«æµè§ˆå™¨æ‹¦æˆªäº†ã€‚æœ€å¥½çš„ä¾‹å­æ˜¯CRSFè·¨ç«™æ”»å‡»åŸç†ï¼Œæ— è®ºæ˜¯å¦è·¨åŸŸï¼Œè¯·æ±‚å·²ç»å‘é€åˆ°äº†åç«¯æœåŠ¡å™¨ï¼</li><li>ä½†æ˜¯ï¼Œ<strong>æœ‰äº›æµè§ˆå™¨ä¸å…è®¸ä»HTTPSçš„åŸŸè·¨åŸŸè®¿é—®HTTPï¼Œæ¯”å¦‚Chromeå’ŒFirefoxï¼Œè¿™äº›æµè§ˆå™¨åœ¨è¯·æ±‚è¿˜æœªå‘å‡ºçš„æ—¶å€™å°±ä¼šæ‹¦æˆªè¯·æ±‚ï¼Œè¿™æ˜¯ä¸€ä¸ªç‰¹ä¾‹ã€‚</strong></li></ol><p>åœ¨åšå®¢å›­æ§åˆ¶å°æ‰“å¼€æŠ¥é”™å¦‚ä¸‹</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">XMLHttpRequest cannot load http://localhost/home/allProductions. No &apos;Access-Control-Allow-Origin&apos; header is present on the requested resource. Origin &apos;http://www.cnblogs.com&apos; is therefore not allowed access.</span><br></pre></td></tr></table></figure><h1 id="æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜"><a href="#æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜" class="headerlink" title="æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜"></a>æ€ä¹ˆè§£å†³è·¨åŸŸé—®é¢˜</h1><p>è§£å†³æ–¹æ¡ˆæœ‰å¾ˆå¤š</p><ol><li>é€šè¿‡jsonpè·¨åŸŸ</li><li>document.domain + iframeè·¨åŸŸ</li><li>location.hash + iframe</li><li>window.name + iframeè·¨åŸŸ</li><li>postMessageè·¨åŸŸ</li><li>è·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰</li><li><a href="http://www.cnblogs.com/morethink/p/6628757.html" target="_blank" rel="noopener">å‰ç«¯é€šè¿‡Nginxè§£å†³è·¨åŸŸé—®é¢˜</a></li><li>nodejsä¸­é—´ä»¶ä»£ç†è·¨åŸŸ</li><li>WebSocketåè®®è·¨åŸŸ</li></ol><p>è¿™é‡Œä¸»è¦ä»‹ç»SpringMVCè§£å†³è·¨åŸŸé—®é¢˜çš„æ–¹å¼ã€‚</p><ol><li>JSONP</li><li>CORS</li><li>WebSocket</li></ol><h1 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h1><p>å¯ä»¥ç›´æ¥å‚è€ƒ<a href="https://my.oschina.net/xinxingegeya/blog/480510" target="_blank" rel="noopener">Spring MVC 4.1 æ”¯æŒjsonp</a>è¿›è¡Œé…ç½®ä½ çš„SpringMVCæ³¨è§£</p><h2 id="JSONP-åŸç†"><a href="#JSONP-åŸç†" class="headerlink" title="JSONP åŸç†"></a>JSONP åŸç†</h2><p>æˆ‘è™½ç„¶è¯·æ±‚ä¸äº†jsonæ•°æ®ï¼Œä½†æ˜¯æˆ‘å¯ä»¥è¯·æ±‚ä¸€ä¸ª<code>Content-Type</code>ä¸º<code>application/javascript</code>çš„JavaScriptå¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æµè§ˆå™¨çš„åŒæºç­–ç•¥ã€‚</p><p>å°±æ˜¯å½“æœåŠ¡å™¨æ¥å—åˆ°åä¸º<code>jsonp</code>æˆ–è€…<code>callback</code>çš„å‚æ•°æ—¶ï¼Œè¿”å›<code>Content-Type: application/javascript</code>çš„ç»“æœï¼Œä»è€Œé¿å…æµè§ˆå™¨çš„åŒæºç­–ç•¥æ£€æµ‹ã€‚</p><p><strong>åœ¨æ§åˆ¶å°ä¸­ç›´æ¥è¿›è¡Œæµ‹è¯•ä½ çš„jsonpæ˜¯å¦é…ç½®æˆåŠŸï¼š</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">println</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">"http://localhost:80/home/allProductions?&amp;callback=println"</span>;</span><br><span class="line"><span class="comment">// åˆ›å»ºscriptæ ‡ç­¾ï¼Œè®¾ç½®å…¶å±æ€§</span></span><br><span class="line"><span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">script.setAttribute(<span class="string">'src'</span>, url);</span><br><span class="line"><span class="comment">// æŠŠscriptæ ‡ç­¾åŠ å…¥headï¼Œæ­¤æ—¶è°ƒç”¨å¼€å§‹</span></span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(script);</span><br></pre></td></tr></table></figure><p><img src="https://images.morethink.cn/jsonp-success.jpg" alt="" title="jsonp success"></p><p><strong>ä½¿ç”¨JQueryæµ‹è¯•ä½ çš„jsonpæ˜¯å¦é…ç½®æˆåŠŸï¼Œå› ä¸ºæ§åˆ¶å°ä¸èƒ½ç›´æ¥åŠ è½½JQueryï¼Œéœ€è¦è‡ªå·±å»ºç«‹htmlæ–‡ä»¶æ¥è¿›è¡Œæµ‹è¯•ï¼š</strong></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="keyword">function</span> <span class="title">println</span>(<span class="params">data</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data);</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'print'</span>);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="javascript">      <span class="function"><span class="keyword">function</span> <span class="title">jsonp_test</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">            $.ajax(&#123;</span></span><br><span class="line"><span class="javascript">                type: <span class="string">"get"</span>,</span></span><br><span class="line"><span class="javascript">                url: <span class="string">"http://localhost:80/home/allProductions"</span>,</span></span><br><span class="line"><span class="javascript">                dataType: <span class="string">"jsonp"</span>,</span></span><br><span class="line"><span class="javascript">                jsonp: <span class="string">"callback"</span>,<span class="comment">//ä¼ é€’ç»™è¯·æ±‚å¤„ç†ç¨‹åºæˆ–é¡µé¢çš„ï¼Œç”¨ä»¥è·å¾—jsonpå›è°ƒå‡½æ•°åçš„å‚æ•°å(ä¸€èˆ¬é»˜è®¤ä¸º:callback)</span></span></span><br><span class="line"><span class="javascript">                jsonpCallback: <span class="string">"println"</span>, <span class="comment">//è¿”å›åè°ƒç”¨çš„å¤„ç†å‡½æ•°</span></span></span><br><span class="line"><span class="javascript">                error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">//è¯·æ±‚å‡ºé”™çš„å¤„ç†</span></span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">"è¯·æ±‚å‡ºé”™"</span>);</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">"jsonp_test()"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h1><p>CORSæ˜¯ä¸€ä¸ªW3Cæ ‡å‡†ï¼Œå…¨ç§°æ˜¯â€è·¨åŸŸèµ„æºå…±äº«â€ï¼ˆCross-origin resource sharingï¼‰ã€‚<br>å®ƒå…è®¸æµè§ˆå™¨å‘è·¨æºæœåŠ¡å™¨ï¼Œå‘å‡ºXMLHttpRequestè¯·æ±‚ï¼Œä»è€Œå…‹æœäº†AJAXåªèƒ½åŒæºä½¿ç”¨çš„é™åˆ¶ã€‚</p><p>CORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒã€‚</p><ol><li>æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒè¯¥åŠŸèƒ½ï¼ŒIEæµè§ˆå™¨ä¸èƒ½ä½äºIE10ã€‚<br><strong>æ•´ä¸ªCORSé€šä¿¡è¿‡ç¨‹ï¼Œéƒ½æ˜¯æµè§ˆå™¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·å‚ä¸ã€‚</strong> å¯¹äºå¼€å‘è€…æ¥è¯´ï¼ŒCORSé€šä¿¡ä¸åŒæºçš„AJAXé€šä¿¡æ²¡æœ‰å·®åˆ«ï¼Œä»£ç å®Œå…¨ä¸€æ ·ã€‚æµè§ˆå™¨ä¸€æ—¦å‘ç°AJAXè¯·æ±‚è·¨æºï¼Œå°±ä¼šè‡ªåŠ¨æ·»åŠ ä¸€äº›é™„åŠ çš„å¤´ä¿¡æ¯ï¼Œæœ‰æ—¶è¿˜ä¼šå¤šå‡ºä¸€æ¬¡é™„åŠ çš„è¯·æ±‚ï¼Œä½†ç”¨æˆ·ä¸ä¼šæœ‰æ„Ÿè§‰ã€‚</li><li>å®ç°CORSé€šä¿¡çš„å…³é”®æ˜¯æœåŠ¡å™¨ã€‚åªè¦æœåŠ¡å™¨å®ç°äº†CORSæ¥å£ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡ã€‚</li></ol><p><strong>å³CORSä¸æ™®é€šè¯·æ±‚ä»£ç ä¸€æ ·ã€‚</strong></p><p>CORSä¸JSONPç›¸æ¯”</p><ol><li><strong>JSONPåªèƒ½å®ç°GETè¯·æ±‚ï¼Œè€ŒCORSæ”¯æŒæ‰€æœ‰ç±»å‹çš„HTTPè¯·æ±‚ã€‚</strong></li><li>ä½¿ç”¨CORSï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨æ™®é€šçš„XMLHttpRequestå‘èµ·è¯·æ±‚å’Œè·å¾—æ•°æ®ï¼Œæ¯”èµ·JSONPæœ‰æ›´å¥½çš„é”™è¯¯å¤„ç†ã€‚</li><li>JSONPä¸»è¦è¢«è€çš„æµè§ˆå™¨æ”¯æŒï¼Œå®ƒä»¬å¾€å¾€ä¸æ”¯æŒCORSï¼Œè€Œç»å¤§å¤šæ•°ç°ä»£æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒäº†CORSã€‚</li></ol><h2 id="CrossOriginæ³¨è§£"><a href="#CrossOriginæ³¨è§£" class="headerlink" title="@CrossOriginæ³¨è§£"></a><code>@CrossOrigin</code>æ³¨è§£</h2><p>æ­¤æ³¨è§£æ—¢å¯ç”¨äºæ–¹æ³•ä¹Ÿå¯ç”¨äºç±»</p><p>æºç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@CrossOrigin</span>(origins = <span class="string">"http://www.zhihu.com"</span>)</span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/allProductions"</span>, method = RequestMethod.GET)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">getAllOldProductions</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>@CrossOrigin</code>æ³¨è§£æ—¢å¯æ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯æ³¨è§£åœ¨ç±»ä¸Šã€‚</p><p>å®Œæˆé…ç½®ä¹‹å</p><h2 id="XMLå…¨å±€é…ç½®"><a href="#XMLå…¨å±€é…ç½®" class="headerlink" title="XMLå…¨å±€é…ç½®"></a>XMLå…¨å±€é…ç½®</h2><p>æ‰€æœ‰è·¨åŸŸè¯·æ±‚éƒ½å¯ä»¥è®¿é—®</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:cors</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:cors</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ›´åŠ ç»†ç²’åº¦çš„é…ç½®ï¼š</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:cors</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/api/**"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">allowed-origins</span>=<span class="string">"http://domain1.com, http://domain2.com"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">allowed-methods</span>=<span class="string">"GET, PUT"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">allowed-headers</span>=<span class="string">"header1, header2, header3"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">exposed-headers</span>=<span class="string">"header1, header2"</span> <span class="attr">allow-credentials</span>=<span class="string">"false"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">max-age</span>=<span class="string">"123"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/resources/**"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">allowed-origins</span>=<span class="string">"http://domain1.com"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:cors</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><p>WebSocketæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½¿ç”¨ws://ï¼ˆéåŠ å¯†ï¼‰å’Œwss://ï¼ˆåŠ å¯†ï¼‰ä½œä¸ºåè®®å‰ç¼€ï¼Œåœ¨2008å¹´è¯ç”Ÿï¼Œ2011å¹´æˆä¸ºå›½é™…æ ‡å‡†ã€‚<strong>æ‰€æœ‰æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒäº†</strong>ã€‚</p><p>å®ƒçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§ã€‚</p><p><strong>è¯¥åè®®ä¸å®è¡ŒåŒæºæ”¿ç­–ï¼Œåªè¦æœåŠ¡å™¨æ”¯æŒï¼Œå°±å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œè·¨æºé€šä¿¡</strong>ã€‚</p><p>è¯·æ±‚å¤´ä¿¡æ¯ï¼š(å¤šäº†ä¸ª origin)</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">GET /chat HTTP/1.1</span><br><span class="line">Host: server.example.com</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Key: x3JJHMbDL1EzLkh9GBhXDw==</span><br><span class="line">Sec-WebSocket-Protocol: chat, superchat</span><br><span class="line">Sec-WebSocket-Version: 13</span><br><span class="line">Origin: http://example.com</span><br></pre></td></tr></table></figure><p>å“åº”å¤´ï¼š(å¦‚æœoriginåœ¨ç™½åå•å†…)</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 101 Switching Protocols</span><br><span class="line">Upgrade: websocket</span><br><span class="line">Connection: Upgrade</span><br><span class="line">Sec-WebSocket-Accept: HSmrc0sMlYUkAGmm5OPpG2HaGWk=</span><br><span class="line">Sec-WebSocket-Protocol: chat</span><br></pre></td></tr></table></figure><h2 id="ç›¸æ¯”äºHTTP-2"><a href="#ç›¸æ¯”äºHTTP-2" class="headerlink" title="ç›¸æ¯”äºHTTP/2"></a>ç›¸æ¯”äºHTTP/2</h2><p>HTTP/2åªæ˜¯å¯¹HTMLã€CSSç­‰JSèµ„æºçš„ä¼ è¾“æ–¹å¼è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¹¶æ²¡æœ‰æä¾›æ–°çš„JS APIï¼Œä¸èƒ½ç”¨äºå®æ—¶ä¼ è¾“æ¶ˆæ¯ï¼Œä¹Ÿæ— æ³•æ¨é€æŒ‡å®šçš„ä¿¡æ¯ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li>è·¨åŸŸ<ul><li><a href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" target="_blank" rel="noopener">æµè§ˆå™¨åŒæºæ”¿ç­–åŠå…¶è§„é¿æ–¹æ³•</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£</a></li></ul></li><li>SpringMVC è·¨åŸŸè§£å†³æ–¹æ³•<ul><li><a href="http://blog.csdn.net/isea533/article/details/50449907" target="_blank" rel="noopener">Spring MVC 4.2 å¢åŠ  CORS æ”¯æŒ</a></li></ul></li><li><a href="https://segmentfault.com/a/1190000011145364?utm_source=weekly&amp;utm_medium=email&amp;utm_campaign=email_weekly#articleHeader2" target="_blank" rel="noopener">å‰ç«¯å¸¸è§è·¨åŸŸè§£å†³æ–¹æ¡ˆï¼ˆå…¨ï¼‰</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è·¨åŸŸ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SpringMVCç©ºå­—ç¬¦ä¸²è½¬ä¸ºnull</title>
      <link href="/SpringMVC-Empty-String-To-Null/"/>
      <url>/SpringMVC-Empty-String-To-Null/</url>
      
        <content type="html"><![CDATA[<h1 id="ç©ºå­—ç¬¦ä¸²è½¬ä¸ºnull"><a href="#ç©ºå­—ç¬¦ä¸²è½¬ä¸ºnull" class="headerlink" title="ç©ºå­—ç¬¦ä¸²è½¬ä¸ºnull"></a>ç©ºå­—ç¬¦ä¸²è½¬ä¸ºnull</h1><p>ç°åœ¨æˆ‘é‡åˆ°è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œé‚£å°±æ˜¯æˆ‘æƒ³è¦å§å‰ç«¯ä¼ è¿‡æ¥çš„å€¼å˜ä¸ºç©ºï¼Œå› ä¸ºæ‰€è°“å‰ç«¯çš„æ ¡éªŒï¼Œå…¶å®éƒ½ä¸æ˜¯æ ¡éªŒï¼Œå¦‚æœå‰ç«¯ä¼ ç»™åå°ä¸€ä¸ªè¡¨å•ï¼Œå¯æ˜¯è¡¨å•æœªå¡«å…¥å€¼ï¼Œæˆ‘ä»¬åå°è¿›è¡Œåˆ¤æ–­çš„æ—¶å€™ <strong>æ—¢éœ€è¦åˆ¤æ–­nullï¼ŒåŒæ—¶éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸º<code>&quot;&quot;</code>, å¹¶ä¸”å¦‚æœä½ ä¸å¸Œæœ›æ•°æ®åº“æ’å…¥çš„æ˜¯ç©ºå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯<code>null</code></strong>ï¼Œé‚£ä¹ˆè½¬æ¢å’Œæ’å…¥çš„å°±å¾ˆéº»çƒ¦</p><a id="more"></a><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (manager.getUsername().equals(<span class="string">""</span>) || manager.getUsername() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ErrorException(<span class="string">"ç”¨æˆ·åæœªå¡«å†™"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (manager.getPassword().equals(<span class="string">""</span>) || manager.getPassword() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ErrorException(<span class="string">"å¯†ç æœªå¡«å†™"</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>å¯æ˜¯å¦‚æœä½ åœ¨SpringMVCè¿›è¡Œå‚æ•°èµ‹å€¼å¤„ç†ä¹‹å‰å°±èƒ½æŠŠ<code>&quot;&quot;</code>è½¬æ¢ä¸º<code>null</code>ï¼Œé‚£ä¹ˆä½ å°±åªéœ€è¦è¿›è¡Œå¦‚ä¸‹åˆ¤æ–­ï¼Œå¹¶ä¸”æ’å…¥æ•°æ®åº“çš„ä¸€ç›´æ˜¯ç©ºå€¼</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (manager.getUsername() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ErrorException(<span class="string">"ç”¨æˆ·åæœªå¡«å†™"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (manager.getPassword() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ErrorException(<span class="string">"å¯†ç æœªå¡«å†™"</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h1 id="å®ç°æ–¹å¼"><a href="#å®ç°æ–¹å¼" class="headerlink" title="å®ç°æ–¹å¼"></a>å®ç°æ–¹å¼</h1><ol><li>å¯ä»¥ä½¿ç”¨è¿‡æ»¤å™¨/æ‹¦æˆªå™¨æŠŠç©ºå­—ç¬¦ä¸²è®¾ç½®æˆnull(æœªå°è¯•)</li><li>æ³¨å†Œä¸€ä¸ªSpringMVC <code>HandlerAdapter</code>æ¥è¿›è¡Œå¤„ç†</li></ol><p>ä½¿ç”¨SpringMVCæ—¶ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½æ˜¯æœ€å…ˆç»è¿‡DispatcherServletçš„ï¼Œç„¶åç”±DispatcherServleté€‰æ‹©åˆé€‚çš„HandlerMappingå’ŒHandlerAdapteræ¥å¤„ç†è¯·æ±‚ï¼ŒHandlerMappingçš„ä½œç”¨å°±æ˜¯æ‰¾åˆ°è¯·æ±‚æ‰€å¯¹åº”çš„æ–¹æ³•ï¼Œè€ŒHandlerAdapteråˆ™æ¥å¤„ç†å’Œè¯·æ±‚ç›¸å…³çš„çš„å„ç§äº‹æƒ…ã€‚æˆ‘ä»¬è¿™é‡Œè¦è®²çš„è¯·æ±‚å‚æ•°ç»‘å®šä¹Ÿæ˜¯HandlerAdapteræ¥åšçš„ã€‚</p><h1 id="å‚æ•°å¤„ç†å™¨"><a href="#å‚æ•°å¤„ç†å™¨" class="headerlink" title="å‚æ•°å¤„ç†å™¨"></a>å‚æ•°å¤„ç†å™¨</h1><p>æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„è¯·æ±‚å‚æ•°å¤„ç†å™¨ï¼Œç„¶åæŠŠè¿™ä¸ªå¤„ç†å™¨æ”¾åˆ°HandlerAdapterä¸­ï¼Œè¿™æ ·æˆ‘ä»¬çš„å¤„ç†å™¨å°±å¯ä»¥è¢«æ‹¿æ¥å¤„ç†è¯·æ±‚äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmptyStringToNullModelAttributeMethodProcessor</span> <span class="keyword">extends</span> <span class="title">ServletModelAttributeMethodProcessor</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EmptyStringToNullModelAttributeMethodProcessor</span><span class="params">(<span class="keyword">boolean</span> annotationNotRequired)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(annotationNotRequired);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">bindRequestParameters</span><span class="params">(WebDataBinder binder, NativeWebRequest request)</span> </span>&#123;</span><br><span class="line">        EmptyStringToNullRequestDataBinder toNullRequestDataBinderBinder = <span class="keyword">new</span> EmptyStringToNullRequestDataBinder(binder.getTarget(), binder.getObjectName());</span><br><span class="line">        RequestMappingHandlerAdapter requestMappingHandlerAdapter = applicationContext.getBean(RequestMappingHandlerAdapter.class);</span><br><span class="line">        requestMappingHandlerAdapter.getWebBindingInitializer().initBinder(toNullRequestDataBinderBinder, request);</span><br><span class="line">        toNullRequestDataBinderBinder.bind(request.getNativeRequest(ServletRequest.class));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://images.morethink.cn/EmptyStringToNull.jpg" alt="enter image description here"></p><h1 id="DataBinder"><a href="#DataBinder" class="headerlink" title="DataBinder"></a>DataBinder</h1><p>ç»§æ‰¿è‡ª<code>ExtendedServletRequestDataBinder</code>ï¼Œä¸»è¦ç”¨æ¥è‡ªå®šä¹‰æ•°æ®ç»‘å®šå¤„ç†</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmptyStringToNullRequestDataBinder</span> <span class="keyword">extends</span> <span class="title">ExtendedServletRequestDataBinder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EmptyStringToNullRequestDataBinder</span><span class="params">(Object target, String objectName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(target, objectName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">addBindValues</span><span class="params">(MutablePropertyValues mpvs, ServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.addBindValues(mpvs, request);</span><br><span class="line">        <span class="keyword">for</span> (PropertyValue propertyValue : mpvs.getPropertyValueList()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (propertyValue.getValue().equals(<span class="string">""</span>))</span><br><span class="line">                propertyValue.setConvertedValue(<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ³¨å†Œå™¨"><a href="#æ³¨å†Œå™¨" class="headerlink" title="æ³¨å†Œå™¨"></a>æ³¨å†Œå™¨</h1><blockquote><p>è¯è¦ä»HandlerAdapteré‡Œç³»ç»Ÿè‡ªå¸¦çš„å¤„ç†å™¨è¯´èµ·ã€‚æˆ‘è¿™è¾¹ç³»ç»Ÿé»˜è®¤å¸¦äº†24ä¸ªå¤„ç†å™¨ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªServletModelAttributeMethodProcessorï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰å¤„ç†å™¨ç»§æ‰¿çš„ç³»ç»Ÿå¤„ç†å™¨ã€‚SpringMVCå¤„ç†è¯·æ±‚å‚æ•°æ˜¯è½®è¯¢æ¯ä¸€ä¸ªå¤„ç†å™¨ï¼Œçœ‹æ˜¯å¦æ”¯æŒï¼Œä¹Ÿå°±æ˜¯supportsParameteræ–¹æ³•ï¼Œ å¦‚æœè¿”å›trueï¼Œå°±äº¤ç»™ä½ å‡ºæ¥ï¼Œå¹¶ä¸ä¼šé—®ä¸‹é¢çš„å¤„ç†å™¨ã€‚è¿™å°±å¯¼è‡´äº†å¦‚æœæˆ‘ä»¬ç®€å•çš„æŠŠæˆ‘ä»¬çš„è‡ªå®šä¹‰å¤„ç†å™¨åŠ åˆ°HandlerAdapterçš„Resolveråˆ—ä¸­æ˜¯ä¸è¡Œçš„ï¼Œéœ€è¦åŠ åˆ°ç¬¬ä¸€ä¸ªå»ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmptyStringToNullProcessorRegistry</span> <span class="keyword">implements</span> <span class="title">ApplicationContextAware</span>, <span class="title">BeanFactoryPostProcessor</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext applicationContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setApplicationContext</span><span class="params">(ApplicationContext applicationContext)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.applicationContext = applicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postProcessBeanFactory</span><span class="params">(ConfigurableListableBeanFactory beanFactory)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line"></span><br><span class="line">        RequestMappingHandlerAdapter requestMappingHandlerAdapter = applicationContext.getBean(RequestMappingHandlerAdapter.class);</span><br><span class="line"></span><br><span class="line">        List&lt;HandlerMethodArgumentResolver&gt; resolvers = requestMappingHandlerAdapter.getArgumentResolvers();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        List&lt;HandlerMethodArgumentResolver&gt; newResolvers = <span class="keyword">new</span> ArrayList&lt;HandlerMethodArgumentResolver&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (HandlerMethodArgumentResolver resolver : resolvers) &#123;</span><br><span class="line">            newResolvers.add(resolver);</span><br><span class="line">        &#125;</span><br><span class="line">        EmptyStringToNullModelAttributeMethodProcessor processor = <span class="keyword">new</span> EmptyStringToNullModelAttributeMethodProcessor(<span class="keyword">true</span>);</span><br><span class="line">        processor.setApplicationContext(applicationContext);</span><br><span class="line">        newResolvers.add(<span class="number">0</span>, processor);</span><br><span class="line">        requestMappingHandlerAdapter.setArgumentResolvers(Collections.unmodifiableList(newResolvers));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="XMLé…ç½®"><a href="#XMLé…ç½®" class="headerlink" title="XMLé…ç½®"></a>XMLé…ç½®</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:argument-resolvers</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"studio.geek.databind.EmptyStringToNullModelAttributeMethodProcessor"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"annotationNotRequired"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">mvc:argument-resolvers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æœ€åå°±å¯ä»¥å®Œæˆå°†ç©ºå­—ç¬¦ä¸²è½¬ä¸º<code>null</code></strong></p><p>å‚è€ƒæ–‡æ¡£</p><ol><li><a href="http://blog.csdn.net/zgzczzw/article/details/53912966" target="_blank" rel="noopener"> SpringMVCå¯¹è±¡ç»‘å®šæ—¶è‡ªå®šä¹‰åç§°å¯¹åº”å…³ç³»</a></li><li><a href="http://neoremind.com/2016/02/springmvc%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" target="_blank" rel="noopener">SpringMVCæºç åˆ†æå’Œä¸€äº›å¸¸ç”¨æœ€ä½³å®è·µ</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>ä»€ä¹ˆæ˜¯ä¼˜ç§€çš„ç¨‹åºå‘˜</title>
      <link href="/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BC%98%E7%A7%80%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%91%98/"/>
      <url>/%E4%BB%80%E4%B9%88%E6%98%AF%E4%BC%98%E7%A7%80%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%91%98/</url>
      
        <content type="html"><![CDATA[<p><strong>å†…å®¹è½¬è‡ª</strong></p><p><a href="http://coolshell.cn/articles/4506.html" target="_blank" rel="noopener">å†è°ˆâ€œæˆ‘æ˜¯æ€ä¹ˆæ‹›è˜ç¨‹åºå‘˜çš„â€ï¼ˆä¸Š - é™ˆçš“</a></p><p>æˆ‘ä»¥å‰å†™è¿‡ä¸€ç¯‡â€œæˆ‘æ˜¯æ€ä¹ˆæ‹›è˜ç¨‹åºå‘˜çš„â€çš„æ–‡ç« ï¼ˆåœ¨CSDNé‚£é‡Œæœ‰å¾ˆå¤šäººè¿›è¡Œäº†å›å¤ï¼‰ã€‚ä»Šå¤©ï¼Œæˆ‘æƒ³å†è°ˆè°ˆå…³äºæ‹›è˜å’Œé¢è¯•è¿™æ–¹é¢çš„ä¸œè¥¿ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹è¿™äº›åŸå› ï¼š</p><a id="more"></a><ul><li>è¿‘åŠå¹´æ¥æˆ‘åœ¨è¿›è¡Œäº†å¤§é‡çš„æ‹›è˜å·¥ä½œï¼Œå¯¹é¢è¯•æœ‰ä¸€äº›æ–°çš„ä½“ä¼šã€‚</li><li>é…·å£³æœ€è¿‘å‘å¸ƒäº†å‡ ç¯‡è¶£å‘³é¢è¯•é¢˜ï¼ˆé¢è¯•é¢˜ä¸€ï¼Œé¢è¯•é¢˜äºŒï¼Œé¢è¯•é¢˜ä¸‰ï¼‰ï¼Œä»å›å¤ä¸­è®©æˆ‘æœ‰ä¸€äº›æ€è€ƒã€‚</li><li>æˆ‘æœ‰ä¸€ä¸ªåŒäº‹æœ€è¿‘é¢è¯•äº†ä¸€å®¶å…¬å¸ï¼Œä»–å’Œæˆ‘åˆ†äº«äº†ä¸€ä¸ªåšå£«ä¸“å®¶å¯¹ä»–çš„é¢è¯•ï¼Œä¹Ÿè®©æˆ‘æ€è€ƒäº†ä¸€äº›ã€‚</li><li>åœ¨è±†ç“£ä¸Šçœ‹åˆ°â€œçŸ¥ä¹ä¸ŠæŸäººå†™é¢è¯•è±†ç“£äº§å“ç»ç†çš„ç»å†ï¼Œå¾ˆæ¬¢ä¹â€(äº®ç‚¹æ˜¯é¢è¯•å®˜ç°èº«çŸ¥ä¹äº²è‡ªä½œç­”)</li></ul><p>æ‰€ä»¥ï¼Œæˆ‘å¾ˆæƒ³æŠŠè‡ªå·±çš„è¿™äº›æ–°çš„æƒ³æ³•å†æ¬¡å†™ä¸‹æ¥çš„ã€‚è¿˜æ˜¯å’Œä»¥å‰ä¸€æ ·ï¼Œè¿™ç¯‡æ–‡ç« åŒæ ·æ˜¯çŒ®ç»™é¢è¯•å®˜çš„ã€‚æˆ‘è®¤ä¸ºï¼Œé¢è¯•çš„å¥½åå®Œå…¨åœ¨é¢è¯•å®˜è€Œä¸æ˜¯é¢è¯•çš„äººã€‚ä¸‹é¢æ˜¯æˆ‘å¯¹â€œæˆ‘æ˜¯æ€ä¹ˆæ‹›è˜ç¨‹åºå‘˜çš„â€ä¸€æ–‡ä¸­çš„ä¸€äº›åŠ å¼ºæ€§çš„è§‚ç‚¹ã€‚ï¼ˆå…³äºä¸€äº›ç‚¹è¯„ï¼Œè¯·å‚çœ‹æœ¬æ–‡ä¸‹ç¯‡ï¼‰</p><p>ä¸ºäº†è®©æˆ‘çš„æ–‡ç« æœ‰è¿ç»­æ€§ï¼Œè¯·å…è®¸æˆ‘é‡ç”³ä¸€ä¸‹å‰æ–‡çš„å‡ ä¸ªé‡è¦è§‚ç‚¹ã€‚</p><ul><li><strong>åªæœ‰åº”è˜è€…çœŸå®å’Œè‡ªç„¶çš„è¡¨ç°ï¼Œæ‰èƒ½äº†è§£åˆ°æœ€çœŸå®çš„ä¸œè¥¿</strong></li><li><strong>é‡è¦çš„ä¸æ˜¯çŸ¥è¯†ï¼Œé‡è¦çš„æ˜¯å…¶æŸ¥æ‰¾çŸ¥è¯†çš„èƒ½åŠ›</strong></li><li><strong>é‡è¦çš„ä¸æ˜¯é‚£ä¸ªè§£é¢˜çš„ç­”æ¡ˆï¼Œè€Œæ˜¯è§£é¢˜çš„æ€è·¯å’Œæ–¹æ³•</strong></li></ul><blockquote><p><strong>æ“ä½œï¼ŒçŸ¥è¯†ï¼Œç»éªŒï¼Œèƒ½åŠ›</strong></p></blockquote><p>æˆ‘ä»¬æœ‰å¾ˆå¤šçš„é¢è¯•å®˜ä¼¼ä¹åˆ†ä¸æ¸…ï¼Œä»€ä¹ˆæ˜¯æ“ä½œèƒ½åŠ›ï¼Œä»€ä¹ˆæ˜¯çŸ¥è¯†ï¼Œä»€ä¹ˆæ˜¯ç»éªŒï¼Œä»€ä¹ˆæ˜¯èƒ½åŠ›ï¼Œè¿™å¯¼è‡´äº†æˆ‘ä»¬çš„é¢è¯•å®˜ç»å¸¸é”™è¯¯åœ°å¯¹é¢è¯•è€…ä¸‹ç»“è®ºï¼Œæˆ‘è®¤ä¸ºåˆ†ä¸æ¸…è¿™äº›äº‹çš„äººæ˜¯æ²¡æœ‰èµ„æ ¼åšé¢è¯•å®˜çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘æœ‰å¿…è¦åœ¨è¿™é‡ŒæŠŠè¿™ä¸ªé—®é¢˜å…ˆè®²æ¸…æ¥šã€‚</p><ul><li><strong>æ“ä½œ</strong>ã€‚æˆ‘ä»¬çš„é¢è¯•å®˜åˆ†ä¸æ¸…æ¥šä»€ä¹ˆæ˜¯æ“ä½œæŠ€èƒ½ï¼Œä»€ä¹ˆæ˜¯çŸ¥è¯†ï¼Œä»–ä»¬ç”šè‡³è®¤ä¸ºæ“ä½œæŠ€èƒ½å°±æ˜¯çŸ¥è¯†ç”šè‡³ç»éªŒã€‚æ¯”å¦‚ä»–ä»¬ä¼šé—®å¦‚ä¸‹çš„é—®é¢˜ï¼Œè¯·é—®:Javaä¸­çš„finalæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ€ä¹ˆæŸ¥çœ‹è¿›ç¨‹çš„CPUåˆ©ç”¨ç‡ï¼Ÿæ€ä¹ˆç¼–å†™ä¸€ä¸ªç®¡é“ç¨‹åºï¼Ÿæ€ä¹ˆæŸ¥çœ‹è¿›ç¨‹çš„ç¨‹åºè·¯å¾„ï¼ŸVIä¸­çš„æ‹·è´ç²˜è´´å‘½ä»¤æ˜¯ä»€ä¹ˆï¼ŸåŒ…æ‹¬é¢å‘å¯¹è±¡çš„XXæ¨¡å¼æ˜¯ä»€ä¹ˆã€‚ç­‰ç­‰ã€‚æˆ‘ä»¥ä¸ºï¼Œ<strong>è¿™äº›èƒ½å¤Ÿé€šè¿‡æŸ¥å†µç›¸å…³æ“ä½œæ‰‹å†Œæˆ–æ˜¯èƒ½å¤Ÿgoogleåˆ°çš„ä¸œè¥¿åªèƒ½è¯´æ˜è¿™ä¸ªäººçš„æ“ä½œæŠ€æœ¯ï¼Œå¹¶ä¸èƒ½è¯´æ˜ä»–æœ‰çŸ¥è¯†æˆ–æœ‰ç»éªŒã€‚</strong></li><li><strong>çŸ¥è¯†</strong>ã€‚çŸ¥è¯†æ˜¯ä¸€ä¸ªäººè®¤çŸ¥å’Œå­¦ä¹ çš„ä½“ç°ï¼Œå¯èƒ½ä¼šæ˜¯ä¸€äº›åŸºç¡€æ¦‚å¿µå’ŒçŸ¥è¯†ã€‚æ¯”å¦‚è¿™äº›é—®é¢˜ï¼šTCPå’ŒUDPçš„ä¼˜ç¼ºç‚¹æ¯”è¾ƒï¼Œé“¾è¡¨å’Œå“ˆå¸Œè¡¨çš„ä¼˜ç¼ºç‚¹çš„æ¯”è¾ƒã€‚ä»€ä¹ˆæ˜¯å †ä»€ä¹ˆæ˜¯æ ˆï¼Ÿè¿›ç¨‹é—´æ˜¯æ€ä¹ˆé€šä¿¡çš„ï¼Ÿè¿›ç¨‹å’Œçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹ï¼ŸåŒæ­¥å’Œå¼‚æ­¥çš„ä¼˜ç¼ºç‚¹ï¼Ÿé¢å‘å¯¹è±¡çš„XXè®¾è®¡æ¨¡å¼çš„ä¸»è¦åŸåˆ™æ˜¯ä»€ä¹ˆï¼Œç­‰ç­‰ã€‚æˆ‘ä»¥ä¸ºï¼Œ<strong>â€œçŸ¥å…¶ç„¶â€åªæ˜¯æ“ä½œæŠ€æœ¯ï¼Œâ€çŸ¥å…¶æ‰€ä»¥ç„¶â€æ‰æ˜¯çœŸæ­£çš„çŸ¥è¯†</strong>ã€‚çŸ¥è¯†ä¸å¤Ÿå¹¶ä¸ä»£è¡¨ä»–ä¸èƒ½å·¥ä½œï¼Œä¼šæ“ä½œæŠ€èƒ½å°±å¯ä»¥åº”ä»˜å·¥ä½œï¼Œä½†æ˜¯çŸ¥è¯†çš„æ¬ ç¼ºä¸€å®šä¼šé™åˆ¶ä½ çš„ç»éªŒå’Œèƒ½åŠ›ï¼ŒåŒæ ·ä¼šå½±å“ä½ çš„å¼€å‘è´¨é‡ã€‚</li><li><strong>ç»éªŒ</strong>ã€‚ç»éªŒé€šå¸¸è·Ÿä¸€ä¸ªäººçš„ç»å†æœ‰å…³ç³»ã€‚ä¸€ä¸ªäººçš„çŸ¥è¯†èŒƒå›´ï¼Œä¸€ä¸ªäººç»å†è¿‡çš„äº‹ï¼Œé€šå¸¸ä¼šæˆä¸ºä¸€ä¸ªäººç»éªŒçš„ä½“ç°ã€‚é¢è¯•ä¸­ï¼Œæˆ‘ä»¬ä¼šé—®è¿™äº›é—®é¢˜ï¼šä½ è§£å†³è¿‡æœ€éš¾çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿä½ æ˜¯æ€ä¹ˆè®¾è®¡è¿™ä¸ªç³»ç»Ÿçš„ï¼Ÿä½ æ˜¯æ€ä¹ˆè°ƒè¯•å’Œæµ‹è¯•ä½ çš„ç¨‹åºçš„ï¼Ÿä½ æ˜¯æ€ä¹ˆåšæ€§èƒ½è°ƒä¼˜çš„ï¼Ÿä»€ä¹ˆæ ·çš„ä»£ç æ˜¯å¥½çš„ ä»£ç ï¼Ÿç­‰ç­‰ã€‚å¯¹äºå·¥ä½œå¹´é™ä¸é•¿çš„äººæ¥è¯´ï¼Œç»å†å’Œåšè¿‡çš„äº‹çš„ç¡®ä¼šæˆä¸ºå…¶ç»éªŒçš„ä¸»è¦å› ç´ ï¼Œå°¤å…¶æ˜¯ä¸šåŠ¡ä¸Šçš„æœ‰è¡Œä¸šèƒŒæ™¯çš„ä¸œè¥¿ã€‚ä½†æ˜¯ï¼Œæˆ‘æ›´ä»¥ä¸ºï¼Œ<strong>ç»éªŒå¯èƒ½æ›´å¤šçš„æ˜¯ä½ å¯¹çŸ¥è¯†çš„è¿ç”¨å’Œé©¾é©­ï¼Œæ˜¯ä½ å¯¹åšè¿‡äº‹æƒ…çš„åæ€å’Œæ€»ç»“ï¼Œæ˜¯ä½ å¯¹ä»–äººçš„å­¦ä¹ ï¼Œè§‚å¯Ÿå’Œäº¤æµã€‚</strong></li><li><p><strong>èƒ½åŠ›</strong>ã€‚ä¸€ä¸ªäººçš„èƒ½åŠ›å¹¶ä¸ä¼šå› ä¸ºçŸ¥é“ä¸œè¥¿å°‘è€Œä¸è¡Œï¼Œä¹Ÿä¸ä¼šå› ä¸ºæ²¡æœ‰ç»éªŒè€Œæ²¡æœ‰èƒ½åŠ›ã€‚<strong>ä¸€ä¸ªäººçš„èƒ½åŠ›æ˜¯ä»–åšäº‹æƒ…çš„ä¸€ç§æ€åº¦ï¼Œæ€§æ ¼ï¼Œæƒ³æ³•ï¼Œæ€è·¯ï¼Œè¡Œä¸ºï¼Œæ–¹æ³•å’Œé£æ ¼ã€‚åªè¦æœ‰çƒ­æƒ…ï¼Œæœ‰æƒ³æ³•ï¼Œæœ‰å¥½çš„è¡Œä¸ºæ–¹æ³•ï¼Œä»¥åŠå¥½çš„è¡Œäº‹é£æ ¼ï¼Œé‚£ä¹ˆçŸ¥è¯†å’Œç»éªŒå¯¹ä»–æ¥è¯´åªæ˜¯ä¸€ä¸ªæ—¶é—´é—®é¢˜ã€‚</strong> æ¯”å¦‚ï¼šå­¦ä¹ èƒ½åŠ›ï¼Œä¸“ç ”ç²¾ç¥ï¼Œåˆ†æèƒ½åŠ›ï¼Œæ²Ÿé€šèƒ½åŠ›ï¼Œç»„ç»‡èƒ½åŠ›ï¼Œé—®é¢˜è°ƒæŸ¥èƒ½åŠ›ï¼Œåˆä½œèƒ½åŠ›ç­‰ç­‰ã€‚æ‰€ä»¥ï¼Œå¯¹äºä¸€ä¸ªæ–°æ‰‹æ¥è¯´ï¼Œä¹Ÿè®¸ä»–çš„çŸ¥è¯†å’Œç»éªŒæœ‰é™ï¼Œä½†å¹¶ä¸ä»£è¡¨ä»–èƒ½åŠ›ä¸Šæœ‰é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªè€æ‰‹æ¥è¯´ï¼Œå¦‚æœå…¶å­˜åœ¨çŸ¥è¯†å’Œç»éªŒæ¬ ç¼ºçš„é—®é¢˜ï¼Œé‚£ä¹ˆé€šå¸¸éƒ½æ˜¯å…¶èƒ½åŠ›çš„é—®é¢˜ã€‚ä½ å¯èƒ½æš‚æ—¶æ€€æ‰ä¸é‡ï¼Œä½†æˆ‘ä¸ç›¸ä¿¡ä½ ä¼šé•¿æœŸæ€€æ‰ä¸é‡ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œé‚£ä¹ˆä½ å¿…ç„¶äº›é—®é¢˜å…¶è®©ä½ çš„èƒ½åŠ›å‘æŒ¥ä¸å‡ºæ¥ã€‚è€Œæ­¤æ—¶ï¼Œâ€æ²¡æœ‰ç»å†è¿‡â€åªä¼šæ˜¯ä½ â€æ²¡æœ‰èƒ½åŠ›â€çš„ä¸€ä¸ªå€Ÿå£ã€‚<br>æˆ‘ä¸å¦è®¤è¿™å››æ ·ä¸œè¥¿å¯¹äºä¸€ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜æ¥è¯´éƒ½å¾ˆé‡è¦ã€‚ä½†æ˜¯ï¼Œé€šè¿‡ä¸Šè¿°çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œèƒ½åŠ›å’Œç»éªŒå’ŒçŸ¥è¯†éœ€è¦åˆ†å¼€å¯¹å¾…ã€‚å½“ç„¶ï¼Œè¿™äº›ä¸œè¥¿æ˜¯ç›¸è¾…ç›¸æˆçš„ï¼Œ<strong>ä½ çš„èƒ½åŠ›å¯ä»¥è®©ä½ è·å¾—çŸ¥è¯†ï¼Œä½ çš„çŸ¥è¯†å¯ä»¥è®©ä½ æ›´æœ‰ç»éªŒï¼Œä½ çš„ç»éªŒåˆä¼šæ”¹å˜ä½ çš„æƒ³æ³•å’Œæ€è·¯ï¼Œä»è€Œæ”¹å–„ä½ çš„èƒ½åŠ›ã€‚åœ¨é¢è¯•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ¸…æ¥šçš„è®¤è¯†åˆ°ï¼Œåº”è˜è€…çš„æ“ä½œæŠ€èƒ½ï¼ŒçŸ¥è¯†å’Œç»éªŒåªæ˜¯å…¶èƒ½åŠ›çš„å¿…è¦æ¡ä»¶ï¼Œå¹¶ä¸æ˜¯å……è¦æ¡ä»¶ï¼Œè€Œæˆ‘ä»¬æ›´åº”è¯¥å…³æ³¨äºåº”è˜è€…çš„èƒ½åŠ›ã€‚</strong></p></li><li><p>å¦‚æœé¢è¯•åªæ˜¯è€ƒæŸ¥è¿™ä¸ªäººçš„æ“ä½œæŠ€èƒ½çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªé¢è¯•å®Œå…¨å¤±è´¥ã€‚è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰èµ„æ ¼çš„é¢è¯•å®˜ã€‚</p></li><li>å¦‚æœé¢è¯•åªæ˜¯åœ¨è€ƒæŸ¥è¿™ä¸ªäººçš„çŸ¥è¯†å’Œç»éªŒçš„è¯ï¼Œé‚£ä¹ˆæˆåŠŸäº†ä¸€åŠã€‚å› ä¸ºä½ äº†è§£äº†åŸºç¡€çŸ¥å’Œåšè¿‡çš„äº‹ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ä½ å®Œå…¨äº†è§£ä»–çš„çœŸæ­£èƒ½åŠ›ã€‚</li><li>å¦‚æœä½ èƒ½å¤Ÿåœ¨äº†è§£è¿™ä¸ªäººçš„çŸ¥è¯†å’Œç»éªŒçš„è¿‡ç¨‹ä¸­é‡ç‚¹å…³æ³¨å…¶èƒ½åŠ›ï¼ˆæ€åº¦ã€æ€§æ ¼ã€æƒ³æ³•ï¼Œæ€è·¯ï¼Œè¡Œä¸ºï¼Œæ–¹æ³•å’Œé£æ ¼ï¼‰ï¼Œå¹¶èƒ½æ­£ç¡®åœ°è¯„ä¼°è¿™ä¸ªäººçš„èƒ½åŠ›ï¼Œé‚£ä¹ˆä½ çš„é¢è¯•ç®—æ˜¯éå¸¸æˆåŠŸçš„ã€‚</li></ul><p>ä¹Ÿè®¸ç”¨è¿™å››ä¸ªè¯æ¥æè¿°å®šå¥—ä¸œè¥¿å¹¶ä¸å¤ªåˆé€‚ï¼Œä½†æˆ‘ç›¸ä¿¡ä½ æ˜ç™½æˆ‘æƒ³è¡¨è¾¾çš„ã€‚å¦å¤–ï¼Œæˆ‘æƒ³è¯´çš„æ˜¯ï¼Œ<strong>æˆ‘ä»¬ä¸æ˜¯å‡ºä¸ªé¢˜æ¥è€ƒå€’åº”è˜è€…ï¼Œè€Œæ˜¯è¦æ‰¾åˆ°åº”è˜è€…çš„äº®ç‚¹å’Œé•¿å¤„ã€‚</strong></p><blockquote><p><strong>ä¸è¦è‚¤æµ…åœ°è®¤è¯†ç®—æ³•é¢˜å’Œæ™ºåŠ›é¢˜</strong></p></blockquote><p>å¾ˆå¤šå…¬å¸éƒ½ä¼šåœ¨é¢è¯•çš„æ—¶å€™ç»™ä¸€äº›ç®—æ³•é¢˜æˆ–æ˜¯ä¸€äº›æ™ºåŠ›é¢˜æˆ–æ˜¯ä¸€äº›è®¾è®¡é¢˜ï¼Œæˆ‘ç›¸ä¿¡ç®—æ³•é¢˜æˆ–æ˜¯æ™ºåŠ›é¢˜æ˜¯ç¨‹åºå‘˜ä»¬åœ¨é¢è¯•è¿‡ç¨‹ä¸­æœ€åæ„Ÿçš„äº‹äº†ã€‚å¾ˆå¤šäººéƒ½å¾ˆBSé¢è¯•å®˜é—®çš„ç®—æ³•é¢˜ï¼Œå› ä¸ºä»–ä»¬è®¤ä¸ºé¢è¯•å®˜é—®çš„è¿™äº›ç®—æ³•é¢˜æˆ–æ™ºåŠ›é¢˜åœ¨å®é™…å·¥ä½œå½“ä¸­ç”¨ä¸åˆ°ã€‚ä½†æˆ‘æƒ³åœ¨è¿™é‡Œè¯´ï¼Œ<strong>é—®éš¾çš„ç®—æ³•æ™ºåŠ›é¢˜å¹¶æ²¡æœ‰é”™ï¼Œé”™çš„å¾ˆå¤šé¢è¯•å®˜åªæ˜¯åœ¨è‚¤æµ…ç”šè‡³é”™è¯¯åœ°ç†è§£ç€é¢è¯•ä¸­çš„éš¾é¢˜çš„ç›®çš„ã€‚</strong>  ä»–ä»¬è®¤ä¸ºï¼Œèƒ½åšå‡ºç®—æ³•é¢˜å’Œæ™ºåŠ›é¢˜çš„äººå°±æ˜¯èªæ˜çš„äººå°±æ˜¯æœ‰èƒ½åŠ›çš„äººï¼Œè¿™ç§æƒ³æ³•å®åœ¨æ˜¯ç›¸å½“çš„è‚¤æµ…ã€‚</p><p>å…¶å®ï¼Œèƒ½è§£éš¾é¢˜å¹¶ä¸æ„å‘³ç€è¿™ä¸ªäººå°±æœ‰èƒ½åŠ›å°±èƒ½åœ¨å·¥ä½œä¸­è§£å†³é—®é¢˜ï¼Œä½ å¯ä»¥æƒ³æƒ³ï¼Œå°å­¦å¥¥æ•°é¢˜å¯èƒ½æ¯”è¿™äº›é¢˜æ›´éš¾ï¼Œä½†å¹¶ä¸æ„å‘³ç€é‚£äº›å¥¥æ•°èƒ½æ‰‹å°±æœ‰å®é™…å·¥ä½œèƒ½åŠ›ã€‚ä½ å¯ ä»¥æƒ³ä¸€æƒ³ä½ ä»¬ç­è€ƒè¯•å¾—é«˜åˆ†çš„åŒå­¦å¹¶ä¸ä¸€å®šå°±æ˜¯èªæ˜çš„äººï¼Œä¹Ÿä¸ä¸€å®šå°±æ˜¯æœ‰èƒ½åŠ›çš„äººï¼Œç›¸åï¼Œè¿™æ ·çš„äººå¾€å¾€è€…æ˜¯åœ¨åº”è¯•æ•™è‚²ä¸‹åŸ¹å…»å‡ºæ¥çš„ä¹¦å‘†å­ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘è®¤ä¸ºè§£éš¾é¢˜çš„è¿‡ç¨‹æ›´é‡è¦ï¼Œä½ è¦ä¸»è¦æ˜¯é€šè¿‡è§£é¢˜æŸ¥çœ‹è¿™ä¸ªåº”è˜è€…çš„æ€è·¯ï¼Œæ–¹æ³•ï¼Œè¿ç”¨åˆ°çš„çŸ¥è¯†ï¼Œæœ‰æ²¡æœ‰ä¸€äº›ç»éªŒï¼Œå’Œä½ ä¸€èµ·äº¤äº’æ—¶å’Œæ²Ÿé€šå¾—æ˜¯å¦é¡ºç•…ï¼Œç­‰ç­‰ï¼Œè¿™äº›æ‰æ˜¯ä½ é‡ç‚¹è¦å»è§‚å¯Ÿçš„ã€‚å½“ç„¶ï¼Œæœ€ç»ˆæ˜¯è¦æ‰¾åˆ°ç­”æ¡ˆçš„ã€‚</p><p>æˆ‘æƒ³ï¼Œè®©é¢è¯•è€…è§£å†³ä¸€ä¸ªéš¾é¢˜çš„çœŸæ­£æ€è·¯æ˜¯ï¼š</p><ul><li><strong>çœ‹çœ‹ä»–å¯¹çŸ¥è¯†çš„åº”ç”¨å’Œç†è§£ã€‚</strong> æ¯”å¦‚ï¼Œä»–æ˜¯å¦ä¼šç”¨ä¸€äº›åŸºç¡€çš„æ•°æ®ç»“æ„å’Œç®—æ³•æ¥è§£å†³ç®—æ³•é¢˜ï¼Ÿ</li><li><strong>çœ‹çœ‹ä»–çš„æ•´ä¸ªè§£é¢˜æ€è·¯å’Œæƒ³æ³•ã€‚</strong> ç­”æ¡ˆæ˜¯æ¬¡è¦çš„ï¼Œä»–çš„æƒ³æ³•å’Œè¡Œä¸ºæ‰æ˜¯é‡è¦çš„ã€‚</li><li><strong>çœ‹çœ‹ä»–æ˜¯å¦‚ä½•å’Œä½ è®¨è®ºäº¤æµçš„ã€‚</strong> æŠŠé¢è¯•è€…å½“æˆä½ æœªæ¥çš„åŒäº‹ï¼Œå½“æˆä½ çš„å·¥ä½œä¼™ä¼´ï¼Œä¸€èµ·è§£é¢˜ï¼Œä¸€èµ·è®¨è®ºï¼Œè¿™æ ·å¯ä»¥çœ‹çœ‹å¤§å®¶æ˜¯å¦å¯ä»¥åœ¨ä¸€èµ·å·¥ä½œã€‚</li></ul><p>è¿™äº›æ–¹é¢æ‰æ˜¯è€ƒæŸ¥åº”è˜è€…çš„èƒ½åŠ›ï¼ˆæ€è·¯ï¼Œæ–¹æ³•ã€æ€åº¦ï¼Œæ€§æ ¼ç­‰ï¼‰ï¼Œå¹¶é¡ºå¸¦ç€è€ƒæŸ¥é¢è¯•è€…çš„ç»éªŒå’ŒçŸ¥è¯†ã€‚ä¸‹é¢æ˜¯ä¸€äº›é¢è¯•çš„ç‚¹ï¼š</p><ul><li>åº”è˜è€…åœ¨è§£ç®—æ³•é¢˜æ—¶ä¼šä¸ä¼šåˆ†è§£æˆ–ç®€åŒ–è¿™ä¸ªéš¾é¢˜ã€‚è¿™æ˜¯åˆ†æèƒ½åŠ›ã€‚</li><li>åº”è˜è€…åœ¨è§£ç®—æ³•é¢˜ æ—¶ä¼šä¸ä¼šä½¿ç”¨ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œå¦‚æ•°æ®ç»“æ„å’ŒåŸºç¡€ç®—æ³•ã€‚è¿™æ˜¯çŸ¥è¯†ã€‚</li><li>åº”è˜è€…åœ¨è§£é¢˜ æ—¶å’Œä½ è®¨è®ºçš„è¿‡ç¨‹ä¸­ä½ æœ‰æ²¡æœ‰æ„Ÿåˆ°åº”è˜è€…çš„ä¸“ç ”ç²¾ç¥å’Œè‰¯å¥½çš„æ²Ÿé€šã€‚</li><li>åº”è˜è€…åœ¨å¯¹å¾…è¿™ä¸ªç®—æ³•é¢˜çš„å¿ƒæ€å’Œæ€åº¦ã€‚å¦‚ï¼Œé¢è¯•é¢æ˜¯å¦æœ‰ç•éš¾æƒ…ç»ªã€‚</li><li>åº”è˜è€…åœ¨è§£é¢˜æ—¶çš„æ€è·¯å’Œæ–¹æ³•æ˜¯å¦å¾—å½“ï¼Œæ˜¯å¦æ˜¯æ¯”è¾ƒç§‘å­¦çš„æ–¹æ³•ï¼Ÿ</li><li>ç­‰ç­‰ã€‚</li></ul><p><strong>åœ¨è§£éš¾é¢˜ çš„è¿‡ç¨‹ä¸­è€ƒæŸ¥åº”è˜è€…çš„èƒ½åŠ›æ‰æ˜¯æœ€ç»ˆç›®çš„ï¼Œè€Œä¸æ˜¯ä¸ºéš¾åº”è˜è€…ï¼Œä¸ç„¶ï¼Œä½ åªæ˜¯ä¸€ä¸ªå‚²æ…¢è€Œæ— çŸ¥çš„é¢è¯•å®˜ã€‚</strong></p><blockquote><p><strong>æ¨¡æ‹Ÿå®é™…ä¸­çš„æŒ‘æˆ˜å’Œèƒ½åŠ›</strong></p></blockquote><p>ä½œä¸ºé¢è¯•å®˜çš„ä½ ï¼Œä½ åº”è¯¥å¤šæƒ³æƒ³ä½ çš„å·¥ä½œï¼Œä»¥åŠä½ çš„æˆé•¿ç»å†ã€‚è¿™ä¼šå¯¹ä½ çš„é¢è¯•å¾ˆæœ‰å¸®åŠ©ã€‚ä½ åœ¨å·¥ä½œä¸­è§£å†³é—®é¢˜çš„å®é™…æƒ…å†µæ˜¯ä»€ä¹ˆï¼Ÿä½ å†™ä»£ç çš„å®é™…æƒ…å†µæ˜¯ä»€ä¹ˆï¼Ÿä½ çš„æˆé•¿ç»å†æ˜¯ä»€ä¹ˆï¼Ÿä½ æ˜¯æ€ä¹ˆè·å¾—çŸ¥è¯†å’Œèƒ½åŠ›çš„ï¼Ÿä½ å–œæ¬¢å’Œä»€ä¹ˆæ ·çš„äººå·¥ä½œï¼Ÿ<strong>ç›¸ä¿¡ä½ ä¸éš¾ä¼šå‘ç°ä½ å·¥ä½œä¸­çš„å®é™…æƒ…å†µå’Œé¢è¯•çš„æƒ…å†µå®Œå…¨æ˜¯ä¸¤ç äº‹ï¼Œé‚£ä¹ˆï¼Œä½ æ€ä¹ˆå¯ä»¥ç”¨è¿™ç§ä¸å®é™…æƒ…å†µå·®åˆ«é‚£ä¹ˆå¤§çš„é¢è¯•æ¥è¯„ä¼°ä¸€ä¸ªäººçš„èƒ½åŠ›å‘¢ï¼Ÿ</strong></p><p>æ‰€ä»¥ï¼Œæœ€ä¸ºç†æƒ³çš„é¢è¯•æ˜¯ä¸€èµ·å·¥ä½œä¸€æ®µæ—¶é—´ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåœ¨æ‹›è˜è¿‡ç¨‹ä¸­ï¼Œæ“ä½œèµ·æ¥å‡ ä¹ä¸å¯èƒ½ï¼Œå› æ­¤ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬çš„é¢è¯•å®˜å°½å¯èƒ½åœ°æŠŠé¢è¯•çš„è¿‡ç¨‹æ¨¡æ‹Ÿæˆå¹³æ—¶å·¥ä½œçš„ è¿‡ç¨‹ã€‚å¤§å®¶ä¸€äº›è®¨è®ºæ¥è§£å†³ä¸€ä¸ªéš¾é¢˜ï¼Œå’Œåº”è˜è€…ä¸€èµ·å›é¡¾ä¸€ä¸‹ä»–å·²ç»åšè¿‡çš„äº‹æƒ…ï¼Œå¹¶åœ¨å›ç¡€çš„è¿‡ç¨‹ä¸­ç›¸äº’è®¨è®ºç›¸äº’å­¦ä¹ ã€‚ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºè½¯ä»¶å¼€å‘æ¥è¯´ï¼Œå¼€å‘è½¯ä»¶ä¸éš¾ï¼Œéš¾æ˜¯çš„ä¸‹é¢æ˜¯è¿™äº›æŒ‘æˆ˜ï¼š</p><ol><li>è½¯ä»¶çš„ç»´æŠ¤æˆæœ¬è¿œè¿œå¤§äºè½¯ä»¶çš„å¼€å‘æˆæœ¬ã€‚</li><li>è½¯ä»¶çš„è´¨é‡å˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œæ‰€ä»¥ï¼Œæµ‹è¯•å·¥ä½œä¹Ÿå˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚</li><li>è½¯ä»¶çš„éœ€æ±‚æ€»æ˜¯åœ¨å˜çš„ï¼Œè½¯ä»¶çš„éœ€æ±‚æ€»æ˜¯ä¸€ç‚¹ä¸€ç‚¹å¾€ä¸ŠåŠ çš„ã€‚</li><li>ç¨‹åºä¸­å¤§é‡çš„ä»£ç éƒ½æ˜¯åœ¨å¤„ç†ä¸€äº›é”™è¯¯çš„æˆ–æ˜¯ä¸æ­£å¸¸çš„æµç¨‹ã€‚</li></ol><p>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬åœ¨è€ƒæŸ¥åº”è˜è€…çš„ä»£ç èƒ½åŠ›æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½æ¨¡æ‹Ÿè¿™æ ·çš„è¿‡ç¨‹å‘¢ï¼Ÿæ¯”å¦‚ï¼Œè®©åº”è˜è€…å®ç°ä¸€ä¸ªatoi()çš„å‡½æ•°ï¼Œå®ç°èµ·æ¥åº”è¯¥å¾ˆç®€å•ï¼Œç„¶å ä¸æ–­åœ°å¾€ä¸ŠåŠ æ–°çš„éœ€æ±‚æˆ–æ–°çš„æ¡ˆä¾‹ï¼Œæ¯”å¦‚ï¼šå¤„ç†ç¬¦å·ï¼Œå¤„ç†éæ•°å­—çš„å­—æ¯çš„æƒ…å†µï¼Œå¤„ç†æœ‰ç©ºæ ¼çš„æƒ…å†µï¼Œå¤„ç†åå…­è¿›åˆ¶ï¼Œå¤„ç†äºŒè¿›åˆ¶ï¼Œå¤„ç†â€œé€—å·â€ï¼Œç­‰ç­‰ï¼Œæˆ‘ä»¬è¦çœ‹ åº”è˜è€…æ˜¯æ€ä¹ˆä¿®æ”¹ä»–çš„ä»£ç çš„ï¼Œæ€ä¹ˆå†™æµ‹è¯•æ¡ˆä¾‹çš„ï¼Œæ€ä¹ˆé‡æ„çš„ï¼Œéšç€è¦å¤„ç†çš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šï¼Œä»–çš„ä»£ç æ˜¯å¦è¿˜æ˜¯é‚£ä¹ˆæ˜“è¯»å’Œæ¸…æ™°ã€‚å¦‚æœåªæ˜¯è€ƒæŸ¥ç¼–ç èƒ½åŠ›ï¼Œä¸€ä¸ªå°æ—¶ï¼Œå°±é—®è¿™ä¸€ä¸ªé—®é¢˜ï¼Œè¶³çŸ£ã€‚çœŸæ­£çš„ç¨‹åºå‘˜æ¯å¤©éƒ½åœ¨å’Œè¿™æ ·çš„äº‹æ‰“äº¤é“çš„ã€‚</p><p>å¦‚æœè¦è€ƒæŸ¥åº”è˜è€…çš„è®¾è®¡èƒ½åŠ›ï¼ŒåŒæ ·å¯ä»¥å¦‚æ³•æ³¡åˆ¶ã€‚ä¸æ–­åœ°åŠ æ–°çš„åŠŸ èƒ½ï¼Œæ–°çš„éœ€æ±‚ã€‚çœ‹çœ‹é¢è¯•è€…çš„æ€è·¯ï¼Œæƒ³æ³•ï¼Œåˆ† æçš„æ–¹æ³•ï¼Œå’Œä½ çš„è®¨è®ºæ˜¯å¦æµç•…ï¼Œè¯´æ²¡è¯´åœ¨ ç‚¹ä¸Šï¼Œæ€æƒ³æ¸…ä¸æ¸…æ™°ï¼Œä¼šåº”ç”¨ä»€ä¹ˆæ ·çš„çŸ¥è¯†ï¼Œä»–åœ¨è®¾è®¡è¿™ä¸ªç³»ç»Ÿæ—¶çš„ç»éªŒæ˜¯ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ï¼Œé¢å¯¹ä¸æ–­çš„ä¿®æ”¹å’Œè¶Šæ¥è¶Šå¤æ‚çš„éœ€æ±‚ï¼Œä»–çš„è®¾è®¡æ˜¯å¦è¿˜æ˜¯é‚£ä¹ˆå¥½ï¼Ÿ</p><p>å½“ç„¶ï¼Œå› ä¸ºæ—¶é—´æ¯”è¾ƒçŸ­ï¼Œæ‰€ä»¥ï¼Œä½ ä¸èƒ½å‡ºå¤ªå¤æ‚çš„é—®é¢˜ï¼Œè¿™éœ€è¦ä½ ç²¾å¿ƒè®¾è®¡ä¸€äº›ç²¾åˆ¶çš„æœ‰ä»£è¡¨æ€§çš„é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹æ€è€ƒ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¨‹åºäººç”Ÿ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Windowsä¸‹Nginxå®ç°è´Ÿè½½å‡è¡¡</title>
      <link href="/Nginx-Load-Balancing-under-Windows/"/>
      <url>/Nginx-Load-Balancing-under-Windows/</url>
      
        <content type="html"><![CDATA[<h1 id="Apache-Nginx"><a href="#Apache-Nginx" class="headerlink" title="Apache,Nginx"></a>Apache,Nginx</h1><p>Apacheå’ŒNginxéƒ½å±äºå±äº <strong>é™æ€é¡µé¢æœåŠ¡å™¨</strong>ï¼Œéƒ½æœ‰æ’ä»¶æ”¯æŒåŠ¨æ€ç¼–ç¨‹è¯­è¨€å¤„ç†ï¼Œä½†Nginxçš„IOæ¨¡æ¯”Apacheæ›´é€‚åˆè·‘ä»£ç†ã€‚æ‰€ä»¥ä¸€èˆ¬éƒ½ä½œä¸º<strong>å‰ç«¯ç¼“å†²ä»£ç†</strong>(Nginxçš„åå‘ä»£ç†åŠŸèƒ½)ã€‚<br><a id="more"></a></p><h1 id="Tomcat-Jetty"><a href="#Tomcat-Jetty" class="headerlink" title="Tomcat,Jetty"></a>Tomcat,Jetty</h1><p>tomcatå’ŒJettyéƒ½æ˜¯Java Servletå®¹å™¨ï¼Œå¯ä»¥ç”¨æ¥ç”ŸæˆåŠ¨æ€é¡µé¢ï¼Œä¸»è¦ç”¨æ¥è·‘Javaçš„WebåŠŸèƒ½ï¼Œå½“ç„¶ä¹Ÿæä¾›ä¸€ä¸ªç®€å•é™æ€é¡µé¢è½¬æ¢ï¼š</p><ul><li>Jetty æ˜¯é¢å‘ Handler çš„æ¶æ„ï¼Œå°±åƒ Spring æ˜¯é¢å‘ Bean çš„æ¶æ„ï¼ŒiBATIS æ˜¯é¢å‘ statement ä¸€æ ·ï¼Œè€Œ Tomcat æ˜¯ä»¥å¤šçº§å®¹å™¨æ„å»ºèµ·æ¥çš„ï¼Œå®ƒä»¬çš„æ¶æ„è®¾è®¡å¿…ç„¶éƒ½æœ‰ä¸€ä¸ªâ€œå…ƒç¥â€ï¼Œæ‰€æœ‰ä»¥è¿™ä¸ªâ€œå…ƒç¥â€œæ„å»ºçš„å…¶å®ƒç»„ä»¶éƒ½æ˜¯è‚‰èº«</li><li>Jetty å¯ä»¥å¾ˆå®¹æ˜“è¢«æ‰©å±•å’Œè£å‰ªï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒTomcat è¦è‡ƒè‚¿å¾ˆå¤šï¼ŒTomcat çš„æ•´ä½“è®¾è®¡ä¸Šå¾ˆå¤æ‚</li></ul><h1 id="è´Ÿè½½å‡è¡¡"><a href="#è´Ÿè½½å‡è¡¡" class="headerlink" title="è´Ÿè½½å‡è¡¡"></a>è´Ÿè½½å‡è¡¡</h1><p><strong>tomcatçš„æœ€å¤§ä¼˜åŠ¿åœ¨äºå¤„ç†åŠ¨æ€è¯·æ±‚</strong>ï¼Œå¤„ç†é™æ€å†…å®¹çš„èƒ½åŠ›ä¸å¦‚Apacheå’ŒNginxï¼Œå¹¶ä¸”ç»è¿‡æµ‹è¯•å‘ç°ï¼Œtomcatåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå…¶æ¥å—çš„æœ€å¤§å¹¶å‘è¿æ¥æ•°æ˜¯ç”±é™åˆ¶çš„ï¼Œè¿æ¥æ•°è¿‡å¤šä¼šå¯¼è‡´tomcatå¤„äºâ€åƒµæ­»â€çŠ¶æ€ï¼Œå› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<strong>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Nginxçš„é«˜å¹¶å‘ï¼Œä½æ¶ˆè€—çš„ç‰¹ç‚¹ä¸tomcatä¸€èµ·ä½¿ç”¨</strong>ã€‚å› æ­¤ï¼Œtomcatä¸Nginxã€Apacheç»“åˆä½¿ç”¨å…±æœ‰å¦‚ä¸‹å‡ ç‚¹åŸå› ï¼š</p><ol><li>Tomcatå¤„ç†htmlçš„èƒ½åŠ›ä¸å¦‚Apacheå’ŒNginxï¼Œtomcatå¤„ç†é™æ€å†…å®¹çš„é€Ÿåº¦ä¸å¦‚Apacheå’ŒNginxã€‚</li><li>tomcatæ¥å—çš„æœ€å¤§å¹¶å‘æ•°æœ‰é™ï¼Œæ¥è¿æ¥æ•°è¿‡å¤šï¼Œä¼šå¯¼è‡´tomcatå¤„äºâ€åƒµå°¸â€çŠ¶æ€ï¼Œå¯¹åç»­çš„è¿æ¥å¤±å»å“åº”ï¼Œéœ€è¦ç»“åˆNginxä¸€èµ·ä½¿ç”¨ã€‚</li></ol><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œtomcatä¸Nginxã€Apacheç»“åˆä½¿ç”¨ï¼ŒNginxã€Apacheæ—¢å¯ä»¥ä½œä¸º <strong>é™æ€é¡µé¢æœåŠ¡å™¨</strong>ï¼Œä¹Ÿå¯ä»¥ <strong>è½¬å‘åŠ¨æ€è¯·æ±‚</strong> è‡³tomcatæœåŠ¡å™¨ä¸Šã€‚ä½†åœ¨ä¸€ä¸ªé«˜æ€§èƒ½çš„ç«™ç‚¹ä¸Šï¼Œé€šå¸¸Nginxã€Apacheåªæä¾›ä»£ç†çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è½¬å‘è¯·æ±‚è‡³tomcatæœåŠ¡å™¨ä¸Šï¼Œè€Œå¯¹äºé™æ€å†…å®¹çš„å“åº”ï¼Œåˆ™ç”±å‰ç«¯ <strong>è´Ÿè½½å‡è¡¡</strong> å™¨æ¥è½¬å‘è‡³ä¸“é—¨çš„é™æ€æœåŠ¡å™¨ä¸Šè¿›è¡Œå¤„ç†ã€‚å…¶æ¶æ„ç±»ä¼¼äºå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://images.morethink.cn/morethink/images/tomcat-redis-nginx.png" alt="tomcat-redis-Nginx" title="è´Ÿè½½å‡è¡¡"></p><p>åœ¨è¿™ç§æ¶æ„ä¸­:</p><ul><li>Nginxä½œä¸ºå‰ç«¯ä»£ç†æ—¶ï¼Œå¦‚æœæ˜¯é™æ€å†…å®¹ï¼Œå¦‚htmlã€cssç­‰å†…å®¹ï¼Œåˆ™ç›´æ¥äº¤ç»™é™æ€æœåŠ¡å™¨å¤„ç†ï¼›å¦‚æœè¯·æ±‚çš„å›¾ç‰‡ç­‰å†…å®¹ï¼Œåˆ™ç›´æ¥äº¤ç»™å›¾ç‰‡æœåŠ¡å™¨å¤„ç†ã€‚</li><li>å¦‚æœè¯·æ±‚çš„æ˜¯åŠ¨æ€å†…å®¹ï¼Œåˆ™äº¤ç»™tomcatæœåŠ¡å™¨å¤„ç†ã€‚</li></ul><p>å› æ­¤åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ç”¨Nginxä½œä¸ºä»£ç†æœåŠ¡å™¨æ¥è½¬å‘æ¥è‡ªå‰ç«¯çš„è¯·æ±‚ï¼Œ</p><h1 id="å®‰è£…å¤šä¸ªTomcat"><a href="#å®‰è£…å¤šä¸ªTomcat" class="headerlink" title="å®‰è£…å¤šä¸ªTomcat"></a>å®‰è£…å¤šä¸ªTomcat</h1><ol><li>ä¿®æ”¹Tomcatç«¯å£ä¸º:8081ï¼Œ8082(åœ¨åŒä¸€å°ç”µè„‘ä¸Šï¼Œé¿å…ç«¯å£å†²çª)</li></ol><table><thead><tr><th></th><th>SHUTDOWN</th><th>HTTP/1.1</th><th>redirectPort</th><th>AJP/1.3</th><th>redirectPort</th></tr></thead><tbody><tr><td>é»˜è®¤</td><td>8005</td><td>8080</td><td>8443</td><td>8009</td><td>8443</td></tr><tr><td>Tomcat7.1</td><td>8101</td><td>8081</td><td>-</td><td>8009</td><td>-</td></tr><tr><td>Tomcat7.2</td><td>8102</td><td>8082</td><td>-</td><td>8009</td><td>-</td></tr></tbody></table><ol start="2"><li><p>åœ¨ä¸¤ä¸ªTomcatä¸­context.xmlä¸­åŠ å…¥(ä¸<code>redis</code>å®¢æˆ·ç«¯äº¤äº’)</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Manager</span> <span class="attr">className</span>=<span class="string">"com.radiadesign.catalina.session.RedisSessionManager"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">host</span>=<span class="string">"localhost"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">port</span>=<span class="string">"6379"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">database</span>=<span class="string">"0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">maxInactiveInterval</span>=<span class="string">"60"</span> /&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ä¸¤ä¸ªTomcatä¸­åŠ å…¥jaråŒ…</p><ul><li>commons-pool2-2.4.2.jar</li><li>jedis-2.7.3.jar</li><li>tomcat-redis-session-manager-1.2-tomcat-7-java-7.jar</li></ul></li></ol><h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><p>å®‰è£…redis(Googleï¼Œç™¾åº¦ä¸€ä¸‹redisä½œä¸ºnosqlï¼Œä½†æ˜¯ä¸‹è½½æˆ‘çš„redisç‰ˆæœ¬ï¼Œåœ¨æœ€å)ï¼Œçœ‹ä¸€ä¸‹binä¸‹çš„RedisService.docx</p><h1 id="Windowsä¸‹Nginxå‘½ä»¤"><a href="#Windowsä¸‹Nginxå‘½ä»¤" class="headerlink" title="Windowsä¸‹Nginxå‘½ä»¤"></a>Windowsä¸‹Nginxå‘½ä»¤</h1><ol><li>å¯åŠ¨<br>ç›´æ¥ç‚¹å‡»Nginxç›®å½•ä¸‹çš„Nginx.exe æˆ–è€… cmdè¿è¡Œstart Nginx</li><li>å…³é—­<br>Nginx -s stop    æˆ–è€…    Nginx -s quit<br>stopè¡¨ç¤ºç«‹å³åœæ­¢Nginx,ä¸ä¿å­˜ç›¸å…³ä¿¡æ¯<br>quitè¡¨ç¤ºæ­£å¸¸é€€å‡ºNginx,å¹¶ä¿å­˜ç›¸å…³ä¿¡æ¯</li><li>é‡å¯(å› ä¸ºæ”¹å˜äº†é…ç½®,éœ€è¦é‡å¯)<br>Nginx -s reload</li><li>å…³é—­è¿›ç¨‹<br>tskill Nginx</li></ol><h1 id="Nginxè´Ÿè½½å‡è¡¡é…ç½®"><a href="#Nginxè´Ÿè½½å‡è¡¡é…ç½®" class="headerlink" title="Nginxè´Ÿè½½å‡è¡¡é…ç½®"></a>Nginxè´Ÿè½½å‡è¡¡é…ç½®</h1><p>åœ¨Nginx.confé…ç½®æ–‡ä»¶ä¸­åŠ å…¥æ³¨é‡Šéƒ¨åˆ†</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#  upstream  localhost   &#123;</span><br><span class="line">#     server   localhost:8081;</span><br><span class="line">#     server   localhost:8082;</span><br><span class="line">#  &#125;</span><br><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line">    location / &#123;</span><br><span class="line">        root   html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">  #     proxy_pass        http://localhost;</span><br><span class="line">  #     proxy_set_header   Host             $host;</span><br><span class="line">  #     proxy_set_header   X-Real-IP        $remote_addr;</span><br><span class="line">  #     proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h1><ol><li>åœ¨ä¸¤ä¸ªTomcatä¸­çš„webappsä¸‹çš„ROOTä¸‹åŠ å…¥ä¸€ä¸ªsession.jsp</li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%=session.getId()%&gt; + Tomcat7.1</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;%=session.getId()%&gt; + Tomcat7.2</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¾æ¬¡è¿è¡Œredisï¼ŒTomcatï¼ŒNginx</li></ol><p><img src="https://images.morethink.cn/session-test1.jpg" alt="session-test1"></p><p><img src="https://images.morethink.cn/session-test2.jpg" alt="session-test2"></p><p><strong>æˆåŠŸ</strong><br>jaråŒ…ï¼Œredisï¼ŒNginxï¼ŒTomcat ï¼š <a href="http://pan.baidu.com/s/1c1NSPzU" target="_blank" rel="noopener">http://pan.baidu.com/s/1c1NSPzU</a></p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><h2 id="Tomcat9é…ç½®"><a href="#Tomcat9é…ç½®" class="headerlink" title="Tomcat9é…ç½®"></a>Tomcat9é…ç½®</h2><p>æœ€å¼€å§‹ï¼Œæˆ‘é‡‡ç”¨çš„æ˜¯Tomcat9ï¼Œåœ¨æˆ‘å®‰è£…çš„æ—¶å€™æ€»æ˜¯æœ‰é—®é¢˜ï¼Œå¾ˆå¤šä¸œè¥¿å·²ç»æ”¹äº†ï¼Œtomcat9å®‰è£…æ¥å®‰è£…å»ï¼Œç»“æœéƒ½æ˜¯åŒä¸€ä¸ªTomcatï¼Œæœ‰æ—¶å€™ç‰ˆæœ¬é«˜å°±æ˜¯æœ‰ç‚¹å‘ã€‚</p><p><strong>Tomcat9å¿…é¡»è¦é…ç½® <code>CATALINA_HOME</code></strong></p><p>é—®é¢˜ ï¼š</p><ol><li>å¿…é¡»é…ç½®CATALINA_HOMEå˜é‡ï¼Œä¸ç„¶å°±é—ªé€€ï¼Œä½†æ˜¯å¦‚æœé…ç½®å°±æ‰“å¼€äº†è‡ªå·±çš„ç”¨çš„Tomcatï¼Œä¸æ˜¯éœ€è¦æµ‹è¯•çš„Tomcat,ç»“æœæ˜¯åŠ çš„ä¸œè¥¿æ”¹å˜äº†ä»–çš„å±æ€§</li></ol><p>å…·ä½“é…ç½®å‚è€ƒ ï¼š <a href="https://my.oschina.net/ihanfeng/blog/286062" target="_blank" rel="noopener">windowsä¸‹å®‰è£…å¤šä¸ªtomcatæœåŠ¡</a></p><ol><li><strong>å®‰è£…æœåŠ¡</strong><br>åœ¨å‘½ä»¤è¡Œä¸­è¿›å…¥/Tomcatè·¯å¾„/bin/ï¼Œæ‰§è¡Œâ€œservice.bat installâ€ï¼š<br>è¯´æ˜ï¼š<ol><li>æœåŠ¡åå’Œæ˜¾ç¤ºåç§°ï¼šservice.batä¸­è®¾ç½®äº†é»˜è®¤çš„æœåŠ¡åç§°ï¼Œä¸åŒç‰ˆæœ¬åˆ†åˆ«å‘½åä¸ºTomcat4ã€Tomcat5ã€Tomcat6ï¼Œå¦‚æœéœ€è¦è‡ª å®šä¹‰æœåŠ¡åæˆ–æœåŠ¡çš„æ˜¾ç¤ºåç§°ï¼Œå¯åœ¨service.batä¸­ä¿®æ”¹SERVICE_NAMEæˆ–PR_DISPLAYNAMEï¼›</li><li>é˜²ç«å¢™çš„å½±å“ï¼š/bin/tomcat6.exeï¼ˆæˆ–tomcat4.exeã€tomcat5.exeï¼‰å°†è¢«ä½œä¸ºæœåŠ¡ç¨‹åºï¼Œå¦‚æœæœ‰é˜²ç«å¢™ï¼Œéœ€è¦è®¾ä¸ºå…è®¸ä½œä¸ºæœåŠ¡ã€‚</li></ol></li><li><strong>å¸è½½æœåŠ¡</strong><br>åœ¨å‘½ä»¤è¡Œä¸­è¿›å…¥/Tomcatè·¯å¾„/bin/ï¼Œæ‰§è¡Œâ€œservice.bat removeâ€ï¼š</li></ol><h2 id="JaråŒ…"><a href="#JaråŒ…" class="headerlink" title="JaråŒ…"></a>JaråŒ…</h2><p>jaråŒ…æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œæœ‰äº›jaråŒ…ä¸æ”¯æŒ(é”™è¯¯ä¸ºä»”ç»†è®°å½•)ï¼Œè€Œä¸”Tomcat-session jarçš„å®ç°ç‰ˆæœ¬ä¹Ÿä¸ä¸€æ ·ã€‚</p><p><strong>ä¸è¿‡æ­£å› ä¸ºè¸©äº†å‘ï¼Œæ‰æ›´æœ‰è¶£ï¼Œä¸æ˜¯å—</strong>ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> æœåŠ¡å™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Nginx </tag>
            
            <tag> åå‘ä»£ç† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SpringMVCå®ç°PUTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶</title>
      <link href="/SpringMVC-Achieve-RESTful-And-Put-With-File-Upload/"/>
      <url>/SpringMVC-Achieve-RESTful-And-Put-With-File-Upload/</url>
      
        <content type="html"><![CDATA[<p>åœ¨JQueryä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡ŒREST fulä¸­deleteå’Œputçš„è¯·æ±‚ï¼Œä½†æ˜¯åœ¨java EEæ ‡å‡†ä¸­ï¼Œé»˜è®¤åªæœ‰åœ¨POSTè¯·æ±‚çš„æ—¶å€™ï¼Œservlet æ‰ä¼šé€šè¿‡getparameter()æ–¹æ³•å–å¾—è¯·æ±‚ä½“ä¸­çš„ç›¸åº”çš„è¯·æ±‚å‚æ•°çš„æ•°æ®ã€‚è€ŒPUTï¼Œdeleteè¯·æ±‚çš„è¯·æ±‚ä½“ä¸­æ•°æ®åˆ™é»˜è®¤ä¸ä¼šè¢«è§£æã€‚</p><a id="more"></a><ol><li>å…³äºdeleteè¯·æ±‚ï¼šdeleteè¯·æ±‚ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šåˆ é™¤èµ„æºã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦æŠŠè¦åˆ é™¤çš„èµ„æºçš„IDä¸Šä¼ ç»™æœåŠ¡å™¨ï¼Œå³ä½¿æ˜¯æ‰¹é‡åˆ é™¤çš„æ—¶å€™ï¼Œä¹Ÿå¯ä»¥é€šè¿‡URLä¼ å‚çš„æ–¹å¼å°†å¤šä¸ªidä¼ ç»™servletï¼Œå› æ­¤ï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œå¯ä»¥ç›´æ¥å‘é€è¯·æ±‚ã€‚</li><li>å…³äºputè¯·æ±‚(æŒ‡çš„æ˜¯å¸¦æœ‰è¯·æ±‚ä½“)<ol><li>æ²¡æœ‰æ–‡ä»¶æ—¶ï¼šSpringMVCæä¾›äº†ä¸€ä¸ªå°†postè½¬æ¢ä¸ºputå’Œdeleteçš„æ–¹æ³•ï¼Œé€šè¿‡åœ¨web.xmlä¸­æ³¨å†Œä¸€ä¸ªHiddenHttpMethodFilterè¿‡æ»¤å™¨ã€‚</li><li>ä¸Šä¼ æ–‡ä»¶æ—¶ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨web.xmlä¸­æ³¨å†Œä¸€ä¸ªMultipartFilterï¼Œ<strong>ä¸€å®šè¦åœ¨HiddenHttpMethodFilterä¹‹å‰</strong>ã€‚</li></ol></li></ol><h1 id="SpringMVCå®ç°PUT-DELETEè¯·æ±‚"><a href="#SpringMVCå®ç°PUT-DELETEè¯·æ±‚" class="headerlink" title="SpringMVCå®ç°PUT,DELETEè¯·æ±‚"></a>SpringMVCå®ç°PUT,DELETEè¯·æ±‚</h1><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:dispatcher-servlet.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬çœ‹æºç ï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doFilterInternal</span><span class="params">(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</span></span></span><br><span class="line"><span class="function"><span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">String paramValue = request.getParameter(<span class="keyword">this</span>.methodParam);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">"POST"</span>.equals(request.getMethod()) &amp;&amp; StringUtils.hasLength(paramValue)) &#123;</span><br><span class="line">String method = paramValue.toUpperCase(Locale.ENGLISH);</span><br><span class="line">HttpServletRequest wrapper = <span class="keyword">new</span> HttpMethodRequestWrapper(request, method);</span><br><span class="line">filterChain.doFilter(wrapper, response);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">filterChain.doFilter(request, response);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ol><li>this.methodParamå±æ€§è¢«é»˜è®¤åˆå§‹åŒ–ä¸ºâ€<code>_method</code>â€œï¼Œé€šè¿‡<code>request.getParameter(this.methodParam);</code>åˆ¤æ–­æ˜¯putè¿˜æ˜¯deleteï¼Œ</li><li><code>&quot;POST&quot;.equals(request.getMethod())</code>ï¼Œè€Œä¸”å¿…é¡»è¦æ±‚æ˜¯postæ–¹å¼æäº¤çš„ï¼Œ</li><li>ç„¶åå®ƒæŠŠrequestè¿›è¡ŒåŒ…è£…åä¼ ç»™ä¸‹ä¸€ä¸ªfilterã€‚</li><li>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æäº¤çš„æ—¶å€™æ·»åŠ ä¸€ä¸ªå­—æ®µ</li></ol><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">id</span>=<span class="string">"formData"</span> <span class="attr">name</span>=<span class="string">"formData"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">id</span>=<span class="string">"username"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"_method"</span> <span class="attr">value</span>=<span class="string">"delete"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"submit"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ–è€…åœ¨<code>$.ajax</code>ä¸­<br><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">"post"</span>,<span class="comment">//è¯·æ±‚æ–¹å¼</span></span><br><span class="line">        url: <span class="string">""</span>,  <span class="comment">//å‘é€è¯·æ±‚åœ°å€</span></span><br><span class="line">        timeout: <span class="number">30000</span>,<span class="comment">//è¶…æ—¶æ—¶é—´ï¼š30ç§’</span></span><br><span class="line">        data: &#123;</span><br><span class="line">            <span class="string">"username"</span>: $(<span class="string">'#username'</span>).val(),</span><br><span class="line">            <span class="string">"password"</span>: $(<span class="string">"#password"</span>).val(),</span><br><span class="line">            <span class="string">"_method"</span>: <span class="keyword">delete</span></span><br><span class="line">        &#125;,</span><br><span class="line">        dataType: <span class="string">"json"</span>,<span class="comment">//è®¾ç½®è¿”å›æ•°æ®çš„æ ¼å¼</span></span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data);</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="comment">//è¯·æ±‚å‡ºé”™çš„å¤„ç†</span></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨åå°<code>@RequestMapping(value = &quot;&quot;, method = RequestMethod.PUT)</code>æ³¨è§£ä¸­æ ‡è¯†æˆ‘ä»¬çš„æ–¹æ³•ï¼Œæœ€åå°±å¯ä»¥æˆåŠŸåœ°è·å¾—æ•°æ®ã€‚</p><h1 id="SpringMVCå®ç°PUTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶"><a href="#SpringMVCå®ç°PUTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="SpringMVCå®ç°PUTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶"></a>SpringMVCå®ç°PUTè¯·æ±‚ä¸Šä¼ æ–‡ä»¶</h1><p>å¯æ˜¯åæ¥æˆ‘åˆæœ‰é‡åˆ°å¦å¤–ä¸€ä¸ªéœ€æ±‚é‚£å°±æ˜¯ä¿®æ”¹çš„æ—¶å€™éœ€è¦ä¼ é€æ–‡ä»¶åˆ°putæ–¹æ³•ä¸­ï¼Œäºæ˜¯è¿™ç§æ–¹æ³•å°±ä¸å¯è¡Œäº†ï¼Œä½†æ˜¯æˆ‘åœ¨<code>HiddenHttpMethodFilter</code>æºç ä¸­çœ‹åˆ°è¿™æ ·ä¸€å¥è¯<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">* &lt;p&gt;&lt;b&gt;NOTE: This filter needs to run after multipart processing in case of a multipart</span><br><span class="line">* POST request, due to its inherent need for checking a POST body parameter.&lt;/b&gt;</span><br><span class="line">* So typically, put a Spring &#123;@link org.springframework.web.multipart.support.MultipartFilter&#125;</span><br><span class="line">* &lt;i&gt;before&lt;/i&gt; this HiddenHttpMethodFilter in your &#123;@code web.xml&#125; filter chain.</span><br></pre></td></tr></table></figure></p><p>å’ŒMultipartFilteræºç ä¸­è¿™æ ·çš„æ³¨é‡Š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Set the bean name of the MultipartResolver to fetch from Spring&apos;s</span><br><span class="line"> * root application context. Default is &quot;filterMultipartResolver&quot;.</span><br><span class="line"> */</span><br></pre></td></tr></table></figure></p><ol><li><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨web.xmlä¸­æ³¨å†Œä¸€ä¸ªMultipartFilterï¼Œ<strong>ä¸€å®šè¦åœ¨HiddenHttpMethodFilterä¹‹å‰</strong>ã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>MultipartFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.multipart.support.MultipartFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>MultipartFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ç„¶åå†åœ¨Springçš„ root application contextä¸­æ·»åŠ å¦‚ä¸‹ä»£ç </p><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"filterMultipartResolver"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span> <span class="attr">value</span>=<span class="string">"209715200"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEncoding"</span> <span class="attr">value</span>=<span class="string">"UTF-8"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"resolveLazily"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>FormDataå¯¹è±¡æ˜¯html5çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç›®å‰çš„ä¸€äº›ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»å…¼å®¹ã€‚FormDataå¯¹è±¡æ˜¯html5çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç›®å‰çš„ä¸€äº›ä¸»æµçš„æµè§ˆå™¨éƒ½å·²ç»å…¼å®¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> form = <span class="keyword">new</span> FormData(<span class="built_in">document</span>.getElementById(<span class="string">"tf"</span>));</span><br><span class="line">    form.append(<span class="string">"_method"</span>, <span class="string">'put'</span>);</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: url,</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        data: form,</span><br><span class="line">        processData: <span class="literal">false</span>,</span><br><span class="line">        contentType: <span class="literal">false</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">window</span>.clearInterval(timer);</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"over.."</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">            alert(<span class="string">"é”™è¯¯ï¼ï¼"</span>);</span><br><span class="line">            <span class="built_in">window</span>.clearInterval(timer);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    get();<span class="comment">//æ­¤å¤„ä¸ºä¸Šä¼ æ–‡ä»¶çš„è¿›åº¦æ¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"tf"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">name</span>=<span class="string">"formDada"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"id"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"name"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"æ"</span> <span class="attr">onclick</span>=<span class="string">"test()"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>æœ€åï¼Œå°±å¯ä»¥å®ç°å°†æ–‡ä»¶ä¸Šä¼ æäº¤ç»™putæ–¹æ³•ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> SpringMVC </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>Servlet æµ…æ</title>
      <link href="/Servlet/"/>
      <url>/Servlet/</url>
      
        <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬å­¦ä¹ Servletä¹‹å‰ï¼Œæœ‰å¿…è¦äº†è§£ä¸€ä¸‹Webå®¹å™¨çš„å·¥ä½œæ¨¡å¼</p><ol><li>æˆ‘ä»¬æ‰€æœ‰çš„è¯·æ±‚å…¶å®éƒ½æ˜¯å…ˆåˆ°è¾¾äº†webå®¹å™¨ï¼Œç„¶åæ‰åˆ†å‘ç»™å·²ç»æ³¨å†Œå¥½çš„Servlet</li><li>è¯·æ±‚ç”±Servletçš„serviceæ–¹æ³•è°ƒç”¨<code>doGet()</code>å’Œ<code>doPost()</code>è¿›è¡Œååº”ã€‚</li></ol><a id="more"></a><h1 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h1><p>JSPçš„æœ¬è´¨æ˜¯ä¸€ä¸ªServletç±»ï¼Œä»–å¼¥è¡¥äº†Servletä¸å¥½åšç•Œé¢çš„åŠ£åŠ¿ã€‚</p><h1 id="Servlet-å·¥ä½œåŸç†è§£æ"><a href="#Servlet-å·¥ä½œåŸç†è§£æ" class="headerlink" title="Servlet å·¥ä½œåŸç†è§£æ"></a>Servlet å·¥ä½œåŸç†è§£æ</h1><h1 id="urlåŒ¹é…å’Œurl-pattern"><a href="#urlåŒ¹é…å’Œurl-pattern" class="headerlink" title="urlåŒ¹é…å’Œurl-pattern"></a>urlåŒ¹é…å’Œurl-pattern</h1><p><strong>urlçš„åŒ¹é…</strong><br>å½“ä¸€ä¸ªè¯·æ±‚å‘é€åˆ°servletå®¹å™¨çš„æ—¶å€™ï¼Œå®¹å™¨å…ˆä¼šå°†è¯·æ±‚çš„urlå‡å»å½“å‰åº”ç”¨ä¸Šä¸‹æ–‡çš„è·¯å¾„ä½œä¸ºservletçš„æ˜ å°„urlï¼Œæ¯”å¦‚æˆ‘è®¿é—®çš„æ˜¯<a href="http://localhost/test/aaa.htmlï¼Œæˆ‘çš„åº”ç”¨ä¸Šä¸‹æ–‡æ˜¯testï¼Œå®¹å™¨ä¼šå°†http://localhost/testå»æ‰ï¼Œå‰©ä¸‹çš„/aaa.htmléƒ¨åˆ†æ‹¿æ¥åšservletçš„æ˜ å°„åŒ¹é…ã€‚è¿™ä¸ªæ˜ å°„åŒ¹é…è¿‡ç¨‹æ˜¯æœ‰é¡ºåºçš„ï¼Œè€Œä¸”å½“æœ‰ä¸€ä¸ªservletåŒ¹é…æˆåŠŸä»¥åï¼Œå°±ä¸ä¼šå»ç†ä¼šå‰©ä¸‹çš„servletäº†ï¼ˆfilterä¸åŒï¼Œåæ–‡ä¼šæåˆ°ï¼‰ã€‚å…¶åŒ¹é…è§„åˆ™å’Œé¡ºåºå¦‚ä¸‹ï¼š" target="_blank" rel="noopener">http://localhost/test/aaa.htmlï¼Œæˆ‘çš„åº”ç”¨ä¸Šä¸‹æ–‡æ˜¯testï¼Œå®¹å™¨ä¼šå°†http://localhost/testå»æ‰ï¼Œå‰©ä¸‹çš„/aaa.htmléƒ¨åˆ†æ‹¿æ¥åšservletçš„æ˜ å°„åŒ¹é…ã€‚è¿™ä¸ªæ˜ å°„åŒ¹é…è¿‡ç¨‹æ˜¯æœ‰é¡ºåºçš„ï¼Œè€Œä¸”å½“æœ‰ä¸€ä¸ªservletåŒ¹é…æˆåŠŸä»¥åï¼Œå°±ä¸ä¼šå»ç†ä¼šå‰©ä¸‹çš„servletäº†ï¼ˆfilterä¸åŒï¼Œåæ–‡ä¼šæåˆ°ï¼‰ã€‚å…¶åŒ¹é…è§„åˆ™å’Œé¡ºåºå¦‚ä¸‹ï¼š</a></p><ol><li>ç²¾ç¡®è·¯å¾„åŒ¹é…ã€‚ä¾‹å­ï¼šæ¯”å¦‚servletA çš„url-patternä¸º /testï¼ŒservletBçš„url-patternä¸º /* ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘è®¿é—®çš„urlä¸º<a href="http://localhost/test" target="_blank" rel="noopener">http://localhost/test</a> ï¼Œè¿™ä¸ªæ—¶å€™å®¹å™¨å°±ä¼šå…ˆè¿›è¡Œç²¾ç¡®è·¯å¾„åŒ¹é…ï¼Œå‘ç°/testæ­£å¥½è¢«servletAç²¾ç¡®åŒ¹é…ï¼Œé‚£ä¹ˆå°±å»è°ƒç”¨servletAï¼Œä¹Ÿä¸ä¼šå»ç†ä¼šå…¶ä»–çš„servletäº†ã€‚</li><li>æœ€é•¿è·¯å¾„åŒ¹é…ã€‚ä¾‹å­ï¼šservletAçš„url-patternä¸º/test/<em>ï¼Œè€ŒservletBçš„url-patternä¸º/test/a/</em>ï¼Œæ­¤æ—¶è®¿é—®<a href="http://localhost/test/aæ—¶ï¼Œå®¹å™¨ä¼šé€‰æ‹©è·¯å¾„æœ€é•¿çš„servletæ¥åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„servletBã€‚" target="_blank" rel="noopener">http://localhost/test/aæ—¶ï¼Œå®¹å™¨ä¼šé€‰æ‹©è·¯å¾„æœ€é•¿çš„servletæ¥åŒ¹é…ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œçš„servletBã€‚</a></li><li>æ‰©å±•åŒ¹é…ï¼Œå¦‚æœurlæœ€åä¸€æ®µåŒ…å«æ‰©å±•ï¼Œå®¹å™¨å°†ä¼šæ ¹æ®æ‰©å±•é€‰æ‹©åˆé€‚çš„servletã€‚ä¾‹å­ï¼šservletAçš„url-patternï¼š*.action</li><li>å¦‚æœå‰é¢ä¸‰æ¡è§„åˆ™éƒ½æ²¡æœ‰æ‰¾åˆ°ä¸€ä¸ªservletï¼Œå®¹å™¨ä¼šæ ¹æ®urlé€‰æ‹©å¯¹åº”çš„è¯·æ±‚èµ„æºã€‚å¦‚æœåº”ç”¨å®šä¹‰äº†ä¸€ä¸ªdefault servletï¼Œåˆ™å®¹å™¨ä¼šå°†è¯·æ±‚ä¸¢ç»™default servletï¼ˆä»€ä¹ˆæ˜¯default servletï¼Ÿåé¢ä¼šè®²ï¼‰ã€‚<br>æ ¹æ®è¿™ä¸ªè§„åˆ™è¡¨ï¼Œå°±èƒ½å¾ˆæ¸…æ¥šçš„çŸ¥é“servletçš„åŒ¹é…è¿‡ç¨‹ï¼Œæ‰€ä»¥å®šä¹‰servletçš„æ—¶å€™ä¹Ÿè¦è€ƒè™‘url-patternçš„å†™æ³•ï¼Œä»¥å…å‡ºé”™ã€‚</li></ol><p><strong>å¯¹äºfilterï¼Œä¸ä¼šåƒservleté‚£æ ·åªåŒ¹é…ä¸€ä¸ªservletï¼Œå› ä¸ºfilterçš„é›†åˆæ˜¯ä¸€ä¸ªé“¾ï¼Œæ‰€ä»¥åªä¼šæœ‰å¤„ç†çš„é¡ºåºä¸åŒï¼Œè€Œä¸ä¼šå‡ºç°åªé€‰æ‹©ä¸€ä¸ªfilterã€‚</strong>Filterçš„å¤„ç†é¡ºåºå’Œfilter-mappingåœ¨web.xmlä¸­å®šä¹‰çš„é¡ºåºç›¸åŒã€‚</p><p><strong>url-patternè¯¦è§£</strong><br>åœ¨web.xmlæ–‡ä»¶ä¸­ï¼Œä»¥ä¸‹è¯­æ³•ç”¨äºå®šä¹‰æ˜ å°„ï¼š</p><ol><li>ä»¥â€/â€™å¼€å¤´å’Œä»¥â€/*â€ç»“å°¾çš„æ˜¯ç”¨æ¥åšè·¯å¾„æ˜ å°„çš„ã€‚</li><li>ä»¥å‰ç¼€â€*.â€å¼€å¤´çš„æ˜¯ç”¨æ¥åšæ‰©å±•æ˜ å°„çš„ã€‚</li><li>â€œ/â€ æ˜¯ç”¨æ¥å®šä¹‰default servletæ˜ å°„çš„ã€‚</li><li>å‰©ä¸‹çš„éƒ½æ˜¯ç”¨æ¥å®šä¹‰è¯¦ç»†æ˜ å°„çš„ã€‚æ¯”å¦‚ï¼š /aa/bb/cc.action</li></ol><p>æ‰€ä»¥ï¼Œä¸ºä»€ä¹ˆå®šä¹‰â€/*.actionâ€è¿™æ ·ä¸€ä¸ªçœ‹èµ·æ¥å¾ˆæ­£å¸¸çš„åŒ¹é…ä¼šé”™ï¼Ÿå› ä¸ºè¿™ä¸ªåŒ¹é…å³å±äºè·¯å¾„æ˜ å°„ï¼Œä¹Ÿå±äºæ‰©å±•æ˜ å°„ï¼Œå¯¼è‡´å®¹å™¨æ— æ³•åˆ¤æ–­</p><h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><p><img src="./1476700589878.png" alt="Alt text"></p><h1 id="Servletè£…è½½çš„ä¸‰ç§æƒ…å†µï¼š"><a href="#Servletè£…è½½çš„ä¸‰ç§æƒ…å†µï¼š" class="headerlink" title="Servletè£…è½½çš„ä¸‰ç§æƒ…å†µï¼š"></a>Servletè£…è½½çš„ä¸‰ç§æƒ…å†µï¼š</h1><ol><li>è‡ªåŠ¨è£…è½½ï¼šæŸäº›Servletå¦‚æœéœ€è¦åœ¨Servletå®¹å™¨å¯åŠ¨æ—¶å°±åŠ è½½ï¼Œéœ€è¦åœ¨web.xmlä¸‹å®ƒçš„<code>&lt;Servlet&gt;</code>æ ‡ç­¾é‡Œä¸­ï¼Œæ·»åŠ ä¼˜å…ˆçº§ä»£ç ï¼š<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;Servlet&gt;</span><br><span class="line">&lt;load-on-startup&gt;1&lt;load-on-startup&gt;</span><br><span class="line">&lt;/Servlet&gt;</span><br></pre></td></tr></table></figure></li></ol><p>æ•°å­—è¶Šå°è¡¨ç¤ºè¯¥servletçš„ä¼˜å…ˆçº§è¶Šé«˜ï¼Œä¼šå…ˆäºå…¶ä»–è‡ªåŠ¨è£…è½½çš„ä¼˜å…ˆçº§è¾ƒä½çš„å…ˆè£…è½½,<strong>åœ¨SpringMVCä¸­æœ‰è¿™ä¸ªé…ç½®</strong><br><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.form<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure></p><ol start="2"><li>Servletå®¹å™¨å¯åŠ¨åï¼Œå®¢æˆ·é¦–æ¬¡å‘æŸä¸ªServletå‘é€è¯·æ±‚æ—¶ï¼ŒTomcatå®¹å™¨ä¼šåŠ è½½å®ƒ</li><li>å½“Servletç±»æ–‡ä»¶è¢«æ›´æ–°åï¼Œä¹Ÿä¼šé‡æ–°è‡ªåŠ¨åŠ è½½<br>Servletæ˜¯é•¿æœŸé©»ç•™åœ¨å†…å­˜é‡Œçš„ã€‚æŸä¸ªServletä¸€æ—¦è¢«åŠ è½½ï¼Œå°±ä¼šé•¿æœŸå­˜åœ¨äºæœåŠ¡å™¨çš„å†…å­˜é‡Œï¼Œç›´åˆ°æœåŠ¡å™¨å…³é—­<br>Servletè¢«è£…è½½åï¼ŒServletå®¹å™¨é€šè¿‡åå°„åˆ›å»ºä¸€ä¸ªServletå®ä¾‹å¹¶ä¸”è°ƒç”¨Servletçš„init()æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ã€‚åœ¨Servletçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ï¼Œinit()æ–¹æ³•åªè¢«è°ƒç”¨ä¸€æ¬¡</li></ol><h1 id="Servletå¾—åˆ°JSPå¯¹è±¡"><a href="#Servletå¾—åˆ°JSPå¯¹è±¡" class="headerlink" title="Servletå¾—åˆ°JSPå¯¹è±¡"></a>Servletå¾—åˆ°JSPå¯¹è±¡</h1><p><img src="./1476789507228.png" alt="Alt text"></p><h1 id="Servlet-3-0"><a href="#Servlet-3-0" class="headerlink" title="Servlet 3.0"></a>Servlet 3.0</h1><p>ä¸ºä»€ä¹ˆå‡ºç°äº†Servlet3.0ï¼Œä¸€åˆ‡çš„ä¸€åˆ‡éƒ½æ˜¯ä¸ºäº†æ•ˆç‡çš„æé«˜ï¼Œæ°å¦‚ï¼Œæ¡†æ¶çš„å‡ºç°ã€‚<br><a href="https://www.ibm.com/developerworks/cn/java/j-lo-servlet30/" target="_blank" rel="noopener">Servlet 3.0 æ–°ç‰¹æ€§è¯¦è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Servlet </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JSPä¸HTMLåŠå‰ååˆ†ç¦»</title>
      <link href="/JSP%E4%B8%8EHTML%E5%8F%8A%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/"/>
      <url>/JSP%E4%B8%8EHTML%E5%8F%8A%E5%89%8D%E5%90%8E%E5%88%86%E7%A6%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="JSPæ˜¯ä»€ä¹ˆ"><a href="#JSPæ˜¯ä»€ä¹ˆ" class="headerlink" title="JSPæ˜¯ä»€ä¹ˆ"></a>JSPæ˜¯ä»€ä¹ˆ</h1><p>é¦–å…ˆè¦çŸ¥é“JSPçš„æœ¬è´¨å…¶å®æ˜¯ä¸ªServletï¼Œindex.jspåœ¨è®¿é—®çš„æ—¶å€™é¦–å…ˆä¼šè‡ªåŠ¨å°†è¯¥é¡µé¢ç¿»è¯‘ç”Ÿä¸€ä¸ªindex_jsp.javaæ–‡ä»¶ï¼Œå³Servletä»£ç ã€‚</p><p>æ‰“å¼€è¿™ä¸ªç±»ä½ ä¼šå‘ç°è¿™ä¸ªç±»ç»§æ‰¿äº†ç±»<code>org.apache.jasper.runtime.HttpJspBase.SUN</code>åœ¨JSP APIä¸­å®šä¹‰äº†ä¸€ä¸ªæ¥å£<code>HttpJspBase</code>,è¿™ä¸ªæ¥å£ç»§æ‰¿äº†<code>JspPage</code>æ¥å£ï¼Œè€ŒJspPageæ¥å£åˆç»§æ‰¿äº†Servletæ¥å£ï¼Œå› æ­¤WEBå®¹å™¨å¿…é¡»å®ç°è¿™äº›æ¥å£ã€‚<code>org.apache.jasper.runtime.HttpJspBase</code>å°±æ˜¯Tomcatå¯¹JSP APIä¸­HttpJspBaseæ¥å£çš„å®ç°ã€‚å› æ­¤JSPé¡µé¢åœ¨æœ¬è´¨ä¸Šå°±æ˜¯Servletç¨‹åºï¼Œè€ŒServletç¨‹åºè¦è¢«WEBå®¹å™¨è°ƒç”¨æ‰§è¡Œï¼Œå¿…é¡»åœ¨WEB.XMLä¸­æ³¨å†Œæ˜ å°„ï¼Œå¯¹äºJSPï¼Œè¿™äº›åˆ™ç”±WEBå®¹å™¨è‡ªåŠ¨å®Œæˆã€‚</p><a id="more"></a><h1 id="HTMLæ˜¯ä»€ä¹ˆ"><a href="#HTMLæ˜¯ä»€ä¹ˆ" class="headerlink" title="HTMLæ˜¯ä»€ä¹ˆ"></a>HTMLæ˜¯ä»€ä¹ˆ</h1><p>å‚è€ƒç»´åŸºç™¾ç§‘çš„å®šä¹‰ï¼š</p><blockquote><p>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼ˆè‹±è¯­ï¼šHyperText Markup Languageï¼Œç®€ç§°ï¼šHTMLï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ›å»ºç½‘é¡µçš„æ ‡å‡†æ ‡è®°è¯­è¨€ã€‚HTMLæ˜¯ä¸€ç§åŸºç¡€æŠ€æœ¯ï¼Œå¸¸ä¸CSSã€JavaScriptä¸€èµ·è¢«ä¼—å¤šç½‘ç«™ç”¨äºè®¾è®¡ä»¤äººèµå¿ƒæ‚¦ç›®çš„ç½‘é¡µã€ç½‘é¡µåº”ç”¨ç¨‹åºä»¥åŠç§»åŠ¨åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢[1]ã€‚ç½‘é¡µæµè§ˆå™¨å¯ä»¥è¯»å–HTMLæ–‡ä»¶ï¼Œå¹¶å°†å…¶æ¸²æŸ“æˆå¯è§†åŒ–ç½‘é¡µã€‚HTMLæè¿°äº†ä¸€ä¸ªç½‘ç«™çš„ç»“æ„è¯­ä¹‰éšç€çº¿ç´¢çš„å‘ˆç°ï¼Œä½¿ä¹‹æˆä¸ºä¸€ç§æ ‡è®°è¯­è¨€è€Œéç¼–ç¨‹è¯­è¨€ã€‚</p><p>HTMLå…ƒç´ æ˜¯æ„å»ºç½‘ç«™çš„åŸºçŸ³ã€‚HTMLå…è®¸åµŒå…¥å›¾åƒä¸å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥ç”¨äºåˆ›å»ºäº¤äº’å¼è¡¨å•ï¼Œå®ƒè¢«ç”¨æ¥ç»“æ„åŒ–ä¿¡æ¯â€”â€”ä¾‹å¦‚æ ‡é¢˜ã€æ®µè½å’Œåˆ—è¡¨ç­‰ç­‰ï¼Œä¹Ÿå¯ç”¨æ¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæè¿°æ–‡æ¡£çš„å¤–è§‚å’Œè¯­ä¹‰ã€‚HTMLçš„è¯­è¨€å½¢å¼ä¸ºå°–æ‹¬å·åŒ…å›´çš„HTMLå…ƒç´ ï¼ˆå¦‚<html>ï¼‰ï¼Œæµè§ˆå™¨ä½¿ç”¨HTMLæ ‡ç­¾å’Œè„šæœ¬æ¥è¯ é‡Šç½‘é¡µå†…å®¹ï¼Œä½†ä¸ä¼šå°†å®ƒä»¬æ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚</html></p><p>HTMLå¯ä»¥åµŒå…¥å¦‚JavaScriptçš„è„šæœ¬è¯­è¨€ï¼Œå®ƒä»¬ä¼šå½±å“HTMLç½‘é¡µçš„è¡Œä¸ºã€‚ç½‘é¡µæµè§ˆå™¨ä¹Ÿå¯ä»¥å¼•ç”¨å±‚å æ ·å¼è¡¨ï¼ˆCSSï¼‰æ¥å®šä¹‰æ–‡æœ¬å’Œå…¶å®ƒå…ƒç´ çš„å¤–è§‚ä¸å¸ƒå±€ã€‚ç»´æŠ¤HTMLå’ŒCSSæ ‡å‡†çš„ç»„ç»‡ä¸‡ç»´ç½‘è”ç›Ÿï¼ˆW3Cï¼‰é¼“åŠ±äººä»¬ä½¿ç”¨CSSæ›¿ä»£ä¸€äº›ç”¨äºè¡¨ç°çš„HTMLå…ƒç´ [2]ã€‚</p></blockquote><h1 id="JSP-VS-HTML"><a href="#JSP-VS-HTML" class="headerlink" title="JSP VS HTML"></a>JSP VS HTML</h1><p><strong>JSPä¸Htmlç›¸æ¯”ï¼Œè°æ›´é€‚åˆåšé¡µé¢</strong>ï¼Ÿ</p><p>javaçš„webå¼€å‘é‡Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨jspæ¥ç¼–å†™é¡µé¢ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…ˆè¿›ç‚¹çš„æ¨¡æ¿å¼•æ“å¼€å‘é¡µé¢ä¾‹å¦‚velocityï¼Œfreemarkç­‰ï¼Œä¸ç®¡æˆ‘ä»¬é¡µé¢ä½¿ç”¨çš„æ˜¯jspè¿˜æ˜¯æ¨¡æ¿å¼•æ“ï¼Œè¿™äº›ç±»ä¼¼htmlçš„æ–‡ä»¶å…¶å®å¹¶ä¸æ˜¯çœŸæ­£çš„htmlï¼Œä¾‹å¦‚jspæœ¬è´¨å…¶å®æ˜¯ä¸ªservletä¹Ÿå°±æ˜¯ä¸€ä¸ªjavaç¨‹åºï¼Œæ‰€ä»¥å®ƒä»¬çš„æœ¬è´¨æ˜¯æœåŠ¡ç«¯è¯­è¨€å’Œhtmlçš„ä¸€ä¸ªæ•´åˆæŠ€æœ¯ï¼Œåœ¨å®é™…è¿è¡Œä¸­webå®¹å™¨ä¼šæ ¹æ®æœåŠ¡ç«¯çš„è¿”å›æ•°æ®å°†jspæˆ–æ¨¡æ¿å¼•æ“è§£ææˆæµè§ˆå™¨èƒ½è§£æçš„htmlï¼Œç„¶åä¼ è¾“è¿™ä¸ªhtmlåˆ°æµè§ˆå™¨è¿›è¡Œè§£æã€‚</p><p>ç°åœ¨æ¯”è¾ƒæå€¡å‰ååˆ†ç¦»ï¼Œå‰åç«¯é€šè¿‡APIæ¥ç›¸äº’è¿æ¥ï¼Œåç«¯ç»™å‡ºæ¥å£ï¼Œå‰ç«¯é€šè¿‡AJAXè®¿é—®æ¥å£ï¼Œæ‹¿åˆ°æ•°æ®ï¼ŒåŠ¨æ€æ›´æ–°ã€‚</p><h1 id="å‰ååˆ†ç¦»"><a href="#å‰ååˆ†ç¦»" class="headerlink" title="å‰ååˆ†ç¦»"></a>å‰ååˆ†ç¦»</h1><p><strong>å‰åç«¯åˆ†ç¦»æ˜¯è¶‹åŠ¿ï¼Œä½†æ˜¯çŸ­æ—¶é—´å†…ä¸å¯èƒ½å–ä»£ä¸åˆ†ç¦»çš„</strong>ã€‚</p><p>å› ä¸ºå‰ååˆ†ç¦»å¯¼è‡´ï¼šæ•°æ®å’Œè¡¨ç°åˆ†ç¦»ï¼Œåªéœ€è¦é™æ€çš„htmlå’ŒåŠ¨æ€çš„æ¥å£ï¼ˆä¾‹å¦‚jspï¼‰ï¼Œæ•°æ®åœ¨æµè§ˆå™¨ç«¯å®ç°åŠ¨æ€åŠ è½½ã€‚å› æ­¤å­˜åœ¨é—®é¢˜ï¼Œä¾‹å¦‚SEOï¼Œæœç´¢å¼•æ“éš¾ä»¥è¯†åˆ«ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒæ·˜å®å‰ç«¯çš„è®¾è®¡ï¼Œåœ¨ java æ¥å£å’Œ html è¾“å‡ºä¹‹å‰ç”¨ NodeJS ä»£ç†ä¸€å±‚ï¼Œæš‚æ—¶èƒ½è§£å†³ SEO çš„é—®é¢˜ã€‚</p><p>ç†æƒ³æƒ…å†µæ˜¯ï¼Œå…ˆå‡ºæ–‡æ¡£ï¼ˆå‰åç«¯éƒ½è®¤å¯ï¼‰ï¼Œç„¶ååç«¯ã€å‰ç«¯éƒ½æŒ‰ç…§æ–‡æ¡£æ¥ï¼Œä¸€åˆ‡ä»¥æ¥å£è§„å®šçš„ä¸ºå‡†ã€‚ é‡ç‚¹åœ¨äºæ¥å£ï¼é  API æ¥åˆ†ç¦»å‰åç«¯ï¼Œè§£å†³å‰åç«¯å¤§å›¢é˜Ÿã€å¤šç‰ˆæœ¬ã€å¤æ‚åŠŸèƒ½åä½œçš„é—®é¢˜ã€‚å®šä¹‰å¥½äº†æ¥å£ï¼Œå‰ç«¯å°±å¯ä»¥ç”¨ä¸ç”¨ç­‰åç«¯ï¼Œç›´æ¥ç”¨æ¨¡æ‹Ÿçš„æ•°æ®æ ¼å¼ï¼Œæ–¹ä¾¿åœ°è¿›è¡Œå‰ç«¯æµ‹è¯•äº†ã€‚</p><p>å‰ç«¯å¯ä»¥é€šè¿‡Nginxæ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚<br>å…·ä½“å¯ä»¥æŸ¥çœ‹ <a href="https://www.morethink.cn/Nginx-Cross-Domain/">å‰ç«¯é€šè¿‡Nginxåå‘ä»£ç†è§£å†³è·¨åŸŸé—®é¢˜</a></p><p>è¯´é‡ç‚¹ï¼ŒAPI ç›¸æ¯”å‰åç«¯æ··å†™ã€æ¨¡æ¿å¼•æ“ä¹‹ç±»çš„ä¸œè¥¿çš„å¥½å¤„ï¼š</p><ul><li>æ–¹ä¾¿è®¾è®¡ã€å¼€å‘ã€æµ‹è¯•ï¼ˆå‰ç«¯ä¸å†éœ€è¦ä¾èµ–åç«¯ï¼Œåç«¯ä¹Ÿä¸éœ€è¦ä¾èµ–å‰ç«¯ï¼Œå°±å¯ä»¥å„å¹²å„çš„ï¼Œç‹¬ç«‹æµ‹è¯•ä»£ç ï¼‰</li><li>æ–¹ä¾¿è®°å½•å’Œç»Ÿè®¡åŠŸèƒ½ä½¿ç”¨ï¼ˆåç«¯ç›¸åŒåŠŸèƒ½çš„å…¥å£ä½ç½®ç»Ÿä¸€ï¼Œä¸åŒåŠŸèƒ½çš„ä½ç½®ä¹Ÿå¯ä»¥åˆç†æœ‰åºåœ°ç»„ç»‡ï¼‰</li><li>æ–¹ä¾¿ä¿®æ”¹å’Œç‰ˆæœ¬æ§åˆ¶ç­‰ï¼ˆåç«¯å¯ä»¥æä¾›å¤šç‰ˆæœ¬çš„ APIï¼Œä¸éœ€è¦ä¿®æ”¹å·²æœ‰ä»£ç ï¼Œä¸å½±å“å·²æœ‰ API çš„åŠŸèƒ½ï¼‰</li><li><strong>æœ€é‡ç‚¹çš„æ˜¯</strong>ï¼š<br>ä½ çš„Teamè¦æ˜¯åˆ†å·¥ä¸æ˜ç¡®ã€äººå°‘ã€åŠŸèƒ½ç®€å•ç›´æ¥ã€ä»£ç ä¿®æ”¹ä¸å¤šï¼Œå°±å®Œå…¨ä¸éœ€è¦åˆ†ç¦»ï¼Œå°±é…±ã€‚</li><li><strong>æœ€æ˜æ˜¾çš„</strong>ï¼š<br>å‰ç«¯ä»£ç ä¸ç”¨è¢«åç«¯ç²˜è´´æ¥ç²˜è´´å»äº†ï¼Œåç«¯çš„ç›¸åŒä»£ç ï¼Œä¹Ÿä¸éœ€è¦å„ç§ä½ç½®ç²˜è´´æ¥ç²˜è´´å»äº†ã€‚</li><li><strong>éšè—çš„å¥½å¤„</strong>ï¼š<br>åˆ°æ—¶å€™å‡ºäº†é—®é¢˜ï¼Œç…§ç€ API è®¾è®¡æ–‡æ¡£ä¸€å¯¹æ¯”ï¼Œå°±çŸ¥é“æ˜¯å‰ç«¯ç”¨çš„ä¸å¯¹ï¼Œè¿˜æ˜¯åç«¯å†™çš„ä¸å¯¹ï¼Œåˆ†åˆ†é’Ÿæ‰¾åˆ°èƒŒé”…ä¾ ã€‚</li><li>å¯ä»¥ä¸€å¥—æ¥å£ï¼Œæµè§ˆå™¨ï¼ŒAndroidé€šç”¨ï¼Œæå¤§å‡å°‘å¼€å‘é‡ã€‚</li></ul><h1 id="RESTFul-API"><a href="#RESTFul-API" class="headerlink" title="RESTFul API"></a>RESTFul API</h1><p>æˆ‘ä»¬çŸ¥é“å‰ååˆ†ç¦»ä¹‹åæ˜¯é APIç»Ÿä¸€å‰åç«¯çš„å¼€å‘ï¼Œ<strong>è€ŒRESTFul APIç›®å‰æ˜¯å‰åç«¯åˆ†ç¦»çš„æœ€ä½³å®è·µ</strong>ã€‚</p><p>å®ƒæœ‰å¦‚ä¸‹å¥½å¤„ï¼š</p><ul><li>è½»é‡ï¼Œç›´æ¥é€šè¿‡httpï¼Œä¸éœ€è¦é¢å¤–åè®®ï¼Œpost/get/put/deleteæ“ä½œ</li><li>é¢å‘èµ„æºï¼Œä¸€ç›®äº†ç„¶ï¼Œå…·æœ‰è‡ªè§£é‡Šæ€§</li><li>æ•°æ®æè¿°ç®€å•ï¼Œä¸€èˆ¬é€šè¿‡jsonæˆ–è€…xmlåšæ•°æ®é€šä¿¡</li></ul><p>ä¸‹é¢å‚è€ƒé˜®ä¸€å³°çš„åšå®¢è§£é‡Šä¸€ä¸‹RESTfulæ¶æ„ã€‚</p><p>è¦ç†è§£RESTfulæ¶æ„ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯å»ç†è§£Representational State Transferè¿™ä¸ªè¯ç»„åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Œå®ƒçš„æ¯ä¸€ä¸ªè¯ä»£è¡¨äº†ä»€ä¹ˆæ¶µä¹‰ã€‚å¦‚æœä½ æŠŠè¿™ä¸ªåç§°ææ‡‚äº†ï¼Œä¹Ÿå°±ä¸éš¾ä½“ä¼šRESTæ˜¯ä¸€ç§ä»€ä¹ˆæ ·çš„è®¾è®¡ã€‚</p><h2 id="èµ„æºï¼ˆResourcesï¼‰"><a href="#èµ„æºï¼ˆResourcesï¼‰" class="headerlink" title="èµ„æºï¼ˆResourcesï¼‰"></a>èµ„æºï¼ˆResourcesï¼‰</h2><p>RESTçš„åç§°â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ä¸­ï¼Œçœç•¥äº†ä¸»è¯­ã€‚â€è¡¨ç°å±‚â€å…¶å®æŒ‡çš„æ˜¯â€èµ„æºâ€ï¼ˆResourcesï¼‰çš„â€è¡¨ç°å±‚â€ã€‚</p><p>æ‰€è°“â€èµ„æºâ€ï¼Œå°±æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå®ä½“ï¼Œæˆ–è€…è¯´æ˜¯ç½‘ç»œä¸Šçš„ä¸€ä¸ªå…·ä½“ä¿¡æ¯ã€‚å®ƒå¯ä»¥æ˜¯ä¸€æ®µæ–‡æœ¬ã€ä¸€å¼ å›¾ç‰‡ã€ä¸€é¦–æ­Œæ›²ã€ä¸€ç§æœåŠ¡ï¼Œæ€»ä¹‹å°±æ˜¯ä¸€ä¸ªå…·ä½“çš„å®åœ¨ã€‚ä½ å¯ä»¥ç”¨ä¸€ä¸ªURIï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æŒ‡å‘å®ƒï¼Œæ¯ç§èµ„æºå¯¹åº”ä¸€ä¸ªç‰¹å®šçš„URIã€‚è¦è·å–è¿™ä¸ªèµ„æºï¼Œè®¿é—®å®ƒçš„URIå°±å¯ä»¥ï¼Œå› æ­¤URIå°±æˆäº†æ¯ä¸€ä¸ªèµ„æºçš„åœ°å€æˆ–ç‹¬ä¸€æ— äºŒçš„è¯†åˆ«ç¬¦ã€‚</p><p>æ‰€è°“â€ä¸Šç½‘â€ï¼Œå°±æ˜¯ä¸äº’è”ç½‘ä¸Šä¸€ç³»åˆ—çš„â€èµ„æºâ€äº’åŠ¨ï¼Œè°ƒç”¨å®ƒçš„URIã€‚</p><h2 id="è¡¨ç°å±‚ï¼ˆRepresentationï¼‰"><a href="#è¡¨ç°å±‚ï¼ˆRepresentationï¼‰" class="headerlink" title="è¡¨ç°å±‚ï¼ˆRepresentationï¼‰"></a>è¡¨ç°å±‚ï¼ˆRepresentationï¼‰</h2><p>â€œèµ„æºâ€æ˜¯ä¸€ç§ä¿¡æ¯å®ä½“ï¼Œå®ƒå¯ä»¥æœ‰å¤šç§å¤–åœ¨è¡¨ç°å½¢å¼ã€‚æˆ‘ä»¬æŠŠâ€èµ„æºâ€å…·ä½“å‘ˆç°å‡ºæ¥çš„å½¢å¼ï¼Œå«åšå®ƒçš„â€è¡¨ç°å±‚â€ï¼ˆRepresentationï¼‰ã€‚</p><p>æ¯”å¦‚ï¼Œæ–‡æœ¬å¯ä»¥ç”¨txtæ ¼å¼è¡¨ç°ï¼Œä¹Ÿå¯ä»¥ç”¨HTMLæ ¼å¼ã€XMLæ ¼å¼ã€JSONæ ¼å¼è¡¨ç°ï¼Œç”šè‡³å¯ä»¥é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼›å›¾ç‰‡å¯ä»¥ç”¨JPGæ ¼å¼è¡¨ç°ï¼Œä¹Ÿå¯ä»¥ç”¨PNGæ ¼å¼è¡¨ç°ã€‚</p><p>URIåªä»£è¡¨èµ„æºçš„å®ä½“ï¼Œä¸ä»£è¡¨å®ƒçš„å½¢å¼ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œæœ‰äº›ç½‘å€æœ€åçš„â€.htmlâ€åç¼€åæ˜¯ä¸å¿…è¦çš„ï¼Œå› ä¸ºè¿™ä¸ªåç¼€åè¡¨ç¤ºæ ¼å¼ï¼Œå±äºâ€è¡¨ç°å±‚â€èŒƒç•´ï¼Œè€ŒURIåº”è¯¥åªä»£è¡¨â€èµ„æºâ€çš„ä½ç½®ã€‚å®ƒçš„å…·ä½“è¡¨ç°å½¢å¼ï¼Œåº”è¯¥åœ¨HTTPè¯·æ±‚çš„å¤´ä¿¡æ¯ä¸­ç”¨Acceptå’ŒContent-Typeå­—æ®µæŒ‡å®šï¼Œè¿™ä¸¤ä¸ªå­—æ®µæ‰æ˜¯å¯¹â€è¡¨ç°å±‚â€çš„æè¿°ã€‚</p><h2 id="çŠ¶æ€è½¬åŒ–ï¼ˆState-Transferï¼‰"><a href="#çŠ¶æ€è½¬åŒ–ï¼ˆState-Transferï¼‰" class="headerlink" title="çŠ¶æ€è½¬åŒ–ï¼ˆState Transferï¼‰"></a>çŠ¶æ€è½¬åŒ–ï¼ˆState Transferï¼‰</h2><p>è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œå°±ä»£è¡¨äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„ä¸€ä¸ªäº’åŠ¨è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒåŠ¿å¿…æ¶‰åŠåˆ°æ•°æ®å’ŒçŠ¶æ€çš„å˜åŒ–ã€‚</p><p>äº’è”ç½‘é€šä¿¡åè®®HTTPåè®®ï¼Œæ˜¯ä¸€ä¸ªæ— çŠ¶æ€åè®®ã€‚è¿™æ„å‘³ç€ï¼Œæ‰€æœ‰çš„çŠ¶æ€éƒ½ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚å› æ­¤ï¼Œå¦‚æœå®¢æˆ·ç«¯æƒ³è¦æ“ä½œæœåŠ¡å™¨ï¼Œå¿…é¡»é€šè¿‡æŸç§æ‰‹æ®µï¼Œè®©æœåŠ¡å™¨ç«¯å‘ç”Ÿâ€çŠ¶æ€è½¬åŒ–â€ï¼ˆState Transferï¼‰ã€‚è€Œè¿™ç§è½¬åŒ–æ˜¯å»ºç«‹åœ¨è¡¨ç°å±‚ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å°±æ˜¯â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€ã€‚</p><p>å®¢æˆ·ç«¯ç”¨åˆ°çš„æ‰‹æ®µï¼Œåªèƒ½æ˜¯HTTPåè®®ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯HTTPåè®®é‡Œé¢ï¼Œå››ä¸ªè¡¨ç¤ºæ“ä½œæ–¹å¼çš„åŠ¨è¯ï¼šGETã€POSTã€PUTã€DELETEã€‚å®ƒä»¬åˆ†åˆ«å¯¹åº”å››ç§åŸºæœ¬æ“ä½œï¼šGETç”¨æ¥è·å–èµ„æºï¼ŒPOSTç”¨æ¥æ–°å»ºèµ„æºï¼ˆä¹Ÿå¯ä»¥ç”¨äºæ›´æ–°èµ„æºï¼‰ï¼ŒPUTç”¨æ¥æ›´æ–°èµ„æºï¼ŒDELETEç”¨æ¥åˆ é™¤èµ„æºã€‚</p><h2 id="æ€»ç»“RESTfulæ¶æ„"><a href="#æ€»ç»“RESTfulæ¶æ„" class="headerlink" title="æ€»ç»“RESTfulæ¶æ„"></a>æ€»ç»“RESTfulæ¶æ„</h2><p>ç»¼åˆä¸Šé¢çš„è§£é‡Šï¼Œæˆ‘ä»¬æ€»ç»“ä¸€ä¸‹ä»€ä¹ˆæ˜¯RESTfulæ¶æ„ï¼š</p><ol><li><strong>æ¯ä¸€ä¸ªURIä»£è¡¨ä¸€ç§èµ„æº</strong>ï¼›</li><li><strong>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ï¼Œä¼ é€’è¿™ç§èµ„æºçš„æŸç§è¡¨ç°å±‚</strong>ï¼›</li><li><strong>å®¢æˆ·ç«¯é€šè¿‡å››ä¸ªHTTPåŠ¨è¯ï¼Œå¯¹æœåŠ¡å™¨ç«¯èµ„æºè¿›è¡Œæ“ä½œï¼Œå®ç°â€è¡¨ç°å±‚çŠ¶æ€è½¬åŒ–â€</strong>ã€‚</li></ol><h1 id="GraphQL"><a href="#GraphQL" class="headerlink" title="GraphQL"></a>GraphQL</h1><p>GraphQLæ˜¯ä¸€ç§APIæŸ¥è¯¢è¯­è¨€ï¼Œæ˜¯ç”±Facebookåˆ›å»ºå¹¶æœ€ç»ˆå¼€æºçš„ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯RESTçš„ä¸€ç§æ›¿ä»£å“ã€‚æ¥è‡ªAXA Banqueçš„APIæ¶æ„å¸ˆLauretç»™å‡ºäº†ä¸€äº›å¯å¯¹äºŒè€…è¿›è¡Œæ¯”è¾ƒçš„åˆ‡å…¥ç‚¹ï¼š</p><ul><li>GraphQLèƒ½å¤Ÿé€šè¿‡ä¸€æ¬¡æŸ¥è¯¢å¾—åˆ°æ‰€æœ‰éœ€è¦çš„æ•°æ®ï¼Œä»è€Œå‡å°‘ç½‘ç»œè·³è½¬çš„æ¬¡æ•°ã€‚</li><li>GraphQLé‡‡ç”¨æ‰€è§å³æ‰€å¾—æ¨¡å‹ï¼Œè¿™æ ·å®¢æˆ·ç«¯ä»£ç ä¸æ˜“å‡ºé”™ã€‚</li><li>RESTful HTTPé€šè¿‡ä½¿ç”¨çŠ¶æ€ç å’ŒHTTP verbï¼Œæé«˜äº†ç»“æœçš„ä¸€è‡´æ€§å’Œå¯é¢„æµ‹æ€§ã€‚</li><li>å€ŸåŠ©è¶…åª’ä½“ï¼Œåœ¨ç”¨æˆ·ä½¿ç”¨APIæ—¶å¯ä»¥â€œå‘ç°â€èµ„æºé—´çš„å…³ç³»ï¼Œè¿™ç®€åŒ–äº†RESTfulç”¨æˆ·çš„å…·ä½“å®ç°ã€‚</li><li>HTTPå®ç°äº†ç¼“å­˜æœºåˆ¶è€ŒGraphQLè¿˜æ²¡æœ‰å®ç°ã€‚</li><li>GraphQLç»™ç”¨æˆ·æä¾›äº†schemaï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯æ¥å£æè¿°å¹¶éAPIæ–‡æ¡£ã€‚</li></ul><p><strong>Lauretè®¤ä¸ºGraphQLçš„ä¸»è¦ä¼˜åŠ¿æ˜¯å…¶ä½¿ç”¨çš„æ‰€è§å³æ‰€å¾—(WYSIWYG)æ¨¡å‹</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸ¥è¯¢ç»“æœçš„ç»“æ„æ˜¯æŸ¥è¯¢ç»“æ„æœ¬èº«çš„ç²¾ç¡®æ˜ å°„ï¼Œè¿™æ ·çš„è¯ï¼Œç”¨æˆ·åœ¨è§£æ’ï¼ˆunmarshalï¼‰å“åº”çš„æ—¶å€™ä¸å®¹æ˜“å‡ºé”™ã€‚</p><p>æœ‰å…´è¶£çš„æœ‹å‹å¯ä»¥çœ‹çœ‹è¿™ä¸¤ç¯‡è§£é‡ŠGraphQLçš„æ–‡ç« ï¼š</p><ul><li><a href="http://www.infoq.com/cn/news/2017/07/graphql-vs-rest#" target="_blank" rel="noopener">GraphQLå’ŒRESTå¯¹æ¯”æ—¶éœ€è¦æ³¨æ„äº›ä»€ä¹ˆ</a></li><li><a href="http://www.zcfy.cc/article/rest-apis-are-rest-in-peace-apis-long-live-graphql-3935.html" target="_blank" rel="noopener">å®‰æ¯å§ REST APIï¼ŒGraphQL é•¿å­˜</a></li></ul><p><strong>æˆ‘è§‰å¾—GraphQLæ›´å¤šçš„æ˜¯ä½œä¸ºRESTçš„ä¸€ç§æ›¿ä»£å“</strong>ã€‚</p><p><strong>å‚è€ƒæ–‡æ¡£</strong>ï¼š</p><ol><li><a href="http://blog.csdn.net/sdyy321/article/details/5838717" target="_blank" rel="noopener">JSPæœ¬è´¨</a></li><li><a href="http://www.blogjava.net/fancydeepin/archive/2013/09/30/404571.html" target="_blank" rel="noopener">JSP/Servlet å·¥ä½œåŸç†</a></li><li><a href="https://zh.wikipedia.org/wiki/HTML" target="_blank" rel="noopener">HTML - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦</a></li><li><a href="http://www.cnblogs.com/sharpxiajun/p/4282789.html" target="_blank" rel="noopener">å…³äºå¤§å‹ç½‘ç«™æŠ€æœ¯æ¼”è¿›çš„æ€è€ƒï¼ˆä¹ï¼‰â€“ç½‘ç«™é™æ€åŒ–å¤„ç†â€“æ€»è¿°ï¼ˆ1ï¼‰</a></li><li><a href="https://segmentfault.com/q/1010000011514355" target="_blank" rel="noopener">è¿™æ ·æ˜¯ä¸æ˜¯å°±å« å‰åç«¯åˆ†ç¦»å¼€å‘äº†ï¼Ÿ</a></li><li><a href="http://2014.jsconf.cn/slides/herman-taobaoweb/index.html#/" target="_blank" rel="noopener">http://2014.jsconf.cn/slides/herman-taobaoweb/index.html#/</a></li><li><a href="http://www.ruanyifeng.com/blog/2011/09/restful.html" target="_blank" rel="noopener">ç†è§£RESTfulæ¶æ„</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JSP </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Stringè§£æ</title>
      <link href="/String/"/>
      <url>/String/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>å¯ä»¥è¯æ˜ï¼Œå­—ç¬¦ä¸²æ“ä½œæ˜¯è®¡ç®—æœºç¨‹åºè®¾è®¡ä¸­æœ€å¸¸è§çš„è¡Œä¸ºã€‚</strong><br>Stringå¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼ŒæŸ¥çœ‹JDKæ–‡æ¡£ä½ å°±ä¼šå‘ç°ï¼ŒStringç±»æ¯ä¸€ä¸ªçœ‹èµ·æ¥ä¼šä¿®æ”¹Stringå€¼å¾—æ–¹æ³•ï¼Œå®é™…ä¸Šéƒ½æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„Stringå¯¹è±¡ï¼Œä»¥åŒ…å«ä¿®æ”¹åçš„å­—ç¬¦ä¸²å†…å®¹ã€‚è€Œæœ€åˆçš„stringå¯¹è±¡åˆ™ä¸æ¯«æœªåŠ¨ã€‚â€“Thinking in Java<br><a id="more"></a></p></blockquote><h1 id="å¸¸é‡æ± "><a href="#å¸¸é‡æ± " class="headerlink" title="å¸¸é‡æ± "></a>å¸¸é‡æ± </h1><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String str1 = <span class="string">"abc"</span>;</span><br><span class="line">String str2 = <span class="string">"abc"</span>;</span><br><span class="line">String str3 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);</span><br><span class="line">String str4 = <span class="keyword">new</span> String(<span class="string">"abc"</span>);</span><br><span class="line">String str5 = <span class="string">"abc"</span> + <span class="string">"li"</span>;</span><br><span class="line">String str6 = <span class="string">"abc"</span> + <span class="string">"li"</span>;</span><br><span class="line">String str7 = str1 + <span class="string">"li"</span>;</span><br><span class="line">String str8 = str1 + <span class="string">"li"</span>;</span><br><span class="line">String str9 = str1 + str2;</span><br><span class="line">String str10 = str1 + str2;</span><br><span class="line"></span><br><span class="line">System.out.println(str1 == str2);</span><br><span class="line">System.out.println(str3 == str4);</span><br><span class="line">System.out.println(str5 == str6);</span><br><span class="line">System.out.println(str7 == str8);</span><br><span class="line">System.out.println(str9 == str10);</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">true</span></span><br><span class="line"><span class="keyword">false</span></span><br><span class="line"><span class="keyword">false</span></span><br></pre></td></tr></table></figure></p><p>è¯´æ˜ï¼š</p><blockquote><p>åœ¨JAVAè™šæ‹Ÿæœºï¼ˆJVMï¼‰ä¸­å­˜åœ¨ç€ä¸€ä¸ªå­—ç¬¦ä¸²æ± ï¼Œå…¶ä¸­ä¿å­˜ç€å¾ˆå¤šStringå¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥è¢«å…±äº«ä½¿ç”¨ï¼Œå› æ­¤å®ƒæé«˜äº†æ•ˆç‡ã€‚ç”±äºStringç±»æ˜¯finalçš„ï¼Œå®ƒçš„å€¼ä¸€ç»åˆ›å»ºå°±ä¸å¯æ”¹å˜ï¼Œå› æ­¤æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒStringå¯¹è±¡å…±äº«è€Œå¸¦æ¥ç¨‹åºçš„æ··ä¹±ã€‚å­—ç¬¦ä¸²æ± ç”±Stringç±»ç»´æŠ¤ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨intern()æ–¹æ³•æ¥è®¿é—®å­—ç¬¦ä¸²æ± ã€‚</p></blockquote><ol><li><p>æˆ‘ä»¬å†å›å¤´çœ‹çœ‹String str1 = â€œabcâ€;  , è¿™è¡Œä»£ç è¢«æ‰§è¡Œçš„æ—¶å€™ï¼ŒJAVAè™šæ‹Ÿæœºé¦–å…ˆåœ¨å­—ç¬¦ä¸²æ± ä¸­æŸ¥æ‰¾æ˜¯å¦å·²ç»å­˜åœ¨äº†å€¼ä¸ºâ€abcâ€çš„è¿™ä¹ˆä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„åˆ¤æ–­ä¾æ®æ˜¯Stringç±»equals(Object obj)æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚æœæœ‰ï¼Œåˆ™ä¸å†åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç›´æ¥è¿”å›å·²å­˜åœ¨å¯¹è±¡çš„å¼•ç”¨ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™å…ˆåˆ›å»ºè¿™ä¸ªå¯¹è±¡ï¼Œç„¶åæŠŠå®ƒåŠ å…¥åˆ°å­—ç¬¦ä¸²æ± ä¸­ï¼Œå†å°†å®ƒçš„å¼•ç”¨è¿”å›ã€‚</p></li><li><p>new å°±æ˜¯åœ¨å †ä¸­é‡æ–°åˆ†é…äº†ä¸€å—å†…å­˜ï¼Œè™½ç„¶  str3  å’Œ  str4 å†…å®¹ç›¸åŒï¼Œä½†å®ƒä»¬æŒ‡å‘çš„æ˜¯ä¸åŒçš„å†…å­˜ã€‚</p></li><li><p>ä½¿ç”¨ â€œ + â€æ—¶ï¼Œ<br>â€œå­—ç¬¦1 â€œ + â€œå­—ç¬¦2â€ åœ¨ä¸Šé¢ç¬¬ä¸€æ¡å·²è¯´æ˜ï¼Œ<br>â€œå­—ç¬¦1â€+  å¼•ç”¨ å’Œ<br>å¼•ç”¨      + å¼•ç”¨  éƒ½å°†åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><h1 id="String-ç›¸ç­‰"><a href="#String-ç›¸ç­‰" class="headerlink" title="String ç›¸ç­‰ ?"></a>String ç›¸ç­‰ ?</h1></li></ol><h2 id="å¼•ç”¨ç›¸ç­‰ï¼š"><a href="#å¼•ç”¨ç›¸ç­‰ï¼š" class="headerlink" title="å¼•ç”¨ç›¸ç­‰ï¼š"></a>å¼•ç”¨ç›¸ç­‰ï¼š</h2><p>â€œ==â€ï¼Œé€šè¿‡â€œ==â€è¿ç®—ç¬¦æ¥æ¯”è¾ƒå†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</p><p><code>C++String</code>ç±»é‡è½½äº†==è¿ç®—ç¬¦ä»¥æ£€æµ‹å­—ç¬¦ä¸²å†…å®¹çš„ç›¸ç­‰æ€§ã€‚</p><h2 id="å†…å®¹ç›¸ç­‰ï¼šequals-æ–¹æ³•"><a href="#å†…å®¹ç›¸ç­‰ï¼šequals-æ–¹æ³•" class="headerlink" title="å†…å®¹ç›¸ç­‰ï¼šequals æ–¹æ³•"></a>å†…å®¹ç›¸ç­‰ï¼šequals æ–¹æ³•</h2><p>æ¯”è¾ƒä¸¤ä¸ªStringå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸åŒæ—¶æ˜¯ä½¿ç”¨equalsæ–¹æ³•ï¼Œequalsæ–¹æ³•æ˜¯Stringç±»ç»§æ‰¿ä¸Objectç±»çš„ï¼Œ<br>åœ¨<strong>Objectç±»çš„equalsæ–¹æ³•çš„æœ¬è´¨å…¶å®æ˜¯å’Œâ€œ==â€ä¸€æ ·çš„ï¼Œéƒ½æ˜¯æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å¼•ç”¨æ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡</strong>ï¼ˆå³ä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€å¯¹è±¡ï¼‰ã€‚<br>é‚£ä¸ºä»€ä¹ˆStringç±»çš„equalsæ–¹æ³•å´åˆæ˜¯æ¯”è¾ƒä¸¤ä¸ªStringå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸åŒå‘¢ï¼Ÿ</p><p>åŸæ¥æ˜¯è¿™æ ·çš„ï¼ŒStringç±»ç»§æ‰¿Objectç±»åï¼Œä¹Ÿç»§æ‰¿äº†equalsæ–¹æ³•ï¼Œä½†Stringç±»å¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™ï¼Œæ”¹å˜äº†equalsæ–¹æ³•çš„æ¯”è¾ƒå½¢å¼ã€‚å…¶å®å¾ˆå¤šå…¶ä»–ç±»ç»§æ‰¿Objectç±»åä¹Ÿå¯¹equalsæ–¹æ³•è¿›è¡Œäº†é‡å†™ã€‚</p><p>jdk1.8.0_92  ä¸­Stringç±»ä¸­equals æ–¹æ³•<br><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object anObject)</span> </span>&#123;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (<span class="keyword">this</span> == anObject) &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">if</span> (anObject <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">Â  Â  Â  Â  String anotherString = (String)anObject;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">int</span> n = value.length;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">if</span> (n == anotherString.value.length) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">char</span> v1[] = value;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">char</span> v2[] = anotherString.value;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">while</span> (n-- != <span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (v1[i] != v2[i])</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  i++;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">Â  Â  <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h1 id="ç¼–ç ï¼š"><a href="#ç¼–ç ï¼š" class="headerlink" title="ç¼–ç ï¼š"></a>ç¼–ç ï¼š</h1><pre><code>ä»£ç ç‚¹å’Œä»£ç å•å…ƒ</code></pre><p>å­—èŠ‚æ˜¯è®¡ç®—æœºå­˜å‚¨ä¿¡æ¯çš„åŸºæœ¬å•ä½ï¼Œ<strong>1 ä¸ªå­—èŠ‚ç­‰äº 8 ä½</strong>ï¼Œ <strong>gbk ç¼–ç ä¸­ 1 ä¸ªæ±‰å­—å­—ç¬¦å­˜å‚¨éœ€è¦ 2 ä¸ªå­—èŠ‚</strong>ï¼Œ<strong>1 ä¸ªè‹±æ–‡å­—ç¬¦å­˜å‚¨éœ€è¦ 1 ä¸ªå­—èŠ‚</strong>ã€‚æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°ä¸Šé¢çš„ç¨‹åºè¿è¡Œç»“æœä¸­ï¼Œæ¯ä¸ªæ±‰å­—å¯¹åº”ä¸¤ä¸ªå­—èŠ‚å€¼ï¼Œå¦‚â€œå­¦â€å¯¹åº” â€œ-47 -89â€ ï¼Œè€Œè‹±æ–‡å­—æ¯ â€œJâ€ å¯¹åº” â€œ74â€ ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å‘ç°æ±‰å­—å¯¹åº”çš„å­—èŠ‚å€¼ä¸ºè´Ÿæ•°ï¼ŒåŸå› åœ¨äºæ¯ä¸ªå­—èŠ‚æ˜¯ 8 ä½ï¼Œæœ€å¤§å€¼ä¸èƒ½è¶…è¿‡ 127ï¼Œè€Œ<strong>æ±‰å­—è½¬æ¢ä¸ºå­—èŠ‚åè¶…è¿‡ 127ï¼Œå¦‚æœè¶…è¿‡å°±ä¼šæº¢å‡ºï¼Œä»¥è´Ÿæ•°çš„å½¢å¼æ˜¾ç¤ºã€‚</strong></p><h1 id="æ­£åˆ™ï¼š"><a href="#æ­£åˆ™ï¼š" class="headerlink" title="æ­£åˆ™ï¼š"></a>æ­£åˆ™ï¼š</h1><h2 id="Stringç±»è‡ªå¸¦æ­£åˆ™è¡¨è¾¾å¼ï¼š"><a href="#Stringç±»è‡ªå¸¦æ­£åˆ™è¡¨è¾¾å¼ï¼š" class="headerlink" title="Stringç±»è‡ªå¸¦æ­£åˆ™è¡¨è¾¾å¼ï¼š"></a>Stringç±»è‡ªå¸¦æ­£åˆ™è¡¨è¾¾å¼ï¼š</h2><p>public boolean matches(String regex)å‘ŠçŸ¥æ­¤å­—ç¬¦ä¸²æ˜¯å¦åŒ¹é…ç»™å®šçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚<br>è°ƒç”¨æ­¤æ–¹æ³•çš„ str.matches(regex) å½¢å¼ä¸ä»¥ä¸‹è¡¨è¾¾å¼äº§ç”Ÿçš„ç»“æœå®Œå…¨ç›¸åŒï¼š<br>Pattern.matches(regex, str)</p><p>java çš„ â€œ \ â€œç­‰äºå…¶ä»–è¯­è¨€çš„â€ \</p><h1 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h1><p>ç©ºä¸²æ˜¯ä¸€ä¸ªå¯¹è±¡</p><h1 id="å¸¸ç”¨API"><a href="#å¸¸ç”¨API" class="headerlink" title="å¸¸ç”¨API"></a>å¸¸ç”¨API</h1><pre><code>public char **charAt**(int index)  </code></pre><p>è¿”å›æŒ‡å®šç´¢å¼•å¤„çš„charå€¼</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> String </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
